# Measuring and Optimizing HLS Performance

## Summary
HTTP Live Streaming (HLS) is used to stream live and on-demand content to global audiences. Discover how to adjust and tune stream authoring and delivery elements to improve the viewing experience. Learn how to accurately measure your streaming performance, identify optimization opportunities, and implement changes to your HLS streams that can significantly improve the user experience.

## Info
* Media
* WWDC 2018 - Session 502 - iOS, macOS, tvOS
* https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/

## Text
 [[ Music ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=7) [&gt;&gt; Hello. Good morning,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=20) [everyone.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=22) [[ Applause ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=23) [And welcome to this year's](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=27) [session on HTP Light Streaming.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=28) [My name is Emil Andriescu.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=31) [Today's talk is about measuring](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=33) [and optimizing HLS performance.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=35) [First, let's reflect for a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=38) [second on why we should care and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=40) [why it is essential for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=42) [application.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=44) [Let's pretend it's Saturday](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=45) [night, you're in your favorite](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=48) [spot on the couch, you've](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=50) [skillfully browsed through all](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=52) [the reviews, title is set,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=53) [popcorn is ready, and you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=55) [eagerly tap play when this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=58) [eagerly tap play when this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=58) [happens.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=60) [Faced with this mysteriously and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=62) [never-ending animation, you ask](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=65) [yourself, what could be worse.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=67) [Let's face it, you know it, it's](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=70) [a playback error.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=72) [But what do customers really](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=73) [expect from HTP Light Streaming?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=77) [Well, they expect](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=81) [high-definition image, high](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=82) [fidelity sound, and instant](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=84) [media response when they tap](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=86) [play.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=88) [Yet, streaming applications over](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=89) [the internet are always at the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=91) [mercy of the network, so how do](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=92) [we reconcile?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=94) [Well, HTP Light Streaming was](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=96) [designed to address this, that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=98) [is to provide the best possible](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=100) [uninterrupted streaming](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=102) [experience in an unpredictable](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=103) [network environment.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=106) [So why are we here?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=107) [Well, there's more.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=108) [Over time, HLS has evolved into](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=110) [a more dynamic ecosystem,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=112) [supporting new offering features](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=114) [such as I-frame playback, new](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=116) [media formats, and of course new](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=118) [media formats, and of course new](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=118) [codecs.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=120) [At the same time, we're](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=121) [constantly adding powerful iOS,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=123) [tvOS, and macOS APIs such as you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=126) [can tune and adjust playback to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=129) [your target audience and provide](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=132) [a much richer user experience.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=133) [Delivery patterns and transport](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=136) [protocols, they are also](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=138) [evolving, so it is important to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=140) [look at your server side](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=142) [performance in connection to how](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=143) [content is being consumed,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=146) [either on a mobile device or in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=147) [the living room.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=149) [Given all these options, how can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=154) [you be sure that you are](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=156) [providing the best possible user](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=157) [experience to your audience?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=159) [Well, the first step is to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=161) [understand and quantify the user](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=163) [experience in conjunction to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=165) [changes that you make to your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=167) [content, application, or](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=169) [delivery.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=170) [This is an area where we believe](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=172) [it is imperative to measure](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=173) [rather than to guess which](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=175) [configuration is optimal.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=177) [What is this session about?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=180) [First, we want to establish a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=182) [common language for discussing](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=183) [streaming quality of service.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=185) [Second, we want to discuss how](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=187) [to objectively measure your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=189) [application streaming](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=191) [performance.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=192) [Third, we want to help you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=193) [identify and solve some of the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=195) [problems that impair streaming](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=197) [quality of service.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=199) [And finally, we want to get](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=202) [those master playlists right.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=204) [This is because many of the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=205) [problems and issues that we see](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=207) [with streaming quality are](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=209) [actually rooted in the authoring](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=211) [of the master playlist.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=213) [Before going into detail, let's](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=215) [begin with a brief overview of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=217) [an HLS playback session.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=218) [As you'd expect, it begins with](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=221) [the download of a master](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=222) [playlist.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=223) [Once the playlist is passed by](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=224) [AV Player, it knows what content](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=227) [it refers to.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=229) [In this case, we have two](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=230) [bitrates, 1 megabit and 2](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=231) [megabit.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=233) [AV Player will pick one of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=233) [these, will go ahead and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=235) [download a media playlist](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=237) [together with additional](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=238) [artifacts such as keys, and then](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=239) [artifacts such as keys, and then](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=239) [continue to download media](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=241) [segments until the buffer level](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=243) [is sufficient for playback.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=245) [When that happens, the AV Player](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=247) [item will communicate a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=250) [prediction of playability by](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=251) [setting the is playback likely](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=254) [to keep up property to true.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=256) [If you've preset the AV Player](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=258) [Rate to 1, so you're using the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=260) [Autoplay feature of a AV Player,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=262) [the player will go ahead and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=264) [start playback immediately.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=266) [We call this Time Interval](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=268) [Startup Time.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=269) [From this point on, the wall](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=271) [clock, also known as real time,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=273) [and the player item time base](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=275) [will advance at the same speed,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=277) [with one condition, which is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=279) [that content must arrive at an](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=281) [equivalent or faster rate than](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=283) [that which AV Player is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=286) [consuming.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=287) [If that's not the case, AV](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=288) [Player will try and switch down](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=289) [to the 1 megabit here.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=292) [If network still cannot keep up](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=293) [with real time at 1 megabit,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=295) [well the buffer will eventually](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=297) [run dry, and AV Player has no](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=299) [run dry, and AV Player has no](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=299) [choice here, it needs to stop](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=301) [playback, event which we call a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=303) [stall.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=304) [The player will remain in this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=305) [state not only until data starts](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=307) [flowing again, but up until](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=309) [there's a sufficient level of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=310) [buffer for the player item to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=311) [trigger another positive](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=313) [playability prediction.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=315) [After that, playback can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=317) [continue normally.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=318) [Now let's discuss about](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=320) [quantifying the user experience](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=322) [for such a session.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=324) [We do that by defining a set of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=326) [Key Performance Indicators or](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=327) [KPIs.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=329) [We picked five of them that we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=331) [believe are most representative](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=332) [for HTP Light Streaming.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=334) [One question you may ask is how](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=336) [much time do my users spend](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=338) [waiting for playback to start.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=340) [Is it one second?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=342) [Is it five seconds or maybe 30](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=344) [seconds?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=346) [This is an essential point in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=347) [terms of user experience.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=349) [Further, playback stalls, like](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=351) [the one we just saw, they are](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=353) [disruptive to the user.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=355) [We care both about how often](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=357) [they occur, but maybe more](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=359) [they occur, but maybe more](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=359) [importantly, how long does it](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=360) [take to recover from a stall?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=362) [Yet, the best strategy without](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=365) [knowledge of the future to not](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=367) [stall is to deliver content at](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=369) [the lowest available bitrate.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=371) [But of course that's not what we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=373) [want.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=374) [We want to deliver the best](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=374) [audio and video quality while](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=376) [still not stalling.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=378) [So there's a clear tradeoff](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=379) [between risk of stalling and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=381) [media quality, right.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=383) [For that, we need another](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=384) [measure of the overall media](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=386) [quality for a session.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=388) [And finally, playback errors.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=390) [We talked about that.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=392) [They are more disruptive than](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=394) [stalls, right.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=395) [What can we do to track playback](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=396) [errors?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=399) [Okay.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=401) [Let's begin with startup time.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=401) [There are multiple APIs that you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=403) [can use to obtain or compute](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=405) [startup time.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=407) [First, don't use the AV Player](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=408) [status changing to ready to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=411) [play.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=412) [That doesn't tell you that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=412) [playback is going to start.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=413) [However, if you are using](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=416) [Autoplay, so you're setting the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=418) [rate, the player's rate in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=419) [rate, the player's rate in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=419) [advance, you can use the AV](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=420) [Player item status changing to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=422) [ready to play or the AV Player](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=424) [item is playback likely to keep](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=426) [out changing to true.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=428) [These are observable properties.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=429) [When that happens, you know that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=432) [playback is about to start, but](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=433) [there might be a few](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=435) [milliseconds before playback](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=437) [actually starts.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=438) [So what we recommend is to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=439) [either use the AV Player time](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=441) [control status changing to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=443) [playing or to track the player](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=445) [item time base, and there's a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=446) [notification that allows you to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=448) [do that.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=449) [AV Player relies on heuristics](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=450) [to avoid stalls, but we know it,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=454) [sometimes they're unavoidable.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=456) [You can monitor as stalls occur](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=458) [by registering to the AV Player](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=460) [item playback stall](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=462) [notification.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=463) [The suggestion here is to count](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=465) [the occurrence of stalls.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=466) [Of course, if you want to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=468) [compare and aggregate stall](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=469) [behavior across sessions of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=472) [different duration, then you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=474) [need to normalize this.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=476) [How do you do that?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=477) [Well, we recommend that you use](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=478) [Well, we recommend that you use](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=478) [the total duration watched and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=480) [compute the stall rate in terms](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=481) [of stalls per unit of time](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=484) [watched, such as stalls per](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=487) [hour.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=488) [A stall of 30 seconds is much](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=489) [worse to the user than a stall](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=493) [of one second.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=496) [This is why we also care about](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=497) [rebuffering time or stall](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=499) [duration.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=500) [By measuring the time interval](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=502) [between playback stalled](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=503) [notification and when the player](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=505) [item time base changes back to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=506) [1, you can compute an accurate](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=508) [stall duration.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=511) [Again, the total duration can be](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=512) [normalized using the duration](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=514) [watched of the session.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=517) [Well, you might be wondering at](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=519) [this point, how do I compute the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=520) [duration watched of a session?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=521) [And the answer is, through the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=523) [Access Log.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=524) [Let's see how we do that.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=525) [So this is a snippet of code.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=527) [First, we get a reference to the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=530) [Access Log from the player item.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=532) [We iterate through the events in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=535) [the Access Log, and we simply](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=537) [sum up each events duration](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=539) [sum up each events duration](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=539) [watch.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=542) [And there you have it.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=542) [We computed a total duration](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=543) [watch for a session.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=544) [And now you may be wondering,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=545) [well what is this event?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=547) [What is an event in the access](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=548) [log mean?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=549) [Well, for that let's look at how](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=550) [AV Player Item Access Log works.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=552) [So the AV Player Item Access Log](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=555) [provides a history of your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=556) [session.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=558) [It is initially null, but as](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=559) [playback occurs, you're going to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=561) [receive an AV Player Item New](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=563) [Access Log Entry notification,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=565) [and by that time, you'll have an](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=567) [Access Log.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=568) [You'll see that events in the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=569) [Access Log contain information](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=570) [on various areas such as the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=573) [current variant URL, the current](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=576) [bitrate, duration watch, number](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=578) [of stalls, and so on.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=581) [These values are initially by](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=583) [convention initialized to a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=585) [negative value or null.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=587) [As playback occurs, they are](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=589) [updated with actual measurement](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=592) [data and the actual variant URL](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=593) [that you're playing.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=595) [There are two cases in which we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=596) [will add new events to the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=599) [will add new events to the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=599) [Access Log, and that is variant](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=600) [switch, like in this case, or a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=602) [playback seek.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=604) [But before a new event is added,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=606) [the old one becomes immutable,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=608) [and then we add the new event.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=610) [Now, keep in mind that while](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=612) [these values here are constantly](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=613) [updating as playback occurs, so](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=616) [the values in the last event,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=617) [they are not observable](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=621) [properties.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=622) [We also mentioned that we care](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=625) [about media quality.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=626) [How do we compute that?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=629) [A way to measure if the user is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=633) [presented with the best possible](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=635) [media quality is of course to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=636) [look at the video bitrate being](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=638) [served.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=639) [Here we don't really care about](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=640) [the startup time or the stall](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=642) [duration, so let's remove those.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=644) [So we're left with the playback](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=646) [state.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=647) [In this example, we see that we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=648) [played for a longer time on the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=650) [2 megabit variant and less time](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=652) [at 1 megabit.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=655) [By time weighting each bitrate,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=657) [we can obtain a single value of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=659) [we can obtain a single value of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=659) [video quality that we can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=661) [compare across sessions.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=662) [We call this measure a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=666) [Time-Weighted Indicated Bitrate,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=667) [and computing it is just as](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=669) [simple as with the total](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=671) [duration.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=673) [Once again, we get a reference](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=675) [to the Player Items Access Log.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=677) [We iterate through the events in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=679) [the log.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=681) [We compute the time weight of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=681) [each event with respect to the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=683) [total duration watch we computed](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=685) [earlier, and finally, we sum up](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=686) [the weighted bitrate value.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=689) [Now keep in mind that some of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=691) [these properties may not be](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=693) [initialized, so do the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=695) [appropriate checks in your code.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=696) [Another event which you must](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=701) [absolutely track is of course](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=702) [playback failure.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=704) [To do that, you observe the AV](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=705) [Player item status.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=707) [If the value ever changes to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=709) [false, it means AV Player](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=711) [encountered an unrecoverable](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=712) [error.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=714) [A good way to transform this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=715) [observation into a KPI?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=716) [Well, one way to do it is to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=719) [Well, one way to do it is to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=719) [look at the percentage of failed](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=723) [sessions with respect to total](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=724) [sessions, but there might be](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=726) [other ways to do it.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=727) [One thing I want to stress here](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=728) [is that not all errors in your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=730) [stream may be fatal.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=732) [Some may impact media quality](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=734) [while some might not even be](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=736) [perceivable by the user.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=738) [But nonetheless, if there are](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=739) [errors, they convey that there](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=741) [is an issue with your stream.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=743) [So how do I get more insights on](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=745) [the stream, right, what](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=749) [happened?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=750) [And the answer is from the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=751) [Player Item Error Log.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=752) [The AV Player Item Error Log.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=755) [The Error Log conveys failures](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=757) [with varying degrees of user](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=758) [impact.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=760) [It works in a similar fashion as](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=761) [the Access Log except that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=763) [events represent error rather](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=765) [than player access states.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=767) [They cover various areas, such](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=769) [as delivery issues, network](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=772) [issues, content authoring](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=774) [errors, and so on.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=776) [For instance, they can give you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=777) [an insight on why a stall](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=779) [an insight on why a stall](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=779) [occurred, such as no response](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=781) [for a media file for about ten](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=783) [seconds.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=784) [So we talked about startup time](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=785) [that you can track for every](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=789) [session.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=790) [We encourage you to take a look](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=791) [at the distribution of startup](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=792) [times for your application.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=794) [We also talked about stall](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=796) [occurrence and stall duration.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=798) [We mentioned that Time-Weighted](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=800) [Indicated Bitrate is a good](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=802) [indication of experienced media](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=803) [quality across a session, and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=805) [finally, you probably want to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=807) [keep the percentage of failed](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=809) [sessions as low as possible.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=810) [Keep in mind that not all KPIs](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=816) [are comparable across sessions.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=819) [One example of that is that AV](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=822) [Player foundation uses the AV](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=824) [Player layer size on the screen](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=826) [to evaluate illegible variants](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=828) [for HLS.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=830) [So for instance, if you've got](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=831) [10 ATP content, it will probably](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=833) [not be displayed on a 200 pixel](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=835) [view, but it doesn't mean the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=837) [user experienced poor image](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=838) [user experienced poor image](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=838) [quality.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=841) [What to do then?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=842) [We recommend that you gather](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=843) [additional context information](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=845) [along with your streaming](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=847) [metrics.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=848) [This will allow you to later](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=849) [partition your playback sessions](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=850) [in classes that make sense for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=852) [your application.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=854) [Sample code for this section is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=856) [available on the Apple developer](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=858) [website as part of the HLS](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=860) [catalogue sample.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=861) [Now, please let me welcome](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=864) [Zhenheng Li, who will talk to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=866) [you about ways to improve HLS](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=868) [performance.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=869) [Thank you.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=869) [[ Applause ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=870) [&gt;&gt; Thank you, Emil.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=875) [Hello, everyone.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=883) [My name is Zhenheng.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=883) [We have discussed all the KPIs](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=885) [that our users care the most.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=890) [In this part of talk, let's](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=893) [focus on ways to improve these](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=895) [APIs.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=897) [We will look deeper in three](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=897) [areas.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=899) [areas.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=899) [One, how to reduce the startup](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=900) [time.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=903) [Two, how to investigate and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=905) [avoid stalls.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=907) [Three, how to investigate and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=909) [avoid errors.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=911) [Let's get started.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=913) [So what can delay start of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=915) [playback?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=917) [Here is an example of the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=919) [operations from the user clicks](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=920) [play until the video start to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=923) [play back.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=925) [The application create every](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=927) [asset and start inspection of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=928) [the asset to find out durations](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=931) [and awardable media options of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=934) [the asset.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=936) [It takes a few round trip](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=938) [between the device and the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=940) [content server to download the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=942) [master playlist and [inaudible]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=945) [playlist.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=947) [After that, the application](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=948) [create AV Player and AV Player](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=950) [Item.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=953) [Buffering starts.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=954) [Oftentime, buffering is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=956) [interrupted, content is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=959) [interrupted, content is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=959) [encrypted.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=961) [It takes a few round trips](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=962) [between the device and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=964) [[inaudible] to fetch the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=966) [decryption keys.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=967) [Once the keys are fetched,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=969) [buffering resumes.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=972) [However, it may be interrupted](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=975) [again.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=977) [Let's say the application offers](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=978) [a feature, resumes from the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=980) [previously watched point.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=982) [Application sets a sic time, a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=985) [set [inaudible] time on the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=987) [player on behalf of the user.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=988) [Every player discard the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=992) [existing buffer and start](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=994) [download from a new location.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=996) [Segment 100.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=998) [Again, it maybe interrupted.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1001) [Users has a language preference](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1004) [setting in the application.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1007) [She or he prefers Spanish audio.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1010) [Thus, application sets media](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1013) [selection on the player item,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1015) [existing audio buffer being](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1017) [discarded, player start](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1019) [discarded, player start](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1019) [downloading from a different](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1021) [language variant.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1024) [In a few seconds later, player](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1025) [item notifies playback is like](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1028) [to keep up, application sets a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1031) [rate.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1034) [Playback starts, and it](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1035) [continues.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1037) [All this time, user is waiting.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1038) [So as we can see, it does take a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1042) [few time-consuming operations to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1045) [start up, run a trip between the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1048) [device and the content server](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1051) [and the key servers.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1053) [Round trip times between AV](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1055) [Player and applications,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1057) [oftentimes these two sit at](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1060) [different processes.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1062) [So how the application measures](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1064) [the time cost and startup time?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1066) [It may measure the time spent](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1069) [between the API calls and the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1072) [player and the Player Item](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1075) [status change notifications.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1077) [Every player item also offers](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1079) [Every player item also offers](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1079) [startup time in the Access Log.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1082) [This time is measured by the AV](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1086) [Player item, represents the time](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1089) [for buffering only.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1091) [It's measured from the start](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1094) [media downloading until the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1095) [first playback is selected to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1097) [keep up.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1099) [So our user wants the video to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1101) [start fast, in at most a few](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1103) [seconds.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1106) [There are ways to achieve that.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1107) [One option, we can move some](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1110) [operations to a different stage](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1113) [before the user clicks play.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1116) [For example, AV Asset creation](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1120) [and inspection can be moved out.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1124) [Key fetching can be moved out.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1126) [Thus, when the users starts a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1131) [video playback, there is less](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1134) [waiting time.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1137) [So where do we move those](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1139) [So where do we move those](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1139) [operations to?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1140) [While your user is viewing the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1143) [video catalogue or video info,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1146) [it's a good time to create an](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1149) [inspect AV Asset before the user](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1152) [decides to play.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1155) [Now, last year we had introduced](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1157) [AV Content Key Session API.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1159) [This new API decouples the media](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1162) [load from key fetching.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1165) [It gives the application total](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1167) [control on key management.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1169) [It offers ways to optimize key](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1171) [fetching, such as bundling up](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1175) [multiple key requests back to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1177) [the key server.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1179) [If you happen to adopt AV](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1181) [Content Key Session, spending a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1183) [few hours of engineering hours,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1185) [your user will notice a faster](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1188) [startup time.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1190) [So we have moved the AV Asset](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1193) [creation and key fetching out of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1196) [startup time.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1198) [Now what's left is mainly the AV](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1199) [Now what's left is mainly the AV](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1199) [Player Item buffering time and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1203) [the communication time from AV](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1205) [Player and your application.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1208) [Oftentime, app may be able to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1211) [avoid buffering, such as due to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1214) [[inaudible] or due to media](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1219) [options.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1219) [We can even try to reduce the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1220) [round trip time between the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1224) [player and the application.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1226) [Thus the startup is further](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1229) [reduced.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1230) [Let's take a look.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1233) [When you create AV Player Item,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1234) [if you know where your user is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1238) [intending to start the playback,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1242) [set the current time on player](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1245) [item.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1246) [If you know what are the media](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1247) [options such as which language](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1249) [to download for playback, set](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1251) [that as well before you set the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1253) [AV Player item onto the player.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1256) [Same with the AV plyer.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1259) [Same with the AV plyer.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1259) [As soon as the user click play,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1262) [set rate before the start](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1265) [downloading for the AV Player](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1267) [Item.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1271) [Thus, the playback will start](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1272) [automatically as soon as Player](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1273) [Item has enough to play back.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1276) [In summary, set up AV Player](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1279) [before buffering.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1282) [Set AV Player rate before](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1284) [setting the player item onto the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1288) [player.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1291) [A lot of application offers a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1291) [feature to allow the user choose](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1296) [multiple videos and play one](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1299) [after another, such as binge](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1301) [watching TV episodes.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1303) [We have seen implementation such](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1306) [as one player and one player](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1308) [item per video.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1310) [There's always a startup](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1312) [buffering time for each new](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1314) [video.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1316) [You may reduce that buffering](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1317) [time for the new video by AV](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1320) [Queue Player.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1322) [Create multiple player items,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1325) [include them all on the play](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1328) [queue.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1330) [While the player is playing the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1331) [current item, when the media](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1334) [download finishes for the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1337) [current item, player will start](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1339) [downloading for the next one](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1342) [while the current one is still](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1344) [playing.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1345) [Thus, the next player item will](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1347) [start playback as soon as](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1350) [current event play to the end.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1352) [So do use AV Queue Player to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1355) [play multiple items and enqueue](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1359) [second AV Player Item well in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1362) [advance.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1364) [So what's left now?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1367) [Buffering time.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1369) [First, what determine network](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1371) [buffering time.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1374) [Four factors.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1375) [The choice of your variant, the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1377) [The choice of your variant, the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1377) [content bitrate, your playlist](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1381) [target duration, and of course,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1384) [last, the network bandwidth.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1386) [Let's take a look a few examples](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1389) [of buffering time.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1393) [First, it's a simple master](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1396) [playlist.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1398) [It specifies an ATP video at](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1399) [about 5 mbps.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1402) [Let's assume the network](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1404) [bandwidth is around 6 mbps.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1406) [Our target duration is 10](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1408) [seconds.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1411) [In most of the cases, player](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1412) [item buffers one segment before](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1415) [it notifies playback it like to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1419) [keep up.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1421) [However, the same master](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1422) [playlist, almost the same](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1426) [network condition, the user may](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1428) [observe slower startup.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1431) [The reason is, remember, the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1435) [network bandwidths change, and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1438) [network bandwidths change, and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1438) [the content bitrate also change.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1440) [In this case, there are a few](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1442) [segments take longer to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1444) [download.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1445) [Thus, it takes longer to start.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1446) [To solve this problem, offering](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1449) [a variant with lower bitrate may](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1453) [help.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1454) [Player may decide to switch down](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1456) [and start up sooner.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1460) [When all other information is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1464) [absent, the first listed variant](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1466) [will be your startup variant.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1469) [So in this example, same two](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1471) [variants.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1475) [The lower bitrate is listed](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1476) [first with same network](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1477) [condition.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1479) [Player will start faster, start](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1480) [up faster and also switch up](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1485) [pretty quickly given the network](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1487) [bandwidth is sufficient for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1490) [playback.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1492) [In summary, to reduce network](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1493) [buffering time, make a wise](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1498) [buffering time, make a wise](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1498) [choice of initial variant.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1500) [Lower content bitrate means](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1502) [shorter buffering time, but it](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1505) [is a tradeoff of video quality.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1507) [If you are offering multiple](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1511) [media formats such as HDR and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1513) [SDR videos or stereo audio and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1516) [multiple-channel audios, make](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1519) [sure the initial variant for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1522) [each media format are on similar](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1526) [level of bitrate so your user](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1529) [will have a similar experience](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1532) [regardless what kind of viewing](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1534) [setup they have.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1536) [That's all about reduce startup](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1538) [time.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1541) [Our video has started.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1542) [Next, let's talk about stalls.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1545) [To be really clear, stalls can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1548) [happen, especially when the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1551) [network bandwidth is really low.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1553) [So in this part of talk, let's](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1556) [focus on how to investigate](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1558) [stalls and how to improve or](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1559) [stalls and how to improve or](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1559) [avoid stalls.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1563) [How the application investigate](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1564) [stalls.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1568) [The application should be](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1569) [listening to the stall](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1570) [notification at all time.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1572) [And the application should be](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1576) [also checking the AV Player](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1577) [status such as is playback](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1580) [likely to keep up.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1583) [AV Player Item also offers Error](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1587) [Log and Access Logs.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1590) [The application should be](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1592) [listening to an exam those logs](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1593) [when the stall happens.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1597) [Next, let's take a look two](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1599) [stall examples.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1603) [First, stall notification has](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1604) [been received by the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1607) [application.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1608) [The application should have](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1609) [received the Error Log as well.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1612) [The error comments give you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1615) [detailed information on what has](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1618) [detailed information on what has](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1618) [happened.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1620) [In this case, it says media file](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1621) [not received in 15 seconds.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1623) [Application checks Access Log to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1626) [find out what the AV Player was](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1629) [playing at the moment when the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1632) [stall happened.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1634) [It tells you detailed](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1635) [information such as the player](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1637) [was playing what content and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1640) [such URI.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1642) [The indicated bitrate is the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1644) [content bitrate.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1646) [In this case, 36 mbps, and that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1647) [is a [inaudible] content.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1650) [An observed bitrate is the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1652) [current network bandwidth.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1655) [In this case is 2.8 mbps.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1657) [It's obviously due to the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1660) [network bandwidth can't catch up](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1663) [with the content bitrate.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1665) [So to deal with variable](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1667) [networks, remember to provide a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1670) [full set of bitrate.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1673) [Remember some of your users may](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1675) [have a slower network](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1677) [connection, or your user may be](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1678) [connection, or your user may be](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1678) [on the go, such as on cellular](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1681) [while viewing the video.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1683) [If you're offering multiple](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1685) [video, multiple media formats,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1687) [each codec combination needs](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1690) [it's own set of tiers.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1692) [Not all stalls are due to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1696) [network condition.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1700) [Let's look at this one.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1702) [Stall happened, Error Log tells](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1704) [you a different story this time.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1706) [It says playlist file unchanged](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1709) [for two consecutive reads.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1712) [If you check the Access Log at](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1715) [the time, player was playing](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1717) [live.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1720) [They indicated the bitrate is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1722) [rather low.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1723) [The content is about 400K, and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1724) [the network bandwidth is 3.7](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1728) [mbps.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1731) [This look like a content](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1731) [delivery issue.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1733) [So to reduce or to avoid stalls](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1737) [due to content delivery, content](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1739) [due to content delivery, content](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1739) [server and CDN must deliver](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1741) [media files, segments, keys](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1744) [without any delay.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1747) [Update live playlist at least](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1749) [every target duration.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1751) [The CDN [inaudible] must be](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1753) [configured to deliver most](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1755) [recent playlist to avoid stale](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1757) [playlists.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1762) [Synchronized discontinuity](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1762) [sequence number between](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1764) [playlist.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1765) [Indicate server-side failure](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1767) [clearly using right HTTP status](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1769) [code.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1772) [That's all about stall.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1775) [What about error?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1777) [How do we investigate errors?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1779) [There are a few ways.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1782) [We have Error Log and Access Log](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1785) [from AV Player Item.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1789) [We also have error property from](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1792) [every player and player item](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1795) [that the application can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1797) [observe.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1800) [In addition, we have some media](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1802) [validation tools for you to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1804) [detect the content issue.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1806) [Let's look at them one by one.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1809) [AV Player Item Error Log, they](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1811) [have talked a little bit about](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1815) [[inaudible] in this one.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1817) [This type of Error Log is an](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1819) [indication that there is a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1821) [problem with network or content](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1822) [format.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1824) [However, they are not always](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1825) [fatal.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1827) [When the error is indicated,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1828) [playback may be perfectly fine](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1831) [at that moment.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1833) [However, the application showed](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1836) [the check in the error comments](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1838) [to find out details, such as](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1840) [this one.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1842) [We have seen it before, media](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1844) [file not received in 15 seconds.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1846) [So it's an indication that your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1849) [user may have observed or will](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1851) [observe stalls.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1854) [Now next one is HTTP error, it](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1856) [Now next one is HTTP error, it](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1856) [says file not found.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1860) [This an indication of a content](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1861) [delivery issue.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1863) [The user may observe audio loss,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1865) [video loss, or both.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1867) [[inaudible] specified bandwidth](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1873) [for variant.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1875) [Now this is an interesting one.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1876) [It's an indication of a stall](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1878) [risk.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1879) [However, the playback may be](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1880) [perfectly fine when the error is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1882) [indicated.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1884) [It means some of the segments](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1885) [bitrate is higher than what is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1888) [specified in the master](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1890) [playlist.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1892) [Last example, crypto format](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1892) [error, unsupported crypto](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1897) [format.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1899) [This may be an indication of a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1900) [failure, a playback failure.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1902) [All this error message and a few](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1904) [more that are not talked about](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1907) [here are very helpful when we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1909) [have AV Player and Player Item](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1912) [errors.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1914) [Let's take a look.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1915) [The application should be](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1919) [The application should be](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1919) [observing AV Player Item status](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1921) [and AV Player Item error](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1924) [property to find out this type](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1925) [of error.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1927) [These errors are fatal errors.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1929) [When the error indicated](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1931) [playback has been terminated](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1933) [already, so what should we do?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1935) [How do we find out the cause?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1938) [Here is example.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1940) [The application is observing](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1942) [player item status when the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1944) [status changed to failed.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1947) [Application go off to check the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1950) [AV Player error properties as](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1952) [well as the Error Log from the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1955) [AV Player Item.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1957) [Here is the error property from](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1961) [the player item.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1965) [It provides some useful](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1967) [information.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1968) [Error code from AV foundation](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1970) [error domain.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1972) [It also provides some hint, go](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1973) [off and check the Error Log from](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1976) [AV Player Item.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1979) [AV Player Item.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1979) [So corresponding AV Player Error](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1981) [Log gives you much more details.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1985) [It tells you on this data and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1988) [the time and what URI with what](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1990) [type of error.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1993) [So in this case, it's](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1994) [unsupported crypto format.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1996) [It also tells you what type of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=1999) [network interface the device was](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2002) [on when the error happens.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2004) [Next type of error, HDCP.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2009) [If you are offering content that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2013) [requires HDCP protection, your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2014) [application should be observing](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2018) [this long property name,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2019) [property.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2022) [It's output obscured due to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2023) [insufficient external](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2026) [protection.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2027) [The value of this property](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2029) [changes to two means three](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2030) [things.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2032) [Current item requires external](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2034) [protection.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2037) [Device does not meet the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2038) [Device does not meet the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2038) [protection level.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2040) [User will observe or is already](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2042) [observing video loss, like](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2044) [through [inaudible] for example.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2046) [To avoid this issue, your master](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2048) [playlist should offer at least](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2053) [one variant that does not](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2056) [require HDCP for fallback.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2059) [Remember, not all your users has](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2062) [the viewing setup that is HDCP](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2064) [capable.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2067) [App user interface should](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2068) [reflect the property change to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2071) [timely hint the user.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2073) [A lot of playback issues are](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2076) [introduced by content authoring](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2078) [such as audio and video out of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2081) [syncope or glitches while](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2083) [[inaudible] switching.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2086) [In addition to the error](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2088) [investigation and handling that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2089) [we have talked about, we would](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2090) [encourage you to use our media](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2093) [stream validator too, which is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2095) [available on the developer](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2098) [available on the developer](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2098) [website.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2100) [That's all I want to talk about](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2102) [it today.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2103) [Now let's welcome my colleague,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2104) [Eryk Vershen, to talk about how](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2106) [to author the master playlist](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2110) [the correct way.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2112) [Thank you.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2113) [[ Applause ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2115) [&gt;&gt; Thanks, Zhenheng.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2125) [My name's Eryk Vershen.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2126) [I'm an engineer working on HLS](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2127) [Tools.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2128) [We've spoken about how to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2129) [measure your performance and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2131) [also how to address many of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2133) [those concerns.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2135) [However, one of the key elements](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2136) [to successful and error-free](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2138) [playback experience is to ensure](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2140) [that your master playlist is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2142) [authored correctly.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2144) [The master playlist is what](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2146) [allows the player to make](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2147) [intelligent decisions both](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2149) [before and during playback.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2151) [So getting it right is critical.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2153) [There we go.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2156) [That's my advice.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2157) [No, I'm just kidding.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2158) [I think I need to give you a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2159) [I think I need to give you a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2159) [little more background to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2161) [understand what Roger meant.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2162) [We want you to put all of the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2164) [encoding options you have into](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2166) [your master playlist and to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2167) [describe them as completely as](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2169) [possible.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2171) [Let's pretend you're asking me](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2172) [questions.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2173) [This is the crucial question and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2174) [the main thing you have to get](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2177) [right.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2178) [Now, first you have to remember](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2180) [that just because a master](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2182) [playlist works doesn't mean it's](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2184) [right.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2186) [I've actually seen master](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2187) [playlists that look remarkably](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2188) [like this.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2190) [This is technically legal, and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2190) [it's next to useless.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2192) [I say, okay, well how about this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2194) [one?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2196) [It has a few more variants.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2196) [Well, it's a little bit better,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2198) [but it's still terrible.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2200) [Can we even play this?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2201) [What codec is it using?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2202) [Is it HDR?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2204) [Is it 60 fps?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2205) [You need to tell us everything.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2206) [We want you to tell us](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2208) [everything.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2209) [For example, average bandwidth.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2210) [Average bandwidth enables us to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2212) [make better decisions about](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2214) [which variant to switch to.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2216) [It's a better predictor or](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2218) [whether we'll be able to keep up](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2219) [whether we'll be able to keep up](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2219) [with a stream.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2220) [Codecs is what enables us to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2222) [filter out things that we can't](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2224) [play, and resolution allows us](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2226) [to make good decisions about](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2228) [which variant to choose.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2230) [Remember, we don't read the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2232) [media playlists or the media](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2233) [segments until we have to.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2235) [So you need to tell us things](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2237) [ahead of time in your master](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2239) [playlist.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2240) [So here's a sample of a simple](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2242) [master playlist.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2245) [This playlist allows the player](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2246) [to adapt to bandwidth changes](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2248) [and make good choices about](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2250) [which variant to use.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2251) [Now, everything that we've done](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2253) [here is invisible to the user.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2256) [It just makes the stream play](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2258) [better.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2259) [Okay.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2261) [Let's look at a common problem.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2261) [Your stream plays, but you're](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2263) [not seeing any images in fast](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2265) [forward, or your not seeing a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2266) [thumbnail in the scrubber bar.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2268) [Here's the Apple TV scrubber](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2270) [bar.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2272) [You can see how long your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2273) [content is.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2274) [You can see where you are in the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2275) [content, where you want to go.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2276) [Now, in order to get that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2278) [thumbnail image, you need to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2279) [thumbnail image, you need to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2279) [give us an I-frame playlist, and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2282) [the I-frame playlist is also](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2284) [what allows us to provide images](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2286) [in fast forward and reverse](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2289) [playback on your iPad or your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2290) [iPhone.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2293) [Now in order to talk about](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2294) [I-frame playlist, we first need](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2295) [to talk just for a moment about](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2297) [normal video.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2298) [Now, here's a way of visualizing](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2300) [regular video segments in HLS.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2302) [Each segment has content for a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2305) [number of frames, so it has a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2306) [duration in frames, and it has a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2308) [particular average bitrate, and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2310) [that bitrate varies from segment](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2311) [to segment.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2314) [Now, because of compression](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2316) [techniques, most frames in a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2318) [video can only be decoded](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2320) [relative to other frames.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2321) [But I-frames, the I stands for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2323) [intercoded frames, these are](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2325) [frames that are independently](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2327) [decodable, and they're the base](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2328) [frames that allow everything](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2329) [else to be decoded.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2331) [Now, as I've shown you here, you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2332) [might have more than one I-frame](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2334) [in a single segment, and the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2336) [I-frames need not be in a, occur](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2338) [I-frames need not be in a, occur](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2338) [at regular intervals.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2342) [An I-frame playlist is a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2345) [playlist which just points to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2347) [the I-frame content, that is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2349) [only the I-frame data will be](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2350) [downloaded.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2352) [And when we talk about the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2353) [duration of an I-frame, we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2354) [always mean the time from that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2356) [I-frame till the next I-frame.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2357) [Now, this particular set of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2360) [I-frames, I've shown as](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2361) [extracted from my normal](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2363) [content, but you can also make](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2364) [what we call a high-density](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2366) [I-frame playlist.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2368) [This isn't something just](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2369) [extracted from your normal](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2371) [content.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2372) [Instead, you make it](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2372) [deliberately with more evenly](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2373) [spaced I-frames.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2375) [This will allow us to work](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2377) [better.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2378) [It allows us to give a much](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2378) [smoother result when you're fast](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2380) [forwarding.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2382) [Now, here I'm showing you a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2384) [master playlist without I-frame](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2385) [playlist added.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2387) [Now, notice that the I-frame](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2389) [playlist has almost exactly the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2391) [same tags as the normal](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2393) [playlist.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2395) [The only difference is the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2396) [I-frame playlist does not](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2398) [support the frame rate attribute](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2399) [support the frame rate attribute](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2399) [because it doesn't make any](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2402) [sense in that context.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2402) [Now, a good test for your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2404) [I-frame playlist is to try and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2406) [play it directly.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2407) [That is, take the URI of your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2409) [I-frame playlist and paste it](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2411) [into Safari.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2413) [It should play at 1X speed, and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2414) [you should see the I-frames](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2416) [displayed one after another in a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2418) [slowly changing sequence.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2420) [Now also I want to point out the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2423) [difference in the bitrate.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2424) [Notice that the I-frame bitrate](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2427) [is much lower than the normal](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2428) [bitrate.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2430) [That should always be the case.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2430) [Now, speaking of bitrates, we've](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2434) [defined how to compute the peak](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2436) [bitrate in the HLS](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2439) [specification.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2440) [Make sure you do it that way.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2442) [Otherwise, you may get that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2443) [segment exceeds playlist,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2445) [exceeds specified bandwidth](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2446) [error.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2449) [Now, we're going to move away](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2450) [from video and talk about audio](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2452) [for a little bit.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2454) [Now the most common question is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2455) [how do I support multiple](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2457) [languages?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2457) [Here's what the interface looks](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2459) [Here's what the interface looks](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2459) [like.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2460) [I've got a list of languages,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2461) [and the user can select one.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2463) [And here's a sample playlist.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2466) [Now, notice what we did is we've](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2469) [added an audio tag, sorry, an](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2470) [audio attribute onto each of our](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2473) [video variants, and we've added](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2477) [a group, the media tags with](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2479) [group ID's.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2481) [The group ID is simply a tag](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2483) [that allows you to associate the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2487) [audio renditions with the video](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2490) [variants.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2492) [So notice there are a number of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2493) [differences between the two](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2494) [audio renditions.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2497) [Just as with your variants, we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2498) [want you to tell us as much as](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2500) [you can about your media.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2502) [Now, there are two attributes](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2504) [that people tend to have trouble](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2506) [with on the media tags, and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2507) [that's Default and Autoselect.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2509) [Okay.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2512) [So Autoselect says that the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2513) [media selection code in the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2516) [player is allowed to choose this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2517) [player is allowed to choose this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2517) [rendition without any special](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2520) [input from the user.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2522) [Most of the time, you want](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2524) [Autoselect set to yes.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2525) [If you don't set this, the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2528) [user's going to have to make an](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2530) [explicit choice to get that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2531) [rendition.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2533) [The default on the other hand is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2535) [what to pick when the user has](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2537) [not given a preferred language.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2539) [Generally this should be the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2542) [original language of your video,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2543) [and the default must be](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2546) [autoselectable because the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2547) [system has to do the choosing.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2548) [Now, this default has nothing to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2551) [do with the default video](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2553) [variant.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2554) [This is the default within the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2555) [group of renditions.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2557) [So, okay, great.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2559) [I've got multiple language, but](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2561) [I'd really like to have some](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2563) [multichannel audio.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2564) [I've got 5.1.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2565) [Okay.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2568) [Well the first thing to remember](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2568) [is not all devices can play](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2570) [multichannel audio.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2572) [So you want to also provide the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2573) [user with a stereo option.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2576) [And you should think of this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2578) [And you should think of this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2578) [always as filling out a matrix.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2580) [You need to have every format](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2582) [having every language.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2584) [You may say, well, I don't have](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2587) [a multichannel original for my](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2590) [French.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2593) [I don't have a 5.1 French.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2594) [In that case what you should do](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2596) [is put stereo, your stereo](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2597) [content in that group instead.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2599) [You need to have something in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2603) [every slot of this matrix.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2605) [So let's see a sample playlist](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2607) [again.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2610) [This one is just like the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2611) [previous example except I've](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2614) [changed the group ID, and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2616) [remember that's perfectly fine](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2618) [because the group ID just serves](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2619) [to connect the audio renditions](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2621) [with the video variants.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2623) [Now, here we had the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2625) [multichannel group, and then](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2628) [I've set this up with French as](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2630) [stereo, so you can see how](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2632) [that's done.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2634) [What you need to do is make sure](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2635) [that the codecs tag indicates](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2638) [that the codecs tag indicates](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2638) [all the different codecs that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2640) [can occur within that rendition](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2644) [group.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2647) [Now, notice that we had to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2648) [duplicate our video variant.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2649) [So now we've got two entries,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2652) [one pointing to one audio group,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2653) [and the other pointing to the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2656) [other audio group.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2657) [And you'll see this kind of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2658) [duplication again in later](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2659) [slides.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2661) [Well let's say rather than 5.1,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2662) [I've got several audio bitrates.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2665) [I've got some high bitrate](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2667) [audio, and I know I need to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2670) [provide a low bitrate for some](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2672) [users.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2675) [So in terms of the renditions,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2676) [this is similar to what we had](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2678) [before.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2680) [We still got a matrix.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2681) [We want to fill it out with](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2682) [every language for every](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2684) [bitrate.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2685) [And since these are both AAC,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2687) [they're considered the same](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2688) [format.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2689) [So if I also want to have](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2690) [another format, all I do is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2692) [extend that matrix.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2695) [Now, I want to mention that I've](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2697) [been saying language for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2698) [convenience, but you should](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2699) [convenience, but you should](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2699) [remember that it's the name](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2700) [attribute which is the unique](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2701) [attribute, not the language](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2704) [attribute.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2706) [Now, in this playlist I'm not](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2707) [going to show you the media](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2709) [tags.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2710) [I'm just going to show you the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2710) [video variants with their audio](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2711) [group names.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2713) [Now you want your low bitrate](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2714) [video associated with your low](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2716) [bitrate audio, and you want you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2718) [high bitrate video associated](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2719) [with your high bitrate audio.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2721) [And you'll always want to split](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2723) [this up like this.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2725) [Don't do a situation where you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2727) [have a complete set of video](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2729) [variants associated with your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2730) [low bitrate audio and a complete](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2731) [set of variants associated with](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2733) [your high bitrate audio.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2735) [Because if you do that, you can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2736) [be at a high video bitrate and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2737) [be bouncing between high and low](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2739) [audio bitrates.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2741) [Now, here I've added in the AC3](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2743) [content.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2748) [Notice that again we had to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2750) [duplicate our video variant](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2751) [entries, but they point to the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2754) [same video playlist.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2756) [Now, notice also that the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2758) [bitrate on the video variants](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2759) [bitrate on the video variants](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2759) [changes.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2761) [Remember that's because the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2762) [video, I'm sorry, the bitrate](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2763) [associated with the video](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2766) [variant is the bitrate of the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2767) [video itself plus any associated](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2768) [renditions.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2771) [Now, let's go back to the video](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2772) [for just a second because I want](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2776) [to have multiple video formats.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2778) [I like to have HEVC, so I can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2779) [have better quality at the same](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2783) [bitrate or I'd like to have](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2785) [Dolby Vision so I can have some](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2786) [HDR content.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2788) [Again, we're kind of filling out](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2789) [a matrix.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2793) [In this case, no matter which](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2794) [video format we choose, we want](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2795) [to end up with a reasonable set](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2797) [of variants.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2799) [So the rows here are tiers based](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2800) [on quality, and we want to fill](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2802) [out the matrix with a variant in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2806) [each tier in each format.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2807) [Now, we don't have to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2810) [necessarily fill out the higher](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2812) [portions of the tiers on our](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2815) [older formats.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2817) [You can skimp a little bit](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2818) [there.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2819) [But similar to audio, not every](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2820) [device supports things like](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2822) [Dolby Vision, so you want to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2824) [provide an H.264 variant as a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2826) [fallback.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2829) [The main thing to remember is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2831) [that in each column you want to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2832) [have the bitrate form a nice](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2833) [progression.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2835) [Now, this playlist has gotten a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2836) [little too big to show on one](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2839) [slide, so I'm going to split it](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2840) [over three slides.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2841) [This one shows you the H.264](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2843) [variant.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2845) [On this slide, we have the HEVC](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2846) [variant.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2849) [Now, notice everything has a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2850) [different video playlist that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2851) [it's pointing to, and here's our](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2854) [Dolby Vision variant, and notice](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2856) [that everything here has had the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2857) [same audio group.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2860) [So, again, if we wanted to have](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2861) [multiple audio formats, we would](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2862) [need to replicate the video](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2865) [variants for each audio format.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2867) [And again this wouldn't increase](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2869) [the number of video playlists we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2871) [had to have.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2872) [It would just increase the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2873) [number of entries that we had in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2874) [the playlist.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2876) [Okay.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2877) [We're almost done.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2878) [We're almost done.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2878) [Our last bit is about subtitles](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2880) [and closed captions.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2882) [Now, you can probably guess how](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2883) [this works.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2885) [Our variants need to point at](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2887) [the subtitle and closed caption](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2890) [groups that we're using.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2892) [So we need to add an attribute](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2894) [to our video variant, and we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2895) [need to describe the renditions.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2898) [Now, notice that the closed](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2900) [caption rendition does not have](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2902) [a URI attribute.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2904) [That tells the system that the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2906) [closed caption data is found](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2908) [within the video content, not in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2910) [a separate playlist.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2913) [So, there you go, the right](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2914) [thing to do is to give us](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2918) [everything you've got.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2918) [See, now you understand better](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2919) [what I meant.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2921) [Okay.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2922) [I'd like to quickly summarize](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2922) [the talk we've given today.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2924) [Emil talked about key](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2927) [performance indicators, about](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2928) [how to get or compute the values](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2929) [and what they mean.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2931) [And Zhenheng talked about ways](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2932) [to reduce startup time and how](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2935) [to go about resolving stalls and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2937) [to go about resolving stalls and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2937) [other errors.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2940) [And I've talked about how to do](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2941) [master playlists.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2942) [I'd like to briefly mention the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2944) [HLS validation tools.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2946) [They do identify many issues](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2948) [with master and media playlists,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2950) [and it's worth your time to use](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2952) [them.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2954) [As always, you can get more](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2955) [information from the WWDC app or](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2957) [the developer website.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2960) [That's all we have today.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2961) [Thanks very much for your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2963) [attention and time.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2963) [[ Applause ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/502/?time=2965)