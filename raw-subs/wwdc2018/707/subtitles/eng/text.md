# New Ways to Work with Workouts

## Summary
Tracking workouts with Apple Watch is popular with fitness professionals and novices alike.  See how the new workout API streamlines the entire lifecycle of a workout, complete with ability to restart a session after a crash to prevent you from losing data. Learn how the new workout classes, types, and queries provide quick access to baseline sample data you would typical calculate without limiting access to the fine grained samples you may occasionally require.

## Info
* Frameworks
* WWDC 2018 - Session 707 - iOS, watchOS
* https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/

## Text
 [[ Music ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=7) [[ Applause ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=17) [&gt;&gt; Good morning, everyone, and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=25) [welcome to New Ways to Work with](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=26) [Workouts.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=28) [My name is Niharika [phonetic].](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=29) [I'm an engineer on the Fitness](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=30) [team here at Apple, and today](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=31) [I'm going to be joined by my](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=33) [colleague Karim, an engineer on](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=34) [the Health team.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=36) [And we are so excited to share](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=37) [with all of you some of the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=39) [brand-new features and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=40) [capabilities that have been](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=41) [added to HealthKit in iOS 12 and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=43) [watchOS 5.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=45) [Apple Watch was released 3 years](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=49) [ago now, and since the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=51) [beginning, our users have loved](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=52) [engaging with its health and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=54) [fitness features.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=55) [They've loved closing their](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=56) [rings and earning achievements,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=57) [sharing with their friends, but](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=59) [sharing with their friends, but](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=59) [they've especially loved to do](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=61) [workouts.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=62) [And the watch has really become](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=64) [just the beginning of what is a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=66) [vibrant, evolving ecosystem, and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=67) [that is thanks to contributions](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=69) [from developers like all of you.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=71) [In just the last quarter of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=75) [2017, there were over 200](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=76) [million downloads of apps in the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=78) [Health and Fitness category on](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=81) [the App Store, and that number](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=82) [itself is incredible.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=84) [Two hundred million is so, so](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=86) [cool.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=87) [But more than that, it's a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=88) [testament to 2 things.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=89) [Number 1, it's a testament to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=91) [the dedication all of you have](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=93) [shown in getting these great](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=95) [user experiences out there.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=96) [But number 2, it's a sign that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=98) [people really care.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=100) [People are engaged in the space,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=101) [and they are so excited about](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=103) [what all of you are putting out](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=104) [there.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=106) [And at the heart of this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=108) [ecosystem are these 2 apps,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=109) [Activity and Health.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=110) [Activity is a home for you to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=112) [visualize just that -- your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=114) [activity data.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=116) [You can see your workouts.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=117) [You can see calories, exercise](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=118) [You can see calories, exercise](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=118) [minutes.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=120) [And Health is all of that and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=121) [more.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=122) [And of course, at the heart of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=123) [all of that, which is the reason](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=125) [we're here today, is HealthKit.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=126) [And so we have a ton of exciting](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=130) [things to talk about today, but](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=132) [before we get started with any](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=133) [of that, we have to talk about](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=135) [something extremely important,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=136) [and that is privacy and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=138) [authorization, because data is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=139) [sensitive, especially health](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=141) [data, and it is so important to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=143) [make sure that you have a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=145) [comprehensive privacy story when](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=146) [working with your apps.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=148) [Next, Karim is going to share](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=150) [our brand-new workout features,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=152) [which have made it easier than](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=154) [ever before to develop a robust](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=156) [workout app.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=158) [And lastly, I'm so excited to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=159) [share our new Quantity series](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=161) [API, which is a brand-new way to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=162) [both store and relate](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=164) [high-frequency data.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=166) [So let's get started.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=168) [Like I mentioned, privacy and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=172) [authorization has to come at the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=173) [beginning of any development](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=175) [story.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=177) [And at Apple, we think about](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=177) [privacy in 1 simple way: Privacy](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=179) [privacy in 1 simple way: Privacy](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=179) [is about people.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=183) [And HealthKit is designed with](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=184) [this in mind.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=186) [HealthKit is designed to put](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=187) [users in control of their data.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=188) [Users have the ability to grant](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=191) [access as well as revoke](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=193) [whenever they want.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=194) [And as developers, all of you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=196) [are the last link of that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=197) [puzzle, and we want to make sure](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=199) [we are giving you the tools to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=201) [make sure that your users'](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=203) [privacy is respected.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=204) [And we think about this in a few](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=205) [simple rules.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=208) [Number 1 is this idea of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=209) [proportional collection, and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=211) [this is the idea that you should](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=213) [only be collecting data relative](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=214) [to what your app needs.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=217) [And this isn't a fixed set of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=218) [data.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=220) [At the beginning, this amount](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=220) [might be small.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=222) [As your use cases, as your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=223) [features grow, the amount of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=225) [data you need to collect might](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=226) [be more, but it is so important](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=228) [that you only collect what you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=230) [need at a specific time.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=231) [And second is the idea that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=234) [HealthKit authorization can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=236) [change.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=237) [And this one's a little nuanced.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=238) [For example, if a user resets](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=240) [their location and privacy data,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=242) [their location and privacy](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=244) [setting, it is so important for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=245) [you to make sure you're honoring](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=248) [that, and it is your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=249) [responsibility to make sure you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=250) [do that.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=252) [And the best way to do this is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=253) [to treat HealthKit as the source](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=254) [of truth because HealthKit will](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=255) [update to reflect that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=258) [authorization status, and it is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=260) [so important to make sure you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=261) [don't cache any of that and make](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=263) [sure you're always turning to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=265) [HealthKit to ask what data you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=266) [have access to.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=268) [And these 2 ideas can be](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=269) [distilled into 3 simple rules.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=271) [And when we're thinking about](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=274) [privacy and authorization, you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=275) [should ask for only what you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=276) [need, only when you need it, and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=278) [every single time you need it.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=280) [And in code, this is just as](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=284) [simple.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=286) [Let's say I'm creating a workout](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=287) [app, and I'm just getting](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=289) [started, and, of course, I need](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=290) [to start with privacy and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=291) [authorization.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=293) [First, since I'm creating a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=294) [workout app, I want to share the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=295) [workout type, so I explicitly](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=297) [declare that I'm going to be](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=299) [declare that I'm going to be](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=299) [sharing the workout type.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=301) [Next, since I'm just getting](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=303) [started, I only have a few](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=304) [things that I'm trying to track.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=305) [I want to be able to track my](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=307) [user's heart rate, calories, as](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=308) [well as distance walking and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=310) [running.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=312) [And this is all I need right](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=312) [now, and so that's all I'm going](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=314) [to ask for.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=316) [And lastly, on my healthStore, I](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=318) [request authorization for just](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=319) [that.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=321) [I request my types to share and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=321) [my types to read.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=323) [And with these 3 simple steps,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=324) [we can really make sure that we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=326) [are taking the steps necessary](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=327) [to respect our user's privacy.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=329) [And privacy is so important](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=332) [because great apps have great](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=335) [privacy, and it's so important](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=336) [that you give attention to this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=338) [at the beginning of any](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=339) [development process.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=341) [And now that we have access to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=342) [our users' data, I'm so excited](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=344) [to introduce Karim [phonetic] to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=346) [tell you all about the brand-new](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=347) [workout features.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=349) [[ Applause ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=351) [&gt;&gt; Hello, everyone.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=356) [Thank you so much for joining us](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=358) [Thank you so much for joining us](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=358) [today.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=360) [I am really excited to tell you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=361) [all about the new workout API.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=363) [If you're new to HealthKit,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=366) [you'll see just how easy it is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=368) [to create a full-featured](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=371) [workout app from scratch.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=372) [If, on the other hand, you have](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=375) [a workout app on the App Store,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=377) [we'll show you all of the great](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=379) [new features of the API that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=380) [your app can benefit from.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=382) [So let's dive in.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=385) [First, I would like to take a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=386) [look at the general workout app](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=389) [life cycle.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=392) [So let's say we're building a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=394) [workout app to track our users'](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=395) [activity, and the first step is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=397) [to set up the app.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=401) [So at this state here, we know](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=404) [that the user wants to perform a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=406) [workout, the type of activity,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=408) [and we need to make sure that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=411) [our UI is ready for that.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=412) [Once the setup is done, we can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=415) [go ahead and start the workout.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=418) [go ahead and start the workout.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=418) [So after this point, the user](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=421) [will be actively working out.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=423) [And then, of course, after some](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=426) [time, the user will want to end](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=428) [the workout.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=432) [And from there, we can save this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=433) [workout and all of its](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=435) [associated data in HealthKit.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=437) [So this is the general life](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=440) [cycle of a workout app.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=443) [Now, let's see what happens when](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=446) [the user is active.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=449) [With your user interface at the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=450) [center, one of the tasks that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=454) [you want to accomplish is to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=456) [collect data that is relevant to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=459) [the workout and displayed in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=461) [your user interface.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=464) [And you also want to make sure](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=466) [that the user can control the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=467) [state of the session so that the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=470) [user can pause or resume the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=472) [workout.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=474) [And if you're familiar with](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=475) [HealthKit, you might know about](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=479) [HealthKit, you might know about](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=479) [HKWorkoutSession on watchOS.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=481) [HKWorkoutSession allows you to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=486) [handle a few of these steps in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=489) [the life cycle.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=491) [It will prepare the device's](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=493) [sensors for data collection set](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=496) [so that you can accurately](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=499) [collect data that's relevant to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=501) [the workout like calories and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=504) [heart rate.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=505) [It will also allow your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=507) [application to run in the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=509) [background when the workout is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=511) [active.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=516) [You'll be, also be able to use](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=516) [HKWorkoutSession to control the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=519) [state of this, the workout.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=521) [And finally, you can also](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=524) [generate events like swimming](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=526) [laps in segments.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=528) [But of course, this is not](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=530) [enough, and you also need to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=533) [collect data that is relevant to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=537) [collect data that is relevant to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=537) [the workout that's generated by](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=540) [the device and be able to save](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=542) [it all in HealthKit.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=544) [And to do just that, I'm really](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=547) [happy to introduce a new class,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=549) [HKWorkoutBuilder.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=552) [The workout builder is your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=555) [one-stop shop to collecting data](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=556) [and saving it in HealthKit.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=559) [So the builder will create and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=562) [save an HKWorkout object, which](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=565) [is a representation of a workout](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=568) [in HealthKit.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=570) [You can then add samples,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=573) [events, and also custom metadata](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=576) [to the builder while building](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=579) [the workout.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=581) [And if you're on watchOS, you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=582) [can use its subclass,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=585) [HKLiveWorkoutBuilder.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=587) [So it's watchOS only, and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=590) [because it's a subclass of the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=594) [workout builder, it has all of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=596) [the great benefits of the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=598) [builder, but because it's on](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=599) [builder, but because it's on](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=599) [watchOS and it works closely](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=602) [with HKWorkoutSession, it has](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=604) [all of these really cool](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=606) [features like automatic sample](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=608) [and event collection, which](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=611) [we'll talk about later.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=612) [So let's go back to the workout](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=615) [app life cycle, and we'll see](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=618) [how we can now set up and start](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=621) [the workout using the new](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=623) [workout builder.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=625) [So first, we need to create a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=629) [workout builder.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=631) [And to do that, we use the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=633) [initializer, and we have to pass](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=634) [a healthStore object, a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=637) [configuration which contains](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=639) [information like the workout](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=641) [type, whether it's indoor or](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=643) [outdoor, and other information.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=645) [And finally, an optional device](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=648) [if the data comes from an](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=651) [external device, for example.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=653) [Once my builder is created, all](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=656) [I need to do is call](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=658) [beginCollection and pass a start](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=659) [beginCollection and pass a start](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=659) [date.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=662) [It's that simple.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=664) [If you are on watchOS, you can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=666) [use the live workout builder.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=669) [And so first, you need to create](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=671) [a workout session by passing the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=673) [healthStore and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=675) [workoutConfiguration, and then](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=676) [you do not create the builder](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=679) [yourself, but you retrieve it](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=681) [directly from the session by](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=683) [using this call.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=685) [Once we have the session and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=687) [builder, we can go ahead and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=689) [start them up.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=690) [And so it's as easy as calling](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=692) [startActivity on the session and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=695) [beginCollection on the builder](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=697) [by passing a start date.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=699) [So this is how you set up and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=701) [start a workout using the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=705) [builder.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=707) [Now, let's see how we can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=708) [collect data displayed directly](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=710) [in our user interface and be](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=713) [able to control the state of the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=716) [workout when the user requests](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=718) [workout when the user requests](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=718) [it.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=720) [So to collect data, if we want](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=722) [to add samples that are relevant](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=725) [to the workout, like calories,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=728) [or distance, or heart rate, we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=731) [can do that using a very simple](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=734) [call, builder.add, and give it](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=736) [an array of HKSamples.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=739) [If we have events that we want](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=742) [to add to the workout, it's very](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=745) [similar.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=747) [We just call builder](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=749) [.addWorkoutEvents.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=750) [For metadata, you guessed it.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=753) [With the dictionary of metadata,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=756) [we just call builder.addMetadata](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=759) [and pass the dictionary.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=761) [But on Apple Watch, because the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=764) [device is on your wrist and has](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=768) [all this wide range of sensors,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=771) [you can actually generate data](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=774) [like calories and distance.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=776) [And wouldn't it be cool if we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=779) [And wouldn't it be cool if we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=779) [could have all of this data](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=781) [automatically collected by the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=783) [builder?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=785) [Starting with watchOS 5, we now](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=787) [have automatic data collection,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=790) [and it all starts with](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=794) [HKLiveWorkoutDataSource.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=795) [So the data source will collect](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=798) [samples that are relevant to the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=802) [workout currently running.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=805) [You do, however, have the option](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=809) [which types you want to collect,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=813) [so you can add or remove types](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=814) [as you wish.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=817) [And this is how it works.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=819) [First, we create a data source.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=821) [And here, I pass the healthStore](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=825) [as well as the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=827) [workoutConfiguration.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=828) [And since I'm passing the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=830) [configuration that contains](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=831) [information about the activity](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=832) [type, the data source will be](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=834) [able to infer which types should](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=836) [be collected for this workout.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=839) [be collected for this workout.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=839) [Next, I simply need to set the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=843) [data source on the live workout](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=845) [builder.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=847) [And optionally, you can add or](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=849) [remove types that are being](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=851) [collected.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=853) [So let's say I want to add the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=854) [type.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=856) [I can specify which type I want](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=857) [to add here as well as an](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=860) [optional predicate if I want to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=862) [further limit which types are](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=864) [being collected.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=866) [And finally, we just call](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=867) [dataSource.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=869) [collectStatistics for and pass](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=871) [the type as well as the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=874) [optionalPredicate.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=876) [So now that we have data being](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=877) [collected, let's see how we can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=881) [display it directly in our user](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=884) [interface.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=887) [So every time new data comes in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=888) [the builder's delegate method,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=893) [workout builder did collect data](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=895) [of collected types will be](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=898) [called.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=899) [called.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=899) [And so here, if, for example,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=901) [I'm interested in the heart rate](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=903) [type, I will make sure that it's](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=904) [one of the collected types.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=907) [And then, I simply make use of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=909) [the builder's statistics for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=911) [quantity type method, which](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=914) [gives me an HKStatistics object](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=916) [that will contain information,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=919) [in this case, like minimum,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=921) [maximum, average, as well as](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=923) [most recent value for the heart](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=925) [rate that's recorded throughout](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=928) [this workout.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=930) [From there, I can simply update](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=931) [my user interface.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=933) [One thing that's also very](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=935) [common in workout apps is to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=937) [have an elapsed timer.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=940) [And so, of course, we start the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=943) [timer at the beginning of the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=946) [workout, but that's not enough](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=948) [because pause or resume events](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=950) [will affect duration of the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=952) [workout.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=954) [So every time new events are](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=956) [added to the builder, the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=958) [added to the builder, the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=958) [builder's delegate method](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=960) [workoutBuilderDid CollectEvents](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=962) [will be called.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=964) [And from here, you can simply](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=965) [use the builder's elapsedTime](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=968) [property, which will give you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=970) [the current elapsed time for the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=972) [workout.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=974) [It's that easy.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=976) [Next, let's see how we can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=979) [control the state of the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=981) [workout.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=982) [So first, I'd like to talk about](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=984) [all of the different states that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=988) [the workout session can be in.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=990) [And the first one is Not](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=992) [Started.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=994) [So here, the workout has not](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=996) [started yet, and we're not yet,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=997) [the user is not performing the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1001) [workout.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1004) [So after that, we'll be moving](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1004) [to the Prepared state.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1007) [And so the Prepared state will](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1009) [put the system in Session Mode,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1012) [which means that your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1014) [application will have background](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1016) [running, the sensors will also](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1018) [running, the sensors will also](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1018) [be ready to track the activity,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1020) [but the workout has not started](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1022) [yet.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1024) [So if you, for example, have a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1026) [countdown in your app before a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1028) [workout, you can move the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1030) [session to the Prepared state](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1032) [before that to make sure that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1034) [the device is ready to start](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1036) [tracking the activity.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1037) [After that, we can move to the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1039) [Running state.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1042) [And here, the user is actively](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1043) [working out.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1046) [And of course, the user can move](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1047) [to the Paused, back to Running,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1049) [and back and forth between these](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1052) [2 until the workout is Stopped.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1053) [So here, the device is still in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1058) [Session Mode, which means that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1062) [your app is still running in the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1063) [background, so that gives you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1065) [some extra time that, if you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1067) [needed to save the workout.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1069) [After that, we can simply end](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1071) [the workout.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1074) [And from there, the system will](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1076) [exit Session Mode.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1078) [And to be able to move between](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1080) [all these states, you simply](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1083) [need to use these calls directly](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1085) [on the workout session.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1088) [So that's how we can collect](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1094) [data displayed in our user](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1096) [interface as well as control the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1098) [state of the session.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1101) [Let's see now how we can end the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1103) [workout and save it in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1105) [HealthKit.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1106) [So to end the workout, you first](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1107) [call session.end, and then you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1112) [also call builder.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1115) [endCollection and pass the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1117) [workout's end date.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1119) [At this point, no data is going](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1121) [to be collected for this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1123) [workout.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1124) [And then, if you want to save](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1125) [the workout in HealthKit, you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1128) [just call builder.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1130) [finishWorkout, and you will get](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1132) [back a workout object in the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1134) [completion handler that's](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1136) [already saved in HealthKit with](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1138) [already saved in HealthKit with](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1138) [all of its associated data.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1140) [So that's how you now build a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1144) [workout app using the new API.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1146) [And now, I'd like to show you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1150) [how this all works in a demo](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1152) [where we will be building a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1155) [workout app for Apple Watch.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1156) [[ Applause ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1159) [So I'm actually currently](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1170) [building a workout app that will](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1172) [allow my users to track running](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1174) [workouts.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1177) [And it's a very simple app.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1178) [I have a big Run button here.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1180) [When I tap on it, I'm presented](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1183) [with this user interface that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1185) [will show an elapsed time of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1187) [their workout as well as some](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1189) [metrics, like calorie burned,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1191) [the most recent heart rate, as](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1194) [well as the distance that's run](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1196) [in the workout.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1199) [in the workout.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1199) [Of course, my user will have the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1200) [option to control the state of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1202) [the workout, so my user can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1204) [pause, resume, and end the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1206) [workout.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1208) [So I already went ahead and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1211) [implemented the user interface.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1214) [So all that's left for me now is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1216) [to use the new workout API and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1218) [make my app functional.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1220) [And the first thing that we need](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1222) [to do here is make sure that the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1225) [project is properly set up.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1227) [And so to do that, I'm going to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1230) [head over to my Project](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1231) [Settings, go to the Capabilities](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1232) [tab, and here just make sure](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1235) [that the HealthKit Capability is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1237) [turned on.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1240) [And you should also do the same](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1242) [for your WatchKit app extension.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1244) [So again, make sure that the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1246) [HealthKit Capability is turned](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1248) [on.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1250) [Once I did that, we should also](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1251) [add the 2 purpose strings in the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1253) [info.plist file that will tell](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1256) [my users why I need access to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1259) [my users why I need access to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1259) [their health data.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1261) [And so here, the first string is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1263) ["health share user description"](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1266) [that tells my users why I would](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1269) [like to save data in HealthKit](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1271) [as well as help update usage](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1274) [description.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1276) [That will tell them why I need](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1277) [to read data in HealthKit.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1279) [Once that's done, I can now](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1283) [start using the new workout API.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1285) [And of course, the first step](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1287) [before being able to use the API](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1290) [is to make sure that I request](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1292) [authorization for the data that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1294) [I need.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1297) [And so, of course, every app is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1298) [different.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1300) [And in my case, if we go back to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1301) [my application, I will be saving](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1303) [a workout here.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1307) [So that's one of the types that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1308) [I will be needing access to.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1310) [And I also need to be able to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1313) [read calories, heart rate, as](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1315) [well as distance.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1317) [So let's do that.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1319) [So let's do that.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1319) [And of course, we need to make](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1321) [sure that we always ask for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1323) [authorization when we need it.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1324) [In my case here, I want to do](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1327) [that every time the user is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1329) [presented with this UI so that I](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1331) [can make sure that I have the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1334) [authorization before starting a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1335) [workout.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1337) [So this view here is backed by](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1339) [my workoutStartView Watchkit](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1340) [interface controller, and I'm](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1344) [going to go ahead and implement](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1345) [the authorization in the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1348) [didAppear method.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1349) [So first, my typesToShare here](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1353) [is workout because I want to be](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1356) [able to save a workout at the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1357) [end.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1359) [Next, I would like to read](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1362) [heartRate, activeEnergyBurned,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1364) [as well as](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1367) [distanceWalkingRunning.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1368) [Once I have my typesToShare and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1370) [typesToRead, I just need to call](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1373) [requestAuthorization on the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1376) [healthStore and pass the types.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1377) [healthStore and pass the types.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1377) [So let's go ahead and run this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1381) [code now and see what happens.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1383) [And because the watch screen is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1385) [small, the user will be](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1388) [presented with an authorization](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1391) [sheet on the phone.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1393) [So you need to make sure to also](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1395) [handle authorization on your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1397) [iPhone app.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1399) [Going to go ahead and dismiss](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1402) [this view here.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1404) [And so let's open my iPhone app.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1405) [And here, I'm presented with an](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1408) [authorization sheet where I can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1410) [decide if I want to grant this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1413) [application access or not.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1415) [For the purpose of this demo,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1417) [I'm going to turn all the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1419) [categories on and tap Allow.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1419) [And that's how we have now](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1424) [granted the authorization to my](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1425) [application.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1427) [Next, we can now finally get](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1429) [started with the workout API.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1431) [So when I tap on this button](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1434) [here, this view will be passed,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1436) [all the workoutConfiguration](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1439) [all the workoutConfiguration](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1439) [object that contains information](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1441) [about the workout.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1443) [In this instance here, it's a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1445) [running workout.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1446) [And from there, I can go ahead](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1447) [and set up my workout.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1449) [So this view here is backed by](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1452) [my workout session, WatchKit](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1453) [interface controller, and I'm](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1456) [going to go do the setup in the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1458) [awake method.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1460) [So first, I'm going to create](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1461) [the HKWorkoutSession as well as](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1464) [the HKLiveWorkoutBuilder.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1466) [So we create the session using](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1469) [its initializer, and we pass the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1473) [workout configuration to it.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1475) [From there, we simply retrieve](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1477) [the builder directly from the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1480) [session.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1484) [Creating a session might fail if](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1484) [the workout configuration is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1486) [invalid, so that's why I wrap my](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1488) [code here in a do-catch block](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1490) [and dismiss if I have any](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1493) [failures.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1495) [Next, let's set up the session](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1496) [Next, let's set up the session](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1496) [and builder.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1500) [So in this case, I want my](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1501) [interface controller to be the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1504) [delegate of both the session and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1506) [the builder.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1508) [And because I also want to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1509) [collect samples generated by the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1511) [device, I'm going to use here a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1513) [live data source and pass it a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1515) [workout configuration so that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1518) [the types are automatically](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1520) [inferred for me.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1522) [Finally, I simply start the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1525) [session as well as the builder.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1528) [So now that my workout is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1531) [started, the first thing that I](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1535) [need to do is to start my](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1537) [elapsedTime timer.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1539) [And so I'm going to do that here](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1540) [in the callback of the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1543) [beingCollectionCall.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1545) [I have a method here that will](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1546) [do that for me.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1551) [And of course, because pause and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1552) [resume events can also affect](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1555) [the duration, I'm going to have](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1558) [the duration, I'm going to have](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1558) [this call in the builder's](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1560) [didCollectEvent call as well.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1562) [Now, let's implement this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1567) [method.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1568) [So in my UI, I'm using a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1570) [WatchKit interface timer.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1573) [If you're not familiar with this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1575) [object, this object needs a date](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1576) [in the past from which it will](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1579) [start counting from.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1582) [So I'm going to go ahead and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1583) [create my date object using the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1584) [builder's elapsedTime property.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1587) [And because I want the date to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1590) [be in the past, I'm going to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1591) [make sure that I have a minus](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1593) [sign here.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1595) [Next, I simply dispatch on the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1597) [main queue because I'm doing UI](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1599) [work, and then I just set the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1601) [date on the timer.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1603) [I also need to make sure that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1606) [the timer is only running when](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1607) [the session is running as well.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1611) [So let's do that.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1613) [First, I grab the session state,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1615) [and then, again, I dispatch on](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1618) [the main queue.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1619) [the main queue.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1619) [And if the session is running,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1620) [I'm going to start the timer.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1623) [And if it's not, I'm going to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1624) [call Stop on the timer.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1626) [And that's all you need to do to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1628) [get the timer tracking the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1629) [elapsed time.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1632) [Next, let's make sure that our](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1633) [metrics displayed in the UI are](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1635) [also accurate.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1638) [So every time new samples are](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1639) [collected by the builder, this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1642) [method here will be called.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1645) [And so here, I'm just going to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1647) [go and iterate over the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1649) [collectedTypes.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1651) [And, in my case, all of the data](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1656) [that I'm interested in is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1659) [quantity samples.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1661) [So I'm going to make sure that I](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1662) [only handle those.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1664) [And from there, we can make use](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1666) [of the new builder's method,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1669) [builder.statistics, for quantity](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1673) [types, which will give me an](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1675) [HKStatistics object that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1677) [contains information like](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1679) [contains information like](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1679) [minimum, maximum, average, and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1681) [most recent values for each](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1684) [type.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1686) [So I grab the statistics object](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1687) [here, and from there, I have a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1689) [method that I already](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1692) [implemented that will give me](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1693) [the user interface label for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1695) [this particular quantity type.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1697) [And from there, it just update](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1700) [my label using the statistics](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1702) [object.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1704) [Next, let's make sure that we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1705) [can control the state when the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1709) [user requests it.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1710) [So every time my user will tap](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1713) [the Pause button, this method](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1715) [here will be called.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1717) [And from there, I simply need to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1719) [call session.pause.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1720) [For resume, it's very similar.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1723) [I'm going to do session.resume.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1726) [And finally, to end the workout,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1729) [we're going to call session.end](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1733) [and then builder.endCollection](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1736) [and pass the workout's end date.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1739) [and pass the workout's end date.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1739) [And from there, we're just going](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1741) [to call finishWorkout to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1743) [actually save the workout and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1745) [all of its associated data in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1747) [HealthKit.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1748) [And then, we just dismissed it](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1750) [here.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1751) [So let's go ahead and run this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1752) [code and see what happens now.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1753) [So I'm going to go ahead and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1764) [start my workout here.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1765) [And as we see now, I have my](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1768) [timer updating.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1771) [I have data directly collected](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1773) [by the builder and displayed](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1775) [right in my user interface.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1777) [And of course, I can also react](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1780) [to the state changes, so going](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1782) [to go ahead and pause the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1785) [workout.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1787) [My timer has paused.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1789) [Data collection as well.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1791) [I can resume.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1793) [And just like that, with a few](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1795) [lines of code, I now have a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1798) [lines of code, I now have a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1798) [fully functional workout app.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1801) [[ Applause ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1803) [So I'm going to stop the workout](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1809) [now, and let's see what we have](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1812) [just saved in the health app on](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1816) [the iPhone.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1819) [So this is my workout here that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1820) [I have just saved, and we have](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1825) [now a very rich representation](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1827) [of this workout saved directly](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1830) [in HealthKit.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1832) [I have the device details as](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1833) [well as all of the samples that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1836) [were associated, like heart](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1837) [rate, distance, and active](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1839) [energy, and, also, the workout](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1842) [events that were generated when](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1844) [I paused and resumed the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1846) [session.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1848) [And that's how easy it is now to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1857) [build a full-featured workout](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1859) [build a full-featured workout](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1859) [app on Apple Watch.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1862) [[ Applause ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1865) [But of course, sometimes things](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1870) [don't go as planned.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1872) [Let's say I'm running my first](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1874) [marathon and I'm really excited](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1877) [about it and using my favorite](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1879) [workout app to track this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1881) [marathon, but I only realize at](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1883) [the end that the app actually](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1885) [crashed sometime in the middle,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1888) [making me lose all of this data.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1890) [Well, with watchOS 5, we are](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1893) [introducing workout recovery](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1895) [that will solve that problem for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1898) [you.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1900) [[ Applause ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1901) [If your application happens to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1904) [crash during an active workout,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1906) [we will automatically relaunch](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1909) [it and give it a chance to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1911) [recover the workout.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1912) [The workout session as well as](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1915) [the builder will be recovered in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1917) [the builder will be recovered in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1917) [their previous state, so you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1920) [should not call startActivity or](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1921) [beginCollection on the builder.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1924) [If you are using a data source](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1927) [to automatically collect data,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1929) [you do need to set it up again,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1932) [and this is how it works.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1934) [If your app is relaunched after](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1938) [a crash, we will be calling the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1940) [WatchKit extension delegate](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1943) [method, handleActive](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1945) [WorkoutRecovery.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1947) [From there, you simply need to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1949) [create a healthStore object and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1951) [then call recoverActive Workout](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1953) [Session, and you will get back a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1957) [session in the completion](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1959) [handler.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1961) [It's that simple.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1962) [So this is our new workout API.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1964) [It makes it easier than ever to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1969) [build great workout apps.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1972) [We also have a new Quantity](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1974) [series API.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1977) [And for that, I'd like to hand](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1978) [And for that, I'd like to hand](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1978) [it back to my colleague Niharika](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1980) [to tell you more about it.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1982) [[ Applause ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1984) [&gt;&gt; Isn't that incredible?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1988) [In less than 10 minutes, Karim](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1990) [was able to build a fully](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1992) [functional workout app.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1993) [And this is so important](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1994) [because, like I mentioned](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1996) [earlier, our users love doing](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1997) [workouts.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=1999) [And with these workouts come a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2001) [lot of data.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2002) [Let's say I'm interested in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2003) [making a soccer app.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2005) [I really want to understand](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2006) [exactly how my users are moving,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2008) [and I want to track the distance](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2010) [they're moving as they go side](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2011) [to side, across the field during](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2013) [the duration of a workout.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2016) [And what happens when we start](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2017) [the workout is that samples](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2019) [start coming in.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2021) [My user first goes 2.25.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2022) [They then go 1.6.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2025) [They go a little more.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2027) [And then, they finish it off.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2029) [And in the past, each one of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2030) [these distances would be stored](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2032) [as 1 individual HKQuantity](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2034) [sample.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2036) [Each one would be independent,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2037) [and they would be stored](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2039) [and they would be stored](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2039) [separately.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2040) [And so we thought that, wouldn't](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2041) [it be great if you could](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2042) [actually just have 1 sample that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2043) [tracks that cumulative total but](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2045) [is still backed by those](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2048) [individual quantities behind it?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2049) [And that's why we've introduced](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2051) [HKCumulative](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2053) [QuantitySeriesSample, which is a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2054) [brand new sample type that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2056) [allows you to more efficiently](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2057) [store high-frequency data, and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2059) [it's great for 2 reasons.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2061) [Number 1, you only have to store](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2063) [1 sample that is backed by](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2065) [multiple quantities, and so](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2066) [you're more efficiently storing](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2068) [the high-frequency data that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2070) [comes from things like workouts.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2071) [And number 2, you now have a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2073) [sense of connection between the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2076) [quantities that make up a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2078) [sample.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2079) [So our new quantity series](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2080) [sample is a subclass of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2083) [HKQuantitySample, which some of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2084) [you may already be familiar](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2085) [with.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2087) [And if you've interacted with](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2088) [HKQuantitySample before, our new](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2089) [sample type will be very much](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2091) [the same.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2093) [So why would you want to use](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2095) [this?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2096) [Let's say you're interested in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2097) [data visualization.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2099) [data visualization.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2099) [Your app requires complex](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2100) [charting or graphs, and you're](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2102) [trying to really visualize the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2104) [data that your users have in a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2105) [beautiful way.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2106) [We actually suggest that you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2108) [continue using our](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2109) [HKStatisticsQuery or our](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2111) [HKStatistics CollectionQuery.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2113) [And that's because those are](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2115) [preexisting queries that do just](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2116) [this.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2118) [You have access to really](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2119) [fine-grained, rich data, and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2120) [these queries will already get](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2123) [the fine-grained data on our new](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2124) [series samples, so you won't](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2126) [have to do any extra work to get](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2128) [those details.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2130) [If, for example, you're](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2132) [interested in data analysis, you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2133) [want to go 1 step deeper.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2135) [You want to understand the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2137) [actual quantities that make up a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2138) [sample.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2140) [We suggest you use our new](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2141) [series sample query.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2144) [And lastly, if you're like me](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2145) [and have a soccer app [laughs]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2147) [or any app that has really](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2148) [high-frequency data collection,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2150) [we suggest that you use our new](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2153) [Quantity series sample builder,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2154) [which is a brand-new way for you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2156) [to actually be able to create](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2157) [those new cumulative Quantity](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2159) [those new cumulative Quantity](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2159) [series samples and store that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2160) [data in a more efficient way.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2162) [So let's start with our sample](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2165) [query.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2167) [Like I mentioned, this is a way](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2167) [for you to be able to really](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2169) [look deeper and understand the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2171) [individual HK quantities that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2173) [make up a Quantity series](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2175) [sample.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2176) [And in code, we, of course,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2178) [first want to start with](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2180) [figuring out where we're going](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2181) [to store our new quantities.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2182) [In my case, I'm going to store](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2183) [it in an array of quantities.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2185) [We next want to initialize our](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2186) [query.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2189) [We initialize it with the sample](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2190) [that we're interested in.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2192) [And in our completion handler is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2193) [where the bulk of the work](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2195) [happens.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2196) [In my case, I have a method](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2197) [called analyzeQuantity which is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2199) [going to do the work that I'm](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2201) [interested in with the quantity.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2202) [In my case, that's adding it to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2203) [the array of quantities that I](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2205) [declared earlier.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2206) [And lastly, we execute our](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2208) [query.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2210) [It's really that simple.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2211) [For those of you familiar with](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2213) [some of our other queries, this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2214) [behaves in a very similar way.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2215) [Next, we have our Quantity](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2219) [Next, we have our Quantity](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2219) [series sample builder, which,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2221) [like I mentioned, is really](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2223) [great for apps that do have](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2224) [high-frequency data ingestion](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2226) [because it's a more efficient](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2228) [way to store that data but also](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2229) [allows you to kind of create](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2230) [connections between that.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2233) [So first, we, of course, want to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2235) [start with creating our sample](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2236) [builder.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2239) [We initialize with the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2239) [healthStore and we initialize it](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2240) [with the quantityType that we're](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2242) [interested in.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2243) [Next, for whatever cadence](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2245) [you're interested in inserting](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2247) [samples, you do that.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2248) [Let's use my soccer app as an](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2250) [example.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2252) [I am super interested in the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2253) [actual distances that my users](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2254) [are moving, so I'm going to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2256) [declare the meter unit as the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2257) [quantity that I'm interested in,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2259) [and I insert that into my](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2261) [seriesBuilder.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2263) [And at the end, we call finish](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2264) [on my series, and we're actually](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2268) [going to get the new Quantity](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2270) [series sample and be able to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2272) [have stored that in a more](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2274) [efficient way.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2275) [And so we're really, really](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2276) [excited for you to start](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2277) [implemented our new Quantity](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2279) [implemented our new Quantity](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2279) [series APIs in your apps because](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2281) [it's a brand-new way to store](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2282) [your data more efficiently, and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2284) [its ability to be able to relate](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2286) [data together really allows for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2287) [some interesting analysis.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2289) [So we have talked about a lot of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2294) [interesting things, and we think](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2296) [that the best way to think about](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2298) [them is actually as parts of a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2299) [whole because together they](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2301) [really make up a way for you to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2303) [respect your users' user](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2304) [experience from start to finish.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2306) [Of course, we have to start with](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2309) [respecting user privacy.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2311) [Our users are giving access to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2312) [one of their most sensitive](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2315) [data, and it is so important for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2316) [us to make sure that we're](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2318) [treating it with the respect](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2319) [that it deserves.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2321) [Next, with the brand-new workout](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2322) [features Karim mentioned, we're](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2324) [able to create seamless user](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2326) [experiences.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2328) [With things like workout crash](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2329) [recovery, we're able to really](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2330) [deliver an experience to our](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2332) [users that they expect.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2334) [And lastly, by implementing our](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2336) [new Quantity series APIs, you're](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2338) [new Quantity series APIs, you're](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2338) [respecting the device's](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2340) [capabilities and really making](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2341) [sure that, from start to finish,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2343) [you are giving your users the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2345) [best experience possible.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2346) [And as the health and fitness](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2348) [space and as workout apps just](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2350) [keep growing and users keep](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2351) [using them more, we're so](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2353) [excited to see how these steps](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2355) [come together to create really](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2357) [incredible experiences.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2358) [So for more information, please](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2361) [check out our developer](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2362) [documentation, but we'd actually](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2363) [love to see you in person today.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2365) [We're going to be at a lab today](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2366) [from 1 to 3 as well as our](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2368) [Health, Fitness, and Research](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2370) [Get-Together later this evening,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2371) [and we'd love to answer any of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2373) [your questions, and hear your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2374) [stories, and meet you in person.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2375) [We also want to mention that we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2378) [have a brand-new features in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2379) [HealthKit, and we'd love for you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2381) [all to check out their talk,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2383) [Accessing Health Records with](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2384) [HealthKit.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2385) [So thank you so much.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2387) [We're so excited to see what you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2388) [all do with this.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2389) [Thank you.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2390) [[ Applause ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/707/?time=2392)