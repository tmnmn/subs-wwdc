# Creating Audio Apps for watchOS

## Summary
Apps in watchOS 5 have control over audio playback like never before.  With a full-fledged background mode for local audio playback using AVFoundation, people can listen to content on the go right from Apple Watch. Learn how to use the new volume control and how to respond to MediaRemote commands. Dive into best practices for getting audio onto Apple Watch with URLSession and update progress when using WatchConnectivity to transfer files from iPhone. Explore how to control playback on iPhone from your app with the new Now Playing view.

## Info
* Media
* WWDC 2018 - Session 504 - watchOS
* https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/

## Text
 [[ 音乐 ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=7) [[ 掌声 ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=20) [&gt;&gt; 大家好 我叫 Neil Desai](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=27) [是 watchOS 框架工程师](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=29) [我很激动能在这里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=31) [探讨如何为](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=33) [watchOS 创建一些杰出的音频 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=34) [说实话  我已经等待了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=36) [超过一年才轮到我跟大家](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=38) [探讨这些  我真十分开心](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=39) [能站在这里 让我们直截了当](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=40) [进入正题吧](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=42) [在 watchOS 4 中 我们展示了一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=44) [修订版的音乐和广播 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=46) [在 watchOS 5 中 我们展示了一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=48) [全新的播客 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=51) [我们发现用户](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=52) [十分喜欢](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=53) [在路上或者](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=56) [在锻炼的时候播放音乐](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=58) [我们也发现了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=62) [用户真的特别喜欢能够](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=62) [远程控制](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=64) [在另一个设备上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=65) [播放的音乐](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=66) [比如你的 iPhone 或者 HomePod](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=67) [我也特别喜欢这一项功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=70) [我很喜欢能够](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=72) [在 iPhone 上播放音乐](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=73) [于此同时也可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=75) [通过我的手表](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=77) [直接控制播放的设置 比如音量](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=78) [这是个伟大的功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=79) [今天 在 watchOS 5 上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=81) [我们将展示如何创造](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=83) [美好的体验 如同](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=85) [在 Keynote 上看到的一样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=87) [在 Audible 中和在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=88) [Pandora 中能做到的一样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=90) [并且他们可以使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=92) [一些 watchOS 5 提供的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=94) [新的功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=96) [今天我要介绍](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=97) [我们是如何做到这些同样的事情的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=99) [为了达成这个目标 我们先要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=102) [讲一下四个今天的主要主题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=103) [我们将要介绍](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=104) [原生的控制 以及如何](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=106) [把我们的系统控制](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=108) [直接嵌入你的 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=110) [我们要介绍如何](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=112) [把信息内容推送到手表上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=113) [在我们获得了信息内容之后](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=116) [如何为用户播放](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=117) [一些东西](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=119) [一些东西](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=119) [最后我们会再](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=121) [梳理一遍整体的音频体验](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=122) [以及如何给我们的用户们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=124) [提供丰富的体验](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=125) [并且这些体验要始终良好地](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=127) [集成在整个系统里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=128) [首先让我们先探讨原生的控制吧](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=131) [在 watchOS 5 中 我们展示了两种](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=135) [新的控制并且它们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=137) [都可以直接植入在你的 App 之中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=139) [第一个是 Now Playing](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=141) [视图 它可以被嵌入到你的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=143) [watchOS App 之中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=145) [这个很适合用于](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=147) [播放那些也许不属于你的内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=149) [你还可以嵌入一个音量](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=152) [控制 这样你可以做一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=154) [自己定制的 UI 来方便用户](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=156) [控制音量](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=158) [你也许会在想](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=161) [这个 Now Playing 界面 到底什么时候才会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=162) [允许用户](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=165) [控制那些音频内容却不属于](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=167) [我的音频播放呢](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=169) [让我来举个例子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=172) [我自己在使用健身 App 的时候](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=173) [就是这么做的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=174) [我正在做 HIIT 健身](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=175) [我向左划一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=177) [我需要一个健身背景音乐 “Eye of the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=178) [我需要一个健身背景音乐 “Eye of the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=178) [Tiger” 我有一点点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=180) [无趣 但是我实际上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=182) [真的有时候在健身时候](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=183) [听这首歌 我很喜欢这首歌](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=185) [并且这是一个很棒的体验](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=186) [只要这么划过来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=187) [就可以让用户控制播放](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=188) [所以如果你在制作一个健身 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=192) [你也可以做出同样的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=195) [用户体验 只要你](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=196) [把 Now Playing 直接嵌入到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=198) [你的 App 里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=199) [让我们探讨一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=202) [Now Playing 的一些特性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=202) [第一个我要说的是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=204) [Digital Crown](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=206) [它控制了音量](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=208) [正因为如此](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=210) [你要把这个视图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=211) [放在不可滚动的控制器里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=212) [比如在我的这个 App 里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=214) [我实际上仅仅把](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=216) [Now Playing 直接塞进了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=218) [控制器里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=220) [或者你可以重新加载一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=221) [包含这个控制器的页面](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=223) [或者把他放到一个类似健身 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=225) [的接口之中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=227) [之后这个视图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=229) [就可以自动控制他所代表的内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=232) [这意味着无论是提供播放](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=234) [的原始数据的 iPhone](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=236) [还是手表也好](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=238) [这个视图将会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=240) [为你把其他事情都处理好](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=241) [你完全不必担心这个问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=241) [最后 Now Playing](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=244) [可以自动获取你](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=246) [App 色调 所以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=247) [它能跟你的 App 的外观与感觉](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=249) [匹配起来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=250) [现在 我们在 Interface Builder](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=253) [使用一下它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=255) [我们现打开了 Xcode](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=257) [选定了 Object Library](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=259) [之后我们可以拖动](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=261) [Now Playing 到控制器里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=262) [一旦我的用户点进来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=265) [所有的事情都为你做好了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=266) [这个系统会把其他工作都处理好](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=268) [就是如此简单](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=270) [这就是我们的 Now Playing 视图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=273) [我们现在说说音量控制](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=275) [这个音量控制](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=278) [可以设置成控制](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=279) [iPhone 的音量或本地手表的音量](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=281) [跟 Now Playing 一样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=284) [我们会获取](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=286) [App 的色调](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=287) [并且在使用这个控制的时候调整好它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=288) [当用户在在转动](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=294) [Digital Crown 的时候](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=298) [Digital Crown 的时候](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=298) [音量控制的色调](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=300) [将会调整到系统绿色](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=301) [以匹配其他的部分](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=304) [至于用这个音量控制调整](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=306) [本地播放的音量](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=309) [还是 iPhone 的音量](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=312) [在 Attributes Inspector 有个选择框](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=314) [可以控制本地音量](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=318) [如果你没有选中它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=320) [这个音量控制](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=321) [将默认控制 iPhone 上的音量](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=322) [如果你选中了它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=325) [音量控制将控制](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=327) [手表上的音量](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=328) [如果你的 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=330) [有多个应用场景](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=332) [分别要远程控制播放内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=334) [或者要控制本地播放内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=335) [这样的话](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=337) [你可能需要多个控制器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=339) [来控制着不同的音量](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=340) [你需要在设计的时候](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=341) [就要做好这些相关的决定](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=343) [好的 这些就是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=345) [我们的系统控制的内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=347) [接下来让我们介绍一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=349) [如何在实际操作中将](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=350) [内容数据传递给设备](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=351) [我做了一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=355) [博物馆导览的 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=357) [我希望我的用户](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=359) [我希望我的用户](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=359) [直接点一下就可以在博物馆里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=361) [听导览并且](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=363) [这是一个在手表上很棒的应用体验是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=364) [因为我们可以把手机放到一边](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=366) [我们可以在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=369) [手腕之上得到完整的体验并且](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=370) [可以欣赏身边的艺术](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=372) [比如说我做了一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=375) [缓冲区让用户](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=377) [在去博物馆的路上下载内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=379) [这样的话 我需要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=384) [使用 URLSession 然后](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=385) [直接从服务器获取数据](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=387) [让手表自己把数据下载下来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=389) [让我们看一眼代码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=393) [是如何实现的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=395) [请看这里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=398) [我有一个 IBAction 绑定到了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=399) [我的 WK Interface 按钮](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=401) [首先你需要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=403) [注意的就是 isFrontmostTimeoutExtended](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=404) [的属性设置成了 true](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=406) [我们等下还要再讨论](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=410) [一下这件事情](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=411) [但是我想说的是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=412) [我们的用户](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=413) [和设备进行了交互](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=415) [可以说当用户再一次抬起手时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=417) [可以说当用户再一次抬起手时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=417) [他们希望看到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=420) [我们的 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=421) [因为我们延长了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=422) [最前超时 我们从](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=424) [系统得到了更多的优先级](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=425) [来帮助我们使用的 URLSessions](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=427) [同样的 这个我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=429) [等一下再说](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=430) [当然了 用户在任何时候](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=432) [都可以把手垂下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=435) [所以我使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=437) [backgroundSession 来保证这一点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=438) [这样的话当我的 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=439) [进入后台](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=441) [下载还在继续](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=442) [然后 我们可以直接启动](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=444) [下载任务然后](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=446) [将它忽略](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=447) [当你在构建这样的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=449) [用户体验时候 你希望](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=450) [显示下载进度](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=452) [并且当然要处理各种错误](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=454) [让我们看看这是如何实现的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=456) [看一下这里我建造了一个类](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=460) [DownloadManager 它是我的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=461) [SessionTaskDelegate 也是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=464) [URLSessionDownload Delegate](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=465) [在第一个函数里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=467) [我可以获取总共下载了的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=469) [数据大小并把它除以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=471) [要写入的总字节数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=472) [这样 我们可以获得](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=474) [某个下载任务的进度](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=475) [在 URLSession](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=476) [提醒我并且给我发出相关](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=479) [提醒我并且给我发出相关](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=479) [信息的时候](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=480) [这样一来 我可以在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=481) [UI 上更新下载进度](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=484) [之后当下载完成时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=487) [我当然可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=490) [操作文件 我也许](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=492) [想要发送一个通知](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=493) [提醒用户](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=495) [文件已经准备好播放了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=497) [当然了 我的程序](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=498) [也会调用 didCompleteWithError](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=501) [用于适当地清理](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=502) [并处理该点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=504) [任何存在的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=506) [任何错误](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=508) [这非常棒](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=509) [使用 URLSession 我们可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=511) [直接把数据下载到手表上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=512) [但有时 iPhone](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=514) [上已经有了数据了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=516) [这样的话我们可以用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=519) [WatchConnectivity 直接传送](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=520) [文件到手表上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=522) [为了完成这个 我们可以使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=528) [transfer file 的 API](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=530) [watchOS 5 有个可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=531) [获取传输进度的新功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=533) [让我们来看一眼](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=537) [在代码里 我们可以看到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=538) [在代码里 我们可以看到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=538) [WCSession FileTransfer 的 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=540) [正如新功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=542) [进度属性已经可以在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=543) [watchOS 5 and iOS 12 查看了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=545) [我可以在我的 iOS 界面上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=552) [获得 fileTransfer](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=554) [获取进度 更新数据](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=556) [如果你希望了解更多](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=560) [WatchConnectivity 相关内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=561) [网上有完备的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=563) [示例代码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=564) [强烈推荐你去看一看](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=565) [simple WatchConnectivity](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=567) [的实例代码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=568) [你可能会思考](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=569) [我们有 URLSession 也有](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=573) [WatchConnectivity 我究竟](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=574) [应该用哪个呢](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=577) [究竟什么时候这么用 会比较合理呢](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=578) [对于 URLSession 我们希望在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=581) [在用户在手表上启动下载的时候使用它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=583) [然后我们将向 connectivity property](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=586) [发送请求以获取](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=588) [在那里的网络连接](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=590) [我还要提一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=594) [如果 iPhone 在旁边](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=595) [那么你的请求将会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=597) [由在信号范围内的 iPhone 进行代理中转](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=598) [由在信号范围内的 iPhone 进行代理中转](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=598) [如果你希望了解一些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=601) [URLSession 的细枝末节](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=603) [有一个去年的讲座](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=605) [可以在网上找到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=606) [Advances in Networking Part 2](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=607) [我强烈建议你去看一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=609) [然后呢 另一方面](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=611) [对于 watchConnectivity](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=614) [它会变得十分重要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=616) [当用户在 iPhone 上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=617) [启动了下载任务](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=619) [或者已经有](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=620) [内容下载好了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=622) [并且已经没有必要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=623) [再向服务器请求了的时候](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=625) [这两个功能 特别是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=628) [watchConnectivity 你需要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=630) [对用户的操作进行一定的预测](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=631) [不要忘了告诉用户](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=634) [下载任务或者](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=635) [文件传输的任务快完成了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=636) [还有那些把手表放在了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=638) [充电器上之后会进行的操作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=640) [比如我们自己是这么做的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=642) [在 Apple Watch App 中的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=645) [Music 界面 在最上面](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=647) [我们会给用户显示](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=649) [有多少歌被实际](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=651) [传送到了手表上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=653) [我们甚至会告诉](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=654) [用户 当 Apple Watch 连上充电器的时候](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=656) [音乐将会被同步](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=659) [音乐将会被同步](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=659) [别把这个忘了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=660) [好了 我们聊了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=663) [获取内容 现在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=664) [我们有了内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=667) [我们说一下如何播放它们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=668) [在 watchOS 上 我们有好多](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=670) [不同的工具可以使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=672) [一部分工具本身](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=674) [就在 WatchKit 里面了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=676) [这里有带有选项的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=678) [presentMediaPlayerController](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=680) [你可以用它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=682) [这里也有 WKAudioFile QueuePlayer](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=684) [你可以提供一个列表的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=687) [播放内容 之后队列播放器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=689) [将按照排列播放](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=690) [相应的内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=691) [所以 presentMediaPlayerController](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=692) [的选项](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=695) [将显示在 UI 之上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=697) [所以这个控制器将给你做好其他的工作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=698) [你真的不需要做很多的工作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=701) [这是个完美的选项](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=702) [尤其对于短时内容来说](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=704) [你不用在这件事情上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=706) [考虑太多](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=707) [并且 WKAudioFIleQueuePlayer 是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=710) [在后台播放](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=712) [较长的内容时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=713) [的一个绝佳选项](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=714) [这是一个传送带式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=716) [的方法 有了播放的内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=717) [的方法 有了播放的内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=717) [你可以直接](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=720) [把它移交给系统](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=721) [系统会代表你](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=722) [进行播放](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=723) [这就是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=725) [WKAudioFileQueuePlayer 的设计目的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=726) [这里也有个正在工作的 AVFoundation](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=729) [所以这里有 AVAudioPlayer 和](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=736) [AVAudioEngine](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=739) [在 watchOS 5 之前](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=740) [他被绑定在健身后台模式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=742) [或者当你的 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=744) [在前台并且屏幕已经点亮的时候](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=746) [比如 Nike Run Club App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=749) [它就干了这个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=751) [比如你正在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=753) [跑步并且你想要一点禅修的感觉](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=754) [你可以用 Headspace 播放](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=756) [一点冥想的辅助内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=759) [在 watchOS 5 之前](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=761) [利用 AVFoundation 的后台播放](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=764) [只可能在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=766) [这些种类的健身 App 中使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=767) [在现在的 watchOS 中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=770) [有一个全新的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=772) [后台模式并且](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=774) [它令我很是激动](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=775) [让我们说一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=777) [让我们说一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=777) [我现在正在做的东西](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=780) [有点拓宽我们的 tool kit 的感觉](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=782) [我们有 AVFoundation 并且](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=787) [它没有绑定在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=789) [某种后台模式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=791) [我们就可以直接用 AVFoundation](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=792) [在后台播放中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=793) [我们开放了权限](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=796) [允许你 允许用户](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=798) [选择一个播放的路线](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=801) [比如不同的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=802) [蓝牙耳机](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=804) [在 watchOS 5 种我们也](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=806) [开放了 MediaPlayer.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=808) [framework 并且你可以提供](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=809) [一些 Now Playing 信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=810) [同时处理远程控制的指令](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=812) [就像 Music Podcasts](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=816) [和 Radio App 中的一样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=817) [长的内容被限定到了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=819) [蓝牙播放 也就是说](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=821) [这是一种更好的方式来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=823) [使你使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=825) [扬声器播放](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=827) [让我们一步一步的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=829) [来看一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=831) [后台较长的内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=832) [是如何播放的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=834) [首先把你的音乐添加到 info.plist](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=835) [的后台模式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=839) [的后台模式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=839) [之后你建立起](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=841) [合适的 session](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=844) [然后告诉你的系统](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=845) [你想要播放](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=846) [较长的内容在系统后台](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=847) [你希望允许用户选择](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=849) [不同的路线](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=853) [之后呢你去](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=854) [调用播放函数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=856) [并且在用户](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=858) [正在播放的时候](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=859) [适时处理播放任务](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=860) [让我们再仔细分析一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=863) [内部的代码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=865) [在 Xcode 里面的 Project](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=869) [Settings 进入到 Capabilities 里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=870) [你可以调整](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=872) [Background Mode 的开关 你选中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=874) [Audio 然后这就好了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=875) [可以进行下一步了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=877) [现在开始建立你的 session](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=878) [你需要设置在 AVAudioSession 之中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=882) [的 routeSharingPolicy](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=883) [到 longform 模式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=885) [之后你调用 在 AVAudioSession 里面的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=886) [newActivate WithOptions Completion 方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=889) [在它完成之后](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=893) [你就可以调用播放了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=895) [在你第一次](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=897) [启动 activate 函数之前到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=898) [启动 activate 函数之前到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=898) [completion 返回之前这段时间内](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=901) [播放路线的选择器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=902) [将会将你的选择显示出来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=904) [这是播放路线的选择器的样子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=907) [它将会在你的 App 内](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=910) [出现 然后它会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=912) [允许用户选择](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=914) [使用哪个蓝牙耳机](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=915) [播放内容并且](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=917) [控制播放](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=918) [我们再说一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=921) [播放路线的选择器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=922) [还是一样 调用一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=923) [asynchronous activate](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=925) [函数然后它就会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=927) [显示播放路线的选择](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=929) [之后它会返回](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=932) [completion 在你处理掉它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=933) [之后你就可以直接调用播放](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=934) [每次要播放东西的时候](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=936) [你都需要这么做](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=939) [这样呢 你就可以保证](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=940) [每次在播放的时候](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=941) [都可以选择合适的播放路线](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=943) [然后我们进入代码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=946) [看一下如何建立 session](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=947) [现在我们有一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=949) [AVAudioSession 我们要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=950) [把我们的类别设置到播放](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=952) [之后我们把模式设置到默认](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=954) [最重要的是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=957) [我们要把 route](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=958) [sharing policy 设置到 longform](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=959) [sharing policy 设置到 longform](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=959) [之后我们启动 session](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=962) [它将会显示路线选择器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=963) [之后你就可以调用播放](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=967) [现在呢 关于线路选择器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=970) [我要指出](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=971) [我们需要把播放路线想成两种不同的方式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=973) [第一种是基于 Apple](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=976) [无线芯片的播放路线](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=978) [我们经常叫它 W1 路线](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=979) [这些是 AirPods 或者](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=981) [Beats Studio Wireless 使用的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=984) [之后呢是我们的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=986) [普通蓝牙耳机路线](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=987) [在讨论路线选择器的时候](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=989) [区别这两种路线](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=990) [是十分重要的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=993) [如果用户正连着一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=997) [播放路线 那么](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=999) [选择器将代表你自动](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1000) [选择这个路线](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1001) [这点非常好因为](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1003) [选择器甚至不会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1004) [显示在界面上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1006) [你将马上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1007) [得到 completion 的回复](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1007) [如果你的用户](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1010) [连到了一个 W1 线路](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1013) [但是它正在被 iPhone 占用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1015) [系统将会直接从 iPhone](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1017) [接管这个播放线路](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1018) [接管这个播放线路](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1018) [并把它给你的手表](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1020) [有时候这也不会发生](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1022) [这就是当你的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1024) [iPhone 有更高的优先级](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1026) [比如我正在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1027) [我的手机上打电话](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1029) [这时候我们将](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1031) [不会为手表接管路线](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1032) [因为打电话](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1033) [可能更加重要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1035) [如果没有正在工作的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1037) [路线 路线选择器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1040) [将会显示出你的选择](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1041) [好了 这是路线选择器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1044) [现在我们说一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1046) [究竟如何](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1047) [播放内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1049) [你还是只需要用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1051) [AVAudioPlayer 和 AVAudioEngine](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1052) [watchOS 上支持了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1054) [很多种内容格式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1055) [更好的一点是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1058) [如果你有 iOS 代码使用了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1060) [这些类 你可以在 iOS 和 watchOS](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1062) [播放操作中共享程序框架](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1064) [在 AVAudioEngine 中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1069) [你实际上可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1071) [配合着 AVAudioPlayer](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1073) [节点播放一些 DRM 内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1075) [你可以播放你自己的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1077) [DRM 内容 你自己](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1079) [DRM 内容 你自己](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1079) [进行解密 然后给用户播放](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1081) [请特别注意一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1083) [watchOS 本身的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1086) [电力 所以请在真的十分](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1089) [必要时候使用音频播放](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1091) [比如用户真的就想](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1094) [在这放音频](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1095) [对于 AVAudioEngine 来说](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1097) [autoShutdownEnabled 属性是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1099) [默认开启的 所以如果没有](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1101) [在 AVAudioEngine 发现活动节点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1104) [我们会在必要的时候](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1105) [自动关闭 AVAudioEngine](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1109) [这就是我们的播放](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1111) [现在我们说一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1115) [我们的 MediaPlayer framework](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1117) [当然了 如果你要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1118) [提供我们的 Now Playing](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1120) [信息给系统](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1121) [那么 Now Playing UI](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1124) [会被更新 这是一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1127) [系统级的播放信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1128) [并且它会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1130) [基于你提供的信息更新](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1131) [所以这些信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1134) [会出现在 Now Playing App 或者在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1135) [Workout 一类的 App 之内或者](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1137) [那些嵌入了 Now Playing](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1139) [那些嵌入了 Now Playing](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1139) [的第三方 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1140) [这些地方都会显示](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1143) [接下来 靠着 MediaPlayer](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1144) [framework 我们希望处理一些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1147) [事件和各种媒体播放](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1148) [远程控制指令](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1150) [比如在 AirPods 上的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1151) [播放下一曲](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1153) [让我们看看这些代码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1155) [如何提供](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1156) [Now Playing 信息的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1158) [在这里我们有 MPNowPlaying InfoCenter](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1163) [我们想要获取信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1166) [然后接下来设置 nowPlayingInfo](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1168) [之后我们需要设置](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1170) [我们的 artwork 我们的 MPMedia](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1175) [ItemArtwork](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1176) [但是这个功能现在还没有在 seed 1 发布](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1177) [它将会在 seed 2 里面出现](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1179) [这个例子里 你提供的 artwork](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1181) [显示在 Siri watch face](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1183) [之后呢 我们设置好了 title album](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1186) [artwork 我们它设置到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1191) [我们的 nowPlaying InfoCenter](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1193) [之后我们再做一些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1196) [类似的工作 之后我们的数据](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1197) [类似的工作 之后我们的数据](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1197) [将在 Now Playing App 中出现](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1201) [这就是 Now Playing App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1202) [我提供了一些关于](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1205) [在我的 App 正在播放音频的信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1207) [然后 Now Playing 与此同时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1210) [也会被更新](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1215) [这个例子里 最底下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1216) [显示着 "Lights in the Sky"](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1217) [正是我正在听的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1218) [之后呢  关于媒体播放](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1220) [远程控制指令 也是一样的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1222) [用 MediaPlayer framework](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1224) [现在在 watchOS 上你可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1225) [随心所欲处理这些指令](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1227) [让我们看一些代码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1231) [我们获取](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1232) [MPRemoteCommandCenter](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1234) [之后 不去播放](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1236) [下一曲 我们实际上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1238) [可以为用户](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1240) [做得更好](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1242) [所以我有这样一个函数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1243) [它是 enableSkipForwardCommand](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1244) [它的默认是 15 秒](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1247) [我可以设置一个喜欢的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1250) [快进时间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1252) [然后我又添加了 target](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1253) [和 selector 接下来我在 command center](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1255) [启动了远程指令](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1257) [启动了远程指令](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1257) [如果你想了解更多](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1261) [media player framework 的信息 特别是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1263) [媒体播放远程指令](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1264) [我很推荐](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1265) [看一下 MP remote](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1267) [command sample 的例子 这个在网上可以找到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1269) [这个例子里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1271) [设置好了想要的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1272) [快进时间之后之后 Now](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1274) [Playing App 将会被适当地调整](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1277) [这个 Now Playing UI  无论在哪里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1279) [都会显示减 15 秒](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1281) [或者加 15 秒](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1282) [这些都可以按你的喜好进行调整](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1285) [好了 这就是手表上的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1289) [音频体验或者是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1292) [音频播放 我们再说说](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1294) [音频体验吧](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1295) [我想说音频体验主要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1302) [有四个主要的方面](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1304) [有我们的自动启动](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1306) [功能让你的 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1307) [自动启动](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1308) [有最前 App 状态](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1310) [并且我们如何在 App 中利用它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1311) [有我们的新的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1314) [交互式通知](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1316) [和我们的 Siri 快捷启动](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1317) [和我们的 Siri 快捷启动](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1317) [我们已经说了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1323) [很多在手表上的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1325) [播放 但是现在我要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1326) [说一说之前聊过的东西](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1329) [我们还想再过一遍](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1330) [远程控制的例子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1331) [比方说我正在 iPhone 上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1335) [用 Apple Music 放音乐](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1336) [Now Playing App 会自动](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1339) [在我的手表上显示相关信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1340) [我很喜欢这个功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1343) [就像魔法一样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1344) [看一眼我的手腕](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1345) [我就可以控制播放了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1347) [这是最酷的事情了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1348) [这个例子中 我们的 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1353) [其实在 iPhone 上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1354) [播放内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1355) [之后我们的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1357) [手表 App 就自动开启了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1358) [我们把这个叫做](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1365) [自动启动音频 App 功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1366) [只要 Now Playing](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1368) [session 正在 iPhone 上运行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1369) [我们的 Apple Watch App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1371) [就会被提到最前面显示](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1373) [并且会在 session 中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1376) [一直保持最前](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1377) [只要用户在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1380) [iPhone 上听内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1381) [我们的 App 就会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1382) [保持在最前](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1384) [除非用户会到别的地方](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1386) [在 watchOS 5 上我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1388) [开放了 Now Playing session](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1391) [API 这能让你知道](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1392) [何时你 iPhone 上的 Now Playing session](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1394) [被启动了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1396) [这样你可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1398) [直接给用户显示合适的界面](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1399) [做这个呢 你需要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1401) [使用 handleRemoteNow](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1404) [PlayingActivity on](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1405) [WKExtension Delegate](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1407) [让我们看看](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1410) [具体代码是怎么用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1411) [看这里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1416) [我有了我的 extension delegate](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1416) [我可以实现](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1419) [handleRemoteNow PlayingActivity](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1420) [首先我需要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1423) [检查一下我的用户界面正在显示什么](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1424) [所以我调用一下 visible](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1427) [interface controller 我可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1430) [知道我的用户现在界面的样子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1431) [他是否在我的 Now](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1434) [Playing UI 上 如果在那么很棒](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1435) [就留在这里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1437) [如果不在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1439) [如果不在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1439) [我们直接重新加载界面](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1441) [这样我们就有了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1444) [魔法般的体验 因为无论停在哪个界面](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1445) [我举起手](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1447) [就可以看到我想控制的东西](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1449) [有时候呢 如果它不是很适合](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1456) [用户的需求](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1458) [你也许会选择主动退出](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1460) [选择你觉得对的就好](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1462) [做个决定](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1463) [比如说你的 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1465) [跟你的手机 App 没什么关系](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1466) [那选择退出](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1468) [是一个非常合适的选择](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1469) [要做到这样 在你的 WK extension](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1472) [的 auto-launch feature](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1474) [里使用 opt out](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1476) [info.plist](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1480) [如果你选择了主动退出](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1481) [Now Playing App 将会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1484) [顶上来出现在屏幕](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1486) [现在呢 我们说说](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1492) [最前 App 状态](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1493) [我们先做一个它的小的回顾](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1495) [我有个 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1498) [我有个 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1498) [它正在前台运行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1500) [我正在看着它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1501) [屏幕是亮着的并且这个 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1502) [被认为是活跃并且在最前](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1504) [但是然后呢](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1506) [我把手垂下来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1507) [我的 App 还是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1509) [被当作最前](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1511) [因为我把手再抬起来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1513) [还是会见到这个 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1514) [这样的话](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1516) [这个 App 仅仅是进入了后台](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1518) [依靠最前 App 状态](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1524) [我们在系统上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1526) [增强了一些功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1527) [从 iPhone 来的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1529) [后台传输 比如说我们正在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1532) [从 iPhone 向手表传输](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1533) [内容 这些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1535) [后台传输任务 他们完成后](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1536) [它将直接唤醒恢复](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1539) [进入我们的 App 如果](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1540) [我们的 App 在最前状态](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1542) [我们的 URL session 恢复](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1544) [也是这么工作的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1545) [比如这个 URL session 我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1547) [的后台 session 之前在下载](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1549) [现在已经完成了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1551) [我们的 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1553) [会被直接唤醒并且播放相应内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1554) [如果我们在最前](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1556) [如果我们在最前](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1556) [用户将会到我们这 所以我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1560) [可以决定何时或者是否](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1562) [让通知显示 还有](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1563) [我们需要适当地处理通知](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1566) [也许我们想要让用户留在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1568) [这个 App 或者可能我们想要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1569) [向用户展示一个通知](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1571) [在最前的 App 状态中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1573) [我们可以做这个决定](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1574) [如果我们 App 在最前](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1576) [状态 我们可以震动一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1578) [如果你还想再](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1581) [了解一些最前 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1583) [状态 有个去年的演讲](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1584) [关于这个 The Life of a watchOS App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1586) [这是个不错的演讲](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1588) [你也许能认出这是哪个演讲者](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1590) [他挺不错的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1591) [你想要保持](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1593) [最前状态两分钟 但是如果你](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1595) [能够想起来 我之前延长了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1598) [最前状态时间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1600) [这样的话 最前时间将会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1601) [被默认延长到8 分钟](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1603) [一样的 这个是很方便](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1605) [来用于下载内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1607) [所以我直接延长了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1608) [最前时间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1610) [如果我们正在播放](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1620) [一些音频 我们的 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1621) [会在整个 session 保持](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1623) [最前状态 就像远程控制](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1626) [iPhone 上正在播放的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1627) [音频一样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1630) [还有呢 当用户](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1632) [离开了界面](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1633) [你的 App 将不是最前了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1635) [但后台播放](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1637) [还是会正常运行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1639) [这个情况下 当然](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1641) [你需要处理好](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1642) [后台各种事件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1643) [好了 现在 当我们在最前](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1646) [的状态之中 我们可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1650) [和通知适当地结合起来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1653) [我们可以显示个通知 比如](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1656) [当下载已完成了 我们可以显示个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1658) [本地内容可以播放的通知](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1659) [我们想把播放](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1662) [作为主要的用户操作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1663) [靠着我们新的在 watchOS 上的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1665) [交互通知 我么可以让](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1666) [用户在通知里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1669) [设置一些播放参数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1670) [并且可以把启动播放](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1672) [作为主要操作 之后可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1676) [立即进入 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1677) [启动播放](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1679) [启动播放](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1679) [比如我们有](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1681) [Salvador Dali exhibit](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1683) [它已经准备好了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1686) [我们可以调整播放速度](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1687) [并且直接启动播放](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1688) [它将启动我的 App 然后](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1690) [我可以以合适的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1692) [速度给用户播放内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1694) [如果你想要更多](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1696) [关于交互通知的内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1699) [可以看看 What's New in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1701) [watchOS 之前的演讲](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1702) [他们都在网上可以找到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1704) [这是个很好的演讲 你可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1706) [学到很多关于](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1707) [交互式通知的内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1708) [在看完这个之后](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1710) [好了 你还记得](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1711) [我之前这个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1713) [发布通知](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1715) [提醒用户](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1716) [有东西可以播放了的功能吗](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1719) [比如说我们的 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1721) [现在在最前](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1722) [这样呢当我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1725) [从最前状态的 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1726) [发布了通知](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1728) [这将会被调用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1730) [并且显示一个有 completion handler](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1732) [的通知](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1733) [这样的话 我实际上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1736) [可以决定是否仍要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1737) [发布这个通知](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1739) [发布这个通知](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1739) [或者因为我的 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1741) [已经在最前了 我可以直接](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1742) [震动一下让用户知道](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1744) [抬起你的手](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1746) [你就有新的内容了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1747) [我可以更新界面](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1748) [同样 如果你想知道](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1750) [更多关于最前状态通知的信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1751) [可以去看一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1752) [Life of a watchOS App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1754) [好了 我们已经用了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1756) [最前 App 状态和](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1758) [交互式通知](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1759) [但我们也想在 Siri watch face 上显示内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1762) [使用音频 App 我们可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1765) [靠着相关的快捷方式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1767) [向 Siri watch face 提供一些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1768) [播放建议](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1770) [比如用户最喜欢的播客下一期](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1772) [内容或者](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1776) [刚刚同步到手表的音乐](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1778) [举个例子 Audible 可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1783) [产生类似的体验](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1786) [它可以从 Siri watch face](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1787) [直接让用户进入App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1789) [然后恢复播放有声读物](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1792) [无论何时交互](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1795) [产生了 就是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1799) [产生了 就是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1799) [强调一下 一定要想一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1800) [你送出了什么](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1802) [要确定你把你的 INMedia](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1803) [PlaybackIntent 送到系统](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1805) [这样之后系统可以知道](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1807) [大多数时候用户在干什么](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1808) [这样呢 你会跟 Siri watch face 连接更紧密](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1811) [同时也要想想你在 Siri](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1817) [中的快捷启动短语 比如](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1819) [设计一个合适的短语](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1821) [你的用户可以在 Siri 用它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1823) [直接进入你的 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1826) [然后进行播放](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1830) [总之 在 Siri watch face](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1832) [你可以设计良好的体验](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1835) [也许你有一些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1838) [只能看一眼的信息类似  “嘿](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1839) [展览就要开始了”](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1841) [或者一下可以点进去的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1843) [操作 像 Audible 做的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1845) [“嘿 我们马上开始语音导览”](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1846) [然后直接进入 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1847) [关于各种快捷方式 你要把你的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1853) [INMediaPlaybackIntent 送出去](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1856) [使用相关的快捷方式的 API](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1858) [使用相关的快捷方式的 API](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1858) [使之出现在 Siri watch face 上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1860) [并且你要想好你的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1863) [快捷启动短语](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1864) [我们这个礼拜有了很多](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1866) [关于快捷方式的演讲](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1867) [我重申一下 Shortcuts on the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1869) [Siri Watch Face 这个演讲的重要性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1872) [我自己这么觉得](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1873) [这个很棒](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1874) [我也从中学了很多](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1876) [总结一下 第一](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1879) [你可以把原生控制](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1881) [直接嵌入到你的 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1883) [你可以随意地使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1886) [后台播放来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1887) [随心所欲地处理](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1889) [远程控制命令](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1890) [同时也有了更好的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1892) [向手表传输内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1895) [并且把他们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1897) [呈现给用户的方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1899) [如果你想要更多的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1901) [信息 请到网上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1903) [查阅资料 或者加入我们下午的实验室活动](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1904) [我真的十分激动](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1909) [能见到这样为 watchOS 构建的的音频 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1910) [谢谢大家](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1912) [享受 WWWDC 大会吧 谢谢](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1915) [[ 掌声 ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/504/?time=1918)