WEBVTT
X-TIMESTAMP-MAP=MPEGTS:181083,LOCAL:00:00:00.000

00:06:57.616 --> 00:07:00.526 A:middle
可以说当用户再一次抬起手时

00:07:00.526 --> 00:07:01.356 A:middle
他们希望看到

00:07:01.356 --> 00:07:02.076 A:middle
我们的 App  

00:07:02.586 --> 00:07:04.476 A:middle
因为我们延长了

00:07:04.476 --> 00:07:05.946 A:middle
最前超时 我们从

00:07:05.946 --> 00:07:07.266 A:middle
系统得到了更多的优先级

00:07:07.266 --> 00:07:09.256 A:middle
来帮助我们使用的 URLSessions  

00:07:09.636 --> 00:07:10.766 A:middle
同样的 这个我们

00:07:10.766 --> 00:07:11.776 A:middle
等一下再说

00:07:12.186 --> 00:07:15.656 A:middle
当然了 用户在任何时候

00:07:15.656 --> 00:07:16.926 A:middle
都可以把手垂下

00:07:17.176 --> 00:07:18.476 A:middle
所以我使用

00:07:18.476 --> 00:07:19.416 A:middle
backgroundSession 来保证这一点

00:07:19.826 --> 00:07:21.276 A:middle
这样的话当我的 App

00:07:21.276 --> 00:07:22.516 A:middle
进入后台

00:07:22.516 --> 00:07:23.886 A:middle
下载还在继续

00:07:24.566 --> 00:07:26.186 A:middle
然后 我们可以直接启动

00:07:26.186 --> 00:07:27.706 A:middle
下载任务然后

00:07:27.906 --> 00:07:28.816 A:middle
将它忽略 

00:07:29.686 --> 00:07:30.926 A:middle
当你在构建这样的

00:07:30.926 --> 00:07:32.886 A:middle
用户体验时候 你希望

00:07:32.886 --> 00:07:34.556 A:middle
显示下载进度

00:07:34.626 --> 00:07:36.216 A:middle
并且当然要处理各种错误

00:07:36.586 --> 00:07:40.406 A:middle
让我们看看这是如何实现的  

00:07:40.406 --> 00:07:41.926 A:middle
看一下这里我建造了一个类

00:07:41.926 --> 00:07:43.796 A:middle
DownloadManager 它是我的

00:07:44.026 --> 00:07:45.536 A:middle
SessionTaskDelegate 也是

00:07:45.566 --> 00:07:47.176 A:middle
URLSessionDownload Delegate  

00:07:47.666 --> 00:07:49.886 A:middle
在第一个函数里

00:07:49.886 --> 00:07:51.296 A:middle
我可以获取总共下载了的

00:07:51.296 --> 00:07:52.646 A:middle
数据大小并把它除以

00:07:52.646 --> 00:07:54.076 A:middle
要写入的总字节数  

00:07:54.356 --> 00:07:55.366 A:middle
这样 我们可以获得

00:07:55.366 --> 00:07:56.676 A:middle
某个下载任务的进度  

00:07:56.676 --> 00:07:58.606 A:middle
在 URLSession

00:07:59.006 --> 00:08:00.796 A:middle
提醒我并且给我发出相关

