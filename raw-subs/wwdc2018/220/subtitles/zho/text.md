# High Performance Auto Layout

## Summary
Get a glimpse inside to find out what happens when you add a constraint! Dive into the internals of Auto Layout to develop intuition for how your code affects what happens under the hood. Learn how to measure and refine your approach to Auto Layout and see how its improved performance in iOS 12 will speed up your app.

## Info
* Frameworks
* WWDC 2018 - Session 220 - iOS
* https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/

## Text
 [[ 音乐 ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=7) [[ 掌声 ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=19) [&gt;&gt; 下午好](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=25) [欢迎大家 我叫 Ken Ferry](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=27) [今天我与 Kasia Wawer 将会给大家介绍](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=29) [Auto Layout 的性能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=31) [上一次我站在这里谈论](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=33) [Auto Layout 是 2011 年](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=35) [当时我们刚刚推出这个功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=38) [所以我很高兴可以回到这里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=39) [与你们一起探讨这个功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=42) [好的 下面说 Auto Layout](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=44) [我们像这样把内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=49) [放置在 Mac 的 iOS 系统中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=51) [其中主要涉及的是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=53) [我们熟知的视图和约束](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=55) [其中约束定义](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=58) [视图之间的关系](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=59) [视图之间的关系](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=59) [那么关于性能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=61) [我想其中的挑战在于](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=63) [如果只说这两个按钮的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=64) [间距为 20](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=67) [就很难去理解机器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=69) [如何一步一步](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=70) [完成这个过程](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=72) [也就是说 很难去](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=74) [正确理解对](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=75) [其性能的期望](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=77) [并了解什么运行得快](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=78) [什么运行的慢 以及一般情况下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=79) [整个过程是如何工作的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=81) [这就是我们今天的目的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=82) [今天的目标是 真正理解并掌握整个过程如何运作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=85) [那么我们就](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=89) [首先展示一些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=91) [我们在过去为了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=92) [iOS 12 发布而做的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=93) [性能方面的工作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=95) [我们有很多成果](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=96) [在演讲中会进行介绍](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=97) [这之后我们将会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=101) [讨论如何建立起](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=104) [我刚才说的那种一步一步的理解](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=106) [这样我们对于性能有](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=108) [较好的判断和较好的期望](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=110) [为此我们将会做](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=112) [一些不寻常的事情](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=113) [我们会谈到一些内在问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=115) [请尽情享受](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=117) [最后 如果你只依赖于](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=122) [对性能的直观判断](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=124) [这远远不够](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=126) [那么我们将有请 Kasia](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=128) [上台来分析代码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=130) [我们将会展示如何](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=132) [将你的直观判断与](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=134) [实践结合起来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=136) [现在开始吧](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=138) [首先 作为一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=140) [Apple 展示的传统](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=142) [我们先来看到一些数据和自夸](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=143) [[ 笑声 ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=145) [我们目前看到的是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=149) [一个基准测试](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=151) [我们进行工作的方法是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=153) [去寻找并查看](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=155) [一些第三方 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=157) [也包括我们自己的 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=158) [并试图将看到的内容提取](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=160) [为测试案例](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=161) [因此我们可以进行基准测试](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=164) [那么我们看到的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=165) [就是 UICollectionView](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=167) [它具有自动调节大小的单元格](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=169) [看起来糟糕的那一边](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=171) [就是 iOS 11 它看起来很差劲](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=173) [就是 iOS 11 它看起来很差劲](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=173) [而在 iOS 12 中它表现完美](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=180) [达到了全帧速率](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=183) [这就是我们所关注的案例之一](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=185) [这里还有一些其他的样本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=187) [这样的样本我们有很多](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=190) [这些都是关于时间的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=192) [你们所看到的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=194) [灰色的条形代表 iOS 11](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=196) [即在 iOS 11 上所需的时间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=198) [蓝色的代表 iOS 12](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=200) [你们可以看到的是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=202) [我们发现很多地方](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=204) [都有很大的改进空间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=205) [而这些会对你们的 App 有帮助](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=208) [这会让产品](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=211) [变得更好 希望如此](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=212) [改进存在于整个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=215) [堆栈的过程](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=216) [其中有的位于](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=217) [核心中 可以影响到方方面面](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=219) [有的存在于 UI Kit 中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=222) [有的则是存在于客户](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=224) [层面 关于如何使用 Auto Layout](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=225) [比如说 UICollectionView 基准测试](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=228) [也就是刚刚展示的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=231) [就包括所有改进](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=232) [它包括了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=234) [核心部分的 也包括了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=235) [一些非常](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=237) [重要的改进](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=238) [重要的改进](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=238) [是关于 UICollectionView 如何](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=240) [使用 Auto Layout 如何展现](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=241) [更高的性能的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=244) [这对于接下来的演讲](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=245) [是一个不错的例子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=247) [你们也可以做到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=249) [那应该如何正确使用它呢](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=250) [当我们完成这些工作后](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=252) [我常常会想到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=255) [我们之所以能够完成](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=256) [这些改进是因为](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=257) [我们有一个很好的心智模型](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=259) [关于事物如何组建以及](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=261) [如何执行 如何工作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=264) [我们希望帮助你们也构建起这一模型](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=267) [为此我们会先](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=270) [探讨一个示例](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=271) [一些客户端代码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=274) [它们有一些问题 我们将会讨论问题的原因](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=276) [你的代码或许不一定有](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=279) [一模一样的问题 但我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=280) [选择的是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=282) [我们认为](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=283) [在看到的这些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=284) [客户端 App 中最为常见的问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=286) [就算你没有这个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=288) [问题 我们所做的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=289) [对问题的探讨](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=290) [将会对每个人都有所帮助](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=292) [而且可能对所有人来说 都是新的内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=293) [那么我们开始吧](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=296) [这个示例是我们即将探讨的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=299) [这个示例是我们即将探讨的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=299) [要产生这个布局 显然非常简单](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=301) [我想你们应该经常](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=305) [在 Interface Builder 中创建它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=306) [这个做法很聪明](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=308) [因为这样就能够](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=309) [完全避免](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=311) [我们可能遇到的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=312) [性能问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=313) [那么假设我们没有这么做](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=316) [假设我们像这样创建布局](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=319) [让我们先大致看一看](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=324) [再进行分析](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=325) [首先看一看 这些代码是做什么的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=326) [首先我们覆写](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=328) [UIView 中的 updateConstraints 方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=331) [不管它是做什么的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=333) [后面会谈到它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=335) [接着 我们有一个成员变量叫 myConstraints](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=337) [我们提取这个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=342) [变量中的所有内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=345) [并停用所有的约束](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=346) [我们然后创建](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=348) [约束 这些约束](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=349) [实现我们刚刚看到的布局](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=351) [这非常直白](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=353) [使用的是视觉格式语言](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=354) [然后我们执行这些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=356) [约束 安装它们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=357) [最后我们调用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=359) [最后我们调用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=359) [super.updateConstraints](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=360) [这很重要 因为这个方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=362) [对 UIView 层面的执行很有用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=364) [好的 这就是基本的结构](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=369) [表明了它的目的 并且确实可用有效果](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=371) [但是我们接下来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=375) [进一步探讨它的运行过程](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=378) [让我们更好地了解其性能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=380) [那么首先要了解的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=382) [就是到底什么是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=383) [updateConstraints 即我们正在覆写的方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=384) [它属于渲染循环](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=388) [渲染循环是一个过程](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=391) [它每秒钟可用运行高达 120 次](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=393) [从而确保所有内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=397) [出现在每一帧上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=398) [好的 它包含 3 个阶段](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=401) [分别是更新约束](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=403) [布局与显示](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=405) [首先所有需要的视图都会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=407) [收到 updateConstraints](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=409) [然后从最末端的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=411) [视图开始 沿着视图层级向上运行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=413) [最终到达窗口](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=415) [接着 每个视图会收到 layoutSubView](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=416) [它沿着相反方向运行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=419) [它沿着相反方向运行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=419) [从窗口向下直到末端](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=420) [最后 所有视图按需求提取](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=423) [差不多就是这样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=425) [好的 那么这是为什么呢](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=428) [它们为什么存在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=431) [它们全部具有完全](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=433) [相同的目的以及完全](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=434) [平行的方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=437) [这个目的就是防止](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=438) [工作的浪费 我后面会举例子解释](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=440) [一个 UI 标签需要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=444) [约束来表述](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=448) [其文本的尺寸 对吗](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=450) [但是 有很多属性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=454) [都与文本尺寸相关](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=454) [比如有文本本身属性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=456) [还有字体 以及](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=457) [文本尺寸 等等](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=459) [一种方法是每次这些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=461) [属性出现变化时 去重新测量你的文本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=464) [但是 那往往效率极低 因为](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=468) [一般会连续改变多个属性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=472) [当你首次设置一个标签时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=474) [你可能会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=475) [调用一批此类属性设置](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=476) [那么如果你](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=477) [每次都重新测量文本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=478) [所有的中间环节就被](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=480) [浪费了 你事实上只想](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=481) [在完成后进行测量](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=482) [那么这就是渲染循环为你做的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=483) [这样你只需选择](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=485) [对于设置的字体调用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=488) [setNeedsUpdateConstraints](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=490) [然后你就可以确保](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=493) [在设置后更新约束](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=495) [且在这一帧出现在屏幕上之前完成](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=497) [这就是它的作用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=499) [那么有一些事情](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=501) [需要了解](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=502) [第一 它运行次数多](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=504) [每秒钟 120 帧](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=506) [第二 它们是平行的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=508) [因此你也可以用作直觉判断](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=510) [如果你觉得你理解了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=512) [布局部分的运行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=513) [或是有了一些感觉 那么你在思考](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=515) [更新约束或显示时也是一样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=517) [最后一件事就是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=520) [它存在的原因是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=521) [避免工作浪费](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=523) [延迟工作 甚至有可能跳过工作 完全跳过](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=525) [好了 看完这些之后](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=529) [我们现在可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=533) [分析这一方法的其他部分](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=534) [可以看到 每一次](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=536) [调用时 我们都停用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=539) [调用时 我们都停用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=539) [一些约束 然后执行一些新的约束](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=541) [这与 layoutSubViews 类似](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=545) [假设我们在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=547) [layoutSubViews 中写了相同的代码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=549) [像是这样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=551) [每一次 layoutSubViews](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=554) [被调用时 你就销毁了之前所有的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=556) [子视图 然后从头开始](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=558) [创建 再添加它们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=560) [我相信很多人都会有](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=563) [非常准确的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=565) [直觉判断 认为这可能不会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=566) [很好的执行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=567) [所以只需要记住的是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=569) [它们一样的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=571) [不管你对此有什么直觉判断](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=573) [都可以用在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=574) [updateConstraints 上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=576) [当你这样停用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=578) [各种约束时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=579) [其实做了很多无用功 那么如何解决这个问题呢](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=580) [你需要做的是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=583) [正如我们说的 你需要确定](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=586) [你不会重复工作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=587) [这就是延迟工作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=589) [情况应该是这样的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=591) [我们询问是否已经做过这个工作了呢](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=593) [如果做过了 那么就不要再做任何事](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=595) [如果还没有做过](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=597) [那么当然要设置这些约束 只做一次](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=598) [这样就能很好地执行了 对吧](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=600) [那么 就像之前说的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=604) [这实际上是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=605) [客户端代码中最常见的错误](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=607) [我们称之为约束流失](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=609) [即不必要的删除约束](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=612) [然后再次添加它们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=614) [好的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=616) [我们还有很多要做](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=617) [但是现在先等一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=619) [回顾一下渲染循环](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=621) [仔细思考](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=622) [如果你确实需要渲染循环](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=624) [那它非常好用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=626) [它的目的是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=627) [有助于避免那些冗余的工作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=629) [但它也比较危险 因为](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=632) [运行次数过多](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=634) [这个代码非常敏感](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=635) [所以像这种情况 一般来说你使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=638) [这样敏感的代码时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=641) [你应该在写代码时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=643) [小心谨慎 同时也应该](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=644) [试图减少](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=645) [写此类敏感代码的次数

00:10:48.616 --> 00:10:50.636 A:middle
因为你有可能会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=646) [把事情搞砸](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=650) [我们都有搞砸的时候](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=652) [所以在这种情况下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=653) [你真的应该考虑](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=655) [我是否可以只做一次](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=655) [而非把它放入](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=657) [updateConstraints 中 完成这个工作的好办法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=660) [就是使用 Interface Builder](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=661) [如果你可以使用 Interface Builder](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=664) [你就应该使用它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=666) [它的好处体现在方方面面](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=667) [可以让你走上正确的路径](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=668) [好的 很好](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=671) [既然我们现在已经讨论过了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=673) [我认为 我们已经更好地理解了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=674) [为什么这是有问题的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=675) [至少是通过类比](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=677) [但是这个演讲的目的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=681) [要求我们做的比这更好](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=682) [我们并不只想说这样不好](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=683) [我们希望真正的理解它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=686) [真正地理解这个过程](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=688) [为此我们需要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=690) [拨开表面](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=693) [看到真正发生了什么事情](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=694) [那么当我们启用约束 添加约束时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=697) [这个过程是什么样的呢](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=703) [我们以图表的形式进行直观阐述](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=706) [假设这是一个视图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=708) [我们想在其中添加约束](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=710) [这个视图在一个窗口中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=713) [窗口挂着](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=715) [一个内部对象叫做引擎](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=717) [一个内部对象叫做引擎](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=717) [引擎是 Auto Layout 的计算内核](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=720) [在添加约束后](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=723) [我们要创建](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=726) [一个与约束对应的等式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=730) [然后我们将](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=732) [该等式添加到引擎中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=733) [这个图表中最后一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=736) [需要理解的问题是该等式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=738) [是关于变量的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=740) [而变量 举个例子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=742) [假设我给你一个等式 然后我说](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=744) [解出 X 那么 X 就是变量](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=745) [在这个情况下我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=749) [需要解决的就是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=750) [视图的帧数据](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=753) [对于每一个视图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=755) [将会有 4 个变量 分别是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=756) [X 轴坐标 Y轴坐标 宽度和高度](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=757) [好的 那么让我们进入这一过程](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=761) [这是我们将要创建的布局](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=764) [简单起见我们仅关注](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=765) [横向约束](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=766) [但是我们会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=768) [考虑整个过程](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=769) [那么第一件事](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=771) [如我们刚才所说 就是我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=772) [创建等式 看起来是这样子的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=773) [这些看起来非常直观](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=777) [我认为最有趣的是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=778) [我认为最有趣的是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=778) [两个文本框之间的空间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=780) [它看起来像是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=781) [看起来非常](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=783) [近似于你写的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=785) [约束 但它相对是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=787) [更低层级的 因为它是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=788) [关于这些变量的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=790) [好的 然后每个等式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=793) [都需要被添加到引擎](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=796) [事实上我们将会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=798) [再次研究这一过程](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=800) [目标是对于](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=802) [性能特点有一个更好的把握](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=804) [那么 当我们这么写时发生了什么?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=807) [引擎试图解出](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=809) [这些变量](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=811) [这跟你在代数中学到的很像](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=813) [看起来也完全相同](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=816) [那么我们一起来看](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=818) [首先是第一个等式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=820) [表明第一个区域的 X 轴坐标是 8](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=822) [好的 它的宽度为 100 好](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=824) [好的 这个等式中我们定义](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=828) [定义第二个区域的 X 轴坐标](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=830) [等于第一个 X 坐标加上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=832) [该宽度再加 20](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=833) [在代数中你会怎么做](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=834) [如果有人要求你解出这些变量](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=837) [你会用已知的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=840) [数据来进行替换](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=842) [这就是接下来即将发生的事情](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=844) [如果你进行程序剖析](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=846) [会看到 引擎中确实有一个方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=848) [包含替换这个词](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=850) [同时还包含了其他的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=852) [140 个字符 因为我们是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=853) [Cocoa 编程开发者](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=856) [这就是引擎将要做的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=858) [然后 你知道 最后一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=862) [等式进入后 看起来就完成了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=863) [看上去这就是全部的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=867) [工作 至少针对](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=869) [这个案例 就可以解出](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=870) [全部变量 确实如此](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=872) [这就是我此时要了解的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=875) [那就是这些工作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=876) [并不复杂](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=879) [它的过程](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=881) [和手工计算](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=882) [非常非常近似](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=883) [同时 它也并不是高消耗](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=886) [它只不过是完成替换 就像这样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=888) [这就是它所做的工作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=890) [好的 那么现在我们已经](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=892) [在引擎中解出了这些变量](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=895) [但是这并不是一个布局](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=896) [下面让我们完成这个过程](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=898) [下面让我们完成这个过程](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=898) [接下来的过程中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=902) [每当引擎将一个值赋给](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=903) [其中一个变量](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=906) [它都会告知视图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=907) [变量从何而来 并告知](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=909) [它已发生变化](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=911) [那么视图会做什么作为回应呢](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=912) [如果你想一想](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=916) [它会调用上级视图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=917) [并使用 setNeedsLayout 因为需要发生变动](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=920) [好的 这就是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=925) [更新约束阶段的全部内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=927) [现在我们已经收到了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=931) [setNeedsLayout 在某个时间点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=932) [就会进入布局阶段](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=933) [好的 最后一块拼图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=936) [就是我们将会收到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=939) [UIView 将会收到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=940) [layoutSubViews 而它要做的就是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=942) [把这部分数据](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=945) [从引擎中复制到帧](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=947) [那么它会询问引擎](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=950) [那些变量的值是多少](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=952) [引擎将会告知它 该上级视图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=954) [就会在下级视图中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=956) [调用 setCenter 和 setBounds](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=958) [调用 setCenter 和 setBounds](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=958) [这就是全部过程](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=963) [那么 我们回顾一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=966) [想一想这就是逐步创建布局的过程](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=967) [如果你能够尝试吸收它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=970) [并找到感觉](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=972) [你将会对性能期望](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=974) [有更好地理解](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=977) [事实上 让我们看看](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=980) [现在是什么情况 因为现在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=981) [当我们看到这里 看着这个方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=984) [也就是我们停用约束](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=986) [以及重新启用约束的地方](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=989) [回想一下我们刚才所做的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=991) [想一想引擎](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=992) [将会怎么做](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=993) [它看起来将是这样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=995) [我们称之为流失](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1000) [它的每一次运行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1002) [并不是特别的高消耗 但是它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1005) [运行的次数很多](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1007) [而这是完全不必要的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1009) [这部分工作被浪费了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1011) [那么如果你可以在心里感觉到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1012) [如果你可以真正感觉到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1014) [当你这么做时 发生的事情](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1016) [那么你就能够处于一个很好的状态](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1018) [那么你就能够处于一个很好的状态](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1018) [那么你就会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1020) [与接下来我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1022) [要做的处于同一水准](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1023) [并对此具备一个良好的把握](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1025) [好的 我希望目前一切都好](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1026) [我们还有另外一个大话题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1028) [希望探讨](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1034) [如果想要获得一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1035) [较好的性能模型 我们的想法是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1036) [你只为你使用的内容消耗性能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1038) [这在 Auto Layout 中可以做到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1040) [当看过这些以后我认为](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1042) [我们已经能够理解其中的含义 对吗](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1043) [为此 我们假设](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1046) [目前的情况是之前的两倍](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1048) [那么我们有四个文本框](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1049) [分别在两个互相独立的层级中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1051) [现在你可以做的是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1054) [创建一个约束](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1056) [令其像这样跨越层级](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1058) [那么你可以说](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1060) [1 号文本框应该与](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1062) [3 号文本框对齐](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1064) [尽管它们的上级视图并不相同](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1065) [我认为 有时候人们会有](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1068) [一个印象 就是因为这是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1070) [可能完成的 就意味着它会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1072) [运行的较为缓慢](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1074) [因为各个部分可能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1076) [随时相互影响](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1078) [就像一团浆糊](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1079) [就像一团浆糊](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1079) [而性能可能很糟糕](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1080) [好的 但我们了解过](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1085) [刚才的内容后 再一起来看看](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1087) [在普通情况下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1088) [不会进行这种操作 因为大部分时间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1091) [都没有必要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1093) [大多数情况下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1094) [视图仅受到上级视图或](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1096) [同级视图的约束](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1097) [你看到由于我们有两个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1099) [互相独立的区块](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1103) [引擎内部](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1105) [将会有两个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1107) [互相独立的等式块](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1108) [它们完全不与](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1109) [对方互动 也不具有任何](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1111) [互相重合的变量](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1112) [这样一来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1114) [由于它们完全不会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1116) [重合 就不会发生互动](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1118) [如果我们只有一个等式快](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1119) [就需要花一些时间来进行处理](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1121) [如果我们有两个这样的等式块](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1124) [就需要花费两倍的时间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1125) [因为它们之间并没有任何关系](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1127) [如果有三个 就是三倍时间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1129) [以此类推 问题在于你](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1130) [将会看到线性关系](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1132) [你将会看到线性的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1134) [性能 这已经是你可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1136) [得到的最优结果](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1138) [已经是最好的情况了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1139) [已经是最好的情况了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1139) [我想要再次强调一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1141) [之所以它是线性的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1143) [是因为它们之间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1145) [不存在任何互相依赖性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1146) [如果它们之间存在互相依赖性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1148) [那么这些等式块](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1150) [将会被连在一起](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1151) [将会有更多的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1154) [计算需要处理](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1155) [但也只是使用的时候](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1158) [当然如果你确实有这样的情况 你知道](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1160) [如果你手动处理](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1162) [当然它会比较](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1163) [消耗性能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1164) [你也能想到 因为这件事情更为复杂](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1165) [这样常见的情况](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1167) [是我们在 Cocoa 中的目标](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1169) [即让简单的事情](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1171) [保持简单 让复杂的事情成为可能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1172) [在这一情况下 它们可能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1175) [性能消耗会高一点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1176) [但是你不必为此消耗性能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1177) [如果你不使用的话](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1178) [事实上 用直觉理解整个引擎的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1181) [正确方法就是 你可以把它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1184) [想作一个布局的缓存](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1186) [和一个依赖关系追踪器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1189) [它非常有针对性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1191) [它了解哪些约束](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1192) [会影响哪些视图 而当你](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1194) [做出改变时 它只会更新](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1195) [需要改变的内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1198) [这对于你写代码也有启发](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1200) [有时候我们看到的一个问题是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1204) [有一些人会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1207) [费很大劲去避免创建](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1208) [约束 因为他们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1211) [认为这样性能消耗太高](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1213) [然而 事实上约束很有针对性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1216) [只要你创建的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1218) [约束能够有效对应](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1219) [你正在解决的问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1221) [那么 就不太可能发生](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1222) [更好的情况](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1224) [如果你试图去回避问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1225) [也不会有更好的性能情况](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1226) [我们经常看到有些人](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1228) [进行非常复杂的测量](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1229) [把问题复杂化](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1231) [然后试图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1233) [获取信息 然后再](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1234) [返回信息 这样往往](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1235) [消耗更多 相对](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1237) [直接表达一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1238) [你所需要的约束而言](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1240) [这个问题的反面是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1242) [有时候我们会看到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1245) [像这样的层级](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1247) [在这样的层级中我们看到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1249) [非常多的约束](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1251) [以及非常多的优先级 以至于](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1252) [过程很不清晰](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1254) [通常这种情况](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1256) [表示事实上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1258) [表示事实上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1258) [情况可能是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1260) [这个人心里有两个完全](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1261) [独立的布局](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1263) [而试图把它们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1265) [打包到一套](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1267) [约束中 然后一次性解决问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1269) [这也不是一个好主意](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1271) [那将会产生](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1274) [许多虚假的依赖关系](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1277) [它们看起来是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1278) [互动的 但事实上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1279) [并非如此](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1280) [而且几乎没办法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1281) [进行调试 如果你不注意的话](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1282) [那么我的总体建议是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1286) [试图以最直接的方式对问题建模](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1290) [Kasia 将会带大家](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1292) [探讨这类在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1293) [不同的布局间切换的例子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1294) [并且展示的更为明确](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1295) [但是这只是一般性建议](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1298) [你需要自然地使用它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1300) [这对于性能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1302) [和理解都有好处](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1303) [好的 这就是我们今天要说的大部分内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1305) [但是由于我们想要建立](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1311) [一个总体的关于](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1312) [布局性能特点的心理模型](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1314) [我希望至少确保](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1315) [我们谈到了全部主要特征](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1317) [你还有很多其他的事情可以做](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1319) [你还有很多其他的事情可以做](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1319) [我们讨论一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1322) [那么你可以定义一些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1324) [特定的视图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1325) [宽度至少为 100](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1327) [你可以使用不等式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1328) [这样做的消耗如何](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1330) [非常非常低](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1331) [与仅仅定义](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1333) [宽度等于 100 相比](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1333) [由于我们已经对内部问题略有探讨](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1335) [它的消耗仅仅是多一个变量 仅此而已](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1337) [你也可以调用设置常量功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1341) [对这个问题的用例](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1344) [就如同我有一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1346) [手势辨认器 而我](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1347) [试图将一个视图四处拖拽](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1349) [要做的是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1351) [每一次我从手势辨识器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1352) [获得信号时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1354) [我会使用它的翻译结果](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1356) [并将其输入一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1358) [约束 通过为](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1359) [该约束设置常量的方式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1361) [输入翻译值](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1364) [好的 它接下来要做的是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1366) [我们刚才讨论过的引擎如何充当](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1368) [一个依赖关系追踪器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1370) [它将这一点发挥到了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1372) [最大水平](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1373) [这是一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1375) [非常快速的一步更新](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1378) [非常快速的一步更新](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1378) [由于约束的改变](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1380) [而改变需要更改的内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1382) [这是一种性能优化](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1384) [这就是为什么我们要用这么一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1386) [设置常量的方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1387) [最后要讨论的是它的优先级](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1389) [因此这里你可以定义](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1392) [你可以定义这个视图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1394) [最好宽度为 100 但是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1396) [如果达不到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1398) [就尽量靠近这个数值](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1400) [这确实会导致更多的工作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1402) [一定量的工作发生](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1405) [那么让我们进一步讨论一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1406) [另一个考虑的角度](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1408) [是定义该文本框的宽度](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1410) [等于 100 加一些误差 并且](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1411) [最小化该误差](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1415) [这就是你们想要的部分](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1417) [因此这里有一个误差](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1419) [最小化的阶段 我之前](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1421) [没有讨论过](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1422) [当视图询问引擎](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1423) [作为布局子视图的一部分](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1426) [“这些变量的值是多少?”](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1428) [引擎需要确保](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1430) [所有误差值](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1431) [已经完成最小化](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1433) [实际上我不会探讨具体](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1435) [是如何工作的 但我会稍微讨论一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1438) [是如何工作的 但我会稍微讨论一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1438) [性能特点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1440) [我会说的简洁明了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1442) [因此你或许想要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1444) [看看这个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1446) [这是简单的 X 算法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1447) [这是实际的事](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1448) [非常古老](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1449) [是第二次世界大战期间开发的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1451) [甚至早于电脑的出现](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1453) [事实上 过去有一些人](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1457) [被称为电脑](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1459) [就在机器被称为电脑之前](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1460) [这就是他们所做的事情](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1461) [他们手动完成计算](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1463) [这会给你一些关于](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1465) [性能特点的感觉](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1467) [如果你手动计算](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1468) [应该非常快 而且它确实是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1469) [这与我们刚才做的事情](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1471) [几乎是相同的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1473) [更多的是替换过程](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1474) [这就是你进行思考的方式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1475) [不管怎么说 你知道](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1478) [当你使用优先级时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1479) [它确实会产生这么多性能消耗](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1480) [这一点需要注意](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1482) [好的 除此之外 它与之前相同](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1484) [这就是我想说的内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1486) [这就是我们试图建立](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1490) [这种直观的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1492) [对于 Auto Layout 的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1494) [性能特点的理解](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1496) [快速地回顾一下我们刚才讨论的内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1498) [不要使你的约束流失](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1500) [这在你完成](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1502) [无意义工作时会发生](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1503) [因此不要这么做](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1505) [当你处理约束时 它实际上是基础代数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1506) [而这种代数也发生在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1510) [你添加约束](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1511) [移除约束](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1512) [以及调用设置常量功能时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1514) [以上是主要情况](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1516) [还有 你知道 当我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1517) [处于误差最小化阶段时 也是代数问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1520) [理解 Auto Layout 的工作原理的方法是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1523) [把它想做是一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1526) [布局缓存](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1528) [可以看到引擎包含所有](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1529) [已解出的值 并且它是一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1531) [依赖关系追踪器 因此当](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1533) [数据发生改变时我们可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1534) [以一个非常有针对性的方法 更新那些值](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1537) [这引出了我们最后一个点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1539) [那就是你只为](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1541) [你在使用的功能消耗性能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1543) [这就是我们所谈到的内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1545) [你知道 这就是你的直觉判断](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1547) [接下来的部分我将会交给 Kasia](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1548) [因为 再次强调 如果你](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1553) [只是依赖于直觉判断 是无法完成布局的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1554) [所以她将会进行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1556) [一些分析](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1558) [避免我们刚才讨论的问题 并把直觉判断](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1559) [避免我们刚才讨论的问题 并把直觉判断](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1559) [用于实践中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1561) [欢迎她](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1562) [[ 掌声 ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1564) [&gt;&gt; 好的 请让我开始我的部分](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1572) [谢谢 Ken 大家好](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1574) [我的名字是 Kasia Wawer](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1575) [我是 iOS 键盘组的成员 我们使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1577) [Auto Layout 也很喜欢它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1580) [所以接下来我想与大家讨论](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1582) [如何创建有效的布局](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1584) [好的 让我们快速](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1586) [回顾一下约束流失问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1587) [正如刚才听到的 约束流失](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1589) [发生在你改变你的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1590) [约束 但是实际视图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1591) [并不需要变动时 因此你](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1593) [向引擎发送了过多工作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1595) [而且可能会影响到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1597) [你的性能表现](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1598) [所以你希望避免这种情况](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1599) [那么让我们探讨一下你什么时候](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1601) [可能遇到这一问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1603) [以及如何解决它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1605) [因此我们将以一个规格说明为例](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1606) [这是一个社交网络 App 使用的规格说明](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1609) [有一个头像视图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1611) [可以显示谁在分享](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1612) [有一个标题 一个日期](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1613) [以及一个日志输入界面](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1616) [你需要设置一些间隔](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1619) [你需要设置一些间隔](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1619) [可能需要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1620) [规定一些尺寸 你也有可能会用到对齐](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1621) [而事实上这并非一个完全的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1625) [社交媒体 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1628) [这是一个半社交媒体 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1629) [你可以选择是否愿意分享内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1631) [因此还有一个可选的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1634) [视图 显示你已经](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1635) [分享的内容 以及分享的用户](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1636) [而且一个社交媒体 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1638) [如果不能分享猫的图片](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1640) [就是不完整的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1642) [因此你可能会需要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1643) [添加另一个布局](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1644) [也许你根本并不想](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1646) [分享这个猫的图片 因为](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1648) [它实在太好了 你想要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1649) [自己保留它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1650) [那么我们有四个非常相似的布局](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1652) [它们并不是相同的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1654) [需要做一些调整](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1655) [当这些表格视图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1656) [单元格出现在屏幕上时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1658) [当做我刚刚没有提到它们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1659) [存在于表格视图单元格中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1660) [让我们假设你正在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1662) [处理这个 App 的性能问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1663) [你第一次运行它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1665) [这就是你获得的滑动性能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1667) [其中有很多卡顿现象](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1669) [尤其是当向上滑动 返回顶部时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1671) [那么你会想 好的 我要怎样来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1673) [提升这个 App 呢](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1675) [发生什么问题了呢](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1677) [因此我想介绍](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1678) [因此我想介绍](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1678) [一个新的功能 它可以让你](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1681) [对我们正在开发的内容先睹为快](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1682) [目前它在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1683) [测试版中尚不可用 但是敬请期待](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1685) [因为我们很快会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1687) [推出一个布局设计的工具](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1688) [好的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1692) [[ 掌声 ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1693) [我很高兴你们对此感到兴奋](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1699) [让我们很有动力](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1700) [不管怎么说 我们一起来看看 发生了什么](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1702) [最顶部的轨迹显示的是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1705) [正在使用的 CPU 容量](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1707) [某种程度上说](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1709) [这是一个危险信号](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1710) [如果存在许多峰值](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1711) [这意味着你](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1713) [你的布局](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1714) [可能有一些问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1715) [而如果它较为平滑](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1717) [可能其它地方](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1719) [会有别的问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1720) [下面的轨迹则](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1722) [具体地追踪约束流失](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1723) [这些柱状图的高度](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1726) [在这个例子中 反映的是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1727) [发生约束流失的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1729) [视图数量](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1731) [因此当你看到很高的柱状图时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1733) [你就知道有许多视图受到了影响](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1734) [我们也会展示如何](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1737) [移除和改变约束](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1739) [移除和改变约束](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1739) [并最终设定](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1741) [UILabel 和其他文本视图的尺寸](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1745) [这里是 UILabel 是因为](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1746) [这是 App 中的内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1748) [它也可以追踪其他](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1749) [类型的文本视图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1751) [那么这是 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1753) [滑动时的情况 我们需要查看什么呢](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1756) [有一些峰值发生在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1759) [CPU 视图中 但是让我们放大](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1761) [这一个 因为在它下面](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1764) [我看到了一个约束流失的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1765) [突然上升 这有些令人担忧](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1767) [那么 如果你选中这个视图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1769) [然后进入 Instruments 中的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1771) [详细视图 你会看到的是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1773) [一个列表 根据视图描述列明](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1775) [受到约束流失影响的视图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1776) [我们依据](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1779) [上级视图将它们分类 那么](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1780) [比如说在表格视图单元格中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1782) [很容易看出这个问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1784) [一次又一次地发生在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1786) [某个特定的情况下 而非不同情况下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1788) [那么在这一实例中我们看到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1791) [头像视图和三个不同标签](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1792) [都出现了流失问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1794) [由于是我](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1797) [负责在 Instruments 中运行的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1799) [负责在 Instruments 中运行的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1799) [我知道这些标签](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1801) [对应的是 标题标签](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1802) [日期标签和我们的日志输入标签](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1803) [这几乎是单元格内的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1807) [全部视图了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1808) [这让人有点担心](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1809) [我们一起来看看发生了什么](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1811) [好的 回到我们的规格说明](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1813) [通过查看代码发现](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1816) [UpdateConstraints 正在被覆写](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1819) [并且在该方法中 在发生任何改变或](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1822) [UpdateConstraints 在运行时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1825) [都会移除全部约束](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1827) [然后再添加](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1828) [我们认为需要的约束](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1830) [一切又回到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1833) [原来的样子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1835) [正是这种移除](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1837) [导致性能问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1839) [那么 这里的社交标签](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1842) [也就是社交头像](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1844) [被反复添加和移除](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1847) [我们并不需要完全移除](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1849) [当你查看](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1851) [这一视图的约束时 你会看到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1852) [它们实际上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1854) [并不与其他任何东西互动](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1856) [仅仅是一个单一的视图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1857) [此时你可以使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1859) [此时你可以使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1859) [这个非常简洁的功能叫做](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1861) [setHidden 也许你听说过](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1863) [而且由于它并不影响](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1865) [任何周围的视图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1867) [它就会消失](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1869) [其约束则会得到保留](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1870) [这是一个非常非常简便的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1871) [方法来隐藏和显示视图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1874) [而非将它们从层级中移除](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1876) [因此这是没有问题的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1878) [但是这是一个非常简单的例子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1880) [那么图像视图呢](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1881) [好的 对于图像视图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1883) [我们可能再一次](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1884) [试图将所有的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1885) [约束移除 而后再添加](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1886) [已有的约束以及图像视图的约束](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1888) [一切又回到原来的样子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1891) [这就是约束流失](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1894) [在这样的情况下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1896) [我希望你们思考的方式是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1898) [分组查看约束](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1899) [让我们从这个分组开始](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1901) [我将其高亮为绿色](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1903) [这些约束在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1905) [每个布局都是一样的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1908) [我们在隐藏或显示分享视图时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1910) [分享视图不需要发生变化](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1913) [头像视图不会移动](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1914) [这些标签也不会发生移动](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1916) [除了日志输入标签会变得更长](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1919) [除了日志输入标签会变得更长](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1919) [因此这些绿色的约束](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1921) [应该在你创建](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1923) [视图时添加 然后被保留在原处](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1924) [不要修改它们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1928) [它们要保持不变](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1929) [现在我们有四个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1932) [约束控制着这个图像视图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1933) [要如何处理它们呢](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1935) [我们把它们放入一个数组 然后我们再将](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1937) [在没有图像时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1941) [将出现的约束放入另一个数组](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1942) [我很有创造性地将它们叫做](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1944) [imageConstraints 和](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1945) [noImageConstraints 这样你们就可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1946) [区分它们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1947) [当我们即将](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1949) [需要添加](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1952) [或删除该图像视图时 让我们看看](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1954) [现在所处的布局](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1956) [如果需要的话 停用 noImageConstraints](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1958) [并且激活那些图像所需的约束](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1961) [如果我们不需要图像](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1963) [那么既然全部其他的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1965) [约束已经被激活了 我们只需要再激活](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1966) [我们正在添加的约束即可](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1969) [现在我把它们都放入数组中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1970) [尽管这是一个单一约束 因为这样可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1971) [简化我的代码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1973) [我不需要检查](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1975) [我是在处理一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1976) [数组还是一个单一约束](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1977) [这样我一直都是在处理约束的数组](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1979) [这样我一直都是在处理约束的数组](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1979) [只是长度的不同](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1981) [这样做的好处是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1983) [如果你像这样 正确地](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1986) [追踪你的约束](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1988) [而且你知道你想要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1990) [实时地在用户面前](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1991) [添加这个图像视图 你可以停用这些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1993) [noImageConstraints 启用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1995) [ImageConstraints 并调用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1997) [视觉动画模块中的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=1998) [layoutIfNeeded](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2000) [它就会很好地出现在你的视图中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2002) [如果你试图通过停用全部的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2004) [约束然后将它们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2005) [再次添加](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2006) [委婉点说 情况会很有趣](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2009) [好的 现在我们已经](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2011) [调试了这个问题 我们正在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2013) [处理约束组](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2014) [而非把所有约束堆在一起](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2015) [让我们看一下 会是什么样子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2016) [提示一下 这是它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2018) [最开始的样子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2019) [我们向上滑动到顶部](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2021) [非常糟糕](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2024) [这是在我们调试之后](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2025) [看起来的样子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2026) [这就顺滑多了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2028) [谢谢](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2030) [[ 掌声 ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2032) [但是等等 还有惊喜](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2034) [我实际上是在 iOS 11 上录制的这个视频](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2035) [没有利用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2037) [没有利用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2037) [我们在 iOS 12 上的性能提升](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2040) [这只不过是一段](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2043) [高效运行的客户端代码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2046) [在 iOS 12 中它看起来也非常棒](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2047) [而且好的难以置信](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2049) [[ 笑声 ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2053) [[ 掌声 ] 是的 它非常棒](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2054) [那么 我们如何避免](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2060) [约束流失呢](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2061) [避免移除全部约束](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2063) [这样通常会让你](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2065) [进入一个尴尬境地 你需要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2066) [把一部分的约束重新添加](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2067) [而这会让你](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2069) [重新布局](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2070) [并不需要的帧](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2072) [或是重新传送不需要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2073) [被再次展示的视图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2074) [如果你有一系列的约束](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2076) [它们对于全部](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2078) [你的 App 中可能的布局都是共用的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2079) [一次性将它们添加 然后不要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2080) [再修改它们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2082) [这对于使用 Interface](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2083) [Builder 和你的 App 的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2084) [初始布局有好处](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2085) [改变那些需要被改变的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2086) [约束 但不要去改变](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2087) [那些不需要改变的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2088) [听起来有点像文字游戏 但是效果很不错](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2090) [现在你已经有了简便的办法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2093) [隐藏视图而非](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2094) [移除视图 可以解决你的需求](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2096) [好的 这就是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2099) [好的 这就是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2099) [Instruments 中的约束流失问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2100) [Instruments 中还有一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2101) [底部视图 叫做 UILabel 尺寸计算](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2102) [UILabel 尺寸计算追踪的是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2105) [标签计算其尺寸](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2107) [所需要的时间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2108) [我们来讨论一下固有](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2110) [内容尺寸](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2111) [让我走到这边来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2112) [好的 并不是所有的视图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2115) [都需要有固有内容尺寸](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2117) [一些视图需要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2120) [具有非视图内容的视图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2121) [会返回一个它们的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2124) [固有内容尺寸的大小](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2125) [尺寸是基于该非视图内容的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2126) [举两个例子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2128) [一个是 UIImageView 它利用其](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2130) [图像的尺寸来计算其](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2132) [固有内容尺寸](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2133) [另一个是 UILabel 它测量其文本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2136) [并依据此来返回其](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2138) [固有内容尺寸](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2139) [固有内容尺寸](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2141) [并没有什么神奇之处](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2143) [它的用处是通过 UIView 创建约束](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2145) [确定约束的尺寸](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2148) [仅此而已](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2149) [你可以在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2151) [约束中定义全部的尺寸](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2152) [并跳过这些内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2154) [有一些情况下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2156) [它需要被覆写](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2157) [这也是它存在的原因](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2158) [这也是它存在的原因](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2158) [这样的情况](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2160) [以及一些其他的例子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2161) [都在 UIView 子集中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2162) [但是大部分情况下它被](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2164) [覆写的原因是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2165) [人们认为这样会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2167) [更快或者更准确](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2167) [但事实上都不会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2170) [但是 有一种情况下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2172) [覆写它会提高你的性能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2174) [因为文本测量可能消耗较高](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2178) [在我们的这个 App 中 UILabel 尺寸计算](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2181) [并没有花费很久](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2184) [它的时间是很短的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2185) [因此 纠结这个问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2187) [并不会提升](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2188) [太多的性能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2189) [但如果你有一个文本密集型的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2191) [App 而你多次看到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2192) [在 UILabel 中发生](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2194) [文本测量 或者你](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2196) [在文本视图中有文本测量过程](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2197) [或者其他功能中有文本测量](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2199) [你或许能够通过这种方式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2200) [借助其他信息 提高性能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2202) [如果你知道](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2205) [该文本所需要的尺寸](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2206) [而无需完成文本测量](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2207) [你可以返回该尺寸](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2209) [和固有内容尺寸 或者是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2210) [在准备将](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2213) [视图显示在屏幕时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2215) [完全使用约束](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2216) [定义该尺寸](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2217) [无论其中的文本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2218) [尺寸如何](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2220) [举个例子 约束](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2220) [总是会让尺寸](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2222) [略大于你的文本量](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2223) [然后你就可以直接不返回](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2225) [任何固有内容尺寸](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2226) [中对于宽度和高度的度量](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2227) [这样做就是告诉](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2231) [上一层级 “嘿我已经知道了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2232) [我的尺寸 不需要再进行文本测量了”](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2233) [很明显 这只在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2236) [你不需要自己进行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2238) [测量时才适用 但是它可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2239) [帮助一些 App 提高性能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2241) [因此我希望你们了解](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2243) [这个小技巧](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2244) [我们不能只谈](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2246) [固有内容尺寸而不谈](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2247) [系统布局适应尺寸](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2249) [因为人们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2250) [往往混淆这两个概念](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2253) [尽管它们几乎是相反的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2255) [很可惜固有内容尺寸是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2257) [你向引擎传输](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2261) [需要添加的尺寸信息的方式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2262) [系统布局配合尺寸是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2265) [你将尺寸](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2267) [信息从引擎中提取出来的方式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2268) [事实上它们几乎是相反的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2270) [这用于一些混合布局](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2272) [出于有一些原因](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2274) [导致你需要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2276) [从一个使用 Auto Layout](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2277) [管理其子视图的视图中提取帧信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2278) [管理其子视图的视图中提取帧信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2278) [不是很常用 但是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2281) [确实可以这么使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2283) [我想要告诉你们这个方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2285) [如何运行 因为它可能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2287) [比你们认为的消耗更高一些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2289) [当你调用 systemLayoutSizeFittingSize 时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2291) [会创建一个引擎](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2293) [约束被加入这个该引擎](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2296) [计算布局](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2297) [然后返回顶部视图的帧尺寸](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2299) [之后此引擎被废弃](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2303) [所以每次你调用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2305) [这个方法都会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2306) [创建然后废弃一个引擎](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2307) [尽管对于小规模使用没问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2309) [如果你多次使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2311) [你可以看到它会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2313) [随着时间的流逝而堆积](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2314) [因此谨慎使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2315) [systemLayoutSizeFittingSize](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2317) [其中的一个做法是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2319) [有时候看到有些人会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2321) [将这一调用从](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2322) [自动调整选项或](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2324) [表格视图单元格转到内容视图中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2325) [当你这么做时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2327) [你事实上在覆写一些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2329) [我们刚才做出的优化](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2330) [让该视图滑动](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2331) [更快的设置](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2333) [并且还添加了多余的引擎](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2334) [因此如果你目前这么做了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2336) [并且你的滑动不顺滑](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2337) [你可以试着解决问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2338) [好了 现在我们到了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2341) [我最喜欢的话题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2342) [不可满足约束](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2343) [好的 那么什么是不可满足约束呢](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2346) [如果你还未遇到过这个问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2350) [这个问题发生的情况是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2351) [当你定义](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2353) [这个视图的宽度应该是 50](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2355) [同时也要是 200 的宽度](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2356) [这不可能满足](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2359) [事实上 量子手机不存在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2361) [你知道 我不能断言未来有没有](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2365) [但是引擎不得不](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2366) [计算得出结果](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2370) [即不存在可用布局](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2371) [于是破坏一个约束以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2373) [为你产生布局](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2375) [它破坏约束时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2378) [会发送一个详细的日志](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2380) [到你的调试器 也许你已经](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2382) [见到过了 并且显示](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2383) [不可满足约束](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2386) [这是我破坏的约束 这些是其他](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2387) [受到影响的约束 因此我](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2389) [不得不破坏它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2391) [有时候这样会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2393) [直接影响性能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2395) [同时也可能掩盖其他问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2396) [因此最好是调试解决此类情况](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2397) [Auto Layout 的秘密 第二部分](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2400) [提供了一些很好的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2401) [调试纠错信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2402) [你可以看看](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2404) [如果你在处理](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2405) [不可满足约束时遇到了问题的话](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2406) [好的 你们已经毕业了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2409) [恭喜你们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2411) [你们现在全部是 Auto Layout 专家了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2412) [你知道 我希望你们真正享受学习](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2414) [它运作的内在问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2417) [现在你们能够更好的了解](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2419) [如何在更新约束之前思考](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2421) [并且理解它们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2423) [所经历的过程 你们已经获得了一些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2424) [最新的关于尺寸](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2425) [优先级和不等式的信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2427) [你们的布局在 iOS 12 中会更快](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2429) [这非常棒](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2432) [我们明天会在实验室](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2433) [如果任何人有问题的话](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2434) [可以进行交流](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2435) [这些是相关会议信息的链接](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2437) [希望你们享受本周接下来的时间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2440) [[ 掌声 ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/220/?time=2441)