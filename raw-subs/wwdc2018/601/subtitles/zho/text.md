# Live Screen Broadcast with ReplayKit

## Summary
ReplayKit 2 provides built-in services for broadcasting your screen from iOS and tvOS to viewers online. See how broadcasts can be started right within Control Center or from standard UI included in your own apps and games. Hear about developing broadcast extensions for ReplayKit 2 and get best practices for handling account sign-in.

## Info
* Media
* WWDC 2018 - Session 601 - iOS, tvOS
* https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/

## Text
 [（REPLAYKIT直播功能）](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=17) [早上好 欢迎来到
ReplayKit直播功能演讲](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=26) [我是Alexander
很高兴能在这里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=32) [为大家讲述ReplayKit概念](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=36) [及今年ReplayKit新增特性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=39) [内容很多 现在开始吧](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=42) [ReplayKit框架可实时抓取
app的屏幕 影像](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=47) [以及声音内容 也可以录制视频](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=52) [方便用户编辑或分享](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=56) [ReplayKit也支持直播](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=61) [对于生成内容的app 比如游戏](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=65) [ReplayKit可以提供工具
实现录制音频](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=69) [和可视化内容
通过使用第三方直播软件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=73) [对于播放app](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=78) [ReplayKit可以接收
从其他app](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=80) [或整个iOS系统中抓取的内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=83) [然后编码并流传输至服务器
无需更换设备](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=87) [ReplayKit传输的内容
都是高质量且低延迟](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=96) [性能开销低 更好用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=101) [同时它可以保护用户隐私
只有用户同意后](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=104) [才能录制或开启直播](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=109) [并且显著标明截取内容的时间点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=112) [今天我的演讲主题是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=122) [ReplayKit的直播功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=125) [简单概述之后 我会讲app内播放](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=127) [和iOS系统播放
之后我会讲到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=131) [一个新的API
叫做系统播放选择器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=135) [这个API可以直接](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=140) [从直播app中开启播放](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=144) [随后我们将讨论](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=148) [如何实现播放扩展](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=150) [以及这个新的API
能发挥哪些作用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=153) [我们还会讲述](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=159) [如何保护app的内容不被截取](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=160) [首先简述下直播的概念](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=168) [我说过ReplayKit
可以将app的屏幕](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=174) [视频和音频内容
传输到第三方播放平台](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=178) [视频和音频内容
传输到第三方播放平台](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=178) [可直接从iOS或tvOS设备操作
iOS上还能够使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=183) [麦克风或相机
提供音频或视频评述](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=190) [所有内容都绝对安全](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=195) [只能在你所使用的服务器上获取](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=197) [无论是录制游戏视频到
Mobcrush或YouTube](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=203) [在WebEx视频通话中分享屏幕](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=206) [用TeamViewer
获取客户支持服务](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=209) [还是在Facebook上
上传绘图app](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=212) [都需要使用ReplayKit技术](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=216) [（REPLAYKIT对比
REPLAYKIT 2）](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=220) [以前ReplayKit的直播](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=222) [是在app中操作 用户通过app](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=225) [开始或停止直播](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=228) [app直接对话
ReplayKit API](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=230) [ReplayKit本身包含
直播扩展](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=234) [可提供来自app的影像或音频内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=239) [可提供来自app的影像或音频内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=239) [扩展会将媒体编码
并流传输到服务器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=244) [这就是app内播放](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=248) [ReplayKit 2的新功能是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=253) [将系统作为一个整体实现直播](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=257) [工作原理是用户启动直播](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=262) [并在控制中心里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=266) [开始或停止播放](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=268) [这会开启系统级
ReplayKit 2直播程序](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=273) [音频视频样本同样是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=278) [通过扩展上传至服务器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=280) [这就是两者在概念上的区分](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=283) [那么我们先从app内播放讲起](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=288) [app内播放中 你的app](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=293) [或游戏会提供](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=295) [玩游戏时直接录制的内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=298) [玩游戏时直接录制的内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=298) [游戏通过调用ReplayKit
API开始或停止直播](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=303) [同样它可以作为播放视图控制器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=310) [让用户自主选择平台](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=313) [与此同时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=318) [播放app提供的播放扩展](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=321) [让ReplayKit代表游戏完成](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=325) [用户注册](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=329) [上传直播内容至服务器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=331) [这是我们原先使用
ReplayKit直播的方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=337) [这个我们之前讲过](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=341) [如果你的app需要精细地控制](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=343) [直播的开始和结束
欲了解更多信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=346) [可以观看
“ReplayKit直播”演讲](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=350) [是几年前的视频](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=355) [但是今天我们要讲的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=359) [但是今天我们要讲的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=359) [是iOS系统播放](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=361) [如果要播放所有屏幕上的活动](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=364) [和所有音频](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=368) [我们不再从app中开启播放](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=370) [通过暂停app开始或停止播放](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=372) [例如 本场演讲是在控制中心内
开始或停止](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=379) [这是系统级活动且持续运行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=383) [不会因为用户从主屏幕切换到app](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=386) [或在不同app之间切换而终止](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=389) [所有这些都在iOS 11
及更高版本中实现](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=392) [这就是我们去年
引入的ReplayKit 2](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=395) [这是个游戏 假设你正在玩](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=401) [你想开始录制并播放](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=403) [那么下拉控制中心](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=409) [点击这个录屏按键](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=411) [就看到选择器
可以选择录制游戏视频](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=415) [就看到选择器
可以选择录制游戏视频](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=415) [也可以选择一个播放平台](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=420) [将内容传输至该平台](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=425) [完成后 回到游戏](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=428) [现在游戏跟平台就连在一起了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=432) [播放扩展接收录屏文件样本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=434) [将视频流上传至后台](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=438) [通过网页浏览器中的播放器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=441) [或其他流媒体渠道](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=444) [就可以随时随地
在自己的设备上观看直播](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=449) [这就是如何开启iOS系统播放](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=456) [那么这种播放的有趣之处](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=460) [就在于我说过的不间断播放](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=463) [不受app切换干扰](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=467) [我这是在主屏幕上进行播放](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=470) [那么我主屏幕上的活动都被播放出来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=473) [如果这时打开另一个app
这个app也进入直播](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=477) [如果这时打开另一个app
这个app也进入直播](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=477) [这才是核心所在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=483) [这种播放本身就是系统级活动](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=485) [你可以回到控制中心停止播放](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=488) [或者点击上方的状态栏](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=491) [打开控制中心停止播放](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=494) [另外如果我切换横屏](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=499) [它也可以支持](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=503) [横屏竖屏 可以随意切换](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=507) [就像app间切换一样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=511) [iOS系统播放是我们去年发布的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=518) [之后收到了许多很好的反馈和改进](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=522) [现在我们的直播API
用于多种app](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=527) [比如通讯、媒体和房屋](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=530) [资讯台、教育以及社交](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=536) [同时我们也收到许多反馈](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=541) [比如在控制中心找不到播放界面](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=544) [为了方便用户直接在app中编辑](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=550) [今年我们的目标是帮助你](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=555) [将iOS系统播放融入app](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=558) [因此就要隆重介绍系统播放选择器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=562) [回到刚才的图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=568) [我们要添加的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=573) [是将这两种线性流程结合在一起](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=575) [这种结合让app也能够](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=582) [启动iOS系统播放](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=586) [因此app可以跟控制中心一样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=590) [开始并持续播放](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=595) [不会因切换app](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=599) [不会因切换app](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=599) [或退回主屏幕而停止](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=602) [从app中开始的直播](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=605) [可以在控制中心停止 反之亦然](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=608) [从控制中心的直播 回到app后](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=614) [可以一键停止](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=617) [因此系统播放选择器使得用户能够](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=622) [直接在app中启动iOS系统播放](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=627) [在我们提供的界面上一键完成](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=631) [这是将在iOS 12实现的新功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=635) [下面来举个例子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=641) [这是样本app Fox 2
app上方添加了这个按键](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=644) [当我点击这个播放选择器按键](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=651) [你看到的界面与之前](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=654) [在控制中心看到的一样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=657) [在控制中心看到的一样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=657) [然后选择播放平台开始直播](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=662) [现在回到app](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=668) [直播就已经在那个平台开始了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=669) [全世界人民都可以观看我的直播](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=673) [怎么做到的？](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=680) [这是个新类名
RPSystemBroadcastPickerView](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=683) [它只是用户界面的子类
可以添加到app里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=689) [在界面构建器设为一个类名
或自定义类界面](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=694) [或通过编程实现](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=700) [你只需要创建一个实例
RPSystemBroadcastPickerView](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=703) [添加到界面层级](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=708) [这是播放选择器最简单的使用方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=713) [我知道在座各位都是直播平台开发者](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=719) [我知道在座各位都是直播平台开发者](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=719) [最后通过这个新的API](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=725) [用户可以直接从app中开始直播](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=728) [再也不需要提供全套的教程](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=732) [比如如何启用录屏、如何设置](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=735) [如何找到自己的
或控制中心列出的平台](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=738) [但是你可能会希望选择器只显示](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=741) [你平台的播放扩展](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=746) [ReplayKit提供的API
就可如你所愿](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=751) [它只是界面的一个属性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=758) [你要做的只是通过程序包标识](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=761) [标记播放扩展](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=766) [然后分配给
preferredExtension界面属性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=768) [这是代码样本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=776) [属性设置](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=780) [应当在界面修正之后](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=783) [与代码样本唯一的区别是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=784) [你需要替换字符串](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=787) [com.your-app.
broadcast.extension](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=790) [这是扩展的捆绑ID](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=793) [这张图表中 我想要强调](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=797) [在app中创建的选择器界面](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=803) [这个界面只是快捷键
可以跳转到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=806) [选择器的系统界面](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=809) [控制中心也可打开](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=812) [选择器本身属于系统](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=816) [app不占有直播的任何部分](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=820) [因此也不可通过编程
开始或停止系统播放](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=825) [（开发REPLAYKIT 2
播放扩展）](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=833) [那么你要做的是
将iOS系统播放加入app](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=834) [新的API十分简单](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=839) [新的API十分简单](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=839) [在此次演讲结束之前
你就能完成app](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=842) [接下来 我们将过程演示一遍](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=848) [给播放扩展开发者看](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=850) [然后讨论如何使用播放扩展](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=853) [以及当app同时提供扩展
和选择器的时候](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=857) [有哪些用处](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=862) [再回到刚才那张图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=865) [我们现在来看播放扩展页面](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=867) [我想向你们展示系统播放的路径](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=870) [（播放APP和扩展）](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=876) [首先 先讲播放app](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=879) [然后是播放扩展以及在直播中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=883) [它们各自的工作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=888) [先安装播放扩展](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=893) [与包含扩展的app一起安装](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=895) [比如你安装了
Facebook](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=898) [你也要安装
Facebook播放扩展](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=900) [播放扩展和app](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=904) [是独立的二进制文件
有各自的运行程序](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=909) [这些程序由用户直接调用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=913) [彼此独立](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=919) [通常你们需要使用app
允许用户登录](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=921) [或注册你们的服务](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=925) [现在app安装了播放选择器API](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=928) [你就可以让用户先输入一些信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=934) [再将直播发到Facebook](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=938) [播放扩展](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=944) [以上就是所有实际的工作
前提是直播所需的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=947) [所有程序都已具备](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=950) [扩展会接收
ReplayKit编辑过的样本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=955) [扩展会接收
ReplayKit编辑过的样本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=955) [app原生音频](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=961) [录屏视频或麦克风录音](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=965) [然后编码并上传至平台](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=968) [可根据喜好使用任何技术](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=972) [（播放上传扩展）](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=974) [（播放扩展模板）](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=975) [为了方便你开发新的播放平台](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=977) [我们提供Xcode模板](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=981) [只要将扩展添加至使用该模板的项目](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=984) [就一切就绪了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=988) [现在看看如何编码吧](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=990) [在使用Xcode模板
在项目中创建扩展时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=995) [你会看到一个
SampleHandler类名](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=999) [在这里添加代码用来控制](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1003) [播放中的各种活动](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1006) [同样你需要安装](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1009) [这个功能以处理导入的音视频样本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1011) [（播放周期）](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1015) [这就是播放周期图示](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1018) [这就是播放周期图示](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1018) [各个状态为设置、启动、开始](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1023) [处理和停止](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1028) [（登录和播放设置）](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1031) [左边的绿色方块代表的状态是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1033) [你的播放扩展还未运行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1037) [此时你的app可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1040) [获取用户的登录信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1043) [然后使用共享的密钥串
将登录信息传输至扩展](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1046) [或者你还是可以让用户输入](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1051) [Facebook上的信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1055) [然后传至扩展 无论以何种方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1058) [一旦用户开启直播](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1063) [无论在控制中心或app里面](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1066) [只要安装了播放选择器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1069) [ReplayKit会启动扩展程序](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1072) [创建SampleHandler
类名的实例](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1075) [这时候](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1079) [这时候](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1079) [你可以覆盖SampleHandler
默认的初始设定](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1082) [编写适用于直播的程式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1086) [不要直接关联媒体样本的处理](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1088) [举例来说
你可以获取登录信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1092) [通过这个密钥串
并在平台上创建直播环节](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1096) [（直播开始）](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1102) [一旦程序启动](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1103) [且SampleHandler
实例已经存在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1105) [扩展得知ReplayKit将提供](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1110) [音视频样本
通过broadcastStarted函数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1114) [在此函数中 可以创建媒体引擎](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1120) [或其他活动以接收样本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1125) [并实时编码 然后上传至服务器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1130) [（媒体样本处理）](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1134) [直播正在运行的时候](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1136) [ReplayKit会提供
原始音视频样本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1140) [扩展要做的是编码并上传至直播平台](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1144) [根据偏好 可使用任何技术](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1148) [ReplayKit为扩展提供
三种样本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1152) [（直播上传扩展）](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1155) [录屏视频样本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1158) [app音频样本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1161) [和麦克风音频样本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1164) [扩展将所有这些编码
并上传至直播平台](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1168) [所有扩展处理的内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1175) [是由一个函数控制](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1177) [叫做processSampleBuffer](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1180) [该函数接收单个
CMSampleBuffer](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1182) [以及该缓冲类型](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1187) [你要做的就是对媒体样本
进行编码并上传](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1189) [这段代码样本展示了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1193) [如何使用Video Toolbox
对视频编码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1195) [我们建议使用
Video Toolbox](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1199) [我们建议使用
Video Toolbox](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1199) [因为它提供的硬件可以加速编码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1202) [这对我们来说十分重要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1206) [因为扩展的内存限制](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1210) [低于app的内存](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1213) [（处理app信息）](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1216) [在你对视频编码
并流传输至直播平台时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1219) [全世界的观众都可以观看你的直播](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1225) [但前提是他们要能够找到你的直播](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1231) [假设有人喜欢玩
以及看别人玩愤怒的小鸟](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1234) [那么你的网页或app中
就要单独设置区域](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1239) [让他们能找到
有关这个游戏的所有直播](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1242) [为了实现这一目的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1247) [你需要在视频流中添加](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1250) [有关这个游戏直播的信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1252) [为此ReplayKit提供一个
API函数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1258) [为此ReplayKit提供一个
API函数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1258) [叫做broadcastAnnotated
WithapplicationInfo](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1261) [一旦玩家开始游戏](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1264) [愤怒的小鸟发送样本
ReplayKit通知扩展](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1268) [游戏开始并提供词库](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1273) [详细说明启动的app信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1276) [比如 你可以使用
ReplayKit定义的密钥](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1280) [RPApplicationInfo
BundleIdentifierKey](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1285) [获取游戏的捆绑包ID](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1289) [作为元数据传输给流](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1291) [（处理播放完成）](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1295) [用户停止直播时 无论以何种方式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1300) [ReplayKit使用的函数为
broadcastFinished](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1304) [来告诉扩展直播已经结束](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1307) [不会再有新的样本
传输至SampleHandler](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1310) [这个函数中 你需要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1315) [结束上传缓存视频](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1318) [结束上传缓存视频](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1318) [释放媒体引擎或其他需要释放的内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1320) [（处理登录）](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1327) [这个就是直播的一般周期](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1330) [我这里还要再补充一点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1335) [如上讨论](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1340) [任何设置直播所需的活动](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1343) [都在app中进行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1346) [你可以获取用户登录app的信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1349) [或app中直播的名称](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1352) [我们也为此标记一个状态
就是左边绿色的方块](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1358) [但是有些情况下 直播开始了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1362) [扩展却缺少内容 无法进行播放](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1368) [比如 登录程序失败](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1371) [或某些东西缺失
我现在告诉大家如何处理](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1375) [或某些东西缺失
我现在告诉大家如何处理](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1375) [ReplayKit提供的API
让扩展可以通知用户](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1382) [直播无法开启](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1387) [并提供某种解决方案](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1389) [工作原理是扩展调用API函数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1394) [ReplayKit终止程序
并向用户报错](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1399) [扩展提供运行失败的原因](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1407) [这个例子中
报错信息来自Mobcrush](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1411) [原因是用户未登录](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1414) [接下来用户点击底部回到app](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1419) [ReplayKit启动app](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1424) [你要做的是以某种方式处理这个情况](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1426) [比如显示用户界面
让用户登录或注册](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1430) [之后直播就可以正常运行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1433) [我们之前看过这个代码片段
broadcastStarted](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1437) [我们之前看过这个代码片段
broadcastStarted](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1437) [这里我要展示的是你如何处理](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1441) [当用户未登录时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1444) [这里有个函数
finishBroadcastWithError](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1446) [你要做的是提供用户信息词库](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1450) [说明失败原因 然后
ReplayKit将用这个字符串](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1455) [并在程序终止后 显示该字符串](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1460) [（开发直播扩展）](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1466) [好了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1469) [现在看看如何开发直播扩展](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1472) [如你所见 过程简单直白](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1476) [app控制直播设置](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1481) [然后将信息递给扩展](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1484) [直播开始后](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1490) [收取并编码媒体样本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1492) [同时获取屏幕上的app信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1497) [同时获取屏幕上的app信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1497) [观众就可以找到你的直播了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1500) [今天我想讲最后一点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1505) [就是保护app内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1510) [你的app可能会显示一些
你并不想被用户](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1515) [录屏或直播的内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1520) [这同时适用于音频和可视化内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1524) [有个API能告诉你内容是否被抓取](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1530) [这个API由UIKit框架提供](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1534) [我讲的就是UIScreen的属性
称为Captured](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1538) [你可以通过注册来接收通知](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1543) [在该属性值被改变的时候](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1546) [停止音频回放或隐藏视觉内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1549) [在录制开始的时候](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1554) [还有个特殊情况需要特别注意](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1557) [还有个特殊情况需要特别注意](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1557) [就是隔空播放投屏](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1560) [我来展示你们可以如何处理](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1563) [通过这个代码样本通知处理程序](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1566) [基本来说 在投屏的情况下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1570) [屏幕数量一般多于一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1573) [Screens这个数组
包含的值大于1](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1575) [那么即使isCaptured
返回值为yes](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1580) [在投屏的时候](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1584) [这一步检查也可以保证回放继续](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1586) [以上就是屏幕直播及其运行原理](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1594) [总结来说](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1598) [ReplayKit提供高级API](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1600) [让你可以直播一个app的内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1602) [或屏幕上的所有活动内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1606) [iOS 12中
我们提供一个API](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1610) [或一种启动系统直播的方法
可直接从app中操作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1613) [实际上需要你去编码的是直播扩展](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1620) [它承担了视频编码的全部实际工作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1624) [同样我们还讨论了
如何保护app的内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1629) [这个演讲的链接可以提供更多信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1637) [今天晚些时候还有个
ReplayKit实验室](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1641) [下午3点在技术实验室5](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1645) [如果有任何问题和意见
请来找我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1647) [我们希望听到你的反馈](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1650) [谢谢大家今天来到这里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1653) [我们很开心能告诉你这个新方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1656) [在iOS中实现直播](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1660) [也很期待看到
使用这个功能的测试app](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1662) [所以大家尽管尝试](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1666) [使用Xcode模板
创建第一个直播扩展](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1668) [或打开现有的app
添加播放选择器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1672) [让直播从iOS到你的平台
都在今天实现](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1678) [让直播从iOS到你的平台
都在今天实现](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1678) [谢谢](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/601/?time=1682)