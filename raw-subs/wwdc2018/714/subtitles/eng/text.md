# Optimizing Your App for Todayâ€™s Internet

## Summary
Learn what Apple has been doing to help your app get the most out of the network with the least effort. Let Apple's networking APIs do the heavy lifting for you. Learn best practices for getting top networking performance from your app using the URLSession APIs.

## Info
* Frameworks
* WWDC 2018 - Session 714 - iOS, macOS, tvOS, watchOS
* https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/

## Text
 [[ Music ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=6) [[ Applause ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=19) [&gt;&gt; Good morning, ladies and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=26) [gentlemen.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=27) [How many of you are here for the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=28) [first time at WWDC?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=29) [That's fantastic.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=33) [It's great to see so many new](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=34) [faces every year.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=36) [My name is Stuart Cheshire.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=38) [And we're going to be talking](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=39) [about networking.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=40) [I'm going to start by covering](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=42) [some topics that affect the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=44) [performance of your app.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=45) [There's hardly an app that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=47) [exists today that doesn't make](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=48) [use of networking.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=50) [And getting the best performance](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=52) [out of the network is really](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=54) [important.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=55) [We're going to cover some](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=56) [technologies here that help you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=57) [get the best performance.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=58) [We're also going to cover some](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=60) [tips and tricks and guidance](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=63) [about how to make the best use](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=65) [of Apple's APIs, a little bit of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=67) [news about new technologies on](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=70) [the horizon, and then my](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=72) [colleague Jiten will go into](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=74) [detail on URLSession.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=76) [Let's start off with a state of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=81) [the Internet update.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=83) [Earlier this year, we hit a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=85) [total of 4 billion people using](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=87) [the Internet.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=90) [That's more than half of the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=91) [world's population.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=92) [And we're used to Internet usage](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=94) [doubling and doubling.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=95) [Clearly when we passed halfway,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=97) [the number of people on the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=99) [Internet can't keep doubling, so](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=100) [that growth is slowing down but](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=103) [that doesn't mean Internet](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=105) [growth is slowing down.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=106) [There's a lot of growth in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=108) [machine-to-machine](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=109) [communications, Internet of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=110) [Things, Smart Homes.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=111) [There's still a lot of growth in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=114) [places like India and China.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=115) [And there is a lot of people who](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=118) [have never owned a desktop](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=119) [have never owned a desktop](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=119) [computer who may never own a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=121) [desktop computer.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=123) [Their primary computing and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=125) [communication device is their](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=126) [Smartphone.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=128) [And a lot of those Smartphones](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=129) [are still using 2G networks.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=132) [I'm sure most of us in this room](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=135) [are fortunate enough to live in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=137) [places and work in places where](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=140) [we build our apps where we have](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=141) [fast LTE networks.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=143) [And that can be a handicap](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=145) [because if you build your app so](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=147) [it works well in LTE, it may](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=151) [perform very, very badly on 2G.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=153) [One of your competitors,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=156) [somewhere else in the world, who](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=157) [builds an app that works great](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=159) [on 2G is going to be fantastic](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=160) [on LTE.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=162) [So we have a tool to help](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=163) [everybody mimic some of the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=166) [properties of these slower](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=168) [networks and that's Network Link](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=170) [Conditioner.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=172) [You should build your app](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=174) [running Network Link Conditioner](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=175) [right from the start.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=177) [Don't think you can add in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=178) [performance at the end because](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=179) [performance at the end because](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=179) [it's too late.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=182) [Always, always, always run and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=183) [test your app using Network Link](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=185) [Conditioner and that way if you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=186) [make a programming mistake that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=188) [has horrible performance](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=190) [implications, you see it right](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=191) [away and you can fix it right](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=192) [away.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=193) [Use tools like Wireshark and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=195) [tcptrace to understand the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=196) [network performance of your app.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=199) [It's a lot like using](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=200) [Instruments to look at memory](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=201) [and CPU usage.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=203) [If you haven't seen tcptrace, it](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=205) [is a wonderful tool that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=206) [produces graphs like this that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=208) [let you see at a glance what's](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=209) [going on, on the network.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=211) [If you want to learn more about](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=213) [that, check out the video from](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=214) [three years ago.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=215) [IPv6 usage continues to grow.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=219) [Why is that important?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=222) [It's important because IPv6 is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=223) [shown to have better performance](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=226) [than IPv4.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=227) [And if you care about](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=228) [performance, you want to make](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=230) [sure not just your app but the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=231) [service your app is talking to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=233) [support Native IPv6.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=235) [Some places in the world are](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=237) [doing better in this respect](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=239) [doing better in this respect](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=239) [than others.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=240) [In the US, we're now up to 87%](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=241) [of mobile carriers offering](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=244) [IPv6.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=245) [Other places like India are](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=246) [doing pretty well too.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=248) [And let's focus a bit more on](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=250) [India.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=251) [Here is some data that the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=252) [networking team at Apple](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=254) [gathered earlier this year about](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=255) [net TCP connection setup time](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=258) [and ongoing round-trip delay on](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=261) [cellular networks in India.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=265) [The blue line is IPv6.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=267) [And if we, for example, look at](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=269) [the 75th percentile, we can say](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=271) [75% of TCP connections over v6](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=274) [are set up in less than 150](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=279) [milliseconds.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=280) [The comparable number for IPv4](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=282) [is worse than 325.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=284) [It's more than twice as slow.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=287) [So if you want fast, responsive](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=289) [applications for your users, get](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=290) [on IPv6 if you're not already.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=293) [Another technology that improves](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=296) [performance by reducing packet](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=298) [performance by reducing packet](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=298) [loss and retransmission is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=300) [Explicit Congestion](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=302) [Notification.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=303) [We've had this enabled by](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=304) [default in macOS and iOS for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=306) [some years now so you don't need](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=308) [to do anything on your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=309) [application to take advantage of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=310) [this.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=312) [Do make sure your service](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=313) [supports ECN.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=315) [In a survey we did of the Alexa](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=317) [top million websites, we found](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=320) [last month we're now up to 77%](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=322) [of the Alexa top million](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=324) [services supporting ECN, which](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=325) [is a big improvement compared to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=327) [a few years ago.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=328) [Another technology that helps](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=332) [improve performance and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=334) [resilience of your connections](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=336) [is Multipath TCP.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=337) [Quite often, the user may make a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=339) [connection in their office on](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=341) [Wi-Fi and then they walk outside](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=343) [and they lose the Wi-Fi signal.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=346) [Now with traditional TCP, the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=347) [connection is broken.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=349) [You have to reconnect.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=350) [You have to start again.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=351) [Multipath TCP makes its packet](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=353) [routing decisions on a per](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=355) [packet basis not per connection,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=356) [so it can switch that connection](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=359) [so it can switch that connection](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=359) [live to a different interface.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=361) [We talked last year about how to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=365) [enable this in your application.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=368) [And, of course, check with your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=370) [server operators to make sure](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=371) [your servers are supporting](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=373) [Multipath too.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=374) [We recently did a survey of the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=376) [mobile carriers that Apple works](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=378) [with around the world and right](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=380) [now 78% of their networks work](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=382) [with Multipath TCP.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=386) [Only 22% of carriers are still](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=388) [blocking Multipath connections.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=390) [TCP Fast Open is a technology](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=392) [that lets you avoid the normal](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=397) [round-trip delay of the TCP](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=399) [connection set up.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=401) [TCP Fast Open lets you put your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=402) [initial data in with the TCP](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=406) [connection set up packets.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=408) [You can check out more details](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=412) [of that from our video from](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=413) [three years ago.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=415) [And check with your server](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=416) [operators to make sure that your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=417) [servers support TCP Fast Open.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=419) [servers support TCP Fast Open.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=419) [Now moving on to some new news.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=423) [There is a technology that many](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=426) [of you will have heard of called](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=429) [Quick.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=430) [Quick is a new transport](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=431) [protocol, the first serious](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=433) [candidate in 30 years for a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=435) [successor to replace TCP.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=437) [It started off as an experiment](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=439) [by some engineers at Google.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=441) [That experiment proved](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=443) [successful.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=444) [It has now been adopted as an](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=445) [IETF work in group item for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=447) [standardization.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=449) [Apple engineers are](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=451) [participating in that.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=453) [In fact, we have engineers right](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=454) [now at the Quick meeting taking](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=455) [place in Sweden.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=457) [This is not yet ready for prime](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=459) [time.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=461) [The standard is not finished,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=462) [but Apple is working on it.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=464) [As soon as it is ready, you can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=465) [expect to see Apple API](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=467) [supporting that.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=468) [Continuing in the theme of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=471) [performance, we observed some](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=472) [behavior that's very common.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=475) [Lots and lots of websites and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=477) [Internet services use pretty](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=479) [Internet services use pretty](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=479) [short lifetimes on their DNS](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=481) [records.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=483) [And they do this because if a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=484) [data center goes down, they want](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=486) [to be able to update the DNS and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=488) [very rapidly direct traffic to a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=490) [different data center.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=492) [The problem with this approach](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=495) [is you're paying a performance](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=497) [cost for something that almost](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=499) [never happens.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=500) [Data centers very rarely go](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=501) [down.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=503) [And what this means is every](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=505) [time a DNS address record is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=507) [expired, your client has to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=509) [spend another round-trip delay](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=511) [waiting for the response from](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=513) [the DNS server, which is the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=515) [same as what it knew already](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=517) [last time.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=518) [So thinking about this, we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=519) [realized and optimization we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=522) [could do.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=524) [If you pass the flag to opt into](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=525) [this new behavior, then when you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=527) [do a DNS query, if we have a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=530) [stale, expired answer in the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=532) [cache, we will give that to you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=534) [immediately while in parallel,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=537) [at the same time, doing the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=539) [at the same time, doing the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=539) [normal DNS query we would have](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=540) [done anyway.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=542) [If the answer comes back the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=544) [same, as we predict it will](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=545) [almost always, everything is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=547) [fine, you just saved a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=549) [round-trip time and got your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=551) [connection started faster.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=552) [If the answer comes back as a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=554) [different address, we will then](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=555) [give another asynchronous](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=558) [notification to your client that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=559) [there's a new address available](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=561) [which it should also try.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=562) [And to make use of this, you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=564) [have to use it in conjunction](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=566) [with Happy Eyeballs algorithm.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=567) [That means your racing multiple](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=569) [connections in parallel.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=570) [You're trying IPv4, IPv6,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=572) [multiple addresses, multiple](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=574) [interfaces.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=576) [If that sounds like a lot of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=578) [work and it's hard to get right,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=579) [you're absolutely correct.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=581) [It is a lot of work.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=582) [Stay after the break and we will](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=584) [tell you about some new APIs](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=586) [that let you take advantage of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=588) [this without doing all the hard](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=590) [work yourself.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=591) [Now moving on to some guidance.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=594) [We have seen a common pattern](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=596) [that many developers use](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=599) [that many developers use](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=599) [SCNetworkReachability as a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=602) [preflight check.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=604) [They want to predict the future.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=606) [They want to know whether the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=607) [next network operation they do](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=609) [will succeed or fail.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=610) [And, unfortunately, predicting](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=612) [the future is always a hard](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=614) [thing to do.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=616) [You may have connectivity now](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=617) [but two seconds from now the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=619) [user has walked out of the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=621) [building and you've lost the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=622) [Wi-Fi signal.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=623) [So there is no way to guarantee](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=624) [whether a future operation will](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=627) [succeed.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=629) [And we see this pattern where](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=630) [they check.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=632) [The preflight says yes.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=633) [They try it.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=634) [They fail.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=635) [They go back.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=636) [They check again.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=636) [This also is a lot of work, a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=638) [lot of [inaudible], a lot of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=641) [difficult things to get right](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=642) [including networks with proxies.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=644) [We can handle that for you.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=647) [The better way to do this is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=650) [just make a connection using the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=653) [waitsForConnectivity option.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=656) [You can learn more about that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=658) [You can learn more about that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=658) [watching last year's video.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=660) [What this means is if you want a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=661) [connection, you tell the system](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=663) [I want a connection.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=665) [Now if you can, later if not.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=666) [If the device is in airplane](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=669) [mode, then when it's out of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=670) [airplane mode your connection](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=672) [will succeed.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=673) [That is much easier than](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=674) [building the retry loop](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=676) [yourself.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=677) [There is one case we've seen](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=678) [with developers which does make](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=680) [sense which is if you're going](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=682) [to have the user answer a lot of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=684) [information in a form, you may](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=686) [not want to waste the user's](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=687) [time if you have good reason to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=689) [believe that may later fail.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=691) [If that is the use case you care](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=694) [about, stay after the break](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=695) [because we have a new way to do](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=697) [that that's much better.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=699) [Security remains important, as](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=703) [always.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=705) [After ten years of using TLS](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=707) [1.2, the Internet is now ready](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=709) [to move to its successor, TLS](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=712) [1.3.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=713) [It has a number of improved](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=715) [security features.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=716) [It has reduced connection setup](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=718) [It has reduced connection setup](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=718) [time, similar to TCP Fast Open.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=720) [That standard is now final.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=723) [The final draft was approved for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=725) [publication by the Internet](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=727) [Engineering Steering Group](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=729) [earlier this year.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=730) [We are waiting for the actual](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=732) [published document to come out](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=734) [of the RFC Editor.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=736) [And when that does, we'll be](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=737) [turning on TLS 1.3 by default.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=739) [Right now in your seed, it's not](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=743) [turned on by default.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=745) [You can use the instructions](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=747) [here on iOS or macOS to enable](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=748) [TLS 13 in your applications.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=752) [And we encourage you to do this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=756) [right away because later this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=757) [year when TLS 1.3 is turned on](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=759) [by default, you don't risk](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=761) [problems with your service not](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=763) [being compatible.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=765) [So test them right now to make](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=766) [sure everything will go smoothly](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=768) [when the switchover happens](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=770) [later this year.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=771) [Another element of security](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=776) [that's new is certificate](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=777) [transparency.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=778) [You've probably heard cases](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=779) [You've probably heard cases](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=779) [where certificate authorities,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=782) [either through malice or](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=786) [incompetence, issue rogue](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=787) [certificates to entities that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=788) [they should not.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=790) [The solution to this is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=792) [something called certificate](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=794) [transparency logs.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=795) [Every legitimate certificate](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=797) [authority now issues a public](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=799) [statement of every certificate](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=802) [it issues.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=804) [And those are recorded in public](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=805) [logs for anybody to inspect.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=807) [And this means that if a rogue](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=810) [certificate authority issues a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=812) [bogus certificate, if it](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=814) [publishes it, they'll](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=816) [immediately get caught.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=817) [And if they don't publish it,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=820) [they'll be caught by the client.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=822) [This is the setup you're](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=824) [probably familiar with.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=826) [The new entity here is the log.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=828) [When a certificate authority](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=831) [issues a certificate to a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=832) [server, it also records that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=834) [with the log and the log gives](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=837) [the server a signed affidavit](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=839) [the server a signed affidavit](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=839) [that its certificate has been](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=842) [publicly recorded.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=843) [And then when the client](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=844) [connects, the server can give](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=846) [all that information to the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=848) [client and the client can verify](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=849) [that not only is this a signed](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=851) [certificate, it is a publicly](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=852) [logged signed certificate.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=854) [Now suppose we have a rogue](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=856) [certificate authority that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=858) [doesn't publicly expose the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=860) [rogue certificates it's issuing.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=862) [The client will reject that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=864) [because it doesn't have the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=866) [affidavit to attest to it being](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=867) [recorded in a public log.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=870) [Starting later this year, we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=873) [will be enforcing this.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=874) [All newly issued TLS](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=877) [certificates must include the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=879) [verification that they are](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=881) [publicly logged.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=883) [And if they're not, then the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=884) [client will reject it.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=886) [Your apps don't need to make any](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=887) [changes, but if you have](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=889) [tailored certificates for your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=891) [servers, make sure that your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=893) [certificate authority is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=894) [recording them in the public](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=896) [certificate transparency logs.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=898) [Now we have a bit of news for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=900) [hardware developers.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=904) [The Bonjour Conformance Test is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=906) [a tool that lets you verify that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=908) [your hardware devices implement](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=910) [Bonjour correctly.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=912) [You need to run this test if you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=914) [want to use the Bonjour](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=915) [trademark name and logo on your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=917) [packaging.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=918) [You need to run this test if you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=920) [want to bundle the Bonjour for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=921) [Windows installer with a Windows](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=923) [application.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=926) [And if you want to use the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=927) [AirPrint, AirPlay, CarPlay,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=928) [HomeKit logos on your packaging,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=930) [passing the Bonjour Conformance](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=933) [Test is a part of the logo](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=934) [licensing process because](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=936) [reliable Bonjour is an essential](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=937) [part of those products.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=939) [But more importantly, the value](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=941) [of running the Bonjour](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=944) [Conformance Test is it helps you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=944) [improve the quality of your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=946) [products and that makes them](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=948) [more reliable which makes your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=950) [customers happy which makes your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=951) [customers not return the product](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=953) [to the store because they can't](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=955) [make it work.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=957) [And that's what your customers](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=958) [want.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=959) [want.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=959) [That's what you want.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=960) [And that's what we want.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=961) [We want happy customers having a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=962) [wonderful time with products](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=964) [that work reliably.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=965) [Now I want to cover API choices.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=966) [Thirty years ago we had BSD](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=972) [Sockets.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=975) [And it was a great API 30 years](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=976) [ago.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=978) [But 30 years ago we didn't have](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=979) [mobile computers in our pockets.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=982) [We didn't have wireless](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=984) [networking.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=985) [We didn't have IPv6.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=986) [We didn't have many computers](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=989) [with more than one network](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=991) [interface.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=992) [If you had an Ethernet port on](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=992) [your computer, that was a fancy](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=994) [computer.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=996) [Now 4 billion people around the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=997) [world have a multi-homed IPv6](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1000) [wireless battery-powered](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1003) [computing device that does power](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1004) [management and goes to sleep to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1006) [save energy.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1007) [The world has become a lot more](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1008) [complicated.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1009) [Many of you may be using](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1012) [third-party libraries which are](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1013) [built on that Sockets](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1015) [foundation.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1016) [Many more of you may be using](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1017) [URLSession.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1019) [URLSession.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1019) [And you may have assumed that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1021) [URLSession is also just a wrap](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1023) [around Sockets.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1025) [Well, not quite.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1027) [URLSession is actually built](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1031) [using Apple's user space](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1033) [networking code network](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1035) [framework.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1037) [And starting now, in iOS 12, we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1038) [are exposing that same API that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1041) [URLSession uses so that your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1043) [apps can directly use that for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1046) [making TCP connections and other](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1049) [appropriate use cases.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1051) [If you're doing things with URLs](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1053) [and HTTP GETs, URLSession is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1055) [still your API of choice.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1057) [But for the things URLSession](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1059) [doesn't cover, we now expose](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1061) [network framework so your apps](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1063) [can use that directly.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1065) [And if you're the developer of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1067) [one of these third-party](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1069) [libraries, which are very](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1070) [popular that are built on BSD](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1071) [Sockets, we encourage you to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1074) [look at the network framework](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1076) [APIs.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1078) [Move your library over to these](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1079) [Move your library over to these](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1079) [improved high-performance APIs,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1082) [and give us feedback about how](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1084) [that goes for you.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1087) [So to summarize, we really](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1088) [strongly recommend here and now](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1091) [in 2018 that you avoid using BSD](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1094) [Sockets.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1097) [Avoid using libraries that are](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1098) [nothing but wrappers around BSD](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1100) [Sockets.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1102) [And if you are one of the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1103) [authors of those libraries using](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1105) [these older APIs, look at](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1107) [switching over.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1109) [Come and meet us in the labs](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1110) [this afternoon and tomorrow and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1112) [give us your feedback about what](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1114) [it takes to move your libraries](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1116) [to new APIs.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1118) [And with that, I would like to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1120) [invite my colleagues Jiten to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1121) [come up on stage and give you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1123) [more details about URLSession.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1125) [[ Applause ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1127) [&gt;&gt; Thank you, Stuart.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1132) [Good morning everyone.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1133) [My name is Jiten Mehta.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1135) [And I'm an engineer on the CF](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1137) [network team.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1138) [Today I'll be talking to you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1140) [about some networking best](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1141) [practices for your apps.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1142) [Networking is an essential part](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1145) [of every application.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1147) [Each year, you guys do a great](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1149) [job of adding awesome features](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1150) [to your apps.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1152) [And today I'll be talking to you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1153) [about some simple networking](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1155) [details, details that can help](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1156) [make your apps successful.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1159) [Our agenda for today is going to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1160) [cover four categories: reducing](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1164) [latency, maximizing throughput,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1167) [increasing responsiveness, and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1171) [making better use of system](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1173) [resources.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1174) [Before that, let's quickly](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1176) [review URLSession, the API](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1178) [you've been using.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1180) [URLSession is the recommended](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1185) [high-level networking API](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1188) [available on all Apple](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1190) [platforms.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1192) [URLSession has first-class](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1194) [support for HTTP/2 and HTTP/1.1.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1196) [support for HTTP/2 and HTTP/1.1.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1196) [If your app does not use HTTP,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1202) [we have support for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1204) [URLSessionStreamTask, an API](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1206) [that allows you to make secure](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1209) [TCP connections to a server over](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1211) [which you can build your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1213) [arbitrary protocol.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1214) [That's URLSession.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1217) [Let's move on to our first](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1219) [agenda item: reducing latency.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1220) [Let's suppose you and your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1225) [friends go to a restaurant where](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1226) [the waiter walks up to you and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1228) [you say, "Can I get a glass of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1229) [water please?"](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1231) [The waiter say, "Sure," walks](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1232) [away, fetches you a glass of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1234) [water.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1235) [Your friend then says, "Can I](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1237) [get a glass of water too?"](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1238) [The waiter says, "Sure," walks](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1240) [away, and fetches your friend a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1241) [glass of water.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1242) [Wouldn't it be faster if the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1244) [waiter took everyone's order at](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1245) [the same time and reduce the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1246) [number of round trips?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1248) [The idea to reduce latency is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1250) [simple.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1252) [To reduce the number of back and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1253) [forths when you fetch a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1254) [resource.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1256) [Let's see how your apps can do](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1257) [this.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1261) [First, let's look at some issues](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1262) [with HTTP/1.1.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1263) [Your app wants to fetch a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1266) [resource, you can create a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1267) [URLSession task and call resume.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1270) [URLSession will create a new](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1274) [connection for you, which](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1276) [involves DNS, TCP and TLS.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1277) [Once the connection to the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1282) [server is established, we will](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1283) [send out your request.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1285) [We will then wait to get a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1287) [response from the server.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1290) [This is the network idle time](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1292) [when your app is not doing any](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1294) [kind of networking, waiting to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1295) [get a response from the server.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1297) [Once we get a response, we will](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1300) [call your completion block or](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1302) [message your delegate indicating](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1304) [that the load has finished.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1306) [Let's suppose in the middle of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1307) [this load your app wants to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1310) [fetch another resource from the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1311) [same server.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1313) [You can create another](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1314) [URLSession task called resume](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1316) [and URLSession will create a new](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1319) [and URLSession will create a new](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1319) [connection to fetch this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1321) [resource since it does not have](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1323) [an idle connection in its](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1324) [connection pool.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1326) [If your app wants to fetch yet](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1328) [another resource from the same](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1329) [server, you can create another](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1330) [URLSession task and call resume](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1332) [and we will create another](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1335) [connection to fetch the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1336) [resource.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1337) [In this example, I've shown you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1338) [that we've created three](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1341) [different connections to fetch](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1342) [these resources from the same](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1344) [server.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1345) [If you notice, we've spent a lot](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1347) [of time opening new connections.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1349) [Let's see how this would look](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1351) [like if you used a single](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1353) [connection instead.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1354) [This is a single connection](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1358) [case.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1359) [We saved a lot of time by not](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1361) [opening new connections, but](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1362) [there is another problem here.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1364) [The request number two which is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1366) [the green request has to wait](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1368) [until response number one is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1370) [fully received.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1372) [The same problem applies to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1374) [request number three which is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1375) [the orange request which has to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1377) [wait until response number two](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1379) [wait until response number two](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1379) [is fully received.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1381) [This problem is known as HTTP](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1383) [head-of-line blocking.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1385) [Consider moving to HTTP/2.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1388) [HTTP/2 uses a single connection,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1391) [and it also solves the HTTP](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1394) [head-of-line blocking problem.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1396) [HTTP/2 multiplexes multiple](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1398) [streams over a single connection](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1401) [allowing you to receive parallel](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1404) [responses in an [inaudible]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1406) [fashion.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1408) [Let's analyze this example a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1409) [little more to see how HTTP/2](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1412) [performs better than HTTP/1.1.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1415) [Pay attention to the times when](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1419) [your app wants to fetch a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1421) [resource and the time when the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1422) [request is sent out.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1424) [In the HTTP/1.1 case, there is a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1427) [significant delay between the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1430) [time when your app desires a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1432) [resource and the time the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1433) [request is sent out.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1435) [HTTP/2 can significantly reduce](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1437) [HTTP/2 can significantly reduce](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1437) [this delay and allows us to send](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1440) [the request almost immediately](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1442) [when the app desires the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1444) [resource.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1446) [Also pay attention to these gray](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1447) [boxes.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1451) [If you recall, this is the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1453) [network idle time when your app](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1454) [is not doing any networking,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1457) [waiting to get a response from](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1458) [the server.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1460) [HTTP/2 can significantly reduce](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1462) [this network idle time allowing](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1465) [you to better utilize the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1467) [bandwidth and load the resources](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1469) [much faster.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1471) [We just discussed many benefits](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1475) [of using HTTP/2 over HTTP/1.1,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1477) [but let's quickly summarize](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1480) [them.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1481) [HTTP/2 solves the head-of-line](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1483) [blocking problem at the HTTP](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1485) [layer.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1486) [And it also allows you to better](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1487) [utilize the bandwidth.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1489) [If your apps use URLSession, you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1492) [don't need to make any](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1494) [client-side changes.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1495) [Simply enable HTTP/2 on your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1497) [Simply enable HTTP/2 on your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1497) [servers and you will see these](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1500) [benefits.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1501) [By adopting HTTP/2, you can also](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1503) [get some server-side savings](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1506) [because devices running your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1508) [apps will now make fewer](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1510) [connections to the servers.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1512) [This year, we have something new](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1515) [in URLSession that is going to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1517) [add to the advantages of HTTP/2.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1519) [Introducing HTTP/2 Connection](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1524) [Coalescing for URLSession.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1526) [HTTP/2 Connection Coalescing is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1528) [going to increase connection to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1532) [use even more.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1533) [Since your apps are not going to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1536) [be opening new connections, they](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1539) [will become more responsive to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1540) [your users.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1543) [Starting with the [inaudible],](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1545) [HTTP/2 Connection Coalescing is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1546) [going to be automatically done](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1550) [on for all your apps using](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1552) [URLSession.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1554) [Now let's see how Connection](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1556) [Coalescing decides to reuse](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1557) [connections.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1559) [connections.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1559) [Let's suppose you have an app](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1560) [and that app wants to fetch a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1565) [resource from menu.example.com.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1566) [We open a connection with the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1570) [server, and the server presents](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1572) [us with the certificate.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1573) [If your app wants to fetch](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1576) [another resource from](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1577) [delivery.example.com, we open](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1578) [another connection and the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1581) [server presents us with another](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1582) [certificate.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1583) [This is the old behavior where](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1585) [URLSession would create two](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1587) [connections to fetch these](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1589) [resources from the given host](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1591) [names.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1592) [But if you look closely, the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1593) [first certificate presented to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1596) [us covers all the subdomains](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1599) [under example.com which means](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1601) [delivery.example.com is covered](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1604) [by this first certificate.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1608) [Also notice that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1610) [delivery.example.com, it results](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1611) [to the same IP address as the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1614) [first connection.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1615) [At this point, it's safe for us](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1617) [At this point, it's safe for us](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1617) [to assume we're talking to the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1620) [same endpoint and reuse the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1621) [connection instead of opening a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1623) [new one when we want to fetch](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1625) [the second resource.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1627) [This saves us time by not](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1629) [opening a new connection and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1630) [makes the load much faster.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1631) [HTTP/2 [inaudible] HTTP/2](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1633) [Connection Coalescing new in iOS](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1636) [12 and macOS Mojave.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1640) [Now let's see how using fewer](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1643) [URLSession objects can help](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1646) [reduce latency.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1648) [All the benefits of connections](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1650) [we use that we just discussed in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1654) [the previous slides are](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1656) [applicable only if you use the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1658) [same URLSession object to create](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1661) [your tasks.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1663) [It's also important to know that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1667) [every URLSession object has a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1668) [connection pool and when you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1671) [create multiple of these](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1673) [URLSession objects, you don't](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1674) [get any benefit of connection to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1676) [use.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1677) [It's also important to note that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1679) [It's also important to note that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1679) [the URLSession objects are](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1681) [fairly expensive to create and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1682) [have a non-trivial memory](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1684) [footprint.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1686) [As we have in the past, we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1688) [continue to advise you to use](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1689) [fewer URLSession objects.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1691) [Let's move on to our next topic](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1693) [for the day: maximizing](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1697) [throughput.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1699) [Coming back to our restaurant](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1699) [example.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1702) [The waiter checks up on you and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1703) [you say, "Can I get an order of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1705) [grilled chicken tossed in creamy](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1708) [tomato onion gravy made with a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1710) [lot of butter?"](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1712) [Now that's a mouthful.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1713) [Wouldn't it be easier if you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1715) [just said, "Can I get butter](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1716) [chicken?"](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1718) [The idea to maximize throughput](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1719) [is the same where you reduce the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1721) [number of bytes that you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1723) [transmit when you want to fetch](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1724) [a resource.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1725) [Let's see how your apps can do](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1727) [this.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1728) [Let's look at a couple of ways](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1729) [to reduce the request size.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1732) [Pay attention to HTTP cookies.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1735) [They are not free and have a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1739) [They are not free and have a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1739) [non-trivial cost in storing and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1741) [looking them up.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1743) [Cookies are attached to all the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1745) [requests that match the domain](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1746) [and path attribute.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1748) [And it can quickly increase your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1750) [request size.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1751) [Please use the domain and path](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1753) [attribute wisely to make sure](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1755) [cookies required by the servers](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1757) [are attached to your requests.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1759) [Use of smaller cookies when](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1762) [possible, and delete these](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1763) [cookies when you no longer need](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1765) [them.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1766) [Try to save some state on the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1768) [server so you can reduce the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1769) [number of client-side cookies.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1771) [Also consider moving to HTTP/2](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1773) [to get benefits of header](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1777) [compression.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1778) [Let's talk a little more about](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1779) [compression.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1782) [HTTP compression, also known as](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1783) [content and coding, is simply](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1788) [compressing the data that is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1791) [shuttled between the client and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1793) [the server.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1794) [This allows us to better utilize](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1796) [the bandwidth.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1797) [The algorithms that URLSession](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1799) [The algorithms that URLSession](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1799) [supports and recommends are Gzip](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1802) [and Brotli.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1805) [Gzip is widely supported and is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1807) [relatively fast.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1809) [Brotli support was introduced](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1811) [last year in iOS 11 and macOS](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1813) [High Sierra.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1816) [Brotli is optimized for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1818) [structured text and HTML.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1820) [And it has the best compression](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1822) [ratio on short data.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1824) [Please enable compression on](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1827) [your servers if you haven't done](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1829) [so already.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1830) [Let's move on to our next topic](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1832) [for the day: increasing](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1834) [responsiveness.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1837) [Coming back to our restaurant](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1839) [example.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1840) [Here you are here in San Jose](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1840) [for WWDC, and you decide to meet](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1842) [up with some old friends.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1844) [You and your friends are sitting](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1846) [at the restaurant table.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1848) [Your drinks are here, but you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1849) [would like some more time to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1851) [catch up with your friends](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1852) [before the food comes out.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1853) [You can simply tell the waiter,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1856) ["Can you please bring out our](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1858) [food after some time?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1858) [We are in no rush."](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1859) [We are in no rush."](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1859) [The same concept can be applied](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1862) [to responsiveness where you mark](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1863) [your tasks with priority](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1865) [depending on the other tasks](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1867) [that you're doing.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1868) [Let's see how your apps can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1870) [benefit from this.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1871) [You might be familiar with these](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1872) [five QoS classes associated with](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1876) [dispatch queues and NSOperation](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1879) [objects.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1882) [Data [inaudible] the CPU](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1883) [scheduling policy.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1884) [URLSession is QoS-aware which](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1887) [means it will capture the QoS](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1891) [off the queue on which you call](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1893) [task.resume.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1895) [And all the messages that it](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1897) [sends to your delegates will](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1898) [respect this QoS.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1900) [Let's take an example.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1901) [If your app wants to fetch some](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1905) [data which is not time critical,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1906) [consider resuming that task on a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1909) [queue which has background QoS](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1911) [to make sure this task does not](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1914) [contend for CPU with other](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1916) [higher priority work that your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1918) [app might be doing.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1919) [app might be doing.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1919) [Network service type is the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1924) [property on the URLSession](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1926) [configuration object that allows](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1928) [you to classify your network](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1930) [traffic that helps the system](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1932) [prioritize the data leaving the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1935) [device.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1937) [This year, we have a new network](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1939) [service type, the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1941) [responsiveData.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1942) [ResponsiveData is slightly](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1944) [higher than the default type but](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1946) [should be used judiciously.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1948) [An example where you might want](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1951) [to use responsiveData is if you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1952) [have a shopping app and you are](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1955) [on the checkout page.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1957) [You might want to mark your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1959) [payment request with the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1960) [responsiveData to make sure you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1962) [get a good response from the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1964) [server.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1966) [Traffic marked with the network](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1968) [service type property will](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1969) [maintain this tag across all the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1971) [hops when on a Cisco Fast Lane](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1973) [network.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1976) [For more information on this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1978) [API, please view the WWDC](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1979) [API, please view the WWDC](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1979) [session from the year 2016.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1982) [Last year, we introduced the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1988) [URLSession Adaptable](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1989) [Connectivity API](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1991) [waitsForConnectivity.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1993) [waitsForConnectivity will simply](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1995) [wait instead of failing the load](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1998) [when your task does not have](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2001) [connectivity.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2002) [In the past, you've been using](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2004) [STNeworkReachability to do a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2006) [preflight check before you send](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2008) [out your request.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2009) [But as Stuart pointed out a few](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2011) [slides ago, there is a race](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2012) [condition where the system might](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2014) [tell you that you have](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2016) [connectivity to a server but by](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2017) [the time you create and send](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2019) [your request, you've lost your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2020) [chance and you're no longer](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2021) [connected to the server.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2023) [We recommend using](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2025) [waitsForConnectivity which will](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2026) [simply send out your request as](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2028) [soon as a connection to the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2030) [server is available.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2031) [Optionally, you can implement](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2033) [the taskIsWaitigForConnectivity](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2036) [delegate method which gets](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2038) [called when your task does not](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2039) [called when your task does not](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2039) [have connectivity.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2041) [This can be helpful to present](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2043) [the user with a different flow](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2044) [or an offline UI for better user](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2046) [experience.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2049) [For more information on this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2051) [API, please view the WWDC](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2053) [session from last year where](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2055) [this API was introduced.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2056) [Now let's move on to our last](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2058) [topic for the day: making better](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2061) [use of system resources.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2063) [Coming back to our restaurant](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2066) [example.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2067) [You like the food at this place](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2068) [so much that you decide to come](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2071) [here for dinner the next day.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2072) [The restaurant has a delivery](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2075) [service where you can place your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2076) [order today and they will](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2078) [deliver the food to your house](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2080) [the next day.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2081) [This not only saves you the time](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2082) [and effort to go and pick up](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2084) [your food but it also helps the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2086) [restaurant prioritize their work](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2088) [based on your deadline.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2090) [Let's see how your apps can make](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2092) [better use of system resources](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2094) [to be more efficient.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2096) [Background sessions have upload](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2100) [and download tasks.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2102) [These tasks use system](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2104) [intelligence to decide when to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2106) [start and when to stop a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2108) [download based on various](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2109) [factors like battery, CPU,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2111) [Wi-Fi, etcetera.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2114) [If your app wants to fetch a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2117) [large file, consider using](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2119) [background sessions.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2121) [These tasks run out of process](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2123) [which means your download will](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2126) [continue even when your app is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2128) [in a suspended state.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2130) [For more information on](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2133) [background sessions, please view](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2134) [the WWDC session from the year](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2136) [2014.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2138) [Caching is a great way of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2142) [reducing latency but it's](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2144) [important to note that caching](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2146) [might result in disk IO.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2148) [In the real world, we've seen](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2151) [some apps write several](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2152) [gigabytes of data to disk each](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2154) [day which can cause severe flash](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2156) [storage degradation.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2158) [Please don't cache unique](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2161) [content.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2162) [Let's take an example.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2164) [Let's suppose you have an app, a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2166) [dating app, and you are](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2168) [responsible for the networking](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2169) [code of the app.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2171) [This app loads user profiles](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2173) [with high-resolution images.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2175) [It might be wasteful to cache](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2178) [these high-resolution images](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2180) [because the user might swipe](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2182) [left, move on to the next](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2183) [profile, which means that the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2185) [images that you just cached are](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2187) [probably not going to be](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2188) [requested again.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2190) [Please consider making](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2192) [client-side changes by adopting](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2193) [the willChacheResponse delegate](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2195) [method to decide what resources](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2197) [should be cached.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2199) [If you own the servers, please](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2201) [consider using cache control](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2203) [headers to decide what resources](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2205) [should be cacheable.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2208) [Let's quickly go over some of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2209) [the key points that we discussed](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2213) [today.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2214) [Number one, order all your food](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2215) [at the same time when you go to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2217) [a restaurant.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2218) [I'm just kidding.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2219) [I'm just kidding.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2219) [Move to HTTP/2 today to get wins](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2221) [like header compression,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2223) [connection coalescing and no](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2225) [head-of-line blocking.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2227) [Use fewer URLSession objects to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2228) [reduce latency by reusing](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2232) [connections.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2234) [This also reduces the memory](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2235) [footprint so it's better use of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2237) [system resources.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2239) [Reduce the request size to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2241) [maximize throughput.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2244) [Pay attention to QoS to increase](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2247) [the responsiveness of your apps.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2249) [And finally use background](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2252) [sessions when you can to make](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2254) [better use of system resources.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2255) [For more information on this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2259) [session, please visit this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2260) [website.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2262) [Now we'll have a short break.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2263) [And after the break, we'll](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2265) [introduce you to network](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2266) [framework, a modern alternative](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2267) [to Sockets.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2269) [I would love to see you all at](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2271) [the networking labs which are](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2272) [going to be held today and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2274) [tomorrow.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2275) [Thank you all for being here.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2277) [And I hope everyone has a great](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2278) [And I hope everyone has a great](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2278) [rest of the conference.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2280) [[ Applause ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2282)