# Optimizing Your App for Today’s Internet

## Summary
Learn what Apple has been doing to help your app get the most out of the network with the least effort. Let Apple's networking APIs do the heavy lifting for you. Learn best practices for getting top networking performance from your app using the URLSession APIs.

## Info
* Frameworks
* WWDC 2018 - Session 714 - iOS, macOS, tvOS, watchOS
* https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/

## Text
 [[ 音乐 ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=6) [[ 掌声 ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=19) [&gt;&gt; 女士们 先生们 早上好](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=26) [你们中有多少人](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=28) [是第一次来 WWDC](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=29) [非常棒](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=33) [每年都能见到一些新面孔](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=34) [实在是太好了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=36) [我是 Stuart Cheshire](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=38) [我们将会讨论网络](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=39) [我会先从影响你的 App 性能的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=42) [一些话题开始](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=45) [如今完全不利用网络的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=47) [App 已经几乎没有了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=48) [而让网络性能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=52) [达到最优非常重要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=54) [我们会讲到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=56) [可以帮助你优化](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=57) [网络性能的一些技术](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=58) [也会讲到一些有用的提示和方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=60) [来指导你如何最大程度地利用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=65) [Apple 的 API 以及关于](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=67) [即将到来的新技术的一些信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=70) [然后我的同事](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=72) [Jiten 将会更详细地](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=74) [讲解 URLSession](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=76) [我们先从互联网的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=81) [近况说起](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=83) [今年早些时候](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=85) [使用互联网的人数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=87) [达到了 40 亿](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=90) [超过了世界人口的一半](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=91) [我们早已习惯了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=94) [互联网使用人数的不断翻倍](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=95) [而当已经超过一半时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=97) [显然互联网使用人数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=99) [不可能继续翻倍 所以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=100) [互联网使用人数增长的速度在减缓](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=103) [但并不意味着](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=105) [互联网的发展会减缓](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=106) [在机器对机器通讯](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=108) [物联网以及](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=109) [智能家庭方面](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=110) [仍然有很高的增长率](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=111) [另外 在一些地方 例如印度和中国](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=114) [仍然有很高的增长率](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=115) [并且仍然有很多人](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=118) [从未拥有过一台桌面计算机](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=119) [从未拥有过一台桌面计算机](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=119) [甚至未来也不会拥有](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=121) [自己的桌面计算机](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=123) [他们主要的计算](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=125) [和通讯设备](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=126) [是他们的智能手机](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=128) [而这些智能手机中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=129) [很多都仍在使用 2G 网络](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=132) [我相信这间屋子里的绝大多数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=135) [都足够幸运](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=137) [居住的地方 工作的地方](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=140) [以及开发我们的 App 的地方](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=141) [都有快速的 LTE 网络](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=143) [而这可能会成为一个短板](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=145) [因为如果你开发 App 时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=147) [考虑的是它在 LTE 下运行良好](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=151) [它可能在 2G 下表现得非常糟糕](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=153) [在世界的另一个角落](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=156) [你的某个竞争对手](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=157) [开发的 App 在 2G 下运行良好](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=159) [那么在 LTE 下会表现得更为出色](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=160) [所以我们有了一个工具](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=163) [可以让所有人都模拟](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=166) [那些较慢网络的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=168) [一些特性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=170) [这就是 Network Link Conditioner](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=172) [从开发 App 的第一刻起](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=174) [就应该运行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=175) [Network Link Conditioner](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=177) [不要认为你可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=178) [到最后再来改善性能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=179) [到最后再来改善性能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=179) [因为到时就来不及了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=182) [请一定一直记得](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=183) [使用 Network Link Conditioner](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=185) [来运行和测试你的 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=186) [这样的话 如果程序中有个错误](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=188) [带来了糟糕的性能问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=190) [你马上就能发现它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=191) [并且立刻修复](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=192) [使用像 Wireshark 和](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=195) [tcptrace 的工具](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=196) [来弄清楚你的 App 的网络性能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=199) [这很像是用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=200) [Instruments 来查看](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=201) [内存和 CPU 的占用情况](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=203) [如果你还没用过 tcptrace](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=205) [这个工具可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=206) [生成像这样的图表](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=208) [让你一眼就看清楚](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=209) [网络上进行中的事](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=211) [如果你想要了解更多](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=213) [请查看三年前的视频](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=214) [IPv6 的使用率持续上升](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=219) [为什么这很重要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=222) [这是因为 IPv6](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=223) [比 IPv4 的性能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=226) [表现更好](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=227) [所以如果你在意性能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=228) [你应该确保](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=230) [不仅你的 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=231) [还有你的 App 使用的网络服务](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=233) [支持原生 IPv6](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=235) [在这方面](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=237) [有些地方的情况比其他地方好一些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=239) [有些地方的情况比其他地方好一些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=239) [在美国 已经有 87% 的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=241) [移动运营商支持 IPv6](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=244) [其他地方 例如印度](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=246) [也非常好](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=248) [那么我们现在来看看印度](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=250) [这里是今年早些时候](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=252) [Apple 的网络团队](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=254) [收集到的一些数据](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=255) [有关印度蜂窝移动网络下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=258) [TCP 网络连接建立时长](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=261) [以及持续的往返延迟](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=265) [蓝色的线是 IPv6](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=267) [举例来说 如果我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=269) [观察 75% 这里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=271) [可以看出 IPv6 上 75% 的 TCP 连接](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=274) [在 150 毫秒内建立完成](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=279) [而相应的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=282) [在 IPv4 上则超过 325 毫秒](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=284) [比 IPv6 慢了不止一倍](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=287) [因此如果你想要为你的用户](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=289) [提供响应速度快的 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=290) [请采用 IPv6](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=293) [另一项通过](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=296) [降低丢包率和重发率](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=298) [降低丢包率和重发率](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=298) [来提升性能的技术](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=300) [是 Explicit Congestion](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=302) [Notification](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=303) [我们在 macOS 和 iOS 上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=304) [默认启用这项技术](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=306) [已经有些年了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=308) [因此想要利用这项技术](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=309) [你不需要在你的 App 中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=310) [进行额外操作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=312) [不过要确保你的服务支持 ECN](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=313) [我们调研了 Alexa](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=317) [前一百万网站](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=320) [发现截止上月](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=322) [前一百万服务中有 77% 已经](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=324) [支持了 ECN](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=325) [相比几年前](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=327) [这是个很大的进步](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=328) [另一项帮助你提升](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=332) [连接的性能和](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=334) [弹性的技术](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=336) [是多路 TCP](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=337) [用户常常可能在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=339) [办公室的 Wi-Fi 下发起连接](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=341) [然后走出办公室](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=343) [就丢失了 Wi-Fi 信号](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=346) [如果是传统 TCP](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=347) [连接就断了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=349) [必须重新连接](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=350) [重新开始发起](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=351) [多路 TCP 以包为单位](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=353) [做数据包的路由选择](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=355) [而不是以连接为单位](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=356) [所以可以即时把连接](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=359) [所以可以即时把连接](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=359) [转向另一个接口](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=361) [去年我们讨论了如何

00:06:08.416 --> 00:06:09.876 A:middle
在你的 App 中启用这项技术](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=365) [当然 请和你的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=370) [服务器运营商](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=371) [确认你的服务器也支持多路](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=373) [我们最近调查了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=376) [全世界与 Apple 合作的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=378) [移动运营商](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=380) [其中 78% 支持多路 TCP](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=382) [只有 22% 的运营商](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=388) [仍限制多路连接](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=390) [TCP Fast Open 是一项](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=392) [可以让你避免通常情况下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=397) [TCP 连接建立时的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=399) [往返延迟的技术](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=401) [TCP Fast Open 可以让你](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=402) [把初始数据放在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=406) [连接建立数据包里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=408) [你可以在三年前的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=412) [视频中找到更多相关信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=413) [也请和你的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=416) [服务器运营商](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=417) [确认支持 TCP Fast Open](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=419) [确认支持 TCP Fast Open](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=419) [现在我们来说讲一些新消息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=423) [你们中很多人应该](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=426) [听说过一个技术](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=429) [叫做 QUIC](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=430) [这是一种新的传输协议](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=431) [也是近 30 年来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=433) [第一个真正意义上的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=435) [可能取代 TCP 的候选者](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=437) [它起源于 Google 的一些工程师](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=439) [做的一项实验](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=441) [这项实验很成功](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=443) [现在已成为 IETF](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=445) [为了标准化的一项工作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=449) [Apple 的工程师](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=451) [也参与其中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=453) [实际上 此时此刻我们的工程师](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=454) [就在瑞典的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=455) [QUIC 会议上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=457) [不过这项技术还没有完全准备好](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=459) [标准尚未完成](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=462) [但是 Apple 正在为之努力](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=464) [一旦准备好了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=465) [你会看到 Apple 有 API](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=467) [来支持这项技术](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=468) [继续有关性能的话题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=471) [我们观察到了一些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=472) [非常常见的行为](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=475) [相当多的网站和](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=477) [互联网服务 使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=479) [互联网服务 使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=479) [生命周期短的 DNS 记录](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=481) [他们之所以这样做](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=484) [是因为如果一个数据中心出了故障](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=486) [他们希望能够更新 DNS](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=488) [从而迅速地把流量导向](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=490) [另一个不同的数据中心](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=492) [这个方法的问题在于](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=495) [你在为一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=497) [几乎从未发生过的情况牺牲性能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=499) [数据中心极少出故障](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=501) [这意味着](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=505) [每当一个 DNS 地址记录过期](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=507) [你的客户端不得不](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=509) [再用一个往返延迟](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=511) [去等候来自 DNS 服务器的回应](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=513) [而这个回应](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=515) [和它上次获知的一模一样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=517) [所以 考虑到这点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=519) [我们做了一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=522) [可以实现的优化](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=524) [如果你传了参与这种新方式的标记](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=525) [那么当你发起 DNS 请求时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=527) [如果我们的缓存中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=530) [有一个此前过期的回应](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=532) [我们会把它立即给你](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=534) [与此同时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=537) [进行原本就会做的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=539) [进行原本就会做的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=539) [普通的 DNS 请求](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=540) [如果请求到相同的结果](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=544) [我们预计大多数时候都是如此](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=545) [那么一切正常](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=547) [你就省了一次往返时长](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=549) [从而更快速地建立连接](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=552) [如果请求到一个不同的地址](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=554) [我们就会给你的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=555) [客户端发另一个异步的通知](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=558) [来告诉它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=559) [这里有一个新的地址](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=561) [也需要进行尝试](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=562) [想要利用这个特性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=564) [你需要与 Happy Eyeballs 算法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=566) [一起使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=567) [这意味着你需要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=569) [同期进行多个连接](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=570) [你需要尝试 IPv4 IPv6](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=572) [多个地址](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=574) [多个接口](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=576) [这听起来工作量很大](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=578) [也很难正确完成](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=579) [确实如此](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=581) [确实有很多工作要做](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=582) [中场休息后回来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=584) [我们会告诉你一些新的 API](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=586) [可以让你在无需做](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=588) [所有麻烦的工作的情况下 利用此特性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=590) [现在我们看一些指导信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=594) [我们见到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=596) [很多开发者](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=599) [很多开发者](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=599) [都把 SCNetworkReachability](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=602) [用作预检查](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=604) [他们想要预测将来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=606) [他们想知道](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=607) [下一个要做的网络操作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=609) [会成功还是会失败](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=610) [然后 不幸的是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=612) [预测将来总是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=614) [一件困难的事情](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=616) [现在你可能连着网](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=617) [但是两秒后](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=619) [用户走出了这栋建筑](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=621) [就没有 Wi-Fi 信号了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=622) [所以并没有一种方式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=624) [可以保证下一个操作能成功](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=627) [我们常常会看到这样的情况](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=630) [他们检查预检成功](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=632) [于是他们去做 结果失败了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=634) [他们又回来重新检查](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=636) [这也有很多工作量](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=638) [很多临界情况](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=641) [很多麻烦的事情要处理](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=642) [比如使用代理的网络](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=644) [我们可以帮你搞定](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=647) [只需要使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=650) [waitsForConnectivity 选项来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=653) [建立连接就行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=656) [你可以从去年的视频中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=658) [你可以从去年的视频中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=658) [了解更多](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=660) [意思是说 如果你需要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=661) [一个连接 你告诉系统](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=663) [说你需要一个连接](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=665) [如果可以 现在就需要 如果不行 就之后](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=666) [如果设备当前在飞行模式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=669) [那么当它关闭飞行模式时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=670) [你的连接就会成功](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=672) [这比你自己](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=674) [创建一个重试循环 要简单得多](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=676) [我们发现开发者会遇到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=678) [这样一种情况](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=680) [如果你需要让用户](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=682) [在一个表格里提供很多信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=684) [而你又有足够的理由相信](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=687) [接下来用户会提交失败](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=689) [所以不想浪费用户的时间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=691) [如果你在意这种情况](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=694) [请在中场休息后回来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=695) [因为我们有一种更好的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=697) [处理这种问题的办法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=699) [一直以来 安全问题都很重要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=703) [TLS 1.2 已经十年了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=707) [互联网现在准备转向](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=709) [它的继承者 TLS 1.3](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=712) [它有很多提升安全性的特性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=715) [类似 TCP Fast Open](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=718) [类似 TCP Fast Open](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=718) [会减少连接建立时间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=720) [这项标准已经完成](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=723) [今年早些时候](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=725) [互联网工程指导小组](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=727) [批准发布](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=729) [最终草案](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=730) [我们在等待](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=732) [RFC 编辑者](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=734) [公布正式文档](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=736) [到那时 我们会默认打开 TLS 1.3](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=737) [目前在你的配置文件里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=743) [还是默认关闭的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=745) [你可以按照这里的说明](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=747) [在你 iOS 和 macOS](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=748) [App 中启用 TLS 1.3](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=752) [并且我们希望你现在就启用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=756) [因为这样一来 今年晚些时候](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=757) [当 TLS 1.3 默认打开时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=759) [你不会有服务不兼容的问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=761) [所以现在就测试好](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=766) [确保当今年晚些时候](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=768) [切换的时候一切正常](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=770) [有关安全的另一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=776) [新要素是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=777) [证书透明度](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=778) [你可能听说过](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=779) [你可能听说过](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=779) [有时证书颁发机构](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=782) [可能是恶意](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=786) [也可能是无能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=787) [会给不符合要求的机构](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=788) [颁发证书](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=790) [解决这个问题的方法是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=792) [一种叫做 证书透明日志的东西](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=794) [每个合法的证书颁发机构](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=797) [每颁发一个证书](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=799) [现在都需要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=802) [公开声明](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=804) [这些公开声明会记录在公共日志中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=805) [供任何人检查](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=807) [这意味着如果](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=810) [资质较差的证书颁发机构](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=812) [颁发了一张假证书](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=814) [一旦公布](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=816) [立刻会被发现](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=817) [如果它们不公布的话](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=820) [会被客户端发现](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=822) [这也许是你](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=824) [很熟悉的一种办法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=826) [这里新增的实体是日志](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=828) [当一个证书颁发机构](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=831) [给一个服务器颁发证书](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=832) [它也会在日志上记录](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=834) [然后日志给服务器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=837) [一张签名的宣誓书](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=839) [一张签名的宣誓书](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=839) [证明它的证书已经](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=842) [被公开记录](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=843) [然后当客户端连接时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=844) [服务器可以把这些信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=846) [提供给客户端](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=848) [客户端就能够确认](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=849) [这不仅是签名证书](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=851) [更是一个被公开记录了的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=852) [签名证书](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=854) [现在假设有一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=856) [资质较差的证书颁发机构](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=858) [不公开它颁发的异常证书](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=860) [客户端就会拒绝它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=864) [因为它没有宣誓书](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=866) [能够证明](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=867) [这张证书存在于公开记录](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=870) [今年晚些时候起](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=873) [我们会强制实施这个机制](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=874) [所有新颁发的 TLS](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=877) [证书必须包含](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=879) [确认他们被公开记录的证明](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=881) [那么如果他们没有被记录](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=884) [客户端就会拒绝它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=886) [你的 App 不需要做任何改动](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=887) [但是如果你的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=889) [服务器有专门的证书](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=891) [确保你的证书颁发机构](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=893) [在公开的证书透明日志中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=896) [留下了记录](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=898) [现在 针对硬件开发者](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=900) [我们有一些新消息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=904) [Bonjour Conformance Test 工具](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=906) [可以让你确认](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=908) [你的硬件设备](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=910) [是否正确使用 Bonjour](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=912) [如果你想要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=914) [在你的包装上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=915) [使用 Bonjour 商标的名字和标识](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=917) [你需要运行这个测试](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=918) [如果你想把 Bonjour for Windows 安装包](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=920) [与 Windows App 捆绑](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=921) [也需要运行这个测试](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=923) [如果你想在包装上使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=927) [隔空打印 隔空播放 CarPlay 车载](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=928) [HomeKit 标识](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=930) [通过 Bonjour Conformance Test](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=933) [是标识授权过程的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=934) [一部分 因为](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=936) [可靠的 Bonjour 是这些产品的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=937) [重要组成部分](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=939) [但更重要的是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=941) [运行 Bonjour Conformance Test 的价值](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=944) [在于它帮你](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=944) [提升了产品质量](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=946) [让产品更可靠](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=948) [从而让你的顾客满意](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=950) [而不会因为](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=953) [无法使用你的产品而退货](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=955) [这正是你的顾客想要的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=958) [这正是你的顾客想要的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=958) [也是你想要的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=960) [更是我们想要的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=961) [我们想让顾客开心](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=962) [与可靠的产品](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=964) [度过美好的时光](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=965) [现在我想讲一下对 API 的选择](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=966) [30 年前我们有了 BSD Sockets](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=972) [30 年前它是个很棒的 API](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=976) [但是 30 年前我们口袋里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=979) [没有移动计算机](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=982) [也没有无线网络](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=984) [没有 IPv6](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=986) [很多计算机](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=989) [只有一个网络接口](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=991) [如果那时候你的电脑上有一个以太网接口](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=992) [那一定是台很不错的电脑](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=994) [现在世界上有 40 亿人](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=997) [拥有多宿主的 IPv6 的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1000) [无线的 内置电池的计算设备](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1003) [具备电池管理功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1006) [可以休眠以节省电量](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1007) [这个世界变得](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1008) [复杂了许多](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1009) [你们中很多人可能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1012) [正在使用一些基于](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1013) [Sockets 的第三方库](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1015) [而更多人可能在用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1017) [URLSession](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1019) [URLSession](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1019) [而你可能会以为](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1021) [URLSession 也只是在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1023) [Sockets 外面包了一层](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1025) [好吧 并不太一样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1027) [URLSession 实际上建立在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1031) [Apple 的用户空间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1033) [网络代码 Network.framework 上的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1035) [从现在开始 在 iOS 12 上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1038) [我们会把 URLSession 使用的 API](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1041) [开放出来 这样你的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1043) [App 可以直接用这个 API](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1046) [建立 TCP 连接](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1049) [或者做其他合理的事情](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1051) [如果你在使用 URL](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1053) [和 HTTP GET](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1055) [URLSession 仍然是 API 中的不二选择](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1057) [而对于 URLSession 做不了的事情](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1059) [我们现在开放了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1061) [Network.framework](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1063) [你的 App 可以直接使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1065) [并且如果你是某个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1067) [基于 BSD Sockets 的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1069) [第三方库的开发者](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1070) [希望你可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1074) [关注 Network.framework 的 API](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1076) [把你的库转移到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1079) [把你的库转移到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1079) [基于这些优化的高性能 API 上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1082) [然后告诉我们效果如何](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1084) [总结一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1088) [我们在此强烈建议](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1091) [现在是 2018 年了 应该避免使用 BSD Sockets](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1094) [不要使用那些仅仅在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1098) [BSD Sockets 外面](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1100) [包了一层的库](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1102) [而如果你是使用这些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1103) [老旧的 API 的库的作者](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1105) [请考虑一下切换过来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1107) [今天下午或者明天](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1110) [请来实验室和我们交流](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1112) [告诉我们如果把你的库转移到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1114) [新的 API 上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1116) [都需要做什么](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1118) [说到这里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1120) [我想请我的同事 Jiten](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1121) [来到台上与你们分享](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1123) [更多关于 URLSession 的细节](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1125) [[ 掌声 ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1127) [&gt;&gt; 谢谢 Stuart](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1132) [大家早上好](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1133) [我叫 Jiten Mehta](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1135) [我是 CFNetwork 团队的一名工程师](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1137) [今天我想和你们聊聊](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1140) [关于你们 App 的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1141) [一些网络最佳实践](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1142) [网络是每个 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1145) [必不可少的一部分](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1147) [每年你们都会给](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1149) [你们的 App 增加一些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1150) [非常棒的功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1152) [那么今天我会与你们聊聊](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1153) [一些简单的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1155) [有关网络的细节](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1156) [让你的 App 更好](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1159) [我们今天计划](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1160) [讲四类问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1164) [减少延迟 最大化吞吐量](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1167) [提升响应度](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1171) [更好地利用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1173) [系统资源](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1174) [在这之前](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1176) [我们快速回顾一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1178) [你们一直在用的 API URLSession](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1180) [URLSession 是一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1185) [Apple 的全平台可用的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1188) [高级网络 API](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1190) [URLSession 对 HTTP/2 和 HTTP/1.1](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1194) [的支持是一流的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1196) [的支持是一流的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1196) [如果你的 App 不使用 HTTP](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1202) [我们也支持](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1204) [URLSessionStreamTask](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1206) [这个 API 让你确保](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1209) [你可以在与服务器的 TCP 连接中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1211) [建立任意的协议](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1213) [这是 URLSession](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1217) [我们来说说第一项](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1219) [减少延迟](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1220) [假设你和你的朋友](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1225) [去一个餐馆](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1226) [服务员走向你们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1228) [你说 “请给我一杯水可以吗？”](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1229) [服务员说 “没问题” 后离开](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1232) [然后给你拿了一杯水](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1234) [你的朋友说](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1237) [“也请给我一杯水 可以吗？”](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1238) [服务员说 “没问题” 后离开](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1240) [然后给你的朋友拿了一杯水](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1241) [如果服务员一次性获知](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1244) [每个人想要的东西](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1245) [从而减少来回当趟数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1246) [不是会更快吗](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1248) [减少延迟的方法很简单](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1250) [当你获取一项资源时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1253) [减少往返的次数即可](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1254) [现在我们看看你的 App 如何做到这点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1257) [现在我们看看你的 App 如何做到这点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1257) [首先我们看一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1262) [HTTP/1.1 的一些问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1263) [你的 App 需要获取资源](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1266) [你可以创建一个 URLSession 任务](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1267) [然后调用 resume](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1270) [URLSession 会为你创建](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1274) [一个包含 DNS TCP 和 TLS 的新连接](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1276) [一旦和服务器的连接被建立](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1282) [你的请求会被发出](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1285) [然后等待从服务器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1287) [返回的回应](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1290) [这就是网络的闲时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1292) [你的 App 没有做任何跟](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1294) [网络相关的事情](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1295) [只是在等服务器的回应](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1297) [一旦得到回应](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1300) [我们会调用你的完成代码块](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1302) [或向你的 Delegate 发消息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1304) [告知已经完成加载](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1306) [假设在加载的过程中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1307) [你的 App 想要从](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1310) [同一服务器获取另一项资源](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1311) [你可以再创建一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1314) [URLSession 任务并调用 resume](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1316) [然后 URLSession 会创建一个新的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1319) [然后 URLSession 会创建一个新的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1319) [连接以获取这个资源](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1321) [因为它在连接池中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1323) [并没有空闲的连接](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1324) [如果你的 App 又要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1328) [从同一服务器再获取](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1329) [一项资源 你可以再创建](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1330) [一个 URLSession 任务并调用 resume](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1332) [然后为了获取资源](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1335) [会再创建一个新的连接](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1336) [在这个例子中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1338) [我们为了从同一个服务器获取资源](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1341) [创建了 3 个不同的连接](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1344) [你可能注意到了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1347) [我们花了很多时间创建新连接](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1349) [我们再看看如果](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1351) [你只用一个连接会怎样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1353) [这是单一连接的情况](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1358) [因为没有不断创建新连接](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1361) [我们省了很多时间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1362) [但这里有另一个问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1364) [请求 2 也就是绿色的请求](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1366) [必须要等待](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1368) [请求 1 的回应](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1370) [被完全接收](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1372) [请求 3 也有同样的问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1374) [也就是橘黄色的请求](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1377) [必须等请求 2 的回应](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1379) [必须等请求 2 的回应](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1379) [被完全接收](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1381) [这个问题被称为](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1383) [HTTP 队头阻塞](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1385) [现在来考虑 HTTP/2](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1388) [HTTP/2 使用单一连接](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1391) [并且也解决了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1394) [HTTP 队头阻塞的问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1396) [HTTP/2 在一条连接上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1398) [多路传输多条数据流](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1401) [让你可以同时收到多个回应](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1404) [我们再来仔细分析一下这个例子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1409) [看看 HTTP/2](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1412) [是怎样比 HTTP/1.1 表现得更好的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1415) [注意以下这些时间节点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1419) [当你的 App 试图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1421) [获取资源的时候](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1422) [当请求被发送出去的时候](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1424) [如果使用 HTTP/1.1](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1427) [从你的 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1430) [需要资源起](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1432) [到请求被发送之间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1433) [有明显的延迟](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1435) [HTTP/2 能显著减少](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1437) [HTTP/2 能显著减少](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1437) [这个延迟](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1440) [在每当 App 需要资源时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1442) [基本上立刻发送请求](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1444) [再来看一下这些灰色的方块](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1447) [如果你还记得](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1453) [这是你的 App 没有做任何](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1454) [跟网络相关的事时的空闲时间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1457) [只是在等待服务器的回应](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1458) [HTTP/2 能显著减少](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1462) [这样的网络闲时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1465) [允许你更充分地利用带宽](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1467) [我们刚才讨论了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1475) [HTTP/2 相比 HTTP/1.1 的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1477) [许多优点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1480) [简单总结一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1481) [HTTP/2 在 HTTP 层面](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1483) [解决了队头阻塞问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1485) [它同时允许你更充分地](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1487) [利用带宽](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1489) [如果你的 App 使用 URLSession](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1492) [你不需要对客户端](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1494) [做任何改动](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1495) [仅需在服务器上启用 HTTP/2](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1497) [仅需在服务器上启用 HTTP/2](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1497) [你就能看到这些改善](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1500) [采用 HTTP/2 同时也能使你](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1503) [在服务器端有所改善](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1506) [因为那些运行你的 App 的设备](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1508) [与服务器连接次数变少了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1510) [今年 我们在 URLSession 里有一些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1515) [新东西 可以作为](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1517) [HTTP/2 优势的补充](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1519) [下面我们介绍针对 URLSession 的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1524) [HTTP/2 Connection Coalescing](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1526) [HTTP/2 Connection Coalescing 将会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1528) [让连接被更充分利用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1532) [因为你的 App 不会再一直](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1536) [建立新连接](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1539) [对用户的响应会更加及时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1540) [从 WWDC 配置文件开始](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1545) [HTTP/2 Connection Coalescing](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1546) [会自动在所有使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1550) [URLSession 的 App 上启用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1552) [现在我们来看看 HTTP/2](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1556) [Connection Coalescing](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1557) [怎样决定重用连接的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1559) [怎样决定重用连接的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1559) [假设你有一个 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1560) [这个 App 想要获得](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1565) [来自 menu.example.com 的资源](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1566) [我们建立一个与服务器的连接](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1570) [然后服务器给我们一个证书](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1572) [如果你的 App 想要获得另一项](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1576) [处于 delivery.example.com 上的资源](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1578) [我们建立另一个连接](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1581) [服务器再给我们另一个证书](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1582) [在这种旧的运作模式下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1585) [URLSession 会从给定的主机名上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1587) [创建两个连接](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1589) [来获取这些资源](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1591) [但如果你细想一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1593) [提供给我们的第一个证书](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1596) [覆盖了 example.com 下的所有子域名](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1599) [这意味着](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1601) [delivery.example.com 也被](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1604) [第一个证书包含在内](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1608) [同时也注意到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1610) [delivery.example.com 和第一个连接](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1611) [导向的 IP 地址一样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1614) [到这里 我们完全可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1617) [到这里 我们完全可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1617) [假定与我们对话的是同一个端点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1620) [那么当我们需要获取](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1621) [第二个资源时可以重用连接](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1623) [而不是重新建立](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1625) [一个新的连接](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1627) [这么做节省了时间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1629) [因为不需要建立一个新的连接](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1630) [这会让加载速度快很多](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1631) [这就是 HTTP/2 Connection Coalescing](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1633) [在 iOS 12 和 macOS Mojave 中的新特性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1636) [现在让我们看一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1643) [如何通过减少 URLSession 对象的使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1646) [来减少延迟](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1648) [在刚才的几页幻灯片中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1650) [我们讨论的所有](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1654) [有关连接的好处](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1656) [都只在你用同一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1658) [URLSession 对象](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1661) [创建任务的情况下生效](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1663) [以下这点也同样重要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1667) [每个 URLSession 对象都有](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1668) [一个连接池](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1671) [当你创建多个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1673) [URLSession 对象](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1674) [你无法得到任何有关](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1676) [连接的好处](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1677) [同时也需要说明的是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1679) [同时也需要说明的是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1679) [创建 URLSession 对象](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1681) [相对来说性能消耗不低](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1682) [并且在内存方面的占用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1684) [不能忽略不计](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1686) [和以前一样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1688) [我们仍然建议你使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1689) [尽可能少的 URLSession 对象](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1691) [让我们开始今天的下一个话题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1693) [最大化吞吐量](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1697) [回到我们那个餐馆的例子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1699) [服务员问你要什么](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1703) [然后你说 “来一份烤鸡拌酱汁](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1705) [酱汁要奶油番茄洋葱肉汁](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1710) [要用大量黄油做”](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1712) [那真是相当绕口](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1713) [如果这样会不会就简单得多](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1715) [就说“我要一份黄油鸡”](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1716) [最大化吞吐量的方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1719) [也是一样的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1721) [每当你想要获取资源](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1723) [减少你传输的数据量](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1724) [我们来看看你的 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1727) [如何做到这点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1728) [有几种方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1729) [来减少请求的大小](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1732) [请注意 HTTP Cookies](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1735) [不是无代价的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1739) [不是无代价的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1739) [储存和查找他们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1741) [都消耗空间和时间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1743) [Cookies 附加于所有符合域](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1745) [和路径的属性的请求上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1748) [这会极大增加](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1750) [你的请求大小](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1751) [请善用域和路径的属性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1753) [来确保服务器需要的 Cookies](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1757) [附在你的请求上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1759) [使用尽可能少的 Cookies](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1762) [并当你不再需要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1763) [它们的时候](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1765) [及时删除](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1766) [试着把一些状态保存在服务器上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1768) [这样你就能减少](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1769) [客户端上的 Cookies](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1771) [同时也请考虑转换到 HTTP/2](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1773) [从而获得头部压缩的好处](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1777) [我们再来多聊聊压缩](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1779) [HTTP 压缩](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1783) [即储存信息与编码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1788) [其实就是压缩那些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1791) [穿梭于客户端与服务器之间的数据](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1793) [这使得我们可以更好地利用带宽](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1796) [URLSession 支持与推荐的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1799) [URLSession 支持与推荐的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1799) [算法是 Gzip 和 Brotli](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1802) [Gzip 被广泛支持](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1807) [而且相对较快](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1809) [Brotli 的支持出现在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1811) [去年发布 iOS 11 和 macOS](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1813) [High Sierra 时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1816) [Brotli 为结构化的文本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1818) [和 HTML 做了优化](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1820) [而且它在短数据上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1822) [具有最优的压缩率](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1824) [如果你还没有启用压缩的话](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1827) [请在你的服务器上启用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1829) [让我们继续今天的下一个话题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1832) [提升响应度](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1834) [回到我们餐馆的例子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1839) [你来圣何塞参加 WWDC](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1840) [你决定去见见](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1842) [一些老朋友](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1844) [你和你的朋友就坐在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1846) [餐馆的餐桌旁](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1848) [你的饮料上来了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1849) [但是你想要更多时间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1851) [来和你的朋友们叙叙旧](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1852) [而不是直接上菜吃饭](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1853) [你可以简单地跟服务员说](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1856) [“请你过一会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1858) [再上菜可以吗？](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1858) [我们不赶时间”](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1859) [我们不赶时间”](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1859) [这里有一个同样的理念](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1862) [可以被应用在响应度上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1863) [你根据你正在进行的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1865) [其它任务给你的任务标上优先级](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1867) [我们来看看你的 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1870) [可以如何从中获益](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1871) [你也许很熟悉](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1872) [跟派遣队列和 NSOperation](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1876) [对象有关的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1879) [这五个 QoS 类](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1882) [数据需要依靠](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1883) [CPU 的调度策略](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1884) [URLSession 是对 QoS 敏感的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1887) [意味着它可以在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1891) [你调用 task.resume 的队列中采集 QoS](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1893) [它发给你的 Delegate 的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1897) [所有消息都会遵守这个 QoS](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1898) [举个例子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1901) [如果你的 App 想要获取一些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1905) [与时间无关的数据](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1906) [考虑在一个有后台 QoS 的队列上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1909) [继续这个任务](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1911) [保证这个任务不会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1914) [与其他正在做的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1916) [更高优先级的工作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1918) [争夺 CPU 资源](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1919) [争夺 CPU 资源](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1919) [网络服务类型](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1924) [是 URLSession 配置对象上的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1926) [一个属性 可以让你](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1928) [将你的网络流量分类](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1930) [从而帮助系统提升](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1932) [将要离开设备的数据的优先级](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1935) [今年 我们有了一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1939) [新的网络服务类型](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1941) [就是 responsiveData](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1942) [responsiveData 比默认的类型](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1944) [优先级稍高](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1946) [但是应该被合理利用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1948) [举个你应该使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1951) [responsiveData 的例子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1952) [如果你有个购物的 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1955) [在结算页面](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1957) [你应该把支付请求](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1959) [标记为 responsiveData](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1960) [来保证可以从](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1962) [服务器得到响应](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1964) [用网络服务类型属性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1968) [标记的流量](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1969) [在 Cisco Fast Lane 上跳转时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1971) [会一直保留这个标记](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1973) [有关这个 API 的更多信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1978) [请查看 2016 年的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1979) [请查看 2016 年的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1979) [有关部分](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1982) [去年我们介绍了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1988) [URLSession 自适应](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1989) [连接 API](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1991) [waitsForConnectivity](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1993) [waitsForConnectivity 会一直等待](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1995) [而不是在你的任务没有](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=1998) [连接的时候](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2001) [直接加载失败](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2002) [过去 你们一直在用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2004) [STNeworkReachability](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2006) [来完成发送请求前的预先检查](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2008) [但是正如 Stuart 刚指出的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2011) [这其实是一场赛跑](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2012) [因为系统可能告诉你](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2014) [你连上了一个服务器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2017) [但是当你创建并发出请求的时候](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2019) [你已经失去了机会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2020) [你不再与服务器连接着了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2021) [我们推荐使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2025) [waitsForConnectivity](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2026) [它会在连接一旦可用时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2028) [把你的请求发出去](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2030) [你也可以执行 taskIsWaitigForConnectivity](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2033) [Delegate 方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2038) [它会在你的任务无连接时被调用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2039) [它会在你的任务无连接时被调用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2039) [这会在为用户呈现](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2043) [另一个流程或者离线的 UI 时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2044) [带来更好的用户体验](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2046) [有关这个 API 的更多信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2051) [请看去年 WWDC](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2053) [介绍这个 API 的有关会谈](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2055) [现在我们来看今天的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2058) [最后一个话题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2061) [更好地利用系统资源](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2063) [回到我们餐馆的例子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2066) [你很喜欢这里的食物](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2068) [你决定第二天](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2071) [来这里吃晚饭](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2072) [餐馆有外送服务](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2075) [你可以今天下单](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2076) [他们第二天会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2078) [把餐品送到你家](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2080) [这不仅帮你省掉了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2082) [去取食物耗费的时间和精力](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2084) [还帮助餐馆](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2086) [根据你的截止时间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2088) [更好地确定工作的优先级](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2090) [让我们来看看你的 App 如何](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2092) [更好地利用系统资源](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2094) [从而提升效率](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2096) [后台会话有上传](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2100) [和下载的任务](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2102) [这些任务让](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2104) [系统智能地决定何时开始](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2106) [以及何时结束下载](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2108) [这个决定基于很多因素](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2109) [例如电量 CPU Wi-Fi 等等](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2111) [如果你的 App 想要下载](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2117) [一个大文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2119) [考虑使用后台会话](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2121) [这些任务在进程外运行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2123) [意味着即使你的 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2126) [在暂停状态](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2128) [下载也会继续](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2130) [与后台会话有关的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2133) [更多信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2134) [参见 2014 年的 WWDC 会议](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2136) [缓存是减少延迟的好方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2142) [但是需要注意的是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2146) [缓存可能会导致磁盘存取问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2148) [在现实世界里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2151) [我们看到有些 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2152) [每天往磁盘里写入若干 GB 的数据](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2154) [会引起严重的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2156) [闪存劣化](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2158) [请不要缓存唯一的信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2161) [举个例子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2164) [假设你有个 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2166) [约会的 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2168) [而你负责其中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2169) [网络部分的代码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2171) [这个 App 加载高分辨率的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2173) [用户照片](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2175) [缓存这些高分辨率图像](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2178) [可能有些浪费](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2180) [因为用户会向左滑动](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2182) [去看下一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2183) [意味着你刚才缓存的图像](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2185) [可能再也不会被请求到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2188) [请考虑做些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2192) [客户端侧的修改 比如](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2193) [采用 willChacheResponse Delegate 方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2195) [来决定哪些资源](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2197) [应该被缓存](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2199) [如果你拥有服务器的话](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2201) [请考虑在请求头中使用缓存控制](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2203) [来决定哪些资源](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2205) [可以被缓存](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2208) [我们迅速地过一遍](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2209) [今天讨论过的关键点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2213) [第一点 当你去餐馆时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2215) [一次性把所有要点的菜都点完](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2217) [我开个玩笑](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2219) [我开个玩笑](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2219) [转移到 HTTP/2](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2221) [从而利用头部压缩](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2223) [Connection Coalescing](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2225) [以及无队头阻塞问题等等好处](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2227) [用更少的 URLSession 对象](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2228) [通过重用连接来减少延迟](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2232) [这也减少了内存占用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2235) [所以也更好地利用了系统资源](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2237) [减小请求的大小](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2241) [来最大化吞吐量](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2244) [注意 QoS](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2247) [提高你的 App 的响应灵敏度](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2249) [最后 使用后台会话](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2252) [从而可以更好地](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2254) [利用系统资源](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2255) [关于这个会议的更多信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2259) [请访问这个网站](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2260) [现在我们短暂休息一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2263) [休息过后](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2265) [我们会向你介绍](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2266) [Sockets 的现代替代者](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2267) [Network.framework](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2269) [我很希望在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2271) [今天和明天举办的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2272) [网络实验室里见到各位](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2274) [感谢各位来到这里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2277) [希望大家享受](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2278) [希望大家享受](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2278) [大会的其他部分](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2280) [[ 掌声 ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/714/?time=2282)