# Advanced Dark Mode

## Summary
Step deeper into Dark Mode adoption in your macOS application. Learn about the powerful Cocoa technologies at the core of Dark Mode, and take a detailed look at the APIs and best practices for adapting to this beautiful new look.

## Info
* Frameworks
* WWDC 2018 - Session 218 - macOS
* https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/

## Text
 [[ Music ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=7) [&gt;&gt; Good morning, everyone.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=17) [[ Applause ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=19) [Wow.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=20) [Thank you.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=22) [Welcome to Advanced Dark Mode.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=24) [I'm Matt Jacobson.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=26) [I'll be joined later on stage by](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=27) [my colleague, Jeff Nadeau.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=29) [We're engineers in the Cocoa](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=30) [Frameworks group at Apple.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=32) [We are super excited to talk to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=34) [you today about the awesome Dark](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=36) [Mode in Mojave.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=39) [Now, in the intro session](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=40) [yesterday, you learned all the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=45) [things you need to get started](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=48) [adapting your app for Dark Mode,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=50) [like rebuilding on the macOS](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=52) [10.14 SDK.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=54) [Making use of dynamic colors](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=55) [instead of static or hardcoded](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=58) [instead of static or hardcoded](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=58) [colors.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=60) [Making correct use of template](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=61) [images and materials.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=63) [And, most of all, making use of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=65) [the new features in Xcode 10 to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=67) [define custom color and image](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=69) [assets specifically for Dark](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=71) [Mode.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=74) [Now, if you need a review on any](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=75) [of those topics, I highly](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=77) [recommend going back and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=78) [watching the intro session on](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=80) [video later.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=81) [Now, most UI will look great in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=84) [Dark Mode using just those](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=87) [techniques.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=88) [In fact, some of our system apps](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=89) [required no other changes.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=91) [It was great.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=92) [But we know some cases will](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=94) [require a little bit more work](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=96) [and that's what we're going to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=97) [get into in this session.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=98) [We're going to cover six main](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=103) [areas today.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=106) [First, the appearance system,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=107) [how it works, and how you can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=110) [make use of it in your custom](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=111) [views.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=113) [Second, materials, what they](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=114) [are, and how you can best make](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=117) [use of them in your UI.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=119) [use of them in your UI.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=119) [Then I'll hand it over to Jeff](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=122) [and he'll talk about vibrant](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=123) [blending, which is an awesome](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=125) [way to make your views look](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=126) [great.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=128) [As well as reacting correctly to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=129) [selection using something called](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=131) [background style.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=133) [Finally, he'll wrap it up with](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=135) [some discussion on how to back](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=137) [deploy your app to older](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=139) [versions of macOS while still](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=141) [supporting Dark Mode, as well as](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=142) [some general tips and tricks for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=145) [polishing your apps for Dark](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=147) [Mode.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=148) [All right.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=150) [Let's get started.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=150) [So, in Mojave, your app will](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=153) [need to look great in light and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=156) [dark.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=158) [And the way you'll do that is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=160) [using something called](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=161) [NSAppearance.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=162) [NSAppearance is the theme system](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=165) [used throughout Cocoa and the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=167) [key part about it is you only](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=169) [have to maintain a single view](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=171) [hierarchy and NSAppearance will](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=173) [help it look great in light and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=175) [dark.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=177) [Now, in addition to being at the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=179) [Now, in addition to being at the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=179) [core of Dark Mode, we've already](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=181) [been using NSAppearance for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=183) [several years and it's underlied](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=185) [[phonetic] such features as the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=186) [high contrast mode of macOS as](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=188) [well as the touch bar UI](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=190) [designed specifically for that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=192) [awesome piece of hardware.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=194) [Now, previously we've had one](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=196) [main appearance, one main light](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=200) [appearance for aqua windows and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=201) [we called aqua.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=203) [And, of course, in 10.14, we're](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=204) [introducing a second appearance](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=206) [for aqua windows for Dark Mode](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=207) [called darkAqua.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=210) [These objects contain all the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=212) [assets that views draw with.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=213) [So, any time you use system](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=216) [dynamic colors or standard](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=218) [effects or named images or even](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=219) [just standard Cocoa controls,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=222) [this is where all that stuff is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=223) [coming from.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=225) [And AppKit will automatically](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=226) [provide appearances for all of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=229) [you views and windows based on](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=231) [the user's light/dark preference](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=233) [in system preferences once you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=235) [link on the macOS 10.14 SDK.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=236) [So, here's our beautiful](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=240) [Chameleon Wrangler app that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=242) [Rachel and Taylor created in the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=243) [intro session and you can see](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=246) [once we linked it on the macOS](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=248) [10.14 SDK, AppKit went ahead and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=250) [automatically gave it the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=253) [darkAqua appearance.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=254) [Now, that's great, but what if](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=256) [we want to change the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=258) [appearance?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=259) [For example, what if we wanted](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=260) [to change the appearance of this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=262) [notes view?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=265) [We might think that in the dark](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=266) [appearance we still might want](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=269) [the notes view to appear light.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=270) [Well, you can do that using](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=273) [something called](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=275) [NSAppearanceCustomization.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=277) [Now, this is a protocol, but](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=279) [it's not a protocol you have to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=281) [go off and adopt in your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=282) [applications.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=283) [It's already adopted by NSView](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=285) [and NSWindow and, in Mojave,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=287) [NSApplication conforms as well.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=290) [It's a pretty simple protocol.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=293) [It just adds two properties.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=294) [First property is appearance and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=296) [this is where you can override](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=298) [this is where you can override](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=298) [the appearance for a particular](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=300) [object.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=301) [Now, it's an optional](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=303) [NSAppearance because, if you set](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=305) [it to nil, the object will](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=307) [simply inherit its appearance](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=309) [from its ancestors.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=310) [There's also effective](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=313) [appearance and this is a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=315) [read-only property that you can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=317) [use to find out what appearance](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=319) [a view will draw with.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=322) [And of course, to use this,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=323) [you'll have to get the right](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=326) [NSAppearance object and you can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=328) [do that pretty easily using the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=330) [NSAppearance named initializer.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=332) [Just pass aqua or darkAqua based](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=334) [on which appearance you want and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=338) [then you can go ahead and just](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=341) [assign that to the appearance](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=342) [property of the object that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=344) [you'd like to customize.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=345) [So, in this case, we'll assign](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=347) [the aqua appearance to the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=349) [appearance property of the text](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=351) [view and now it uses the light](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=352) [appearance.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=354) [All right.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=354) [That was pretty easy, so let's](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=356) [take a look at another case.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=359) [take a look at another case.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=359) [You might have a window that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=362) [kind of hangs off of a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=364) [particular view.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=366) [And you probably want its](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=367) [appearance to match the view it](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=369) [hangs off of.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=371) [Now, we could just assign the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=372) [aqua appearance to this window](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=375) [just like we did to the view,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=376) [but what we really want is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=378) [something a little stronger.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=380) [We want its appearance to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=381) [inherit from the view and we can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=383) [do that-- first of all, AppKit](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=386) [will automatically do this for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=388) [us for a number of common](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=390) [windows, like menus, popovers,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=391) [tool tips, and sheets, so you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=394) [don't have to worry about it in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=396) [those cases.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=397) [But, for custom cases like this,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=399) [there's new API in Mojave that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=401) [you can use to do this.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=403) [It's called Appearance Source.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=406) [Now, this is a property that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=409) [takes any object that conforms](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=411) [to that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=414) [NSAppearanceCustomization](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=414) [protocol-- so, views and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=415) [windows-- and you just assign it](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=417) [windows-- and you just assign it](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=417) [to the appearanceSource property](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=420) [and the window will inherit its](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=424) [appearance from that object.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=426) [So, in this case, we'll assign](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=428) [the text view to the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=431) [appearanceSource property of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=432) [that child window and now it's](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=434) [appearance will always inherit](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=436) [from that view no matter what it](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=438) [is.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=440) [In fact, you should think of the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=442) [appearance system as a sort of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=444) [hierarchy.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=446) [Similar to the view hierarchy](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=447) [you're probably familiar with,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=449) [but extending to windows and the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=451) [application as well.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=452) [And when we ask AppKit for a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=454) [view's effective appearance,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=457) [AppKit will simply walk up this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=459) [hierarchy until it finds an](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=461) [object with a specified](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=463) [appearance and that's the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=465) [appearance we'll use.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=467) [OK.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=469) [So, now that we know how objects](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=470) [get an appearance and how the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=473) [appearance system works, let's](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=474) [talk about how you can use it in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=475) [your custom views and controls.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=477) [Here's an example.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=479) [Here's an example.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=479) [Let's say I wanted this custom](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=480) [header view here to use a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=482) [different color in light and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=484) [dark appearance.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=487) [Now, we already know in Xcode 10](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=489) [I can go into the asset catalog](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=491) [editor and specify specific](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=493) [color assets for light and dark.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=495) [But then how do I use that in my](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=498) [custom view?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=501) [Well, here's one way that seems](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=502) [tempting but won't work and I'll](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=504) [show you why.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=506) [First, we'll add an NSColor](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=508) [property to our view.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=510) [And in init, we'll use that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=512) [color to populate our layer.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=514) [And if the color changes, we'll](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=518) [go ahead and update our layer](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=521) [there too.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=522) [Let's try that out.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=524) [OK. It looks pretty good in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=526) [light, but if we switch to dark,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=528) [we can see our color didn't](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=531) [actually change.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=532) [And that's because even though](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=535) [our NSColor is dynamic, the CG](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=536) [color that we get from it is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=539) [color that we get from it is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=539) [static.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=540) [It won't change for the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=540) [appearance.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=542) [And, since we configured our](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=543) [layer in our initializer, we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=545) [didn't get a chance to run any](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=548) [code when the appearance](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=549) [changed.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=550) [Now, the key takeaway from this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=551) [is you need to do your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=554) [appearance sensitive work in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=555) [specific areas.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=557) [Specifically, the update](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=559) [constraints, layout, draw, and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=561) [update layer methods of NSView.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=563) [Now, AppKit will automatically](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=567) [call these methods as needed](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=569) [when the appearance changes.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=571) [And if you need to trigger them](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=572) [manually, of course you can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=574) [always use the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=575) [needsUpdateConstraints,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=576) [needsLayout, and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=578) [needsDisplayProperties and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=579) [AppKit will automatically call](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=582) [them.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=585) [So, let's go back to our](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=586) [example.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=586) [Instead of overriding init,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=588) [we'll implement updateLayer and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=590) [there we can go ahead and safely](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=593) [populate our layer by asking our](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=597) [NSColor for a CG color.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=599) [NSColor for a CG color.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=599) [And if our color changes,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=601) [instead of updating our layer](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=603) [right there, we'll just set the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=605) [needsDisplay property to true.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=607) [AppKit will come back around](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=609) [automatically and call](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=610) [updateLayer.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=612) [So, let's run it again.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=614) [Still looks good in light.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=616) [And now it uses the correct](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=617) [color in dark just like we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=621) [wanted, so that's great.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=622) [Now, what if we want to do](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=625) [something a little more](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=627) [complicated that might not be](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=628) [expressible just with dynamic](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=629) [colors or images?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=631) [For example, maybe I would like](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=633) [to add this nice white glow](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=635) [behind Chloe's beautiful face](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=638) [here, but only in Dark Mode.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=640) [How would I do that?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=643) [Well, for cases like that, we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=644) [have new API in Mojave that you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=646) [can use to match against your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=649) [view's appearance.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=650) [Let me show you how it works.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=651) [So, in this view, I'll override](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=653) [the layout method and I'll](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=656) [switch on effectiveAppearance](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=658) [switch on effectiveAppearance](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=658) [bestMatch(from:, I'll pass an](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=661) [array with all of the appearance](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=665) [names that my view happens to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=666) [know about.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=668) [In this case, aqua and darkAqua.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=668) [Then it's just a matter of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=671) [implementing behavior for each](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=674) [of those appearances.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=676) [So, for the aqua appearance,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=677) [I'll simply use my imageView](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=679) [with Chloe's face as a subview.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=681) [And for darkAqua, I'll not only](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=684) [use that imageView, but I'll](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=687) [also through my glowView behind](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=688) [it.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=691) [Finally, I'll implement a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=693) [default case and this is for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=695) [appearances my view doesn't know](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=698) [about and that includes](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=700) [potential appearances Apple](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=701) [might come out with in the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=703) [future.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=704) [OK.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=705) [Let's take a look at what it](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=706) [looks like.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=707) [So, there it is in light, no](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=708) [glow, that's what we wanted.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=710) [Switch to dark and we have that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=712) [glow.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=714) [That's great.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=715) [All right.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=716) [Let's talk for a minute about](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=718) [high contrast.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=719) [high contrast.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=719) [So, I said before that we've](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=721) [been using NSAppearance for the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=722) [high contrast mode of macOS.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=725) [And one of the nice side effects](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=728) [of doing all this work to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=730) [support Dark Mode is it makes it](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=731) [really easy to support high](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=732) [contrast really well as well.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=734) [As a reminder, high contrast is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=739) [enabled through the increase](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=741) [contrast checkbox in system](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=743) [preferences.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=744) [And in this mode, colors are](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=746) [changed so that control bounds](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=749) [and other kinds of boundaries](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=751) [are more easy to see.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=752) [Now, in this mode, AppKit](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=756) [automatically replaces the aqua](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=758) [and darkAqua appearances with](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=761) [high contrast counterparts.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=763) [Now, these high contrast](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=765) [appearances inherit from their](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=766) [normal contrast versions.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=768) [So, what that means is any code](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=770) [you've written to take advantage](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=773) [of Dark Mode will automatically](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=774) [apply in high contrast Dark](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=776) [Mode.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=778) [But you can go even further.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=780) [In Xcode 10, if you check this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=782) [high contrast checkbox in the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=784) [asset catalog editor, it'll](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=786) [allow you to specify color and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=788) [image assets specifically for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=790) [the high contrast versions of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=793) [the appearances.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=795) [Now, you can also use those](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=797) [appearance names in code.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=800) [You might be temped to think,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=801) [well, great, I'll just pass them](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=804) [to NSAppearance themed and I'll](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=806) [get the NSAppearance object and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=807) [I'll do something with that, but](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=809) [that won't work.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=811) [Those appearances are only](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=812) [available through system](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=814) [preferences.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=815) [But what you can do is pass them](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=816) [to bestMatch(from:) just like we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=819) [did before for Dark Mode to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=821) [implement custom programmatic](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=822) [behavior.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=824) [OK.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=828) [Let's talk for a minute about](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=828) [sublayers.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=829) [I know a lot of you out there](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=831) [have views that manage their own](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=832) [sublayers and there are](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=834) [important things to be aware of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=836) [for Dark Mode.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=838) [Primarily, you need to know that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=841) [custom sublayers will not](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=843) [inherit your view's appearance](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=845) [automatically.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=847) [Now, the easiest fix for this is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=848) [to switch them from being](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=852) [sublayers to subviews.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=853) [If you do that, AppKit will](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=855) [automatically handle the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=857) [appearance inheritance for those](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=859) [views, just like any other view.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=862) [Otherwise, you'll have to manage](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=865) [those layers manually using a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=867) [couple techniques that I'll talk](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=869) [about now, viewDidChange](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=870) [EffectiveAppearance and the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=871) [concept of the current](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=873) [appearance.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=875) [So, first viewDidChange](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=876) [EffectiveAppearance.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=879) [This is a new method on NSView](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=881) [that you can override to find](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=884) [out when your view's effective](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=887) [appearance changes.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=888) [Now, this is a good time to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=891) [perform any custom invalidation](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=892) [you might need to do or drop any](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=893) [caches that are no longer](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=896) [relevant.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=897) [But remember you don't need to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=898) [But remember you don't need to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=898) [invalidate the view itself here,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=900) [AppKit will do that for you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=902) [automatically.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=903) [Second, the concept of the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=907) [current appearance.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=908) [Now, this is a thread local](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=910) [variable that you can access](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=912) [through a class property on](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=914) [NSAppearance.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=916) [If you're familiar with concepts](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=917) [like the current NSGraphics](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=920) [context or the current](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=921) [NSProgress, you already know](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=922) [what I'm talking about.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=924) [If not, just remember that this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=925) [is the appearance used to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=927) [resolve dynamic colors and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=929) [images.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=932) [AppKit will set up the current](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=934) [appearance automatically for you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=935) [before we call any of those](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=937) [special NSView methods we talked](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=939) [about before, like](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=940) [updateConstraints, layout, draw,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=941) [and updateLayer, but you can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=944) [also set it up yourself where](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=947) [necessary and let's take a look](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=949) [at an example why you might do](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=950) [that.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=951) [So, here's a custom that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=955) [maintains some sublayers.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=957) [I'll override this new](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=960) [viewDidChange](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=962) [EffectiveAppearance method and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=963) [I'll set my sublayer](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=965) [needsDisplay.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=967) [Now, if I didn't do this, my](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=968) [sublayer wouldn't update when my](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=970) [view's effective appearance](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=972) [changed.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=973) [It would just stay the same.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=974) [And then in my layer delegate](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=975) [routine, I'll save off the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=979) [current appearance for later and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=981) [then I'll go ahead and set the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=982) [current appearance to my view's](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=984) [effective appearance.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=986) [Then I can go ahead and update](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=987) [my layer.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=991) [Now, if I hadn't set the current](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=992) [appearance before this, this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=994) [code wouldn't be using my view's](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=996) [appearance and so it would end](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=998) [up looking wrong.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=999) [Finally, when I'm done, I'll](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1001) [just restore the old current](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1002) [appearance.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1004) [Here's another thing to be aware](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1008) [of if you're managing layers.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1009) [You might have code that looks](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1012) [like one of these two examples.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1014) [Either you're setting the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1016) [contents of a layer to an](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1017) [NSImage or you're using the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1019) [NSImage or you're using the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1019) [layer contents for content scale](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1021) [API to create layer contents](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1024) [from an image for your layer.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1026) [If you have code like this, you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1029) [should know that the image will](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1031) [not automatically inherit the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1032) [appearance.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1034) [As before, the best fix is to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1035) [switch to views.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1039) [In this case, NSImageView.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1040) [NSImageView will take care of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1042) [this detail as well as a bunch](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1043) [of others automatically, so do](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1045) [that if you can.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1048) [Otherwise, you'll need to create](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1050) [a CGImage from your NSImage for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1052) [your layer.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1055) [And you'll do that using the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1056) [cgImage(forProposedRect:,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1057) [context:, hints: API on NSImage.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1060) [And you'll have to be careful to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1064) [do this at a point where the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1066) [current appearance is correct.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1067) [So, a good place to do it is in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1069) [your updateLayer method.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1071) [All right, so that's appearance.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1072) [Now let's talk about materials.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1076) [Now, you've probably heard that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1077) [Now, you've probably heard that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1077) [materials are one of the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1080) [building blocks of the modern](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1082) [Mac UI, but you may have](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1084) [wondered to yourself, well, what](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1086) [exactly is a material, so let's](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1087) [start with a definition.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1089) [Materials are dynamic](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1091) [backgrounds that make use of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1093) [effects like blurs, gradient,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1095) [tinting, translucency, and they](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1098) [provide a sense of depth or](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1101) [context to your UI, as well as](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1104) [just a bit of added beauty.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1106) [Here's a pretty typical Mac](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1108) [desktop and you can see all the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1111) [different places where we're](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1113) [using these material effects--](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1115) [actually, this isn't even all of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1116) [them.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1117) [Now, AppKit automatically](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1121) [provides materials in a number](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1122) [of common places, like the title](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1124) [bars and backgrounds of windows,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1127) [table views, sidebars, popovers,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1129) [menus, and even other places as](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1132) [well.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1136) [But you can create a material](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1136) [yourself and add it to your UI](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1138) [yourself and add it to your UI](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1138) [using a view called](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1141) [NSVisualEffectView.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1142) [If you're not familiar with](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1144) [NSVisualEffectView, quite](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1145) [simply, it's a view that shows a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1147) [material.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1149) [And if you want to use one,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1150) [you'll need to be aware of three](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1152) [main properties that you'll have](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1154) [to set up and I'll go through](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1155) [these in order.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1157) [The state, blendingMode, and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1157) [material properties.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1159) [So, first, the state property.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1163) [This controls whether the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1164) [material uses the active window](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1167) [look.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1169) [Now, by default, the material](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1170) [will just match its containing](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1171) [window and so when that window](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1173) [is active it'll look active.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1174) [When the window's inactive, the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1176) [material will look inactive.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1177) [But you can also specify this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1179) [specifically to be active or](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1182) [inactive if you'd like to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1184) [control it manually.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1186) [Second, the blendingMode](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1189) [property.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1190) [This property controls whether](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1191) [the material punches through the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1193) [back of the window.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1195) [Let me show you what I mean by](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1196) [that.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1197) [Here's a preview using two](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1199) [Here's a preview using two](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1199) [different materials.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1202) [For one, this title bar](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1204) [material, if we peel it back, we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1206) [can see that it's blending the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1209) [contents within the window,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1210) [including that color image](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1212) [there.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1213) [So, it's not punching through](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1214) [the back of the window.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1216) [There's also the sidebar](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1219) [material and if we peel it back](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1220) [we can see it's blurring the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1223) [contents behind the window, so](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1224) [it's punching through the back](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1226) [so it can see to the windows](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1228) [behind it as well as the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1229) [desktop.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1232) [So, by default, a visual effect](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1240) [view will be in behind window](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1242) [mode, but you can control that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1243) [using the blendingMode property.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1246) [Finally, the material property.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1248) [This property encapsulates the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1252) [material effect definition.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1253) [What do I mean by that?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1256) [That means the exact recipe of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1258) [That means the exact recipe of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1258) [blur, translucency, gradience,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1260) [tinting-- that all depends on](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1263) [the material property.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1265) [Now, when we first started using](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1267) [materials in Yosemite, we had](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1268) [two main materials, the light](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1271) [and dark materials, and those](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1272) [served us really well at the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1274) [time, but since then we've](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1275) [really expanded our use of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1278) [materials across the system.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1279) [And now with Dark Mode, it no](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1282) [longer really makes sense to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1283) [specify a material just as light](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1284) [or dark.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1287) [Instead, we have something](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1288) [called semantic materials.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1289) [Now, if you're familiar with](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1292) [semantic colors, you know that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1293) [they're named after where](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1296) [they're used, not necessarily](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1297) [what they look like.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1299) [Same thing for semantic](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1301) [materials.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1302) [The menu material, for example,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1304) [will always look like system](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1306) [contextual menus, regardless of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1307) [light versus dark.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1309) [And in Mojave, we're introducing](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1311) [a bunch more semantic materials](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1315) [so that you can always use the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1318) [right one for your specific use](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1319) [right one for your specific use](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1319) [case.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1322) [In fact, these semantic](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1322) [materials are now our preferred](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1326) [way of using materials and we're](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1328) [deprecating these non-semantic](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1330) [materials like light, dark,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1332) [medium light, and ultra dark.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1335) [If you're using one of these](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1337) [materials, now is a great time](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1339) [to go ahead and switch over to a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1341) [semantic material that's right](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1343) [for your use case.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1344) [Just to give you an idea of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1349) [where we're using these semantic](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1350) [materials across the system,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1352) [here's the Finder using the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1354) [title bar and sidebar materials.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1355) [Here's Mail using the header](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1359) [view and content background](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1361) [materials.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1362) [Here's our Chameleon Wrangler](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1365) [app using the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1367) [underPageBackground material.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1368) [And here's system preferences](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1370) [using the window background](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1374) [material.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1375) [Now, of course this window](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1377) [background material, as you've](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1378) [probably heard, is one of these](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1379) [probably heard, is one of these](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1379) [special desktop-tinted materials](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1380) [new in Mojave.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1383) [And the way these work is they](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1384) [pick up a slight tint from the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1386) [desktop picture based on the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1389) [window's location onscreen.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1391) [And the idea here is to help](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1393) [your window blend in with the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1394) [windows on the rest of the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1396) [system.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1397) [Again, the easiest way to get](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1398) [one of these desktop-tinted](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1404) [materials is to use the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1405) [automatic support in NSWindow,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1406) [NSScrollView, NSTableView, and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1409) [NSCollectionView.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1410) [The default configurations of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1412) [these objects will come with](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1413) [this desktop-tinted effect.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1415) [You can also configure NSBox to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1417) [get these materials by setting](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1422) [its type to custom and selecting](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1425) [one of these fill colors.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1428) [It'll use the corresponding](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1430) [NSVisualEffectView material.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1431) [Here's an example.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1434) [I'll set my box's type to custom](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1436) [and then I'll set its fillColor](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1439) [and then I'll set its fillColor](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1439) [to the underPageBackgroundColor.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1440) [Of course, I can also use](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1443) [NSVisualEffectView, I can set](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1445) [it's material property to the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1446) [underPageBackground material.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1448) [Now, the advantage of using](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1450) [NSBox is it's back-deployable](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1451) [actually all the way back to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1453) [Leopard.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1455) [VisualEffectView, on the other](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1457) [hand, gives you a little more](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1458) [flexibility and I'll give you an](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1459) [example of that later.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1461) [So, just as a reminder, these](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1462) [materials will show their](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1466) [untinted color in light.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1468) [And in dark, they'll show that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1471) [desktop-tinting effect.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1473) [But remember that the tint](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1475) [effect can be disabled.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1477) [Let me show you why.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1479) [So, in Mojave, you can choose an](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1480) [accent color for the system.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1485) [And if I switch this over to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1487) [graphite, you'll probably first](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1492) [notice that all the controls](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1495) [lost their colored accents, but](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1496) [those desktop-tinted materials](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1500) [also lost their tint.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1501) [So, just make sure you're not](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1504) [depending on that tint being](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1506) [there in any way.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1507) [Now, VisualEffectView by default](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1512) [will show its material in its](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1516) [frame rectangle like this.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1518) [And that's pretty great, but](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1519) [what if I wanted to show a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1521) [custom UI element with this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1523) [material, like say a chat](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1524) [bubble.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1526) [How would I do that?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1527) [Well, here's one way that seems](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1529) [tempting, but won't work, and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1532) [I'll show you why.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1533) [We'll first implement the draw](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1535) [method on NSView and then I'll](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1538) [go get my custom chat bubble](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1542) [BezierPath.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1544) [And then I'll fill with the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1545) [controlBackgroundColor in that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1548) [path.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1552) [Now, if you do that, you'll find](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1553) [it looks something like this and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1554) [it looks pretty good, but if we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1556) [zoom in closely, you'll see that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1558) [zoom in closely, you'll see that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1558) [the bubbles are not getting that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1561) [desktop-tinting effect that we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1562) [want.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1564) [It's just a plain gray.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1564) [So, what went wrong?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1567) [Well, this effect is provided by](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1569) [the Quartz window server like a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1571) [lot of our other material](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1573) [effects.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1574) [And what this means is it](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1575) [updates asynchronously from your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1576) [application and this is great](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1579) [for performance, but it also](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1580) [means that you can't directly](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1583) [draw with that color or get it's](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1585) [RGB values.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1587) [Instead, you can use the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1589) [maskImage property of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1591) [VisualEffectView to do something](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1593) [very similar.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1595) [maskImage is an optional NSImage](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1597) [on VisualEffectView that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1600) [VisualEffectView will use to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1604) [mask its material, the material](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1605) [that it shows.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1607) [And in addition to using](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1609) [standard art-based images, you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1610) [can use drawing handler images](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1613) [to simulate drawing with the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1615) [material.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1616) [Let me show you an example.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1616) [So, I'll go back to my view,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1620) [I'll override layout, and I'll](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1621) [go ahead and add a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1624) [VisualEffectView.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1625) [I'll set its material to the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1627) [contentBackground material, and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1629) [then I'll create a drawing](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1632) [handler image using the NSImage](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1634) [size flipped initializer that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1637) [takes a block.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1639) [In it, I'll set the white](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1642) [color-- this color doesn't](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1644) [really matter as long as its](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1645) [opaque.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1647) [And then I'll go ahead and fill](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1647) [with my path.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1649) [Then I'll set that image ask the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1652) [maskImage on my](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1654) [VisualEffectView.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1656) [All right.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1657) [Let's look at it now.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1659) [Looks a lot better.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1661) [It's desktop-tinted.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1663) [And, if we look side by side, we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1665) [can really see the difference.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1667) [So, this technique works with](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1671) [any material, but just remember](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1673) [that only the alpha channel of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1675) [the image is used for the mask.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1677) [This is similar to template](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1678) [images.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1679) [images.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1679) [And the mask only masks the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1681) [material, not any subviews or](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1683) [other descendent views of the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1686) [VisualEffectView.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1687) [A common technique is to provide](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1690) [a resizable image for this-- for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1692) [the maskImage using the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1695) [capInsets and resizingMode](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1696) [properties of NSImage.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1698) [And this is really good for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1700) [performance.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1702) [OK.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1704) [With that, I'll hand it off to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1704) [Jeff, who is going to talk about](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1705) [vibrant blending.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1706) [[ Applause ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1708) [Jeff.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1710) [&gt;&gt; All right.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1713) [Thank you, Matt.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1713) [So, now that we've had a look at](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1715) [our great materials, I want to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1716) [cover the things that we draw in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1718) [front of those materials,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1719) [particularly the materials that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1721) [we use that pull in part of the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1722) [background and provide that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1724) [really awesome blur effect.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1726) [So, if we revisit our Chameleon](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1728) [Wrangler application, we have](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1731) [this UI here, it's our](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1732) [mood-o-meter.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1733) [It's where we go to record how](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1734) [our various reptiles are](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1736) [feeling.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1737) [And it's in a popover, which](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1738) [And it's in a popover, which](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1738) [means that it's automatically](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1740) [getting that awesome popover](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1741) [material backing.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1743) [And what we want when we're](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1745) [drawing over this backing](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1747) [material is for our content to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1748) [really stand out on top of that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1750) [varied background.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1752) [Something like this.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1753) [And we do that with an effect](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1755) [that we call vibrancy.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1756) [So, what is vibrancy?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1758) [It's a blending mode that we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1760) [apply to the content that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1762) [uniformly lightens or darkens](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1764) [the content behind it.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1766) [It's very similar to a color](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1768) [dodge or burn that you might](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1770) [have seen in your favorite photo](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1771) [editor or design tool.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1772) [But let's take a closer look.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1774) [Here we have a glyph that's](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1776) [drawing in about a medium gray,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1778) [about a 50% gray, but at 100%](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1779) [opacity.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1782) [And when we apply the vibrant](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1784) [blending effect that we use](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1785) [against dark materials, which we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1787) [call a lightening effect, we can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1788) [see that it's not that the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1791) [opacity has dropped on our](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1793) [glyph, but we're actually](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1794) [lightening the content behind it](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1795) [using the lightness of that gray](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1798) [value.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1799) [And in fact, when we look at how](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1799) [And in fact, when we look at how](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1799) [this works on a range of gray](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1803) [values-- here we have swatches](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1804) [going from 0% to 100% gray, all](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1806) [totally opaque.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1808) [When we apply our lightening](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1810) [effect, we can see a number of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1811) [interesting things have](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1812) [happened.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1814) [Down on the bottom right side,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1815) [we have 100% light, and because](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1816) [we have added the lightness of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1819) [white to the content behind, it](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1820) [just remains white.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1823) [There is nowhere further to go.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1824) [But on the top left where we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1826) [were drawing black, there was no](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1827) [lightness to add, which means](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1829) [that it completely disappears.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1831) [In fact, you wouldn't be able to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1833) [see it if I didn't have an](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1833) [outline there.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1834) [And in-between we can see that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1835) [we have varying degrees of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1837) [lightening which we can use to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1839) [establish a hierarchy of content](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1840) [in our application.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1842) [But where does this effect come](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1844) [from?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1845) [Well, it's our old friend](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1847) [NSAppearance, it turns out.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1848) [We have two special vibrant](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1850) [NSAppearance objects,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1852) [vibrantDark and vibrantLight and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1853) [these are a complete package.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1857) [Not only do they include the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1858) [Not only do they include the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1858) [exact formula that we use for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1860) [that lightening or darkening](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1861) [effect, but they also have a set](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1863) [of control artwork and color](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1865) [definitions that have been](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1866) [designed to work great with that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1867) [blend mode.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1869) [But how does your code use it?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1870) [Well, it's very simple.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1874) [In your NSView subclass, you can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1876) [override the allowsVibrancy](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1878) [property to return true and the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1879) [blending effect is going to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1882) [automatically apply to your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1883) [views drawing and also the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1884) [drawing of all of its](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1885) [descendants.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1887) [Typically, when you're drawing](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1889) [in this vibrant context, you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1891) [want to use one of the built-in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1893) [label colors, depending on the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1894) [prominence of your content.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1895) [Both vibrantDark and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1897) [vibrantLight have great](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1898) [definitions for all four of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1899) [these colors that allow you to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1901) [establish that nice hierarchy.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1902) [However, you don't have to use](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1905) [these colors.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1906) [You can use any color that you'd](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1907) [like, but we prefer to use](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1908) [non-grayscale colors.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1910) [Avoid non-grayscale colors](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1912) [because, if you use them, the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1913) [blending effect is going to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1916) [impact the design intent of your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1917) [color and it's going to wash it](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1919) [color and it's going to wash it](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1919) [out in a way that is not](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1920) [desirable.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1921) [I'll show you an example of that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1923) [later.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1924) [So, revisiting our application,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1926) [we can go ahead and override](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1929) [allowsVibrancy on our view and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1931) [in this case we're going to just](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1933) [set it on the view that contains](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1934) [our entire meter in the entire](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1935) [popover.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1938) [And let's see what that looks](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1939) [like.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1940) [Well, our slider looks pretty](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1941) [good.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1943) [It's exactly what we expected.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1944) [But what happened to the faces?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1945) [They're all washed out.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1948) [And what happened here is that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1950) [when we set allowsVibrancy on](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1952) [the overall meter view, not only](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1954) [are we getting the vibrant](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1956) [blending on that view, but also](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1957) [both of these subviews.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1959) [And the fix here is pretty](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1962) [simple.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1963) [If we localize our definition of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1964) [allowsVibrancy to just the part](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1965) [that's drawing the slider, we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1967) [get exactly what we expected.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1969) [Our slider is drawing vibrantly](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1970) [and the colors in our face](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1972) [buttons look exactly the way](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1973) [that we wanted.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1975) [When you're drawing vibrantly,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1977) [typically you'd want to apply](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1978) [vibrancy to only the leaf views](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1979) [vibrancy to only the leaf views](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1979) [that are drawing the content](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1981) [that you actually want to have](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1983) [vibrant.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1984) [And, if you have views that are](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1985) [drawing a mix of content, that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1986) [means that you probably want to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1988) [break your drawing out into](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1989) [separate sibling views that you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1990) [can use to apply vibrancy at the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1992) [granularity that you want.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1994) [Further, you should avoid](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1997) [overlapping vibrant and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=1999) [non-vibrant views.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2000) [If you do this, the blending](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2002) [modes can clash and you might](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2004) [find that some of your content](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2006) [is drawing with a blend mode](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2007) [that it didn't expect.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2009) [Further, don't subclass Cocoa](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2011) [controls just to override](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2013) [allowsVibrancy.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2014) [I mentioned earlier that the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2016) [vibrantLight and vibrantDark](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2017) [appearances have been designed](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2018) [with control artwork and colors](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2020) [that were designed specially for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2021) [the blend mode and if you remove](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2023) [that blend mode, the contrast on](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2025) [that artwork is not going to be](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2027) [what you expected because we're](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2028) [using the blend mode to provide](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2029) [a lot of that pop against the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2031) [material, so you should only](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2032) [override allows vibrancy if](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2034) [you're actually overriding](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2036) [drawing and you know what](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2037) [vibrant blend mode or](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2038) [vibrant blend mode or](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2038) [non-vibrant blend mode is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2040) [appropriate for the drawing that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2041) [you're doing.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2042) [That's vibrancy.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2043) [Next, I want to talk a little](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2045) [bit about background styles,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2046) [specifically the ones that we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2047) [use for selections.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2049) [So, here we have a pretty](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2051) [typical situation in a aqua](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2052) [Cocoa application.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2054) [In this case, it's a message](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2056) [from the Mail application and we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2058) [can see that when we have a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2060) [selection state, we need our](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2062) [content inside of this table row](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2063) [to invert to look good against](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2066) [that blue selection.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2068) [But when we add darkAqua into](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2070) [the mix, we can see that we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2072) [can't just naively invert our](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2076) [content anymore.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2077) [That's not going to work](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2078) [uniformly.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2079) [And so we need to describe these](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2080) [states semantically.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2081) [Now, if you're familiar with](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2083) [Cocoa, you've probably seen the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2085) [NSView.BackgroundStyle enum and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2088) [that includes a couple of cases,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2090) [including light and dark, and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2091) [NSTableView sets this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2094) [automatically on the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2094) [TableRowView, TableCellView, and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2096) [also all of the controls that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2098) [also all of the controls that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2098) [are immediate subviews of your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2100) [TableCellView.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2101) [Now, traditionally, we have set](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2103) [the light background style on](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2105) [unselected rows and the dark](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2107) [background style on selected](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2109) [ones.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2110) [But, in the face of this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2111) [brand-new, beautiful theme where](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2113) [the background is effectively](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2115) [always dark, these names don't](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2116) [make sense anymore and so we've](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2118) [renamed them to normal and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2120) [emphasized, respectively.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2122) [And these are just more semantic](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2124) [descriptions that better match](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2125) [the way that these enum cases](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2127) [are used in a modern Cocoa](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2129) [application.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2130) [We also have some additional](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2132) [updates with background styles,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2133) [including that TableView will](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2135) [now automatically set that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2137) [background style recursively on](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2138) [all of the controls in your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2140) [table row, not just the ones](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2141) [that are immediate subviews of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2143) [your CellView.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2144) [And so, if you've been catching](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2146) [that background style and trying](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2146) [to forward it along to all these](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2148) [subviews because you wanted to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2149) [use a stacked view or something](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2151) [for layout, you no longer have](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2152) [to do that on Mojave.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2153) [That's the applause of somebody](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2156) [who's done this manually.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2158) [Thank you, I agree.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2159) [Further, all four of our label](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2161) [colors now automatically adapt](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2163) [to the background style, which](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2165) [means that you can just set up](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2167) [your content hierarchy once,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2168) [describe it semantically, and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2170) [it's going to look great in both](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2171) [of these contexts.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2172) [You can also use these](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2174) [emphasized variants manually and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2177) [I'll give you an example.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2178) [So, here we have something that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2179) [looks a little bit like the icon](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2180) [view in Finder.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2182) [And we've got two labels that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2183) [are ascribed with label color](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2185) [and secondary label color.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2186) [And we want to draw a custom](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2188) [selection behind them, so we've](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2190) [got this custom Bezier](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2191) [path-based selection, maybe](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2192) [we're filling it with alternate](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2193) [selected control color, and we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2194) [want our labels to match the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2196) [primary and secondary variants](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2200) [in this emphasized style.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2202) [And to get that is very simple.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2204) [All we have to do is set the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2206) [background style to emphasized](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2207) [on both of our text fields and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2209) [they're automatically going to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2210) [provide this nice emphasized](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2211) [variant.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2212) [And the great thing is that now](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2213) [that we've described it this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2215) [way, when we switch into Dark](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2216) [Mode, everything just works.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2218) [Mode, everything just works.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2218) [We don't have to do anything](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2220) [special to support that.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2221) [One final note on selections.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2224) [The selection material that you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2226) [commonly see in sidebars, menus,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2228) [and popovers now follows the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2230) [accent color preference on](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2233) [Mojave.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2235) [And what that means is that if](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2236) [you're drawing a custom blue](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2237) [selection, it's not going to fit](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2238) [in.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2240) [Instead, you should use](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2241) [NSVisualEffectView.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2242) [It has a special selection](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2243) [material just for this and when](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2244) [you use this it's going to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2246) [automatically follow the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2247) [preference, as you expect.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2248) [Now, before I get into the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2253) [exciting part, the tips and the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2255) [tricks, I want to say a couple](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2256) [of words about backward](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2258) [deployment because we know that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2259) [many of you, especially on the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2260) [Mac, like to deploy your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2262) [applications back to previous](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2263) [releases of macOS and it was](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2265) [important to us to make sure](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2267) [that you could adopt Dark Mode](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2268) [without necessarily compromising](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2269) [on your backward deployment.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2271) [And so I'm going to step through](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2272) [a couple of APIs and just](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2275) [examine them for backward](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2276) [deployment, starting with system](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2277) [colors.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2278) [So, here's a sampling of the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2279) [So, here's a sampling of the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2279) [system colors that we support](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2280) [that are dynamic for the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2282) [appearance.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2283) [And what I want to highlight](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2284) [here is that the ones](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2285) [highlighted in green have been](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2286) [available since at least 10.10](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2287) [Yosemite, many of them actually](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2290) [far further back.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2292) [And that means that we think](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2292) [that you have a great vocabulary](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2295) [of colors available to you to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2297) [describe more or less any UI](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2298) [that you'd like and that all](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2300) [supports backward deployment out](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2302) [of the box.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2303) [For custom colors, our modern](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2306) [preferred solution for defining](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2308) [them is asset catalogs and these](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2309) [are available back to 10.13.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2312) [Now, when you do specify dark](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2315) [variants for any of your assets,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2317) [when you back deploy them, those](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2319) [dark variants are safely ignored](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2321) [on previous versions of the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2322) [operating system, so that's a--](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2323) [that's a solution that has](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2325) [backward deployment built right](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2327) [in.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2328) [But if you want to deploy back](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2329) [further than 10.13, you can use](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2330) [a technique like this where you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2332) [write a custom color property.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2335) [And here we just encapsulate the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2337) [availability check to use our](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2339) [availability check to use our](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2339) [asset catalog color on operating](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2341) [systems that support it and then](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2342) [we can go ahead and put in a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2344) [hardcoded fallback color for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2345) [those older operating systems.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2347) [Desktop-tinted materials is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2349) [another great new thing in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2353) [Mojave and if you want to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2353) [address those materials directly](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2356) [with VisualEffectView, of course](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2357) [that's only available starting](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2359) [in 10.14, but we've been](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2360) [providing-- but we have classes](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2363) [that are providing these](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2364) [materials automatically,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2365) [including Window, ScrollView,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2366) [and TableView, which have been](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2368) [available since essentially the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2369) [beginning of time.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2371) [In fact, some of these predate](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2372) [macOS 10.0.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2374) [And so, if you configure them](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2375) [correctly, they're going to on](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2377) [previous operating systems show](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2380) [that special NSColor which looks](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2381) [exactly the way that you would](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2383) [expect in previous versions and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2384) [then when you run it on Mojave](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2386) [you're going to get that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2388) [material automatically.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2388) [And of course NSBox, the custom](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2390) [style that allows you to set a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2392) [fill color, deploys back to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2393) [Leopard 10.5 and so does](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2396) [NSCollectionView.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2398) [And this works whether you're](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2399) [And this works whether you're](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2399) [using the legacy](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2400) [NSCollectionView API or the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2401) [modern one, although we'd prefer](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2403) [that you use the modern one.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2405) [Finally, enabling Dark Mode is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2408) [generally gated on linking](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2412) [against the 10.14 SDK, but, as](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2414) [you can see, really, the tools](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2417) [that you need to develop a great](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2419) [Dark Mode application aren't](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2421) [necessarily specific to the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2423) [10.14 SDK and you could have](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2424) [developed one just using the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2426) [10.13 SDK that you have today.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2428) [And so, if you have a situation](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2431) [where you can't necessarily](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2433) [update your SDK, we have an](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2434) [Info.plist key that you can use](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2436) [to opt-in to Dark Mode.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2438) [It's called](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2439) [NSRequiresAquaSystemAppearance](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2440) [and if you set that to NO](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2442) [explicitly, then that's going to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2443) [enable Dark Mode even if you're](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2445) [linking on an earlier SDK,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2446) [although we very strongly prefer](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2448) [that you update your SDK.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2450) [It's a far better solution.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2451) [You can also set this key to YES](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2453) [to disable it temporarily-- and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2455) [I want to emphasize temporarily.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2457) [This is a key that you can use](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2459) [This is a key that you can use](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2459) [to give yourself time to really](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2460) [build a great polished update](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2461) [for supporting Dark Mode.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2463) [Finally, some tips and tricks.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2467) [First of all, when you're](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2471) [updating your application, one](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2473) [of the greatest things that you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2475) [can do is just audit your use of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2476) [NSColor just by searching](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2477) [through your code base and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2480) [seeing where you're using it.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2481) [And you're going to find a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2483) [couple situations that you can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2484) [use to upgrade to make your Dark](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2485) [Mode experience a lot better.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2487) [And so, for example here, we can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2488) [find places where we're using](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2490) [named colors that are not](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2491) [dynamic and also colors that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2493) [have hardcoded components.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2494) [And when we encounter these](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2496) [kinds of situations, we can look](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2497) [at these and decide one of two](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2499) [things.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2501) [One, maybe there is a built-in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2502) [system color that describes what](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2504) [I'm going for and is fully](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2506) [dynamic for the appearance.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2507) [Or, two, this is a custom color](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2509) [that I think is really important](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2511) [to be specific to my](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2513) [application.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2513) [And so the first case is pretty](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2515) [straightforward.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2516) [We were using black color for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2517) [this label and we can just](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2518) [switch that to labelColor and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2519) [switch that to labelColor and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2519) [that's going to be fully dynamic](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2520) [and do what we expect.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2522) [But in the second case, we might](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2523) [decide that this color is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2525) [actually really special to our](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2526) [app and that's a really great](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2527) [candidate for moving into the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2529) [asset catalog.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2530) [Not only does this clean up our](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2532) [code because we get all of these](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2533) [magic numbers out of our code](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2535) [and into a data-driven source,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2536) [but we can also then set a dark](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2538) [variant for that color and so we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2540) [get great Dark Mode support](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2542) [built in.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2544) [Another common source of issues](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2548) [is offscreen drawing.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2549) [To do offscreen drawing, you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2551) [have to make sure that you're](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2553) [being sensitive to the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2554) [appearance and also other](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2555) [drawing conditions.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2556) [One really common case of this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2558) [is using the NSImage lockFocus](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2559) [API to try and draw custom](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2561) [NSImages.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2563) [In this case, we're going to go](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2565) [ahead and try and draw this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2566) [badged image where we have a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2568) [base image and we're applying a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2569) [badge because something new is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2570) [happening with our lizard.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2572) [And, in this case, we're](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2573) [creating an NSImage, calling](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2575) [lockFocus on it, and then doing](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2577) [our drawing.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2579) [And the problem with this is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2580) [that once we've used lockFocus,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2582) [we lose a lot of the semantics.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2584) [We just have a single bitmap](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2585) [representation.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2587) [And so if the appearance changes](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2588) [or if many other conditions](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2590) [change, including say the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2592) [backing scale factor because](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2593) [you've moved your window from a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2594) [Retina display to a non-Retina](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2595) [display, suddenly this drawing](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2596) [is going to be stale.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2598) [So, a better solution is to use](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2600) [the block-based image-- image](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2602) [initializer, NSImage size](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2604) [flipped drawing handler.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2607) [And we can just do the exact](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2609) [same drawing that we were doing](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2611) [before, but inside of this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2612) [block.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2614) [And when you assign this kind of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2614) [image to an NSImageView, you're](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2616) [automatically going to have this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2618) [block rerun when the appearance](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2619) [changes, scale factor changes,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2621) [color gamut changes-- anything](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2623) [changes, essentially.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2625) [And so that's great news because](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2626) [if our, say, badge fill color is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2628) [a dynamic color, it's going to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2629) [always resolve against the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2631) [correct appearance.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2632) [There are a couple of other ways](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2634) [that you might be doing](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2635) [offscreen drawing.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2636) [You might be making custom](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2637) [bitmap graphics contexts using](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2639) [bitmap graphics contexts using](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2639) [NSGraphicsContext or](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2640) [CGBitmapContext.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2642) [And, depending on what you're](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2643) [doing, these might also be great](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2644) [candidates for replacing with a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2646) [block-based NSImage.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2647) [Further, if you're using the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2649) [NSView cacheDisplay in Rect](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2651) [method to cache your image to a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2653) [bitmap rep, just be aware that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2655) [this method is not going to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2658) [capture some of our more](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2659) [advanced rendering techniques](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2661) [like materials and blurs and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2662) [it's also just another way that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2665) [you can produce drawing that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2666) [goes stale when the appearance](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2667) [changes, so be aware of that.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2668) [Here's another situation that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2673) [you might find yourself running](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2674) [into.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2675) [If you have an](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2676) [NSAttributedString or](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2677) [NSTextStorage and you're](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2678) [manipulating those attributes](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2680) [manually-- say I am in this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2682) [case, I've just set my](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2684) [attributes to just be a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2684) [dictionary with a font in it--](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2686) [you might find that this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2688) [happens.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2688) [Your text is drawing black even](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2689) [when you switch into Dark Mode](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2691) [and what has happened here?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2692) [Well, we're missing a foreground](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2694) [color attribute and when the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2696) [text drawing engine encounters a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2698) [text drawing engine encounters a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2698) [range of attributed strings that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2700) [doesn't have a foreground](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2702) [attribute, it defaults to black.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2702) [And this is what it has always](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2704) [defaulted to and it's going to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2706) [continue to be the default for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2708) [compatibility.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2709) [So, one way to fix this is to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2711) [set a foreground color](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2712) [explicitly to one of our dynamic](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2713) [system colors, and that's going](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2715) [to do what you expect.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2717) [But a better alternative is that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2719) [if you're doing manual](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2721) [attributed string drawing, you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2722) [should switch to a Cocoa](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2724) [control, like an NSTextField,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2725) [which does this for you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2727) [automatically, or, if you're](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2728) [manipulating the storage of a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2730) [textView, we have new API called](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2732) [performValidatedReplacement on](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2736) [textView that does a nice thing](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2738) [for you.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2740) [If you go ahead and replace a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2740) [string with an attributed string](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2743) [in your textView, it will fill](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2745) [in any missing attributes with](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2747) [the typing attributes from the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2750) [textView, so that way you can go](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2751) [ahead and specify your new](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2754) [attributed string without having](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2755) [to manually merge all your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2757) [attributes together.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2758) [Here's something else that we've](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2763) [encountered in a couple places,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2764) [which is appearances that are](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2766) [set in Interface Builder.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2767) [So, if you're going ahead and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2769) [building and debugging your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2770) [application and you find that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2771) [there's some part of your app](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2772) [that just isn't switching, you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2773) [might have this in your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2775) [Interface Builder.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2777) [A hardcoded aqua appearance.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2778) [And it's easy to miss, because](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2780) [before today, essentially, you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2782) [were always running under aqua,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2783) [so you didn't notice it.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2785) [And the fix for this is easy.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2787) [If you set this back to the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2789) [Inherited option in the pop-up](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2790) [menu, your view's going to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2792) [automatically inherit from its](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2794) [ancestor.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2795) [An extra special case of this is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2796) [NSVisualEffectView.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2800) [It's very likely that if you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2801) [have a VisualEffectView in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2802) [Interface Builder or even in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2804) [code, you're setting one of the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2805) [two vibrant appearances on it](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2807) [and the great news is that in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2809) [macOS 10.14 this is no longer](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2811) [necessary.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2814) [NSVisualEffectView will](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2815) [automatically pick the right](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2816) [vibrant appearance based on the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2818) [appearance it's inheriting.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2819) [appearance it's inheriting.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2819) [So, if it inherits darkAqua,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2820) [it's going to choose vibrantDark](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2822) [and if it inherits aqua, it'll](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2823) [choose vibrantLight.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2825) [And so the fix for this is easy.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2826) [In Interface builder, you can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2828) [set this to inherited and then](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2830) [in code you can set the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2831) [appearance to nil or just delete](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2832) [your override.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2834) [Interface-- speaking of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2835) [Interface Builder, Interface](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2838) [Builder is a great tool for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2840) [designing and previewing your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2842) [views visually.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2843) [And so, for example, here I have](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2845) [a view that is actually a custom](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2847) [view using IB designable.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2848) [So, I'm rendering a gradient](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2850) [here and I can see it right here](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2852) [in the canvas.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2853) [And, by default, my canvas is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2854) [previewing my custom designable](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2855) [view using the canvas's](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2857) [appearance, in this case dark.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2859) [But down at the bottom, we have](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2862) [a new toggle that lets you go](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2863) [ahead and set it to the light](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2865) [appearance so that you can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2866) [preview the way that your view](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2867) [looks in either appearance.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2868) [And thanks to Interface](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2870) [Builder's great support for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2872) [asset catalog colors, we can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2874) [actually use our custom asset](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2876) [catalog colors, which have dark](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2877) [and light variants, and we can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2879) [and light variants, and we can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2879) [preview them in the canvas live.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2881) [And if you see there's a little](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2883) [arrow button built into that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2884) [pop-up button and you can use](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2885) [that to follow it and go](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2887) [straight to the definition in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2888) [your asset catalog, so you can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2889) [see live as you're changing it.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2890) [And you can do this all without](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2893) [even building and recompiling.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2895) [When you do build and run,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2896) [you're going to see a new item](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2898) [in your Debug Bar and it](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2900) [produces a menu that allows you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2902) [to choose the appearance for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2904) [your application.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2905) [And this is really handy for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2906) [previewing your app in various](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2907) [appearances without having to go](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2909) [and reconfigure your entire](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2910) [system.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2911) [Not only can you choose light](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2913) [and dark, but you can also](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2914) [choose the high contrast](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2916) [variants and test those as well.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2917) [And, if you have a Touch Bar](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2920) [Mac, this appears in the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2921) [expanded Debug Bar as well, so](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2922) [you can do this without even](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2924) [leaving your app to go back to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2925) [Xcode.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2927) [Finally, I want to talk about](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2930) [one last tool in Xcode that is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2931) [really great for debugging your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2933) [Dark Mode applications.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2934) [So, here we have our app and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2936) [really things are looking pretty](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2938) [good.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2939) [There's nothing out of place,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2939) [There's nothing out of place,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2939) [but I find that when I scroll](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2942) [and rubber band a bit, oh, I'm](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2944) [revealing something that I](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2946) [didn't expect.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2947) [There's a light background](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2948) [hiding back there somewhere, but](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2949) [it's hard to see without doing](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2951) [that little scroll gesture.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2952) [And this is a great case for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2954) [using the View Debugger.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2956) [Using the View Debugger's](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2958) [expanded 3D view, the view](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2959) [that's drawing unexpectedly is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2962) [really easy to spot.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2963) [And in this case, we can see](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2965) [that although our collection](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2966) [view was drawing the background](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2967) [that we expected, the scroll](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2969) [view behind it still has a light](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2971) [background for some reason.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2972) [And when we select it, we can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2973) [use the Inspector to see how](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2975) [it's being configured.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2977) [And in this case, we can verify](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2978) [that, yeah, it's just drawing a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2979) [hardcoded white color and that's](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2980) [a really easy fix.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2982) [The View Debugger has made a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2984) [number of enhancements in Xcode](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2986) [10 that are great for debugging](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2987) [Dark Mode applications,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2988) [including colors.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2990) [They can now show you the names](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2993) [of colors, both dynamic system](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2994) [colors and your asset catalog](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2995) [colors, so you can identify](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2997) [where these RGB components are](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2999) [where these RGB components are](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=2999) [coming from, and it'll show you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=3000) [the configuration of your view](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=3002) [for NSAppearance, including the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=3004) [appearance that it's going to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=3005) [draw with as well as whether](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=3006) [there's any local overrides of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=3008) [NSAppearance on that object.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=3010) [So, we have covered an awful lot](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=3014) [of content and so let's rewind](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=3016) [and make sure that we remember](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=3017) [it all.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=3018) [We started off with NSAppearance](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=3019) [and leveraging it effectively to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=3021) [draw your custom views that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=3023) [adapt based on the theme.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=3025) [Then we learned how to add depth](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=3027) [and beauty to our UI using our](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=3028) [new and updated palette of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=3030) [NSVisualEffectView materials.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=3031) [We talked about drawing in a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=3034) [couple of interesting contexts,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=3035) [both vibrancy and selections,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=3037) [and then we walked through some](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=3039) [of the great ways that Xcode can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=3040) [help you design and debug your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=3042) [Dark Mode applications.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=3043) [As always, you can go to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=3044) [developer.apple.com to re-watch](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=3046) [the video for this talk and see](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=3047) [any related resources and we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=3049) [have labs today.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=3051) [We have a special Cocoa and Dark](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=3052) [Mode Lab, it's at 2:00, and not](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=3054) [only will we have Cocoa](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=3058) [engineers onsite to help you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=3059) [engineers onsite to help you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=3059) [with your code, but we'll also](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=3060) [have human interface designers](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=3061) [onsite to help you with your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=3062) [design questions as well.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=3063) [So, go get lunch, think about](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=3065) [Dark Mode the entire time, and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=3067) [then come see us.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=3068) [And then, finally, we have an](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=3069) [additional Cocoa Lab on Friday](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=3071) [at 11:00 as well.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=3072) [All right.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=3074) [Thank you very much.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=3074) [[ Applause ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/218/?time=3076)