# Whatâ€™s New in Core ML, Part 1

## Summary
Introduced just one year ago, Core ML has already revolutionized the way apps can benefit from machine learning, by enabling fast and private on device machine learning features for your app. Find out how new Core ML features let you reduce the size of models, make them more flexible, and dramatically improve performance.

## Info
* Frameworks
* WWDC 2018 - Session 708 - iOS, macOS, tvOS, watchOS
* https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/

## Text
 [[ Music ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=7) [[ Applause ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=20) [&gt;&gt; Good morning.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=27) [Welcome. I'm Michael, and this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=28) [session is about what's new in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=31) [Core ML.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=33) [So introduced a year ago, Core](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=35) [ML is all about making it](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=37) [unbelievably simple for you to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=39) [integrate machine learning](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=41) [models into your app.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=42) [It's been wonderful to see the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=45) [adoption over the past year.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=46) [We hope it has all of you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=49) [thinking about what great new](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=51) [experiences you can enable if](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=53) [your app had the ability to do](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=55) [things like understand the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=57) [content of images, or perhaps,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=59) [content of images, or perhaps,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=59) [analyze some text.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=64) [What could you do if your app](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=68) [could reason about audio or](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=71) [music, or interpret your users'](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=73) [actions based on their motion](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=76) [activity, or even transform or](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=77) [generate new content for them?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=81) [All of this, and much, much](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=84) [more, is easily within reach.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=86) [And that's because this type of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=89) [functionality can be encoded in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=90) [a Core ML model.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=92) [Now if we take a peek inside one](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=95) [of these, we may find a neural](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=96) [network, tree ensemble, or some](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=99) [other model architecture.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=101) [They may have millions of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=103) [parameters, the values of which](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=104) [have been learned from large](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=106) [amounts of data.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=107) [But for you, you could focus on](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=110) [a single file.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=112) [You can focus on the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=114) [functionality it provides and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=115) [the experience it enables rather](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=117) [than those implementation](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=119) [than those implementation](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=119) [details.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=120) [Adding a Core ML model to your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=124) [app is simple as adding that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=126) [file to your Xcode project.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=128) [Xcode will give you a simple](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=131) [view, describe what it does in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=132) [terms of the inputs it requires](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=135) [and the outputs it provides.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=137) [Xcode will take this one step](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=140) [further and generate an](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=141) [interface for you, so that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=142) [interacting with this model is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=145) [just a few lines of code, one to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=146) [load the model, one to make a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=149) [prediction, and sometimes one to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=151) [pull out the specific output you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=154) [are interested in.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=155) [Note that in some cases you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=158) [don't even have to write back](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=159) [code because Core ML integrates](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=160) [with some of our higher-level](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=161) [APIs and allows you to customize](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=163) [their behavior if you give them](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=164) [a Core ML model.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=166) [So with Vision, this is done](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=167) [through the VNCoreML Request](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=169) [object.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=171) [And in the new Natural Language](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=171) [framework, you can instantiate](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=173) [an MLModel from a CoreML model.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=174) [So that's Core ML in a nutshell.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=177) [So that's Core ML in a nutshell.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=177) [But we are here to talk about](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=181) [what's new.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=182) [We took all the great feedback](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=184) [we received from you over the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=186) [past year and focused on some](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=186) [key enhancements to CoreML 2.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=189) [And we are going to talk about](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=192) [these in two sessions.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=193) [In the first session, the one](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=195) [you are all sitting in right](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=196) [now, we are going to talk about](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=197) [what's new from the perspective](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=198) [of your app.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=200) [In the second session, which](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=201) [starts immediately after this at](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=203) [10 a.m. after a short break, we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=204) [are going to talk about tools](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=206) [and how you can update and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=209) [convert models to take advantage](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=210) [of the new features in Core ML](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=212) [2.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=213) [When it comes to your app, we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=216) [are going to focus on three key](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=217) [areas.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=219) [The first is how you can reduce](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=220) [the size and number of models](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=222) [using your app while still](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=225) [getting the same functionality.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=226) [Then we'll look about how you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=228) [can get more performance out of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=230) [a single model.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=231) [And then we'll conclude about](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=232) [how using Core ML will allow you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=235) [to keep pace with the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=237) [state-of-the-art and rapidly](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=238) [moving field of machine](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=239) [moving field of machine](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=239) [learning.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=240) [So to kick it off, let's talk](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=242) [about model size.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=243) [I'm going to hand it off to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=244) [Francesco.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=245) [[ Applause ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=246) [&gt;&gt; Thank you Michael.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=250) [Hello. Every ways to reduce the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=252) [size of your Core ML app is very](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=255) [important.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=257) [My name is Francesco, and I am](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=258) [going to introduce quantization](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=259) [and flexible shapes, two new](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=261) [features in Core ML 2 that can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=263) [help reduce your app size.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=265) [So Core ML, [inaudible] why](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=268) [should you learn in models and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=270) [device.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=273) [This gives your app four key](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=273) [advantages compared to running](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=274) [them in the cloud.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=276) [First of all, user privacy is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=277) [fully respected.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=279) [There are many machine-learning](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=280) [models on device.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=282) [We guarantee that the data never](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=283) [leaves the device of the user.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=285) [Second, it can help you achieve](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=288) [real-time performance.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=289) [And for silicon [phonetic] and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=292) [devices are super- efficient for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=292) [machine-learning workloads.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=294) [Furthermore, you don't have to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=297) [maintain and pay for Internet](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=298) [servers.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=299) [servers.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=299) [And Core ML inference is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=301) [available anywhere at any time](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=302) [despite natural connectivity](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=305) [issues.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=306) [All these great benefits come](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=307) [with the fact that you now need](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=309) [to store your machine-learning](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=310) [models on device.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=312) [And if the machine-learning](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=314) [models are big, then you might](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=315) [be concerned about the size of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=317) [your app.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=318) [For example, you are -- you have](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=319) [your [inaudible] map, and it's](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=321) [full of cool features.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=322) [And your users are very happy](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=324) [about it.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=325) [And now you want to take](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=326) [advantage of the new](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=328) [opportunities offered by machine](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=328) [learning on device, and you want](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=331) [to add new amazing capabilities](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=332) [to your app.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=333) [So what you do, you train some](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=334) [Core ML models and you add them](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=336) [to your app.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=338) [What this means is that your app](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=339) [has become more awesome and your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=341) [users are even happier.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=342) [But some of them might notice](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=345) [that your app has increased in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=347) [size a little bit.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=348) [It's not uncommon to see that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=349) [apps grow up, either to tens or](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=351) [hundreds of megabytes after](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=353) [adding machine-learning](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=354) [capabilities to them.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=355) [And as you keep adding more and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=357) [more features to your app, your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=358) [more features to your app, your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=358) [app size might simply become out](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=361) [of control.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=362) [So that's the first thing that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=364) [you can do about it.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=365) [And if these machine-learning](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=366) [models are supporting other](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=368) [features to your app, you can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=370) [keep them outside your initial](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=371) [bundle.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=373) [And then as the user uses the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=373) [other features, you can download](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=377) [them on demand, compile them on](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=378) [device.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=380) [So this -- in this case, this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=381) [user is happy in the beginning](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=383) [because the installation size is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=384) [unchanged.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=386) [But since the user downloads and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=387) [uses all the current Core ML](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=388) [functionality in your app, at](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=390) [the end of the day the size of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=392) [the -- of your app is still](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=393) [large.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=394) [So wouldn't it be better if,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=396) [instead, we could tackle this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=398) [problem by reducing the size of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=400) [the models itself?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=403) [This would give us a smaller](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=406) [bundle in case we ship the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=407) [models inside the app, faster](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=408) [and smaller downloads if instead](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=411) [of shipping the models in the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=414) [app we download them.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=415) [And in any case, your app will](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=416) [enjoy a lower memory footprint.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=418) [enjoy a lower memory footprint.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=418) [Using less memory is better for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=420) [the performance of your app and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=422) [great for the system in general.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=424) [So let's see how we can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=426) [decompose the size of a Core ML](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=428) [app into factors to better](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=429) [tackle this problem.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=431) [First, there is the number of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=433) [models.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=434) [This depends on how many](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=434) [machine-learning functionalities](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=436) [your app has.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=438) [Then there is the number of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=439) [weights.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=440) [The number of weights depends on](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=441) [the architecture that you have](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=443) [chosen to solve your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=444) [machine-learning problem.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=444) [As Michael was mentioning, the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=446) [number of weight -- the weights](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=449) [are the place in which the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=450) [machine-learning model stores](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=451) [the information that it has been](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=453) [learning during training.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=454) [So it is -- if it has been](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=456) [trained to do a complex task,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=458) [it's not uncommon to see a model](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=459) [requiring tens of millions of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=461) [weights.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=463) [Finally, there is the size of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=465) [the weight.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=466) [How are we storing these](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=467) [parameters that we are learning](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=468) [during training?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=470) [Let's focus on this factor](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=471) [first.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=472) [For neural networks, we have](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=474) [several options to represent and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=475) [store the weights.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=477) [And the first, really, is of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=479) [And the first, really, is of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=479) [Core ML in iOS 11.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=480) [Neural networks were stored](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=483) [using floating-point 32-bit](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=484) [weights.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=487) [In iOS 11.2, we heard your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=488) [feedback and we introduced half](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=492) [precision floating-point 16](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=493) [weight.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=496) [This gives your app half the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=496) [storage required for the same](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=498) [accuracy.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=501) [But this year we wanted to take](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=502) [several steps further, and we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=503) [are introducing quantized](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=505) [weights.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=507) [With quantized weights we are no](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=508) [longer restricted to use either](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=509) [Float 32 or Float 16 values.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=511) [But neural networks can be](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=514) [encoded using 8 bits, 4 bits,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=515) [any bits all the way down to 1](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=518) [bit.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=521) [So let's now see what](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=522) [quantization here is.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=523) [Here we are representing a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=526) [subset of the weights of our](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=527) [neural networks.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=529) [As we can see, these weights can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=530) [take any value in a continuous](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=532) [range.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=534) [This means that in theory, a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=535) [single weight can take an](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=537) [infinite number of possible](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=538) [infinite number of possible](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=538) [values.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=540) [So in practice, in neural](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=541) [networks we store weights using](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=542) [floater 32 point -- Float 32](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=544) [numbers.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=547) [This means that this weight can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=548) [take billions of values to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=549) [better represent the -- their](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=550) [continuous nature.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=553) [But it turns out the neural](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=554) [networks also work with lower](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=556) [precision weights.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=558) [Quantization is the process it](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=559) [takes to discontinue strings of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=561) [values and constrains them to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=563) [take a very small and discrete](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=565) [subset of possible values.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=568) [For example, here quantization](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=571) [has turned this continuous](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=572) [spectrum of weights into only](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=574) [256 possible values.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=577) [So before quantization, the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=579) [weights would take any possible](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=581) [values.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=582) [After quantization, they only](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=583) [have 256 options.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=584) [Now since its weight can be](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=587) [taken from this small set, Core](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=590) [ML now needs only 8 bits of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=592) [stored information of a weight.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=594) [But nothing can stop us here.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=596) [We can go further.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=599) [And for example, we can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=600) [constrain the network to take,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=602) [instead of one of 56 different](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=604) [values, for example, just 8.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=606) [And since now we now have only 8](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=608) [options, Core ML will need 3-bit](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=611) [values per weight to store your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=613) [model.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=615) [There are now some details about](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=617) [how we are going to choose these](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=619) [values to represent the weights.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=620) [They can be uniformly](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=622) [distributed in this range, and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=624) [in this case we have linear](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=626) [quantization instead in lookup](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=627) [table quantization, we can have](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=630) [these values scattered in this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=633) [range in an arbitrary manner.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=635) [So let's see practically how](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=637) [quantization can help us reduce](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=639) [the size of our model.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=641) [In this example, you are](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=641) [focusing on Resnet50, which is a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=643) [common architecture used by many](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=645) [applications for many different](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=647) [tasks.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=648) [It includes 25 million trained](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=650) [parameters and this means that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=652) [you have to use 32-bit floats to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=654) [represent it.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=656) [Then the total model size is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=657) [more than 100 megabytes.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=659) [more than 100 megabytes.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=659) [If we quantize it to 8-bits,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=661) [then the architecture hasn't](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=664) [changed; we still have 25](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=665) [million parameters.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=667) [But we are now using only 1 byte](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=669) [to store a single weight, and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=672) [this means that the model size](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=674) [is reduced by a factor of 4x.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=675) [It's only -- it now only takes](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=677) [26 megabytes to store this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=678) [model.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=680) [And we can go further.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=680) [We can use that quantized](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=682) [representation that only uses 4](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=683) [bits per weight in this model](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=684) [and end up with a model that is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=687) [even smaller.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=688) [[ Applause ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=689) [And again, Core ML supports all](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=696) [the quantization modes all the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=698) [way down to 8 bits.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=700) [Now quantization is a powerful](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=704) [technique to take an existing](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=707) [architecture and of a smaller](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=708) [version of it.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=710) [But how can you obtain quantized](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=711) [model?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=712) [If you have any neural](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=714) [networking in Core ML format,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=716) [you can use Core ML Tools to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=718) [obtain a quantized](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=719) [obtain a quantized](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=719) [representation of it.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=720) [So Core ML 2 should quantize for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=721) [you automatically.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=723) [Or you can train quantized](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=725) [models.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=727) [You can either train quantized](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=729) [-- with a quantization](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=730) [constraint from scratch, or](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=731) [retrain existing models with](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=732) [quantization constraints.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=734) [After you have obtained your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=736) [quantized model with your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=737) [training tools, you can then](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=738) [convert it to Core ML as usual.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=739) [And nothing will change in the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=742) [app in the way you use the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=743) [model.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=744) [Inside the model, the numbers](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=745) [are going to be stored in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=747) [different precision, but the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=748) [interface for using the model](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=749) [will not change at all.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=752) [However, we always have to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=755) [consider that quantized models](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=756) [have lower-precision](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=758) [approximations of the original](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=760) [reference floating-point models.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=761) [And this means that quantized](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=764) [models come with an accuracy](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=765) [versus size-of-the-model](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=767) [tradeoff.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=768) [This tradeoff is model dependent](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=769) [and use case dependent.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=771) [And it's also a very active area](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=773) [of research.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=775) [So it's always recommended to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=776) [check the accuracy of the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=777) [quantized model and compare it](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=778) [quantized model and compare it](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=778) [with the referenced](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=780) [floating-point version for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=782) [relevant this data and form](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=784) [metrics that are valid for your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=785) [app and use case.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=787) [Now let's see a demo of how we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=788) [can use -- adopt quantized](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=790) [models to reduce the size of an](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=793) [app.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=794) [[ Applause ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=795) [I would like to show you a style](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=805) [transfer app.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=806) [In style transfer, a neural](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=808) [network has been trained to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=809) [render user images using styles](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=811) [that have been learned by](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=813) [watching paintings or other](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=814) [images.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=815) [So let me load my app.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=816) [As we can see, I am shipping](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=817) [this app with four styles; City,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=821) [Glass, Oils and Waves.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=823) [And then I can pick images from](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=825) [the photo library of the users](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=827) [and then process them blending](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=829) [them in different styles right](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=831) [on device.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=832) [So this is the original image,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=833) [and I am going to render the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=836) [City style,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=837) [Glass,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=839) [Oils,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=842) [and Waves.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=844) [Let's see how this app has been](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=847) [built in Xcode.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=848) [This app uses Core ML and Vision](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=850) [API to perform this stylization.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=853) [And as we can see, we have four](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=856) [Core ML models here bundled in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=857) [Xcode; City, Glass, Oils, and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=859) [Waves, the same ones we are](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=861) [seeing in the app.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=862) [And we can see -- we can inspect](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=863) [this model.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=865) [These are seen as quantized](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=866) [model, so each one of these](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=867) [models is 6.7 megabytes of this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=869) [space on disk.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=871) [We see that the models take an](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=873) [input image of a certain](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=874) [resolution and produce an image](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=875) [called Stylized of the same](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=877) [resolution.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=879) [Now we want to investigate how](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=881) [much storage space and memory](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=883) [space we can use by -- we can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=884) [save by switching to quantized,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=886) [models.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=887) [So I have been playing with Core](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=888) [ML Tools and obtained quantizer](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=889) [presentation for these models.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=892) [And for a tutorial about how to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=896) [obtain these models, stay for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=897) [Part 2 that is going to cover](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=899) [Part 2 that is going to cover](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=899) [quantization with Core ML Tools](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=901) [in detail.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=902) [So I want to focus first on the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=904) [Glass style and see how the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=905) [different quantization versions](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=907) [work for these styles.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=909) [So all I have to do is drag](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=911) [these new models inside the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=913) [Xcode project, and rerun the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=915) [app.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=917) [And then we are going to see how](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=918) [these models behave.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=919) [First we can see that the size](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=921) [has been greatly reduced.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=923) [For example, the 8-bit version](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=925) [already from 6 or 7 megabytes](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=927) [went down to just 1.7.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=929) [[ Applause ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=931) [In 4-bit, we can save even more,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=937) [and now the model is less than 1](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=939) [megabyte.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=940) [In 3-bit, it is -- that's even](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=941) [smaller, at 49 kilobytes.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=943) [And so on.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=944) [Now let's go back to the app.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=947) [Let's make this same image for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=950) [reference and apply the Glass](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=952) [style in the original version.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=954) [Still looks as before.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=957) [Now we can compare it with the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=959) [Now we can compare it with the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=959) [8-bit version.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=960) [And you can see nothing has](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=962) [changed.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=965) [This is because 8-bit](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=966) [quantization methods are very](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=967) [solid.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=969) [We can also venture further and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=970) [try the 4-bit version of this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=973) [model.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=974) [Wow. The results are still](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=975) [great.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=978) [And now let's try the 3-bit](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=979) [version.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=981) [We see that there are -- we see](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=984) [the first color shift.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=986) [So it probably is good if we go](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=987) [and check with the designers if](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=989) [this effect is still acceptable.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=990) [And now, as we see the 2-bit](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=993) [version, this is not really what](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=994) [we were looking for.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=997) [Maybe we will save it for a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=997) [horror app, but I am not going](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=999) [to show this to the designer.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1000) [[ Applause ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1001) [Let's go back to the 4-bit](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1006) [version and hide this one.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1007) [This was just a reminder that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1009) [quantized models are](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1011) [approximation of the original](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1012) [models.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1014) [So it's always recommended to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1015) [check them and compare with the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1016) [original versions.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1017) [Now for every model and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1019) [Now for every model and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1019) [quantization technique, there is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1020) [always a point in which things](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1022) [start to mismatch.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1023) [Now we -- after some discussion](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1026) [with the designer, extensive](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1028) [evaluation of many images, we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1029) [decided to ship the 4-bit](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1030) [version of this model, which is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1032) [the smallest size for the best](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1033) [quality.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1035) [So let's remove all the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1036) [floating-point version of the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1037) [models that were taking a lot of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1039) [space in our app and replace](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1041) [them with the 4-bit version.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1043) [And now let's run the app one](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1050) [last time.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1052) [OK. Let's pick the same image](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1060) [again and show all the styles.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1061) [This was the City, Glass, Oils,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1068) [and big Wave.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1074) [So in this demo we saw how we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1078) [So in this demo we saw how we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1078) [started with four models and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1082) [they were huge, in 32-bit -- or](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1084) [total app size was 27 megabytes.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1086) [Then we evaluated the quality](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1089) [and switched to 4-bit models,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1090) [and the total size of our app](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1093) [went down to just 3.4 megabytes.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1094) [Now --](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1096) [[ Applause ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1097) [This doesn't cost us anything in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1103) [terms of quality because all](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1104) [these versions -- these](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1106) [quantized versions look the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1107) [same, and the quality is still](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1109) [amazing.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1111) [We showed how quantization can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1112) [help us reduce the size of an](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1116) [app by reducing the size of the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1117) [weight at the very microscopic](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1119) [level.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1120) [Now let's see how we can reduce](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1121) [the number of models that your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1124) [app needs.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1125) [In the most straightforward](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1126) [case, if your app has three](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1128) [machine-learning functionalities](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1131) [then you need three different](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1133) [machine-learning models.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1134) [But in some cases, it is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1136) [possible to have the same model](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1138) [possible to have the same model](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1138) [to support two different](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1141) [functions.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1143) [For example, you can train a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1144) [multi-task model.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1146) [And multi-task models has been](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1146) [trained to perform multiple](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1149) [things at once.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1150) [There is an example about style](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1152) [transferring, the Turi Create](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1153) [session about multi-task models.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1154) [Or in some cases, you can use a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1156) [yet new feature in Core ML](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1159) [called Flexible Shapes and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1161) [Sizes.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1162) [Let's go back to our Style](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1164) [Transfer demo.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1167) [In Xcode we saw that the size of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1168) [the input image and the output](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1170) [image was encoded in part of the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1171) [definition of the model.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1174) [But what if we want to run the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1176) [same style on different image](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1178) [resolution?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1179) [What if we want to run the same](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1181) [network on different image](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1182) [sizes?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1184) [For example, the user might want](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1186) [to see a high-definition style](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1189) [transfer.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1190) [So they use -- they give us a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1191) [high-definition image.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1193) [Now if I were Core ML model all](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1195) [it takes is a lower resolution](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1197) [as an input, all we can do as](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1198) [as an input, all we can do as](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1198) [developers is size -- or resize](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1200) [the image down, process it, and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1203) [then scale it back up.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1206) [This is not really going to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1207) [amaze the user.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1209) [Even in the past, we could](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1210) [reship this model with Corel ML](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1214) [Tools and make it accept any](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1216) [resolution, in particular, a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1218) [higher-resolution image.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1220) [So even in the past we could do](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1223) [this feature and feed directly](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1224) [the high-resolution image to a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1227) [Corel ML model, producing a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1228) [high-definition result.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1230) [This is because we wanted to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1231) [introduce a finer detail in the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1234) [stylization and the way finer](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1236) [strokes that are amazing when](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1238) [you zoom in, because they have](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1240) [-- they add a lot of work into](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1242) [the final image.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1243) [So in the past we could do it,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1244) [but we could do it by](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1247) [duplicating the model and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1249) [creating two different versions:](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1251) [one for the standard definition](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1253) [and one for the high](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1254) [definitions.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1255) [And this, of course, means that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1256) [our app is twice as much the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1257) [size -- besides the fact that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1259) [size -- besides the fact that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1259) [the network has been trained to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1261) [support any resolution.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1262) [Not anymore.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1264) [We are introducing flexible](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1265) [shapes.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1266) [And with flexible shapes, you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1267) [have -- if you have -- you can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1269) [have the single model to process](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1270) [more resolutions and many more](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1272) [resolutions.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1273) [So now in Xcode --](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1274) [[ Applause ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1276) [-- in Xcode you are going to see](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1281) [that this -- the input is still](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1284) [an image, but the size of the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1286) [full resolution, the model also](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1287) [accepts flexible resolutions.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1289) [In this simple example, SD and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1292) [HD.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1294) [This means that now you have to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1294) [ship a single model.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1297) [You don't have to have any](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1298) [redundant code.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1301) [And if you need to switch](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1303) [between standard definition and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1304) [high definition, you can do it](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1305) [much faster because we don't](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1306) [need to reload the model from](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1308) [scratch; we just need to resize](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1309) [it.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1311) [You have two options to specify](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1312) [the flexibility of the model.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1314) [You can define a range for its](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1317) [dimension, so you can define a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1318) [dimension, so you can define a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1318) [minimal width and height and the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1320) [maximum width and height.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1322) [And then at inference pick any](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1323) [value in between.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1325) [But there is also another way.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1326) [You can enumerate all the shapes](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1328) [that you are going to use.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1330) [For example, all different](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1331) [aspect ratios, all different](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1332) [resolutions, and this is better](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1334) [for performance.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1336) [Core ML knows more about your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1337) [use case earlier, so it can --](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1339) [it has the opportunities of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1341) [performing more optimizations.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1342) [And it also gives your app a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1344) [smaller tested surface.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1346) [Now which models are flexible?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1348) [Which models can be trained to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1350) [support multiple resolutions?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1352) [Fully convolutional neural](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1355) [networks, commonly used for MS](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1357) [processing tasks such as style](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1359) [transfer, image enhancement,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1361) [super resolution, and so on --](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1363) [and some of the architecture.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1366) [Core ML Tools can check if a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1368) [model has this capability for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1370) [you.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1372) [So we still have the number of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1374) [models Core ML uses in flexible](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1375) [sizes, and the size of the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1377) [weights can be reduced by](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1378) [quantization.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1379) [quantization.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1379) [But what about the number of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1380) [weights?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1381) [Core ML, given the fact that it](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1383) [supports many, many different](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1385) [architecture at any framework,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1387) [has always helped you choose the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1388) [right -- the model of the right](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1390) [size for your machine-learning](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1392) [problem.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1393) [So Core ML can help you tackle](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1394) [the size of your app using this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1397) [-- all these three factors.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1400) [In any case, the inference is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1401) [going to be super performant.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1403) [And to introduce new features in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1404) [performance and customization,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1406) [let's welcome Bill March.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1408) [Thank you.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1409) [[ Applause ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1410) [&gt;&gt; Thank you.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1417) [One of the fundamental design](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1419) [principles of Core ML from the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1421) [very beginning has been that it](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1422) [should give your app the best](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1423) [possible performance.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1425) [And in keeping with that goal,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1426) [I'd like to highlight a new](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1428) [feature of Core ML to help](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1429) [ensure that your app will shine](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1430) [on any Apple device.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1432) [Let's take a look at the style](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1434) [transfer example that Francesco](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1435) [showed us.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1437) [From the perspective of your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1438) [app, it takes an image of an](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1439) [app, it takes an image of an](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1439) [input and simply returns the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1441) [stylized image.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1442) [And there are two key components](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1444) [that go into making this happen:](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1445) [first, the MLModel file, which](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1447) [stores the particular parameters](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1449) [needed to apply this style; and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1451) [second, the inference engine,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1453) [which takes in the MLModel and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1455) [the image and performs the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1457) [calculations necessary to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1458) [produce the result.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1460) [So let's peek under the hood of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1461) [this inference engine and see](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1463) [how we leverage Apple's](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1464) [technology to perform this style](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1465) [transfer efficiently.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1467) [This model is an example of a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1470) [neural network, which consists](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1471) [of a series of mathematical](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1473) [operations called layers.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1474) [Each layer applies some](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1476) [transformation to the image,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1477) [finally resulting in the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1479) [stylized output.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1480) [The model stores weights for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1481) [each layer which determine the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1483) [particular transformation and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1485) [the style that we are going to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1487) [apply.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1488) [The Core ML neural network](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1489) [inference engine has highly](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1490) [optimized implementations for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1492) [each of these layers.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1493) [On the GPU, we use MTL shaders.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1495) [On the CPU we can use](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1497) [Accelerate, the proficient](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1498) [calculation.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1499) [calculation.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1499) [And we can dispatch different](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1501) [parts of the computation to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1502) [different pieces of hardware](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1503) [dynamically depending on the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1504) [model, the device state, and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1506) [other factors.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1508) [We can also find opportunities](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1510) [to fuse layers in the network,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1512) [resulting in fewer overall](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1514) [computations being needed.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1515) [We are able to optimize here](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1518) [because we know what's going on.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1520) [We know the details of the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1522) [model; they are contained in the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1523) [MLModel file that you provided](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1524) [to us.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1526) [And we know the details of the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1527) [inference engine and the device](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1528) [because we designed them.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1530) [We can take care of all of these](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1532) [optimizations for you, and you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1533) [can focus on delivering the best](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1535) [user experience in your app.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1537) [But what about your workload?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1539) [What about, in particular, if](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1542) [you need to make multiple](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1544) [predictions?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1545) [If Core ML doesn't know about](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1547) [it, then Core ML can't optimize](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1548) [for it.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1550) [So in the past, if you had a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1551) [workload like this, you needed](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1553) [to do something like this: a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1555) [simple for loop wrapped around a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1557) [call to the existing Core ML](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1558) [call to the existing Core ML](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1558) [prediction API.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1560) [So you'd loop over some array of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1561) [inputs and produce an array of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1563) [outputs.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1564) [Let's take a closer look at what](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1565) [happens under the hood when this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1568) [-- when we are doing this.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1570) [For each image, we will need to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1572) [do some kind of preprocessing](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1573) [work.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1575) [If nothing else, we need to send](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1575) [the data down to the GPU.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1576) [Once we have done that, we can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1579) [do the calculation and produce](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1580) [the output image.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1581) [But then there is a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1583) [postprocessing step in which we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1583) [need to retrieve the data from](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1585) [the GPU and return it to your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1586) [app.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1588) [The key to improving this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1589) [picture is to eliminate the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1591) [bubbles in the GPU pipeline.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1592) [This results in greater](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1595) [performance for two major](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1596) [reasons.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1598) [First, since there is no time](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1598) [when the GPU is idle the overall](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1600) [compute time is reduced.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1602) [And second, because the GPU is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1604) [kept working continuously, it's](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1605) [able to operate in a higher](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1607) [performance state and reduce the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1609) [time necessary to compute each](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1611) [particular output.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1612) [But so much of the appeal in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1615) [Core ML is that you don't have](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1616) [to worry about any details like](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1617) [this at all.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1619) [In fact, for your app all you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1620) [are really concerned with for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1621) [your users is going from a long](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1622) [time to get results to a short](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1625) [time.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1626) [So this year we are introducing](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1627) [a new batch API that will allow](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1630) [you to do exactly this.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1631) [Where before you needed to loop](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1634) [over your inputs and call](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1635) [separate predictions, the new](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1636) [API is very simple.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1638) [One-line predictions, it](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1640) [consumes an input -- an array of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1642) [inputs and produces an array of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1644) [outputs.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1645) [Core ML will take care of the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1646) [rest.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1647) [[ Applause ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1648) [So let's see it in action.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1654) [So in keeping with our style](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1656) [transfer example, let's look at](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1658) [the case where we wanted to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1660) [apply a style to our entire](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1661) [photo library.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1662) [So here I have a simple app](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1663) [that's going to do just that.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1665) [I am going to apply a style to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1666) [200 images.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1667) [On the left, as in your left,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1669) [there is an implementation using](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1671) [last year's API in a for loop.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1674) [And on the right we have the new](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1675) [batch API.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1677) [So let's get started.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1678) [We are off.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1680) [And we can see the new is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1683) [already done.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1684) [We'll wait a moment for last](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1685) [year's technology, and there we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1686) [go.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1688) [[ Applause ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1689) [In this example we see a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1695) [noticeable improvement with the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1696) [new batch API.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1698) [And in general, the improvement](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1699) [you'll see in your app depends](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1700) [on the model and the device and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1702) [the workload.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1703) [But if you have a large number](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1705) [of predictions to call, use the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1706) [new API and give Core ML every](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1707) [opportunity to accelerate your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1709) [computation.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1710) [Of course, the most](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1715) [high-performance app in the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1716) [world isn't terribly exciting if](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1717) [it's not delivering an](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1719) [experience that you want for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1720) [your users.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1721) [We want to ensure that no matter](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1723) [what that experience is, or what](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1724) [it could be in the future, Core](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1726) [ML will be just as performant](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1728) [and simple to use as ever.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1730) [But the field of machine](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1732) [learning is growing rapidly.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1733) [How will we keep up?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1735) [And just how rapidly?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1736) [Well let me tell you a little](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1737) [bit of a personal story about](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1739) [bit of a personal story about](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1739) [that.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1740) [Let's take a look at a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1742) [deceptively simple question that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1743) [we can answer with machine](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1745) [learning.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1746) [Given an image, what I want to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1747) [know: Are there any horses in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1749) [it?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1751) [So I think I heard a chuckle or](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1752) [two.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1754) [Maybe this seems like kind of a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1754) [silly challenge problem.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1755) [Small children love this, by the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1756) [way.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1758) [But -- so way, way back in the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1759) [past, when I was first starting](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1762) [graduate school and I was](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1763) [thinking about this problem and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1764) [first learning about machine](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1765) [learning, my insights on the top](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1766) [came down to something like](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1768) [this: I don't know -- seems](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1769) [hard.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1772) [I don't really have any good](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1773) [idea for you.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1774) [So a few years pass.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1775) [I get older, hopefully a little](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1778) [bit wiser.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1779) [But certainly the field is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1780) [moving very, very quickly,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1781) [because there started to be a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1782) [lot of exciting new results](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1783) [using deep neural networks.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1785) [And so then my view on this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1787) [problem changed.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1788) [And suddenly, wow, this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1789) [cutting-edge research can really](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1790) [answer these kind of questions,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1792) [and computers can catch up with](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1793) [small children and horse](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1794) [recognition technology.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1795) [What an exciting development.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1796) [[ Laughter ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1797) [So a few more years pass.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1800) [Now I work at Apple, and my](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1802) [perspective on this problem has](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1803) [changed again.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1805) [Now, just grab Create ML.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1806) [The UI is lovely.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1809) [You'll have a horse classifier](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1810) [in just a few minutes.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1811) [So, you know, if you are a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1813) [machine learning expert, maybe](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1815) [you are looking at this and you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1816) [are thinking, "Oh, this guy](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1817) [doesn't know what he is talking](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1818) [about.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1818) [You know, in 2007 I knew how to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1819) [solve that problem.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1820) [In 2012 I'd solved it a hundred](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1821) [times."](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1823) [Not my point.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1824) [If you are someone who cares](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1825) [about long-lasting, high-quality](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1827) [software, this should make you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1829) [nervous, because in 11 years we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1830) [have seen the entire picture of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1832) [this problem turn over.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1834) [So let's take a look at a few](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1836) [more features in Core ML that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1837) [can help set your mind at ease.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1838) [To do that, let's open the hood](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1841) [once again and peek at one of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1843) [these new horse finder models,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1844) [which is, once again, a neural](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1846) [network.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1848) [As we have illustrated before,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1849) [the neural network consists of a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1851) [series of highly optimized](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1852) [layers.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1854) [It is a series of layers, and we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1854) [have highly optimized](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1856) [implementations for each of them](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1857) [in our inference engine.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1858) [Our list of supported operations](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1860) [is large and always growing,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1862) [trying to keep up with new](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1864) [developments in the field.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1865) [But what if there is a layer](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1867) [that just isn't supported in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1868) [Core ML?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1870) [In the past, you either needed](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1871) [to wait or you needed a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1874) [different model.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1875) [But what if this layer is the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1876) [key horse-finding layer?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1879) [This is the breakthrough that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1881) [your horse app was waiting for.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1882) [Can you afford to wait?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1883) [Given the speed of machine](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1886) [learning, this could be a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1887) [serious obstacle.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1888) [So we introduced custom layers](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1891) [for neural network models.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1893) [Now if a neural network layer is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1895) [missing, you can provide an](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1897) [implementation with -- will mesh](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1898) [seamlessly with the rest of the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1901) [Core ML model.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1902) [Inside the model, the custom](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1904) [layer stores the name of an](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1905) [implementing class -- the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1906) [AAPLCustomHorseLayer in this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1908) [case.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1909) [The implementation class fills](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1910) [the role of the missing](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1912) [implementation in the inference](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1913) [engine.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1914) [Just like the layer is built](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1915) [into Core ML, the implementation](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1916) [provided here should be general](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1919) [provided here should be general](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1919) [and applicable to any instance](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1920) [of the new layer.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1922) [It simply needs to be included](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1924) [in your app at runtime.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1925) [Then the parameters for this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1927) [particular layer are](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1928) [encapsulated in the ML model](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1930) [with the rest of the information](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1932) [about the model.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1933) [Implementing a custom layer is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1935) [simple.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1937) [We expose an MLCustomLayer](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1938) [protocol.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1939) [You simply provide methods to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1940) [initialize the layer based on](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1941) [the data stored in the ML model.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1943) [You'll need to provide a method](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1946) [that tells us how much space to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1947) [allocate for the outputs of the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1948) [layer, and then a method that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1949) [does the computation.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1951) [Plus, you can add this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1954) [flexibility without sacrificing](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1956) [the performance of your model as](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1958) [a whole.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1959) [The protocol includes an](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1960) [optional method, which allows](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1961) [you to provide us with a MTL](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1963) [shader implementation of your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1964) [model -- of the layer, excuse](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1965) [me.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1967) [If you give us this, then it can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1967) [be encoded in the same command](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1970) [buffer as the rest of the Core](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1971) [ML computation.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1972) [So there is no extra overhead](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1973) [from additional encodings or](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1975) [multiple trips to and from the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1976) [GPU.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1977) [If you don't provide this, then](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1978) [we'll simply evaluate the layer](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1979) [we'll simply evaluate the layer](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1979) [on the CPU with no other work on](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1981) [your part.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1982) [So no matter how quickly](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1984) [advancements in neural network](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1986) [models may happen, you have a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1987) [way to keep up with Core ML.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1988) [But there are limitations.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1990) [Custom layers only work for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1992) [neural network models, and they](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1994) [only take inputs and outputs](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1995) [which are ML MultiArrays.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1996) [This is a natural way to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1998) [interact with neural networks.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1999) [But the machine learning field](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2001) [is hardly restricted to only](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2002) [advancing in this area.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2004) [In fact, when I was first](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2006) [learning about image](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2007) [recognition, almost no one was](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2008) [talking about neural networks as](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2009) [a solution to that problem.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2011) [And you can see today it's the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2012) [absolute state of the art.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2014) [And it's not hard to imagine](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2017) [machine-learning-enabled app](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2018) [experiences where custom layers](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2019) [simply wouldn't fit.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2021) [For instance, a machine-learning](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2022) [app might use a neural network](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2024) [to embed an image in some](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2026) [similarity space, then look up](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2027) [similar images using a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2029) [nearest-neighbor method or](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2030) [locality-sensitive hashing -- or](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2031) [even some other approach.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2033) [A model might combine audio and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2036) [motion data to provide a bit of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2038) [needed encouragement to someone](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2039) [needed encouragement to someone](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2039) [who doesn't always close his](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2041) [rings.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2042) [Or even a completely new model](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2044) [type we haven't even imagined](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2046) [yet that enables novel](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2047) [experiences for your users.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2048) [In all these cases, it would be](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2051) [great if we could have the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2052) [simplicity and portability of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2053) [Core ML without having to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2054) [sacrifice the flexibility to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2056) [keep up with the field.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2058) [So we are introducing custom](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2059) [models.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2062) [A Core ML custom model allows](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2063) [you to encapsulate the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2065) [implementation of a part of a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2066) [computation that's missing](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2067) [inside Core ML.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2068) [Just like for custom layers, the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2070) [model stores the name of an](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2072) [implementation class.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2073) [The class fills the role of the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2074) [general inference engine for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2076) [this type of model.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2077) [Then the parameters are stored](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2079) [in the ML Model just like](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2080) [before.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2082) [This allows the model to be](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2083) [updated as an asset in your app](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2084) [without having to touch code.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2086) [And implementing a custom model](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2090) [is simple as well.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2091) [We expose a protocol,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2092) [MLCustomModel.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2094) [You provide methods to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2095) [initialize based on the data](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2096) [stored in the ML Model.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2097) [And you provide a method to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2099) [And you provide a method to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2099) [compute the prediction on an](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2101) [input.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2102) [There is an optional method to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2102) [provide a batch implementation](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2104) [if there are opportunities in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2106) [this particular model type to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2107) [have optimizations there.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2108) [And if not, we'll call the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2110) [single prediction in a for loop.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2111) [And using a customized model in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2114) [your app is largely the same](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2116) [workflow as any other Core ML](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2117) [model.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2118) [In Xcode, a model with](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2119) [customized components will have](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2121) [a dependency section listing the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2122) [names of the implementations](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2124) [needed along with a short](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2126) [description.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2127) [Just include these in your app,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2128) [and you are ready to go.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2129) [The prediction API is unchanged,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2131) [whether for single predictions](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2133) [or batch.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2134) [So custom layers and custom](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2137) [models allow you to use the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2139) [power and simplicity of Core ML](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2141) [without sacrificing the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2142) [flexibility needed to keep up](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2143) [with the fast-paced area of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2145) [machine learning.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2146) [For new neural network layers,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2148) [custom layers allow you to make](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2150) [use of the many optimizations](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2152) [already present in the neural](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2153) [network inference engine in Core](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2154) [ML.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2156) [Custom models are more flexible](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2157) [for types and functionality, but](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2159) [for types and functionality, but](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2159) [they do require more](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2161) [implementation work on your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2162) [part.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2165) [Both forms of customization](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2165) [allow you to encapsulate model](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2167) [parameters in an ML model,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2168) [making the model portable and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2170) [your code simpler.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2172) [And we've only been able to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2174) [touch on a few of the great new](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2176) [features in Core ML 2.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2178) [Please download the beta, try](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2180) [them out for yourself.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2182) [Core ML has many great new](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2187) [features to reduce your app](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2188) [size, improve performance, and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2189) [ensure flexibility and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2191) [compatibility with the latest](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2193) [developments in machine](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2194) [learning.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2195) [We showed you how quantization](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2196) [can reduce model size, how the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2197) [new batch API can enable more](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2199) [efficient processing, and how](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2201) [custom layers and custom models](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2203) [can help you bring cutting-edge](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2204) [machine learning to your app.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2206) [Combined with our great new tool](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2208) [for training models in Create](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2209) [ML, there are more ways than](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2211) [ever to add ML-enabled features](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2212) [to your app and support great](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2214) [new experiences for your users.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2216) [After just a short break, we'll](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2219) [After just a short break, we'll](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2219) [be back right here to take a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2221) [deeper look at some of these](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2222) [features.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2224) [In particular, we'll show you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2224) [how to use our Core ML Tools](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2226) [software to start reducing model](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2227) [sizes and customizing your user](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2229) [experiences with Core ML today.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2231) [Thank you.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2233) [[ Applause ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2234)