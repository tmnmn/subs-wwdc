# What’s New in Core ML, Part 1

## Summary
Introduced just one year ago, Core ML has already revolutionized the way apps can benefit from machine learning, by enabling fast and private on device machine learning features for your app. Find out how new Core ML features let you reduce the size of models, make them more flexible, and dramatically improve performance.

## Info
* Frameworks
* WWDC 2018 - Session 708 - iOS, macOS, tvOS, watchOS
* https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/

## Text
 [（Core ML新特性
第一部分）](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=17) [早上好](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=27) [欢迎大家](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=28) [我是Michael
这次演讲的内容是关于](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=29) [Core ML中的新特性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=32) [一年前推出的Core ML
能够大大简化](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=35) [将机器学习模型整合到app中的过程](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=40) [看到它在过去一年能被广泛使用
真是太棒了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=45) [我们希望它让能所有人思考](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=49) [如果你的app有能力做到以下这些
你可以带来什么样的全新的体验](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=52) [比如理解图片的内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=57) [比如理解图片的内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=57) [或者分析一些文本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=62) [（Cate 你的工作很优秀
继续努力！激励）](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=66) [如果你的app可以理解音频或音乐
你可以做什么](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=68) [或根据用户的动作解释用户的行为](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=75) [甚至可以对其转换或生成新的内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=79) [所有这些 以及更多其它的功能
现在都很容易实现](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=84) [这是因为这种类型的功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=88) [都可在Core ML模型中编码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=91) [现在 如果我们窥视其内部](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=95) [我们可能会找到一个神经网络](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=97) [集成树或其他的模型体系结构](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=100) [它们可能有数百万个参数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=103) [其值是从大量的数据中学习到的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=105) [但是对于你来说
你可以专注于单个文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=110) [你可以专注于它提供的功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=114) [及其带来的体验
而不是那些实现细节](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=117) [及其带来的体验
而不是那些实现细节](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=117) [将Core ML模型添加到
你的app中 非常简单](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=124) [只需将该文件添加到
你的Xcode项目即可](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=126) [Xcode会显示一个简单的视图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=131) [根据其输入及输出来描述它的功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=135) [Xcode还能更进一步
为你生成一个接口](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=140) [这样只需几行代码就可以
与这个模型交互](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=144) [一行用来加载模型](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=148) [一行进行预测](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=151) [有时可以再加一行代码
来提取你感兴趣的特定输出](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=153) [注意在某些情况下
你甚至不必编写这些代码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=157) [因为Core ML与我们的一些
更高级的API集成在一起](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=160) [若你为它们提供Core ML模型
它会允许你自定义它们的行为](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=163) [在Vision中 这通过
VNCoreMLRequest对象完成的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=168) [新Natural Language框架中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=171) [你可以从Core ML模型中
实例化一个MLModel](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=173) [这即Core ML的简介](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=179) [这即Core ML的简介](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=179) [但我们这次要谈论有何新鲜东西](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=181) [我们在过去的一年中
收到了很多来自你们的宝贵意见](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=184) [并在Core ML 2中
重点关注这些改进](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=187) [我们将分两次演讲讨论这些问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=192) [在第一次演讲中
也就是现在这个演讲](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=195) [我们将从你的app的角度
讨论有哪些新特性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=198) [在第二个演讲中
也就是等下经过短暂休息后](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=201) [在上午10点开始的那个演讲](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=204) [我们将讨论一些工具](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=207) [以及如何更新和转换模型](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=209) [来充分利用
Core ML 2中的新功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=211) [当涉及到你的app时
我们将关注三个关键领域](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=216) [首先是你如何在
保证获得同样功能的前提下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=220) [减小app中模型的大小和数量](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=225) [然后 我们将看看
如何从单个模型中获得更好的性能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=228) [接着我们将总结
为什么使用Core ML](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=234) [可以让你跟上发展迅速的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=236) [机器学习领域的最新进展](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=238) [机器学习领域的最新进展](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=238) [我们首先从讨论模型大小开始](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=242) [我将把这个话题
交给Francesco](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=244) [谢谢Michael](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=250) [大家好](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=252) [任何减小Core ML
app大小的方法都非常重要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=254) [我是Francesco
我将要介绍](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=258) [量化和弹性形状](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=260) [它们是在Core ML 2中
可帮助你减小app大小的两项新功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=262) [所以…](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=268) [Core ML是一种在设备上
运行的机器学习模型](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=269) [与在云中运行app相比
它为你的app提供了四大优势](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=273) [首先](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=277) [用户隐私得到充分尊重](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=278) [通过在设备上运行机器学习模型](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=281) [我们保证数据
永远不会离开用户的设备](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=283) [其次 它可以帮助你实现实时性能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=287) [Apple设备对运行
机器学习工作载荷非常高效](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=292) [此外 你不必维护互联网服务器
并为其支付费用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=297) [此外 你不必维护互联网服务器
并为其支付费用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=297) [最后 Core ML的推理过程
随时随地可用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=301) [而不需考虑连接问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=305) [所有这些好处都伴随着这个事实](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=307) [即你现在需要将机器学习模型
存储在设备上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=310) [如果机器学习模型很大
那么你可能会担心](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=314) [你的app的大小](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=317) [假设你有一个很棒的app
它具有很多很酷的功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=319) [你的用户非常喜欢这个app](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=324) [现在你想利用设备上的机器学习](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=326) [所提供的新机会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=329) [来为你的app添加超酷的新功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=332) [那么你怎么做呢
你训练了一些Core ML模型](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=334) [然后将它们添加到你的app中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=337) [这意味着 你的app变得更棒了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=339) [并且你的用户也更加开心](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=342) [但其中一些用户可能会注意到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=345) [你的app大小有所增加](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=347) [app在添加机器学习能力之后](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=349) [变大数十或数百兆字节](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=352) [并不罕见](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=354) [随着你不断向app
添加越来越多的功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=357) [随着你不断向app
添加越来越多的功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=357) [你的app大小可能会失控](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=360) [如果这些机器学习模型](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=364) [正在支持你的app的某些附加功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=366) [你首先可以做的是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=369) [就是将它们保存在
最初的app包之外](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=371) [然后当用户使用这些附加功能时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=375) [你可以根据需要下载它们
并在设备上进行编译](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=377) [因此在这种情况下
用户在开始时就很高兴](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=381) [因为安装大小不变](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=384) [但由于用户在你的app中下载
并使用了所有Core ML功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=387) [最终你的app大小仍然很大](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=391) [那么如果我们采用另一种方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=396) [即缩小模型大小本身
来解决该问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=399) [这不是更好吗？](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=402) [如果我们在app内部自带模型
这会给我们一个更小的安装包](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=406) [而如果我们按需下载模型](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=411) [这可以带来更快 更小的下载文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=413) [无论如何 你的app将有
更小的存储足迹](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=417) [无论如何 你的app将有
更小的存储足迹](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=417) [使用较少的存储空间
使你的app性能更好](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=420) [也对整个系统大有所益](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=423) [所以让我们看看如何将
Core ML app的大小](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=426) [分解成更小的因素
来更好地解决这个问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=429) [首先是模型的数量](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=433) [这取决于你的app
有多少个机器学习功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=434) [然后是权重的数量](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=439) [权重的数量取决于
为了解决你的机器学习问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=441) [你所选择的体系结构](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=444) [如Michael提到的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=446) [权重是机器学习模型存储](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=448) [它在训练期间所学习的信息的地方](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=452) [因此如果它被训练
去完成一项复杂的任务](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=456) [这样的一个模型需要数千万个权重
是很正常的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=460) [最后是每个权重的大小](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=465) [我们如何存储我们在训练期间
学习的这些参数呢？](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=467) [我们首先关注这个因素](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=471) [对于神经网络 我们有几种选择](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=474) [来表示和存储权重](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=476) [在iOS 11的
第一个Core ML版本中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=479) [在iOS 11的
第一个Core ML版本中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=479) [神经网络使用浮点32位权重存储](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=483) [在iOS 11.2中
我们采取了你们的建议](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=489) [并且引入了半精度浮点16位权重](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=492) [这在为app提供相同准确度的基础上
将存储空间缩减为原来的一半](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=496) [但今年 我们想更进一步](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=502) [我们推出了量化权重](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=505) [通过使用量化权重
我们不再受限于](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=508) [只能使用浮点32位或浮点16位值](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=510) [神经网络可以使用8位 4位](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=514) [一直到1位来进行编码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=518) [现在我们来看看这里的量化是什么](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=522) [这里我们想要表示我们的
神经网络权重的一个子集](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=526) [正如我们所看到的
这些权重可以在连续范围内取任何值](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=530) [这意味着在理论上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=535) [每个权重的取值具有无限可能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=538) [每个权重的取值具有无限可能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=538) [因此在神经网络中
我们使用32位浮点数来存储权重](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=541) [这意味着这个权重
可以表达数十亿种数值](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=548) [以更好地表现它们的连续性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=550) [但事实上神经网络也可以
以较低精度权重工作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=554) [量化是将不连续值的取值限制在
其可能取值的子集的过程](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=559) [这个子集非常小并且离散](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=564) [例如 这里的量化过程
使这个连续的权重谱变成了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=571) [只有256个可能取值的子集](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=576) [所以在量化之前
权重可以取任何可能的值](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=579) [量化后 它们只有256种可能取值](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=583) [现在 由于它的权重可以
从这个很小的子集中取得](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=587) [因此Core ML现在只需要8位
即可存储权重信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=592) [但还不止如此 我们可以走得更远](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=596) [但还不止如此 我们可以走得更远](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=596) [比如我们可以限制网络](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=600) [只能取8种值 而不是256种](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=604) [既然现在我们只有8种可能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=609) [Core ML中每个权重将需要
用3位值来存储你的模型](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=612) [这里有一些细节](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=617) [关于我们如何选择这些值](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=619) [来表示其权重](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=621) [它们可以在取值范围内均匀分布](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=622) [在这种情况下 它是一个线性量化](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=626) [然而如果是查找表量化](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=629) [我们可以任意的方式
将这些可能取值分散在这个范围内](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=633) [现在我们来看看
量化如何帮助我们减小模型的大小](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=637) [在这个例子中
我们关注的是Resnet50](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=642) [这是许多app用来
执行许多不同的任务的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=645) [常见体系结构](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=647) [它包含2500万个训练参数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=649) [这意味着如果你使用
32位浮点数来表示它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=653) [那么总模型大小超过100兆字节](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=657) [那么总模型大小超过100兆字节](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=657) [如果我们将它量化为8位
而架构没有发生改变](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=662) [我们仍然有2500万个参数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=666) [但我们现在只使用一个字节](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=669) [来存储单个权重](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=672) [这意味着模型大小减少了4倍](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=674) [现在只需要26兆字节
来存储这个模型](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=677) [我们还可以更进一步](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=680) [我们可以在这个模型中使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=682) [4位来表示每个权重的量化表示](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=684) [并最终得到一个更小的模型](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=687) [Core ML支持所有的量化模式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=696) [直到只需1位](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=700) [现在…](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=704) [量化是一项强大的技术](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=705) [它可以采取现有的体系结构
却具有更小的大小](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=707) [但是你如何获得量化模型呢？](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=711) [如果你有Core ML格式的
神经网络](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=714) [你可以使用Core ML工具
来获得它的量化表示](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=718) [你可以使用Core ML工具
来获得它的量化表示](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=718) [Core ML工具会自动替你量化](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=721) [或者你可以直接训练量化模型](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=725) [你可以使用量化约束
从零开始进行量化训练](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=729) [或者用量化约束重新训练现有模型](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=731) [在你获得量化模型和训练工具后](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=736) [你可以像平常一样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=738) [将其转换为Core ML](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=740) [在app中
使用模型的方式不会改变](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=742) [在模型中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=745) [数字将以不同的精度进行存储](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=747) [但使用该模型的接口完全不会改变](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=749) [但我们总是需要考虑到
量化模型](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=755) [只是原始浮点模型的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=758) [较低精度的近似](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=760) [这意味着量化模型](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=764) [具有精确性与模型大小的折衷](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=765) [这种折衷取决于模型和用例](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=769) [这也是一个非常活跃的研究领域](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=773) [因此总是建议检查量化模型的准确性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=776) [并将其与原来的浮点数版本进行比较](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=780) [你应在检查中使用相关的测试数据
以及适用于你的app和用例的指标](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=784) [现在让我们看一个如何采用量化模型](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=788) [来减小app大小的演示](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=792) [我想向你展示一款风格转换app](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=805) [在风格转换app中 有一个训练好的
神经网络被用来渲染用户图像](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=808) [该网络使用通过观看绘画或其他图像
学习到的风格来对用户的图像渲染](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=812) [首先加载app](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=816) [我们可以看到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=819) [我的app中内置了四种风格](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=820) [城市 玻璃 油画和波浪](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=822) [然后我可以从用户的照片库中
选择图片](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=825) [然后通过在设备上
以不同风格渲染来处理它们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=829) [这是原始图像
我将其渲染为城市风格](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=833) [玻璃风格](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=839) [玻璃风格](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=839) [油画风格](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=842) [和波浪风格](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=844) [看看该app
是如何在Xcode中构建的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=847) [这个app使用Core ML
和Vision API执行这种风格化](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=850) [如我们所见 我们在Xcode中
捆绑了四个Core ML模型](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=856) [城市、玻璃、油画和波浪
与我们在app中看到的一样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=860) [我们可以检视这个模型
这些仍然是未经量化的模型](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=864) [所以这些模型中的每一个
都占用6.7兆字节的磁盘空间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=868) [我们看到模型的输入
是特定分辨率的图像](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=873) [并生成一个名为Stylized的
相同分辨率的的图像](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=876) [现在我们想知道
我们可以通过切换为量化模型](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=880) [节省多少存储空间和内存空间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=885) [我已使用
Core ML Tools](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=888) [获得了所有这些模型的量化表示](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=891) [有关如何获取这些模型的教程](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=896) [参见稍后第二部分 其将详细介绍
Core ML Tools的量化过程细节](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=898) [参见稍后第二部分 其将详细介绍
Core ML Tools的量化过程细节](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=898) [我想先关注玻璃风格](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=904) [并查看不同的量化版本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=906) [对这些风格的效果影响如何](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=909) [我所要做的就是
将这些新模型拖入Xcode项目中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=911) [并重新运行该app
然后我们再看看这些模型的表现](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=917) [首先我们可以看到app大小
现在大幅缩小了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=922) [例如 8位版本已经
从原来的6.7兆字节](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=925) [缩小到1.7兆字节](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=930) [在4位版本中 我们可以节省更多](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=937) [现在模型少于1兆字节](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=939) [在3位版本中 它是649千字节
等等](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=941) [现在让我们回到app](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=946) [让我们选择相同的图像作为参考](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=951) [并在原始版本中应用玻璃风格](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=953) [仍然像以前一样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=957) [现在我们可以将它
与8位版本进行比较](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=958) [现在我们可以将它
与8位版本进行比较](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=958) [你可以看到没有任何改变](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=964) [这是因为8位量化方法非常稳定](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=966) [我们还可以进一步尝试
这种模型的4位版本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=970) [哇 结果仍然很好](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=976) [现在让我们试试3位版本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=980) [我们看到第一次颜色偏移](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=984) [因此 我们最好去和设计师核对一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=987) [这种效果是否仍然可以接受](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=990) [现在 当我们看到2位版本时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=993) [这不是我们所期待的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=996) [也许我们会将它保存为一恐怖app](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=997) [但我不打算向设计师展示这个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=999) [让我们回到4位版本并隐藏这个版本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1006) [这只是在提醒我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1009) [量化模型是原始模型的一个近似](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1012) [因此你最好检查它们
并与原始版本进行比较](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1015) [现在 对于每种模型和量化技术](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1019) [现在 对于每种模型和量化技术](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1019) [事情总会从某点开始变得不太匹配](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1021) [在与设计师进行了一些讨论](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1026) [并对许多图像进行了广泛的评估之后
我们决定发布](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1029) [这个模型的4位版本
这是最好的质量中的最小尺寸](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1032) [让我们删除app中占了大量空间的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1036) [所有的浮点版本模型](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1039) [并将其替换为4位版本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1043) [现在让我们最后一次运行app](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1051) [我们再次选择相同的图像](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1060) [并显示所有风格](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1065) [这是这个城市风格](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1068) [玻璃风格](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1070) [油画风格](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1073) [和大波浪风格](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1076) [在这个演示中
我们从四个庞大的32位模型开始](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1080) [其总app大小为27兆字节](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1085) [然后我们评估质量并切换到4位模型](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1089) [我们app的总大小一路降到
只有3.4兆字节](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1092) [现在…](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1097) [这在质量方面没有任何缩水](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1103) [因为所有这些量化版本
看起来都是一样的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1106) [质量仍然令人满意](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1110) [我们看到了量化如何
通过在微观层面减少权重的大小](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1114) [来帮助我们缩小app的大小](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1117) [现在让我们看看
如何减少app需要的模型数量](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1122) [在最简单的情况下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1127) [如果你的app有三种机器学习功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1130) [那么你需要三种不同的机器学习模型](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1133) [但在某些情况下
有可能使用同一个模型](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1136) [但在某些情况下
有可能使用同一个模型](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1136) [来支持两种不同的功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1141) [例如 你可以训练一个多任务模型](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1144) [多任务模型被训练成
一次执行多项任务](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1147) [Turi Create演讲中
有个关于风格转换的例子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1152) [涉及到多任务模型](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1154) [或者 在某些情况下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1156) [你可以在Core ML中使用一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1158) [被称为“弹性形状和尺寸”的新特性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1161) [让我们回到风格转换演示](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1164) [在Xcode中
我们看到输入图像和输出图像的大小](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1168) [被编码到模型的部分定义中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1172) [但如果我们想在不同的图像分辨率下
运行相同的风格呢？](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1176) [如果我们想在不同的图像尺寸上
运行相同的网络 该怎么办？](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1181) [例如](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1186) [用户可能希望看到
高清版本的风格转换](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1188) [所以他们给我们一个高清图像](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1191) [现在如果我们的Core ML模型
仅以较低的分辨率作为输入](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1195) [作为开发者我们能做的只有
缩小图片的尺寸 处理它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1200) [然后再将其放大
这实际上并不会让用户感到满意](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1206) [即便在过去](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1211) [我们也可使用Corel ML Tools
重新安装此模型](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1214) [并让它接受任何分辨率的图像](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1216) [特别是高分辨率图像](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1219) [因此即使在过去
我们也可以实现此功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1223) [并将高分辨率图像
直接传给Corel ML模型](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1227) [然后产生一个高分辨率的结果](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1229) [这是因为我们想要在风格化中
引入更精细的细节](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1233) [并有更精细的笔触
使得放大时的效果非常好](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1237) [因为它们在最终图像中
进行了大量的工作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1241) [过去我们的确可以做到
但我们使用的方式是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1246) [复制模型并创建两个不同的版本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1249) [一个用于标准画质
一个用于高清画质](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1253) [这当然意味着我们的app大小
变为原来的两倍](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1256) [这当然意味着我们的app大小
变为原来的两倍](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1256) [尽管这个网络](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1260) [是被训练为处理任何分辨率的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1261) [现在不再是这样了
我们推出了弹性形状](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1264) [通过使用弹性形状
你可以用单一的模型](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1267) [来处理更多的分辨率种类](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1271) [现在在Xcode中…](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1275) [在Xcode中 你会看到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1281) [输入仍然是图像](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1284) [但除了默认分辨率
模型也接受弹性分辨率](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1287) [在这个简单的例子中
它们分别是标清和高清](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1292) [这意味着现在你只需安装一个模型](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1296) [你不必写任何冗余代码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1300) [如果你需要在标清和高清之间切换](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1303) [其速度非常快 因为我们不需要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1306) [重新加载模型
我们只需要调整它的大小](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1308) [你有两种方法来指定模型的弹性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1312) [你可以为其维度定义一个范围](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1316) [你可以定义一个最小的宽度和高度](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1319) [你可以定义一个最小的宽度和高度](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1319) [以及一个最大的宽度和高度](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1321) [然后在推理过程中
使用两者之间的任何值](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1323) [但也有另一种方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1327) [你可以枚举你要使用的所有形状](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1328) [例如 所有不同的宽高比](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1331) [所有不同的分辨率
这样做的性能会更好](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1334) [Core ML更早地了解你的用例](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1337) [因此它有机会进行更多的优化](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1340) [这也为你的app提供了更小的测试面](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1344) [那哪些模型是弹性的呢？](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1349) [哪些模型能被训练
以支持多种分辨率呢？](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1350) [完全卷积神经网络
通常用于图像处理任务](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1356) [如风格转换 图像增强
超分辨率等等](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1360) [它还被用来实现一些对象检测架构](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1365) [Core ML工具可以替
你检查模型是否具备此功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1368) [我们看到了如何使用弹性大小
来减少模型的数量](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1374) [以及权重的大小可以通过量化来缩小](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1377) [以及权重的大小可以通过量化来缩小](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1377) [那权重的数量呢？](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1380) [Core ML](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1383) [考虑到它支持](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1384) [许多不同的架构和训练框架](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1385) [它一直帮助你为你的机器学习问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1388) [选择合适大小的模型](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1392) [因此 Core ML可以同时使用
这三种因素](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1394) [来帮助你解决你的app大小的问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1398) [在任何情况下
推理都将是超高性能的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1401) [为了介绍在性能和定制化中
引入的新功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1404) [让我们欢迎Bill March
谢谢](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1408) [谢谢](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1417) [Core ML
最初的基本设计原则之一](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1419) [就是它应该为你的app
提供可能的最佳性能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1423) [为了达到这个目标 我想强调一下
Core ML的一个新特性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1426) [以帮助你的app能够
在任何Apple设备上表现耀眼](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1430) [我们来看看
Francesco向我们展示的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1434) [风格转换示例](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1436) [从你的app的角度来看](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1438) [它需要一个输入的图像
并简单地返回风格化的图像](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1440) [有两个关键组件可以实现这一点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1444) [第一个是MLModel文件
它存储了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1447) [应用此风格所需的特定参数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1451) [第二个是推理引擎](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1453) [它摄入MLModel和图像](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1455) [并执行必要的计算以生成结果](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1458) [让我们来看看这个推理引擎的底层](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1461) [以及我们如何利用Apple
提供的技术高效地执行这种风格转换](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1464) [这个模型是一个神经网络的例子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1470) [它由一系列称为层的数学运算组成](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1472) [每个层都会对图像进行一些转换](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1476) [最终产生风格化输出](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1479) [模型存储了每个层的权重](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1482) [这些权重决定了特定的转换
以及我们将要应用的风格](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1485) [Core ML神经网络推理引擎](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1489) [为这些层中的每一层
都进行了高度优化的实现](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1491) [在GPU上 我们使用MTL着色器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1495) [在CPU上 我们可以使用
Accelerate进行有效计算](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1497) [在CPU上 我们可以使用
Accelerate进行有效计算](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1497) [并且我们可以进行调度
以将计算的不同部分](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1501) [根据模型 设备状态和其它因素](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1503) [动态地分配给不同的硬件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1507) [我们也可以找到
融合网络中的层的机会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1511) [这会减少所需的整体计算](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1514) [我们能够在这里进行优化
因为我们知道发生了什么](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1518) [我们知道模型的细节](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1522) [它们包含在你提供给我们的
MLModel文件中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1523) [我们知道推理引擎和设备的细节](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1526) [因为我们设计了它们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1530) [我们可以为你处理所有这些优化](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1532) [以使你可以专注于
在你的app中提供最佳的用户体验](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1535) [但是你的工作载荷呢？](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1540) [特别是 如果你需要进行多重预测
那该怎么办呢？](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1542) [如果Core ML不知道它
Core ML就无法对其进行优化](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1547) [因此在过去
如果你有这样的工作载荷](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1551) [你需要做这样的事情：](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1555) [一个简单的for循环 环绕着
对现有Core ML的prediction API的调用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1557) [一个简单的for循环 环绕着
对现有Core ML的prediction API的调用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1557) [你可以遍历一个输入数组
并产生一个输出数组](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1561) [让我们仔细看看
我们这样做时底层所发生的情况](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1566) [对于每张图片
我们都需要做一些预处理工作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1572) [如果没有别的要做了
我们需要将数据发送到GPU](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1575) [一旦我们完成这些
我们就可以进行计算](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1579) [并生成输出图像
但接下来有一个后处理步骤](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1581) [我们需要从GPU中拿回数据
并将其返回给你的app](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1585) [改善这张图片的关键](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1589) [是消除GPU管道中的气泡](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1591) [出于两个主要原因
这将导致更高的性能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1595) [首先 由于GPU不曾空闲](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1598) [整体计算时间得到了缩短](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1601) [第二 由于GPU持续工作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1604) [它能够以更高的性能状态运行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1607) [并减少计算每个特定输出所需的时间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1610) [但Core ML的魅力在于
你不必关心](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1615) [这其中的任何细节
事实上 在你的app中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1618) [这其中的任何细节
事实上 在你的app中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1618) [你需要关心的仅仅是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1621) [用户得到结果的时间变短了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1623) [所以今年我们推出了
一个新的批处理API](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1627) [可以让你做到这一点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1631) [之前你需要循环遍历输入](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1634) [并调用它们各自的预测
然而新的API非常简单](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1636) [单行预测代码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1640) [它会摄入一个输入数组
并产生一个输出数组](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1642) [Core ML将负责其余部分](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1646) [让我们看看它的实践](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1654) [继续我们的风格转换示例](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1656) [让我们看看我们想要为整个照片库](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1659) [应用风格转换的情况
这里我有一个简单的app](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1662) [就是用来做这件事的
我打算将风格应用于200张图片](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1665) [在左边 你们的左边](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1669) [这是在for循环中
使用去年的API的实现](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1671) [在右侧
则是我们新的批处理API](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1675) [让我们开始吧](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1678) [我们开始了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1680) [我们可以看到新API已完成](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1683) [我们等一下去年的技术](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1685) [好了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1688) [在这个例子中
我们看到了新的批处理API](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1695) [明显的改进](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1697) [一般来说 你在app中看到的改进
取决于模型](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1699) [以及设备和工作载荷](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1702) [但若你有大量prediction
要调用 请使用新的API](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1704) [并为Core ML
提供加速计算的机会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1708) [当然 世界上性能最好的app
如果不能提供](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1715) [你想为你的用户提供的体验
它也并不特别令人激动](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1719) [我们希望确保无论该体验是什么](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1723) [或将来是什么样的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1726) [Core ML的性能
和易用性都一如既往](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1728) [但机器学习领域正在迅速发展](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1732) [我们将如何跟上呢？
而且跟上的速度有多快呢？](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1735) [让我告诉你一个跟这个问题有关的
我自己的故事](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1738) [让我告诉你一个跟这个问题有关的
我自己的故事](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1738) [让我们看一个
可以用机器学习来回答的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1742) [看似简单的问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1745) [给出一张图片 我想知道
其中有马吗？](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1747) [我想我听到一两声笑了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1752) [也许这是一个愚蠢的挑战问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1754) [顺便说一句 小孩儿都好这口](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1756) [很久很久以前
当我刚开始读研究生的时候](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1759) [我当时正在考虑这个问题
并首次接触机器学习](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1764) [我对这个问题的看法像下面这样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1767) [“我不知道 似乎很难
我真的没有什么好主意”](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1770) [几年过去了 我变老了
希望也能变得更聪明一点了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1775) [但是这个领域非常迅速地发展](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1780) [因这时开始出现很多
使用深度神经网络](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1783) [得到的令人兴奋的新结果](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1785) [就这样 我对这个问题的看法
就改变了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1787) [突然间 哇 原来这些先进的研究
真的可以回答这些问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1790) [电脑现在可以赶上小孩子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1793) [和马识别技术了
多么令人兴奋的发展](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1795) [又经过了几年](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1800) [现在我在Apple工作
对这个问题的看法又改变了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1802) [现在只需要使用Create ML
它的用户界面很漂亮](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1806) [你将在几分钟内拥有一个马分类器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1810) [所以 你知道
如果你是机器学习专家](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1813) [且正在看这个 你可能会想
“哦 这个人](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1815) [不知道他在说什么](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1817) [在2007年我就知道
如何解决这个问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1819) [到2012年我已解决它一百次了”](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1821) [这不是重点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1824) [如果你是一个关心
持久且高质量软件的人](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1825) [这会让你感到紧张
因为在11年内](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1830) [我们看到这个问题的环境
发生了天翻地覆的变化](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1832) [所以我们看看
Core ML中的另一些功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1836) [来让你将悬着的心放下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1838) [为了做到这一点
我们再次进入底层并窥视](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1841) [这个新的马匹识别模型
这又是一个神经网络](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1844) [如前所述](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1849) [神经网络由一系列层组成](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1851) [我们在推理引擎中对其中每一层](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1854) [都有高度优化的实现](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1857) [我们支持的操作列表很庞大
而且一直在增长](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1860) [试图跟上这一领域的新发展](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1864) [但是如果在Core ML中
有一层不再得到支持了呢？](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1867) [过去](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1872) [你要么等待
要么需要一个不同的模型](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1873) [但如果这层是关键的马匹识别层呢？](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1877) [这是你的马匹识别app
正在等待的突破](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1881) [你等得起吗？](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1883) [鉴于机器学习的发展速度
这可能是一个严重的障碍](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1886) [因此 我们为神经网络模型
引入了自定义层](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1891) [现在 如果缺少某个神经网络层
你可以提供一个实现](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1895) [它将与Core ML
模型的其余部分无缝衔接](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1899) [在模型中
自定义层存储了实现类的名称](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1904) [在这里是
AAPLCustomHorseLayer](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1908) [实现类在推理引擎中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1911) [充当所缺失实现的角色](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1914) [就像这个层
内置于Core ML一样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1915) [这里提供的实现应该是通用的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1917) [这里提供的实现应该是通用的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1917) [并适用于新层的任何实例](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1921) [它只需要在运行时
被包含在你的app中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1924) [然后这个特定层的参数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1927) [和其他有关该模型的信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1930) [将一同被封装在MLModel中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1932) [实现一个自定义层很简单
我们暴露了MLCustomLayer协议](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1935) [你只需根据存储在
MLModel中的数据](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1940) [提供用来初始化层的方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1942) [你需要提供一个方法
来告诉我们需要为该层的输出](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1946) [分配多少空间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1949) [然后是执行计算的方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1951) [另外 你可以添加这种灵活性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1954) [而不牺牲整个模型的性能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1957) [该协议包含一个可选的方法
它允许你提供给我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1961) [一个该层的MTL着色器的实现](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1963) [如果你给我们这个 那么它可以在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1968) [与其它Core ML计算所在的
同样命令缓冲区中被编码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1970) [所以这里没额外的开销
无论是来自额外的编码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1973) [还是多次往返GPU产生的开销](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1976) [如果你不提供这个
那么我们将简单的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1978) [如果你不提供这个
那么我们将简单的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1978) [在CPU上进行计算
而不会做其他这些工作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1980) [因此 不管神经网络模型的进展
有多快](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1984) [你都有办法跟上Core ML](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1988) [但有一些限制](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1990) [自定义层仅适用于神经网络模型](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1992) [他们只能处理
ML MultiArrays的输入和输出](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1995) [这是一种与神经网络交互的自然方式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=1999) [但机器学习领域几乎不会限制](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2001) [只在这个领域前进](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2003) [实际上 当我第一次学习图像识别时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2006) [几乎没有人在谈论将神经网络
作为解决这个问题的方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2009) [今天你可以看到
这绝对是最先进的技术](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2012) [并不难想象具有机器学习功能的app](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2017) [可能会导致有些自定义层根本不适用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2020) [例如 机器学习app
可能会使用神经网络](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2023) [来向某个相似空间中嵌入图像
然后使用使用最近邻法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2026) [或局部敏感哈希法
或其它什么方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2030) [来查找相似的图像](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2033) [模型可能会结合
音频和动作数据来提供鼓励](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2036) [给那些并不总能完成跑步目标的人](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2039) [给那些并不总能完成跑步目标的人](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2039) [甚至是一种我们甚至还没有想到的
能为你的用户提供新颖的体验的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2044) [全新模型类型](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2048) [在所有这些情况下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2050) [如果我们可以拥有Core ML的
简单性和可移植性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2052) [而不必牺牲灵活性来跟上领域的发展
将是很棒的一件事](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2055) [所以我们推出了自定义模型](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2060) [Core ML自定义模型允许你](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2063) [封装Core ML中缺少的
部分计算实现](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2066) [就像自定义层一样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2070) [该模型存储了实现类的名称](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2071) [这个类则充当了这类模型的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2074) [通用推理引擎的角色](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2077) [而参数像以前一样
存储在MLModel中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2079) [这允许将模型
作为app中的资源进行更新](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2083) [而无需接触代码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2086) [并且实现自定义模型也很简单](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2090) [我们暴露了一个协议
MLCustomModel](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2092) [你根据存储在MLModel中
的数据提供初始化的方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2095) [再提供一个
根据输入计算预测结果的方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2100) [如果有机会在这个特定的模型类型中
进行一些优化](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2103) [我们还有一个可选的方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2106) [来提供批处理实现](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2108) [如果没有
我们将在for循环中调用每个预测](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2110) [在你的app中使用自定义模型](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2114) [与使用其他任何Core ML模型
在工作流程上基本相同](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2116) [在Xcode中
一个带有自定义组件的模型](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2119) [将有一个依赖项部分
其将列出所需实现的名称](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2122) [以及简短的描述](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2126) [只需将其包含在你的app中
就可以开始使用了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2128) [原来的prediction API没有改变
无论是单个还是批处理预测](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2131) [因此 自定义层和自定义模型允许你](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2138) [使用Core ML的强大能力
和简洁性而不牺牲所需的灵活性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2141) [这种灵活性对跟上
机器学习领域的进展至关重要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2145) [对于新的神经网络层 自定义层
允许你使用Core ML中的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2148) [神经网络推理引擎中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2152) [已经存在的诸多优化](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2154) [自定义模型对于类型和功能更加灵活](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2157) [自定义模型对于类型和功能更加灵活](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2157) [但他们的确需要你做更多的实现工作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2161) [这两种自定义形式都允许你
在MLModel中封装模型参数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2165) [使得模型可移植且代码更简单](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2169) [我们只接触到Core ML 2中的
一小部分很棒的新功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2175) [请下载测试版 自己尝试一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2180) [Core ML具有许多优秀新特性
可以减少你的app大小](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2187) [提高性能 确保灵活性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2190) [并兼容机器学习的最新进展](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2193) [我们向你展示了量化如何
缩小模型大小 和新的批处理API](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2196) [可以实现更高效的处理
以及自定义层和自定义模型](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2200) [如何帮助你将先进机器学习技术
应用到你的app中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2204) [结合我们在Create ML中
训练模型的强大的新工具](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2208) [将机器学习功能添加到你的app中
并为你的用户提供全新的体验](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2211) [的方式比以往任何时候都多](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2215) [短暂休息后](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2219) [短暂休息后](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2219) [我们会回到这里
并深入了解这些功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2221) [特别是 我们将向你展示如何使用
我们的Core ML工具软件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2224) [来缩小模型大小并使用
Core ML自定义你的用户体验](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2228) [谢谢](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/708/?time=2232)