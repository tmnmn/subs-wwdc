# Getting and Using a MapKit JS Key

## Summary
MapKit JS uses the JWT standard for ensuring a secure connection between your site and the MapKit JS services.  Learn how to create, protect, and use site-specific keys to ensure only your servers are accessing APIs linked to your domain.

## Info
* Frameworks
* WWDC 2018 - Session 508 - iOS, macOS
* https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/

## Text
 [（获取和使用
MAPKIT JS密钥）](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=17) [欢迎来到演讲508
获取和使用MapKit JS密钥](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=22) [我是MapKit JS团队的
Eric Gelinas](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=26) [在这段视频里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=29) [我们将学习
MapKit JS授权如何工作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=30) [创建一个MapKit JS密钥](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=33) [创建一个授权令牌](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=36) [最后 我们将制作一张地图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=37) [让我们深入了解一下
授权在MapKit JS中的过程](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=40) [（网络是纯文本）](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=44) [你放在网上的任何内容（包括
MapKit JS）都是纯文本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=45) [网络的伟大之处之一在于](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=49) [仅仅通过查看源代码
就可以学习他人技术](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=51) [只需打开网络检查器
看看它是如何完成的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=56) [看到你喜欢的地图了吗？](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=59) [看到你喜欢的地图了吗？](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=59) [查看它的源代码
看看它是如何工作的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=60) [我就是这样来学习的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=62) [问题是 有时这意味着](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=65) [你的API授权凭证可以被复制](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=67) [而且未经你的许可而误用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=70) [未经授权的使用
可能会使你超出你的使用限制](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=73) [一旦达到限制](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=78) [你的网站可能无法再显示地图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=79) [MapKit JS授权系统
旨在对如何使用你的凭证](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=83) [为你提供更多控制](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=86) [你可以设置访问应该到期的时间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=89) [并限制对特定域名的访问](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=93) [当然 网络的特点是
其他人仍然可以查看源代码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=96) [并用网络检查器读取有关信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=99) [但是如果有人出于任何原因
而得到了你的身份](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=101) [如何使用它将是有限制的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=104) [让我们来概括地谈谈
MapKit JS授权如何工作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=107) [你拿到了MapKit JS密钥后
要把它保存在一个安全的地方](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=112) [绝不能通过网络共享](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=117) [相反 你将创建有限制的令牌](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=119) [相反 你将创建有限制的令牌](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=119) [并用你的密钥来签名](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=121) [你就用这个令牌](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=124) [通过MapKit JS API
进行授权](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=126) [让我们看看如何创建
一个MapKit JS密钥](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=130) [MapKit JS密钥
是你的身份凭证](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=135) [与MapKit JS API
一起使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=137) [这是一次性设置
具体过程是这样的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=140) [创建一个地图标识符](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=143) [创建一个MapKit JS密钥
并将其与该标识符关联](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=145) [然后下载你的密钥
并将其保存到一个安全的地方](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=150) [在我们开始之前](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=154) [请到
developer.apple.com/account登录](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=155) [左侧菜单中 单击
Certificates 然后IDs](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=160) [再Profiles](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=163) [我们的第一步是创建一个地图标识符](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=167) [这将在Apple Developer
网站中识别你的项目](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=170) [同时它也用于跟踪使用限制](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=174) [你可能想要对生产和开发环境](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=178) [你可能想要对生产和开发环境](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=178) [创建不同的标识符](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=181) [要创建地图标识符](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=184) [从菜单中选择地图标识符](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=186) [点击右上角的 + 按钮](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=190) [给这个标识符一个说明](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=194) [这个说明应该是你显示给用户的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=196) [网站的名称](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=198) [给这个标识符一个独特的ID](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=201) [我们建议为此ID
使用反向域名风格命名](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=203) [它需要以字符串maps开始](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=207) [例如](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=212) [maps.com
yourdomainname.yourapp](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=213) [下面我们将创建一个
MapKit JS密钥](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=220) [此密钥是你与Apple之间的秘密](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=222) [绝不应该存储在前端代码中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=225) [存入源代码管理
或与其他人共享](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=228) [首先点击左侧菜单中
Keys副标题下的All](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=232) [然后点击标题中的 + 图标](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=238) [然后点击标题中的 + 图标](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=238) [下面给这个新的密钥命名](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=242) [再选择MapKit JS复选框](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=246) [然后点击Configure按钮](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=251) [现在你已经创建了一个新的密钥](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=254) [我们可以从Maps下拉菜单中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=256) [将它与你之前创建的
地图标识符相关联](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=260) [地图标识符同时只能与一个密钥关联](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=264) [当你选择了你的地图标识符后
请点击Continue](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=269) [最后在出现提示时复查你的输入
然后单击Confirm](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=274) [现在可以下载你的密钥了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=280) [点击Download按钮](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=283) [将你的授权密钥文件
保存到你的计算机](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=284) [你只能下载此文件一次](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=287) [请务必保存在安全的地方](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=289) [若这个文件找不到了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=291) [你需要创建一个新的密钥](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=292) [然后撤销旧密钥](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=294) [下载时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=297) [你的授权密钥文件看起来像这样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=298) [你的授权密钥文件看起来像这样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=298) [如我之前所说](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=301) [此密钥旨在成为
你与Apple之间的秘密](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=302) [这是你唯一能够下载
验证密钥文件的时间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=307) [我们建议你尽快将其
保存在安全的地方](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=310) [如果你丢失了钥匙或者钥匙被盗用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=314) [你可以随时回到
Apple Developer网站](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=317) [来撤销它并创建一个新的密钥](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=320) [你刚创建了一个
MapKit JS密钥](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=325) [现在我们将创建授权令牌](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=328) [可用于通过Web授权
MapKit JS](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=330) [令牌创建时包含了开发人员的身份](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=336) [并使用你的授权密钥文件进行签名](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=339) [声明被添加到此令牌中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=342) [Apple用它来验证客户的授权](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=344) [让我们深入了解如何制作授权令牌](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=349) [MapKit JS授权令牌](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=355) [基于JSON Web令牌
RFC 7519](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=357) [基于JSON Web令牌
RFC 7519](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=357) [简称JWT](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=362) [这是专为传输通过网络的授权声明](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=364) [而设计的行业标准](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=369) [你可以在jwt.io上
找到关于此标准的更多信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=372) [你还可以找到用大多数编程语言写的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=377) [用于签署JWT令牌的库](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=381) [所有JWT令牌都由以下三部分组成](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=385) [头部 有效载荷和签名](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=389) [以句点进行分隔
并对每个Base64 URL编码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=394) [这就是一个可以
很容易传递给请求头的令牌](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=399) [为你的授权令牌
我们有两种](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=404) [推荐的JWT配置](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=407) [短命令牌和长命令牌](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=409) [让我们从短命令牌开始](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=414) [这些授权令牌
可以最大程度地防止滥用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=417) [这些授权令牌
可以最大程度地防止滥用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=417) [通过确保授权令牌如果从源代码复制](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=421) [不能长期使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=425) [这种方法要求你提供服务器端点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=427) [响应来自MapKit JS的请求](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=430) [获取新的授权令牌](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=433) [任何时候我们需要
在用户会话中进行授权](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=435) [MapKit将从此端点刷新](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=438) [首先有效载荷必须包含ISS声明](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=443) [这是你的Apple Developer
Program ID](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=448) [你可以到
Apple Developer网站](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=451) [从帐户部分找到你的团队ID](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=453) [IAT声明](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=457) [这是以秒计算的授权令牌发出的时间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=459) [EXP声明](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=464) [这是以秒计算的授权令牌到期时间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=466) [对于短期令牌 我们建议30分钟](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=470) [最后 一个起源的声明](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=474) [这可以通过匹配原始标题
来限制浏览器访问](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=477) [这可以通过匹配原始标题
来限制浏览器访问](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=477) [虽然此声明是可选的 但我们建议](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=483) [所有授权令牌都用它
尤其是在生产中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=485) [其次 你先前下载的
授权密钥文件内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=490) [这个完整的文件
包括空白 页眉和页脚](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=495) [应该用来签署此令牌](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=500) [请参阅你的JWT签名库的文档](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=502) [获取特定于你的编程语言的指令](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=506) [最后 JWT令牌的标题部分
将包含KID声明](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=510) [这是你的MapKit JS
密钥ID](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=516) [注意这与你的地图标识符不同](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=519) [TYP声明应该是字符串JWT](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=523) [来识别这是一个JWT风格的标记](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=527) [和一个ALG声明
这是使用的散列算法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=530) [这必须设置为ES256](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=535) [当它传递给你的JWT签名库时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=540) [将输出一个JWT令牌](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=542) [由MapKit JS使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=545) [由于短命令在用户完成其会话之前](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=548) [可能会过期](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=550) [你的服务器需为MapKit JS
提供一个端点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=552) [将响应新令牌的请求](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=556) [稍后我将向你展示如何使
MapKit JS知道你的端点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=558) [但现在 我已经创建了
一个快速的JS路线](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=562) [这里是一个端点的例子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=564) [每次调用时 这条路线只是返回
一个新的访问令牌](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=568) [设置为在1800秒或30分钟内](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=571) [过期](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=575) [无论你的令牌是否到期](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=576) [贯穿用户的会话](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=579) [任何时候需要授权](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=581) [MapKit JS会调用该端点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=583) [由于你的端点需要返回一个新的令牌](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=586) [每次调用时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=589) [你需要让浏览器知道不要缓存](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=590) [你可以通过设置缓存控制标题来做到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=593) [如果设置正确](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=597) [你应该在你的服务器上
有一个返回令牌的路线](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=599) [你应该在你的服务器上
有一个返回令牌的路线](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=599) [看起来像这样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=601) [长寿命的标记是不同的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=605) [其到期时间设定得远得多](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=607) [你可以在很长一段时间
对许多请求](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=609) [使用相同的标记](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=612) [这种类型的令牌不需要服务器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=614) [因为令牌在用户的会话期间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=617) [不易过期](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=619) [出于这个原因
它可以很容易地在静态网站上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=622) [或在开发环境中使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=625) [你可以根据你的发布周期](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=627) [同步调整令牌的到期和续订](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=631) [我们强烈建议你在长寿命的令牌中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=633) [附上来源声明](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=636) [让我们看看这如何完成](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=637) [在这个例子中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=640) [我们设置了长达6个月的长期令牌](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=641) [如我之前所说](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=645) [你可以根据你的app的需要改动](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=646) [例如 如果你团队的发布周期是两周](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=649) [你可以设置你的期望与之同步](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=652) [甚至加几个星期作为缓冲](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=656) [无论什么情况下 建议设置原始声明](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=659) [无论什么情况下 建议设置原始声明](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=659) [尤其是长期到期的令牌](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=663) [这是你防止滥用你的身份的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=666) [最强的防守](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=667) [现在令牌在手 我们准备做一张地图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=671) [最简单的例子就是
创建一个HTML页面](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=675) [包括链接到Apple CDN上的
MapKit JS的脚本标记](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=679) [记得吗 刚才我说我会展示](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=686) [如何使MapKit JS
知道你的令牌端点？](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=687) [这发生在初始化
MapKit JS过程中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=692) [当你提供回调函数时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=694) [对于短命令牌](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=697) [MapKit JS
将在整个用户会话过程](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=699) [根据需要获取新的令牌](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=701) [请注意 当MapKit JS
调用你的回调函数时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=706) [它会传递一个函数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=710) [在我们的例子里我们调用Done](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=712) [用你的新令牌调用这个函数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=715) [以允许MapKit JS
继续进行授权过程](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=717) [以允许MapKit JS
继续进行授权过程](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=717) [如果你使用的是长寿命的令牌](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=723) [只需在授权回调函数的主体中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=725) [立即调用Done](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=727) [任何时候需要刷新其授权时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=731) [MapKit JS
将使用相同的长命令标记](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=734) [最后 为地图设置一个地图框和中心](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=739) [让我们启动我们的服务器
并观察这些步骤](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=745) [如果一切设置正确](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=751) [你的浏览器应显示一个地图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=753) [如果你在网络检查器中使用短命令牌](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=756) [你应该保证服务器端点被调用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=760) [返回授权令牌](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=763) [既然MapKit JS有了授权](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=766) [它会完成其余的工作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=769) [任何时候它需要一个新的令牌](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=771) [MapKit JS
会从你的路线请求](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=774) [现在你知道了
MapKit JS授权如何工作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=777) [现在你知道了
MapKit JS授权如何工作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=777) [你也知道了如何创建一个
MapKit JS密钥](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=782) [创建一个授权令牌](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=785) [以及如何用你的新令牌做一个地图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=787) [请记住 获取你MapKit JS
密钥并将它存储在安全的地方](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=794) [只能通过网络发送授权令牌](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=799) [如果某个密钥泄露](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=802) [你只要创建并更新你的网站](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=804) [然后在Apple Developer网站上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=807) [撤消旧密钥](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=810) [想要了解更多信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=812) [请访问
developer.apple.com/wwdc18/508](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=814) [看看我们的演讲](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=823) [“引入MapKit JS”](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=824) [星期二下午5点在行政宴会厅举行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=826) [谢谢](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/508/?time=830)