# TextKit Best Practices

## Summary
Leverage the abilities of TextKit to provide the best experience possible displaying and editing text. Get the best performance out of your app by using TextKit effectively. Learn the concepts to do more complex handling, layout and presentation.

## Info
* Frameworks
* WWDC 2018 - Session 221 - iOS, macOS
* https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/

## Text
 [[ 音乐 ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=6) [[ 掌声 ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=20) [&gt;&gt; 大家好](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=25) [欢迎来到 221 号讨论会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=27) [“TextKit Best Practices（最佳实践）”](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=29) [我是 Donna Tom](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=29) [一名 TextKit 工程师](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=31) [我的同事 Emily Van Haren](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=32) [今天也会和我一起介绍](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=35) [她来自创作工具组](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=36) [我们非常激动能够](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=37) [和大家分享](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=38) [运用 TextKit 的一些最佳实践](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=39) [让我们开始吧](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=41) [首先 我们将回顾一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=43) [运用 TextKit 的一些关键概念](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=45) [然后 我们会通过一些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=48) [例子来说明如何](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=49) [把这些关键概念运用到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=51) [你的 App 中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=52) [最后 我们将以一些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=53) [在正确性 性能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=55) [以及安全领域的最佳实践结束](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=56) [现在让我们从关键概念开始吧](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=60) [为了确保我们进度相同](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=63) [我们将从最基础的内容开始](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=64) [什么是 TextKit](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=67) [你的第一反应可能是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=69) [去在 Xcode 中打开一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=72) [新的 Playground 并且输入](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=73) [“import TextKit”](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=75) [除非你已经试过这样做](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=77) [并且发现没有用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=79) [这是因为 TextKit](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=80) [与其他你可能已经用过的框架相比](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=83) [有些不同](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=84) [你不必导入任何东西](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=86) [就可以使用它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=87) [UIKit 和 AppKit 中的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=89) [文本控件都是建立在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=90) [TextKit 上面的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=92) [所以 如果你曾使用过](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=93) [label textField 或者 textView](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=94) [你其实已经使用过 TextKit 了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=97) [TextKit 还集成了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=99) [强大的底层技术](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=100) [比如 Core Text Core Graphics](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=102) [和 Foundation 来让你的 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=104) [能够轻松且完美地显示文本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=106) [每次你使用这些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=109) [内置控件之一的时候 你都是在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=110) [使用 TextKit 的功能去](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=111) [显示或编辑文本 以一种完全](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=113) [国际化 可本地化](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=115) [的方式 并且没有](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=116) [直接运用这些底层](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=118) [技术或者理解](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=119) [技术或者理解](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=119) [复杂的脚本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=121) [还有很多](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=122) [你还能顺带获得很多额外的东西](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=124) [比如你在这里看到的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=125) [这些显示特性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=126) [至于编辑 你也会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=127) [获得所有 OS 所支持的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=130) [技术服务](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=131) [比如辅助功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=132) [拼写检查等等](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=134) [你可以充分利用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=135) [所有这些出色的功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=136) [而无需编写](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=138) [一行代码 这真的很棒](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=139) [有了这么多触手可及的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=142) [功能供你选择](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=143) [你怎么决定](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=144) [使用哪一个控件呢](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=145) [那我们就来讨论一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=148) [如何为你的情况选择](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=149) [合适的控件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=150) [你可能会有](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=151) [不同的选择 取决于](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=152) [你是在使用 UIKit 还是 AppKit](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=153) [所以让我们分别讨论一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=156) [好的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=157) [让我们从 UIKit 开始](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=158) [首先 你会考虑你是否需要文本输入](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=161) [如果你不需要文本输入](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=165) [那接下来你考虑你是否](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=167) [需要选择或滚动](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=169) [如果你不需要这些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=170) [那你应该使用 UILabel](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=173) [UILabels 适用于](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=175) [少量的文本 比如几个字](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=177) [或者几行字](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=178) [如果你有比这更多的文本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=181) [或者你需要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=182) [选择或者滚动的功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=183) [那你需要使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=184) [禁用编辑的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=185) [UITextView](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=187) [现在我们回到顶端](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=188) [如果你需要文本输入 那么](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=190) [考虑你是否需要安全的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=192) [文本输入](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=193) [这会像密码栏一样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=194) [其中文本被隐藏起来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=195) [复制被禁用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=196) [如果你需要这样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=199) [你就应该使用 UITextField 因为它是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=201) [唯一支持安全文本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=203) [输入的控件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=205) [否则 想想你](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=206) [想输入的文本有多少](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=209) [如果你想要像表单栏输入那样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=212) [只需要一行的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=213) [那就使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=214) [UITextField](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=216) [UITextField 仅支持](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=217) [一行文本输入](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=218) [如果你需要比这更多的文本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=221) [你可以使用 UITextView](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=223) [对于 AppKit 来说](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=225) [同样需要这样的决策过程](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=227) [这个过程和 UIKit 的很像](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=229) [但是有些小小的不同](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=231) [你也要从考虑是否](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=233) [需要文本输入开始](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=235) [AppKit 没有标签控件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=237) [AppKit 没有标签控件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=237) [所以 如果你需要展示文本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=240) [那就使用 NSTextField](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=243) [你可以禁用编辑和选择](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=244) [来获得和标签一样的效果](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=245) [现在回到顶端](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=247) [如果你需要文本输入](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=250) [问问自己是否需要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=252) [安全文本输入](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=253) [如果需要 那你可以使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=253) [NSSecureTextField](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=255) [否则 我们会问](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=257) [我们最喜欢的问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=259) [你想要多少文本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=260) [NSTextView 对展示](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=263) [大量文本进行了优化](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=265) [所以 如果你有大量文本要处理](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=266) [你应该使用 NSTextView](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=268) [否则 你可以使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=271) [NSTextField](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=272) [与 UIKit 不同](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=273) [NSTextField](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=274) [支持多行文字](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=276) [但是它更适用于](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=279) [短一些的字符串](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=280) [因此如果你有大量的文本的话](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=281) [仍然应该使用 NSTextView](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=283) [好 你们中的和 TextKit 打过几次交道的人](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=285) [可能已经注意到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=287) [这个流程图缺少了一个选项](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=289) [那就是字符串绘制优化](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=290) [你可以通过在你的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=293) [NSString 或者 NSAttributedString 下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=294) [直接调用 draw(at: CGPoint)](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=296) [或 draw(in: CGRect)](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=298) [来进行字符串绘制](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=299) [来进行字符串绘制](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=299) [你们中的一些人可能会为了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=301) [避免在 Kit 层级上使用过多的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=302) [视图对象所带来的性能收益](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=303) [来使用它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=305) [因此 如果你想要用这个方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=307) [请务必记住下面的几点提示](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=308) [你应该用它来处理](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=311) [少量的静态文本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=312) [并且你应该限制](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=314) [调用 draw() 方法的频率](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=314) [如果你频繁地调用字符串](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=317) [绘制方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=318) [你获得的性能表现可能不如](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=320) [使用标签或文本栏](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=321) [因为这些控件能提供](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=323) [更好的缓存 特别是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=325) [使用自动布局的情况下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=326) [如果你正在绘制一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=327) [有很多自定义属性的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=329) [属性文本字符串 这也会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=331) [减慢你的字符串绘制](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=333) [因为文本系统](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=334) [需要在渲染之前](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=335) [验证所有的属性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=336) [因此 为了最佳性能表现](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=338) [你应该在绘制之前](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=340) [剥离额外的属性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=341) [只保留那些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=342) [需要去决定的视觉表现属性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=344) [比如字体或颜色](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=346) [最后你要知道](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=349) [如果使用字符串绘制](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=351) [你会失去所有这些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=353) [文本控件提供的额外功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=354) [因此只要可能的话](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=355) [你应该一直使用文本控件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=357) [所以现在你知道](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=359) [所以现在你知道](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=359) [仅仅通过 TextKit 的内置控件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=362) [你可以做些什么了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=363) [但是如果你需要的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=365) [比这些控件所提供的更多](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=366) [你需要文本堆栈中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=368) [找到正确的定制点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=368) [与 Cocoa 很像 TextKit](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=372) [是基于 MVC 设计模式的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=374) [文本系统可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=377) [被分为三个阶段](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=379) [直接与 MVC 对应](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=380) [分别是存储 显示和布局](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=382) [我们现在来仔细看看](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=385) [构成了各个阶段](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=387) [的 TextKit 对象](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=388) [我们从存储开始](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=390) [它对应的是 Model（模型）](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=392) [NSTextStorage 存储着你的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=395) [字符串数据和属性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=396) [它是 NSMutableAttributedString 的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=398) [一个子类 因此你可以用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=400) [你已经熟悉的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=401) [使用 attributedString 的方式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=403) [来使用它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=404) [我的同事 Emily](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=406) [将会在稍后](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=407) [展示一些强大的方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=408) [来自定义 NSTextStorage](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=409) [期待一下吧](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=411) [NSTextContainer 会为](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=413) [你的文本将要被展示的几何区域](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=415) [建立模型](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=416) [默认情况下 它是一个矩形](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=418) [默认情况下 它是一个矩形](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=418) [但你也可以自定义](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=420) [文本布局的走向或者形状](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=421) [就像这里展示的一样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=422) [要了解更多详细的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=424) [关于存储对象的信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=426) [看看这些以往优秀的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=427) [WWDC 讨论会内容和文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=428) [这些能在讨论会结束时的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=431) [更多信息链接中找到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=432) [接下来是显示阶段](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=437) [它对应着视图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=438) [我们已经讨论了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=441) [一些显示阶段的内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=442) [在我们讨论选择](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=443) [正确控件的时候](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=444) [因此为获得更多的信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=445) [你可以再一次查看](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=446) [这些文件和资源](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=447) [这些也可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=449) [在讨论会的结尾的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=450) [更多信息链接中获得](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=451) [最后 我们讨论下布局阶段](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=455) [它对应着控件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=456) [NSLayoutManager 是这个阶段中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=459) [唯一的组成部分](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=461) [它是一头野兽](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=462) [这是个褒义词](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=466) [因为它的功能实在是太棒了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=467) [因此它是整个运作的大脑](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=470) [它协调所有阶段中的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=472) [变化 并且控制着布局过程](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=473) [所以这里简要介绍一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=476) [布局过程是怎样进行的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=479) [布局过程是怎样进行的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=479) [文字布局发生在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=481) [系统修复文本存储的属性之后](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=483) [来消除不一致](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=484) [比如确定字符串中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=486) [所有的字符](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=488) [都使用支持](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=489) [显示该字符的字体](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=491) [所以在这个例子中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=493) [Times New Roman 被指定到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=494) [整个字符串](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=496) [但是这个字体并不支持](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=498) [显示日文汉字或者表情符号](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=499) [因此在属性修正后](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=503) [你的文本存储](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=504) [看起来会像这样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=505) [日文字符被](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=506) [分配了适当的日文字体](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=508) [表情符号被](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=509) [分配了的表情符号字体](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=511) [好的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=512) [一旦属性被修正了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=513) [布局过程就开始了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=516) [我们可以认为布局](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=517) [分为两步 字形生成和字形布局](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=519) [一旦它们被布局好了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=524) [就可以显示了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=525) [但是 等一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=527) [什么是字形](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=528) [让我们回顾一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=530) [字形是一种代表一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=532) [或多个字符的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=533) [视觉符号](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=534) [正如你在这里看到的那样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=535) [字符与字形之间的映射](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=536) [并不总是一对一的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=538) [并不总是一对一的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=538) [字符串 “ffi” 有](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=541) [三个字符 但是它可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=543) [由连起来的单个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=544) [字形表示](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=546) [其实反过来也可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=547) [这里有一个 “ñ”](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=550) [这是一个单独的字符](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=551) [它可以由多个字形表示](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=553) [一个 “n”](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=554) [一个波浪号](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=556) [回到我们的图中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=558) [我们的 NSLayoutManager](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=560) [执行字形生成和字形布局](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=562) [在字形生成这一步中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=565) [布局管理器（Layout Manager）会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=567) [获取字符并确定](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=568) [需要绘制的字形](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=569) [在字形布局这一步](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=571) [布局管理器会定位好这些字形](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=572) [以在你的视图中显示](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=574) [从以往 WWDC 讨论会和文档中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=576) [还可以学到很多](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=578) [关于布局管理器的知识](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=579) [你可以在 没错](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=582) [讨论会结尾的更多](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=585) [信息链接中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=587) [好的 现在你了解了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=589) [文本系统的阶段](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=591) [并且你知道了 TextKit](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=593) [构成每个阶段的组件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=594) [所以现在让我们来看看](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=597) [如何为这些组件选择正确的配置](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=598) [如何为这些组件选择正确的配置](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=598) [来创造不同的效果](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=600) [这是你的标准配置](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=603) [当你从 “界面构建器（界面构建器）”](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=605) [中拖放文本视图时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=607) [你会自动获取](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=608) [每个组件中的一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=610) [像这里一样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=611) [大多数时候](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=613) [这对你来说就足够了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=614) [如果你想要一个多页或一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=617) [多栏布局 你可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=619) [使用多对文本容器和](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=620) [文本视图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=622) [每页或每列一对](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=624) [你可以将所有这些都绑定到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=625) [相同的文本存储中的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=626) [相同的布局管理器上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=628) [这样它们就能在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=629) [后台存储中 共享](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=630) [布局信息了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=631) [如果你想要让每个视图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=632) [呈现不同的视图 你也可以做到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=635) [只要使用多个布局管理器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=636) [就可以了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=637) [再次说明 因为文本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=639) [共享相同的后台存储](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=640) [更新该文本将更新](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=642) [所有视图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=643) [我们现在不会讨论过多](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=644) [关于这些配置的细节](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=647) [因为之前已经有一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=648) [讨论会介绍过了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=649) [你可以去看看](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=650) [WWDC 2010 讨论会中的 “Advanced Cocoa](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=652) [Text Tips and Tricks”](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=654) [你可以在讨论会结尾的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=655) [更多信息链接中找到它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=657) [更多信息链接中找到它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=657) [好的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=662) [我们已经看过了内置](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=664) [文本控件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=664) [我们已经看过了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=666) [TextKit 的组件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=667) [我们已经讲过了如何](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=667) [配置这些组件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=669) [以实现不同的效果](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=670) [在你了解了这些知识以后](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=671) [现在你已经可以做很多事情了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=672) [但是如果你想要更多](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=674) [你需要自己扩展](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=676) [并自定义 TextKit 的某些部分](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=677) [所以现在我们会谈一谈](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=679) [选择正确的方式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=681) [来做到这一点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=682) [选择正确的方式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=684) [就像构建文本工具箱一样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=686) [这就像因为需要一把锤子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=688) [所以你去了商店一样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=689) [当你到了商店](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=690) [你发现有大量的锤子供选择](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=692) [但你想选择](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=694) [能够完成这项工作的锤子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=696) [最理想的是能满足你需求的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=698) [最便宜的锤子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=699) [这些是我们可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=700) [得到的锤子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=703) [委托就是一种](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=705) [标准的羊角锤可以用来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=706) [完成各种任务](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=708) [委托们有很多](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=710) [不同的自定义钩子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=711) [大多数时候它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=712) [就能帮你完成任务](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=713) [通知就像是球头锤](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=716) [它的末端是一个球](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=718) [而不是羊角 所以它更专业化](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=719) [而不是羊角 所以它更专业化](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=719) [适合某些特定的任务](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=723) [但它并不像委托那样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=724) [是一个全能的锤子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=726) [最后 子类是你的大锤](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=728) [大锤非常强大](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=733) [你可以将它用于](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=734) [任何你需要锤子的任务](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=736) [但在很多时候](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=737) [使用它会有些大材小用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=739) [接下来 我想](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=741) [邀请 Emily 向我们展示如何](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=743) [使用这些不同种类的锤子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=744) [Emily](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=746) [[ 掌声 ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=747) [&gt;&gt; 谢谢你 Donna](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=752) [因此 作为开发人员](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=754) [我们有一系列控件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=756) [各种配置](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=757) [以及大量的自定义选项供我们选择](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=760) [以实现我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=761) [所需的功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=762) [所以我们的工具箱](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=764) [储备充足 那么我们要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=765) [如何选择工具呢](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=767) [我们一起来看看](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=769) [一些 App 示例](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=771) [它们套用了 TextKit 的强大功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=772) [这样的 App 示例并不难找](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=775) [因为几乎我们使用的每个 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=776) [都需要显示或](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=778) [都需要显示或](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=778) [编辑文本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=781) [我们首先看看](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=783) [两个我们都熟悉的 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=784) [然后一步一步](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=785) [构建我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=787) [自己的 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=788) [我们要看的第一个 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=789) [是 iOS 上的 “Apple News”](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=792) [这是一个漂亮的 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=794) [在个性化以及甄选的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=795) [文章中显示文本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=798) [下面这个例子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=800) [是在 “Spotlight” 标签页中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=803) [“Featured” 栏目中的一篇文章](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=805) [现在 App 的顶部显示了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=807) [关于这篇文章的一些细节](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=809) [我们如何才能用 TextKit](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=812) [重现这个外观和风格呢](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=813) [所以让我们考虑一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=818) [早些时候 Donna 向我们展示的流程图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=819) [以便选择最适合](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=821) [本示例的控件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=822) [我们有不少文本控件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=823) [可供选择](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=827) [但由于我们想要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=829) [显示的文本很少](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=830) [所以我们将在每一行都使用标签](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=832) [我们可以看到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=834) [在检查器面板中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=838) [在检查器面板中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=838) [有很多定制选项](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=840) [我们继续](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=841) [将文本更改为 “Spotlight”](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=843) [并把字体](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=845) [改为 “Body”](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=848) [我们还要勾选](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=849) [“Dynamic Type” 这可以让](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=852) [启用辅助功能设置的用户](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=854) [能以适合它们需要的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=855) [字体大小和样式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=858) [来查看文本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=859) [现在我们可以在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=861) [界面构建器中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=863) [自定义这个标签 但我们也可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=864) [在 Swift 代码中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=865) [看到所有这些属性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=867) [我们可以在运行时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=868) [动态设置文本和](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=870) [排版属性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=871) [现在回到界面构建器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=873) [我们将继续添加两个标签](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=876) [现在一切都很好](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=880) [但我们还需要做一件事](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=882) [所以回头看 Apple News](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=886) [我们可以看到右边的文字](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=887) [实际上显示](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=888) [以两种不同的颜色](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=890) [一部分是黑色的 一部分是白色的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=891) [现在我们可以实现这一点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=895) [用两个单独的标签 但如果我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=896) [只想使用一个标签](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=897) [只想使用一个标签](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=897) [在界面构建器中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=900) [是无法实现的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=901) [那么我们怎么做到这一点呢](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=902) [我们可以利用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=906) [NSAttributedString 强大而](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=907) [灵活的功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=909) [attributedString 是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=911) [一串字符 它可以将属性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=913) [应用于一定范围内的字符](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=915) [你可以轻松地获取一些属性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=918) [比如默认字体](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=919) [和文本颜色一样 但我们可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=921) [用我们自己的值重写](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=923) [这些属性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=924) [在这种情况下 我们将把](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=925) [字符串的部分文本颜色](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=927) [设置为白色](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=928) [要具体查看属性字符串](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=928) [我们将使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=932) [在 NSMutableAttributedString 中的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=934) [addAttribute() 方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=935) [来讲我们想要的范围内的文本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=937) [设置成白色](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=939) [这一次 我们将](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=941) [在我们的标签上设置](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=942) [属性文本属性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=944) [在运行时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=945) [这看起来很酷](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=950) [UILabels 对这类文本来说](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=951) [是很棒的选择](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=953) [如果我们看看屏幕底部](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=955) [我们会看到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=956) [一个标题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=957) [这也是文本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=958) [但它有比较大](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=959) [但它有比较大](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=959) [占了很多行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=961) [使这个文本不同的另一点是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=962) [它是可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=965) [被选中的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=966) [那么这次我们应该使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=968) [哪种控件呢](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=970) [文本栏和文本视图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=972) [都支持选择](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=974) [但文本栏通常](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=976) [仅用于一行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=978) [因此 在这种情况下 由于我们的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=979) [标题可以跨越多行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=981) [因此我们将使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=982) [文本视图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=986) [当我们将文本视图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=986) [放到 Storyboard 上时 我们可以看到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=988) [我们默认会得到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=989) [大量的测试文本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=991) [我们继续来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=992) [检查器面板中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=993) [更改文本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=995) [我们还要改变字体](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=997) [使它看起来更](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=998) [像 “Apple News”](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=999) [我们希望禁用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1000) [编辑功能 因为](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1003) [标题不应该被编辑](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1004) [UITextView 默认支持滚动](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1006) [因为它们是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1009) [UIScrollView 的子类](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1011) [但是 如果我们希望我们的文本视图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1013) [在自动布局中良好运行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1014) [我们应该禁用滚动](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1017) [因此 这将允许](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1019) [因此 这将允许](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1019) [我们的文本视图的边界调整大小](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1020) [以适应文本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1023) [最后 这个白色背景](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1025) [真的需要删去](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1027) [所以我们要把它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1029) [设置为透明](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1030) [界面构建器使得](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1032) [自定这个文本视图非常容易](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1033) [但是和之前的标签一样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1035) [我们可以在代码中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1036) [设置所有这些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1038) [因此 在 Swift 中我们可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1040) [在运行时动态设置](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1041) [文本和格式属性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1043) [我们现在看过了 Apple News](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1046) [并选择了正确的控件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1047) [现在我们要看看另一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1049) [我们都熟悉的 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1050) [并选择正确的配置](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1052) [那就是“文本编辑”](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1053) [“文本编辑” 是 macOS 上的一个 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1057) [用于处理显示和编辑](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1060) [富文本内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1062) [但大多数人不知道](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1064) [“文本编辑” 实际上是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1066) [NSTextView 套上了一个壳子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1068) [我想花一点时间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1071) [感叹一下 TextKit 给我们带来了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1072) [多少额外的好处](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1074) [所以这是检查器栏](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1077) [我们通过勾选](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1079) [我们通过勾选](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1079) [界面构建器中的复选框](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1080) [就可以轻松获得](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1082) [正下方是一个标尺视图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1083) [我们也可以轻松获得它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1084) [只要简单地启用它即可](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1086) [而下面的所有内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1089) [其实只是一个文本视图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1090) [更准确地说 是一个文本视图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1093) [加上文本容器 布局管理器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1095) [还有文本存储](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1097) [这是 NSTextView 和](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1098) [UITextView 的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1099) [标准配置](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1101) [但相似之处也就这些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1104) [例如 表格](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1107) [只在 NSTextView 中受支持](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1110) [再次感叹一下 我们免费](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1112) [获得的强大功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1114) [TextKit 提供了一个表格编辑器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1116) [为我们完成所有](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1117) [繁冗的工作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1119) [当我们使用“文本编辑”时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1122) [我们经常编辑大量的文本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1124) [有时候我们会粘贴很多](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1126) [示例文本 来看看我们是否](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1128) [也免费获得了拼写检查器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1129) [但我们真的想看到的是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1131) [当我们使用格式菜单](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1132) [选择“按页面换行”时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1134) [最终看起来会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1136) [有点像一个页面](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1138) [我们可以看到文本容器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1139) [我们可以看到文本容器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1139) [已被调整大小](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1140) [以匹配一张纸的尺寸](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1142) [现在 如果我们向下滚动](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1146) [我们可以看到文本会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1147) [从第一页跳到第二页](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1148) [标准配置](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1150) [并不真的支持](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1152) [这样的布局](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1153) [显然 这个布局使用了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1155) [两个文本视图和文本容器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1156) [但它们仍然](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1159) [由相同的布局管理器和文本存储管理](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1160) [这使得文本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1161) [可以从一个页面跳到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1162) [另一个页面](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1165) [现在 如果你想了解更多](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1166) [关于文本编辑是如何工作的信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1167) [你其实可以在指南和示例代码库中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1169) [找到它的源代码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1171) [所以我们选择了正确的控件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1172) [我们选择了正确的配置](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1176) [但有时我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1177) [实际上需要使用锤子控件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1179) [以达到我们想要的效果](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1181) [但是 我们如何决定](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1183) [使用哪个锤子呢](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1184) [我们将尝试为任务](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1185) [挑选合适的锤子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1189) [在我们接下来一起](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1190) [构建一个日记 App 的过程中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1191) [我们从把今天的日期](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1194) [放到窗口上开始](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1195) [我们在 AppKit 中没有 UILabels](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1198) [但是我们可以使文本栏](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1199) [但是我们可以使文本栏](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1199) [像标签一样工作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1201) [我们所需要做的就是禁用编辑](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1203) [现在 对于窗口的日记内容部分](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1206) [我们将使用 textView](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1209) [所以在检查器中 我们可以确保](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1212) [文本视图是可编辑和可选的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1213) [并支持富文本和撤销](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1216) [我们还要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1218) [在窗口底部添加几个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1221) [文本栏 来显示](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1223) [写了多少个单词](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1224) [现在 当我们运行我们的 App 时 我们希望](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1226) [底部的字数统计随之变化](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1229) [所以让我们来为这个任务](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1230) [找到合适的锤子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1232) [我们可以选择委托通知或子类](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1233) [但在这种情况下 我们将](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1239) [使用小锤子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1241) [我们将监听](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1242) [来自文本存储的通知](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1243) [我们可以从文本存储中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1246) [获取单词的数量](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1247) [当我们收到通知时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1250) [我们可以更新](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1251) [文本栏的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1252) [字符串值属性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1254) [当我们开始输入时 我们可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1255) [看到字数改变](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1258) [如果我们想强调部分文本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1260) [我们可以使用键盘快捷键](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1263) [或菜单来应用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1265) [格式 比如粗体](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1267) [但是如果我们能够支持](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1269) [现代文本排版工具会更好](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1271) [比如 Markdown](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1273) [它使用命令字符](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1275) [来指定格式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1277) [如果我们在一段内容前后](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1279) [分别添加两个星号](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1280) [我们希望结果是粗体的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1282) [但我们应该使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1284) [哪种锤子呢](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1287) [我们想知道什么时候](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1288) [发生变化 并且我们想知道](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1289) [变化发生在哪里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1291) [但通知并没有真正](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1292) [给我们提供很多关于](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1293) [这种改变的信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1295) [所以我们将使用更大的锤子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1297) [并实现 textStorage() 委托](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1298) [具体是 _ didProcessEditing: 方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1300) [我们可以从现有的字体中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1305) [创建一个新的粗体字体](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1307) [而且 我们可以将该字体](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1308) [直接添加到我们的 textStorage](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1310) [用于我们想要加粗的范围](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1311) [现在 当我们插入最后一个星号时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1313) [我们可以将其加粗](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1315) [我们现在对这个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1318) [我们现在对这个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1318) [Markdown 功能非常满意](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1321) [那么如果我们尝试插入](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1322) [代码片段呢](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1324) [在 Markdown 中是这样的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1326) [如果我们添加最后一个反引号](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1329) [我们希望它看起来像一个代码块](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1330) [它应该有一个背景和](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1334) [一个表示 Swift Code 的标头](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1335) [这实际上是一项复杂的任务](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1337) [所以我们需要两把大锤](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1338) [第一个是 NSTextStorage 子类](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1343) [当我们子类化 NSTextStorage 时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1346) [我们需要实现四个必要的方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1347) [我们通过对一个可变字符串的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1351) [局部实例进行操作来做到这一点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1352) [我们需要注意](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1354) [replaceCharacters() 方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1357) [我们可以将 NSTextBlock 添加](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1359) [到我们的段落样式中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1362) [然后我们将](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1363) [该段落样式添加到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1366) [我们文本存储中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1367) [代码块的范围内](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1369) [现在 NSTextBlock 本身](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1370) [不会自己做任何自定义绘制](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1371) [所以我们也需要对它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1374) [进行子类化](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1377) [我们的 NSTextBlock 子类需要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1378) [我们的 NSTextBlock 子类需要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1378) [在顶部有一些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1380) [额外的留白](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1382) [还需要一个浅灰色背景](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1384) [我们将重写 drawBackground()](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1387) [并使用字符串绘制来绘制](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1389) [标头 Swift Code](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1391) [实际上这些我们想](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1393) [让文本块看起来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1394) [像一个代码片段所需要做的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1396) [现在回到我们的 customTextStorage](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1398) [我们可以创建](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1400) [新代码块的实例](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1401) [而不是使用纯文本块](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1404) [最后 我们还要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1407) [告诉我们的 textView 使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1411) [我们的 customTextStorage](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1412) [所以我们要在布局管理器中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1414) [把原来的文本存储替换掉](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1416) [现在这变成了一个真正的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1417) [所见即所得的 Markdown 编辑器了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1421) [现在在大多数 Markdown 编辑器上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1423) [都有的一个功能是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1424) [并排视图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1425) [左侧是编辑区域](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1427) [右侧是渲染版本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1429) [我们可以通过使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1431) [两个文本视图来实现](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1432) [我们停用右侧视图的编辑功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1435) [现在我们有两个文本视图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1438) [现在我们有两个文本视图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1438) [虽然我们希望它们显示](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1440) [相同的内容 但我们还希望](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1441) [右边视图能够看起来不太一样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1443) [所以我们需要一个像这样的配置](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1445) [两个视图的文本存储器相同](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1447) [而所有其他都不同](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1448) [为此 我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1454) [将用左侧的文本存储](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1456) [把右侧的替换掉](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1458) [现在让我们看看](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1460) [这是什么样子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1461) [现在这真的很酷](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1462) [如果我们在左侧添加任何字符](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1465) [它们将立即显示在右侧](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1466) [现在通常右手边](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1469) [并没有真正显示 Markdown 字符](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1471) [但由于这是一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1473) [共享文本存储 这意味着我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1475) [必须隐藏字符](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1478) [在布局过程中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1479) [因为我们需要这样做](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1480) [所以我们实际上只有一个选择](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1484) [那就是实现](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1485) [NSLayoutManager 委托上的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1489) [shouldGenerateGlyphs() 方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1491) [这将允许我们介入](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1493) [字形生成过程](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1495) [因此 我们可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1498) [获取即将布局的字形](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1499) [获取即将布局的字形](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1499) [并且如果它们表示 Markdown](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1501) [命令字符 我们可以将](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1503) [.null 属性应用于该字形](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1505) [现在 这将让字形](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1508) [在布局过程中被](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1509) [彻底消除 而不会更改](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1510) [底层的文本存储](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1512) [然后 我们将使用新的字形](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1514) [并告诉布局管理器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1519) [我们想要用这些新的属性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1520) [来呈现这些字形](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1522) [这真的很酷](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1527) [所以左侧显示了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1529) [可编辑版本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1530) [包含所有 Markdown 字符](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1531) [而右侧没有显示](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1532) [任何 Markdown 字符](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1534) [全部使用相同的文本存储](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1536) [现在构建一个并排的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1538) [Markdown 编辑器 并不是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1540) [我们每天都在做的事情](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1542) [但是很开心看到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1544) [TextKit 的可自定义度是多么高](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1545) [以及它是如何与现实的例子结合的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1547) [如果你想了解更多](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1549) [关于如何使用和自定义](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1551) [TextKit 的信息 请查看我们出色的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1553) [编程指南](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1554) [然后 我要把现场交给 Donna](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1556) [[ 掌声 ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1559) [[ 掌声 ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1559) [&gt;&gt; 谢谢 Emily](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1566) [这些例子真的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1568) [非常酷](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1569) [我真的希望你能够](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1569) [采用她展示的一些技术](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1570) [并在你自己的 App 中使用它们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1571) [但现在让我们稍微转换一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1574) [并讨论一些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1576) [使用文本的最佳做法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1577) [关于正确性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1581) [如果你的文本没有](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1583) [按照你期望的方式呈现](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1584) [它可能与属性字符串上的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1586) [不完整或不正确的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1588) [属性有关](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1589) [所以我们来看看一个例子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1591) [在实践中看到这一点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1593) [假设我们有一个 UITextView](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1596) [它带有一些属性文本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1597) [写着 “Don't hate.”](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1599) [这段文本的格式是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1600) [Comic Sans 字体 24 号大小](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1602) [我们希望以编程的方式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1604) [把它设置成粗体](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1606) [因为如果有](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1608) [任何比 Comic Sans 令人讨厌的字体](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1610) [那一定是 Comic Sans Bold](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1612) [所以乍一看](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1614) [编写这样的代码似乎是合理的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1618) [现在 我们有我们的原始字体](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1620) [我们将使用一个 fontDescriptor](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1623) [来创建原始字体](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1625) [的粗体版本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1626) [然后 我们要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1629) [使用原始文本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1631) [初始化可变属性字符串](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1633) [我们要将我们的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1634) [新字体或新的粗体字体应用于](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1636) [单词 “Don't”](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1638) [这是前五个字符](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1640) [然后我们将设置](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1641) [我们的 UITextView 的属性文本属性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1642) [来使用这个新的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1644) [属性字符串 但是我们这样做时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1645) [我们会看到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1648) [应用于该单词的新的粗体字体](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1650) [确实像我们预期的那样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1652) [但字符串其余的部分](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1654) [不知道为什么丢失了原始字体](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1655) [现在 那些不喜欢](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1657) [Comic Sans 的人可能会为此感到高兴](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1659) [但结果是错误的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1660) [所以这是一个悲伤的故事](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1663) [那么为什么会这样呢](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1666) [为了回答这个问题 让我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1668) [仔细看看我们是如何](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1671) [初始化我们的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1672) [属性字符串的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1673) [所以请注意 我们要使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1675) [纯文本字符串来初始化它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1676) [并且我们使用的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1678) [初始化程序没有属性信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1679) [初始化程序没有属性信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1679) [当你创建一个新的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1681) [属性字符串 并且你没有](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1684) [提供任何属性信息时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1685) [新的属性字符串](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1686) [会使用默认的属性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1688) [默认字体是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1691) [Helvetica 12 号](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1691) [为了回顾发生了什么](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1693) [我们开始](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1696) [从这个原始的属性字符串](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1697) [将字体 Comic Sans 24 应用于](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1699) [整个范围](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1700) [然后我们创建了这个新的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1701) [属性字符串](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1704) [并使用默认属性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1706) [进行了初始化](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1707) [并且我们将粗字体应用于](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1708) [新字符串上的 “Don't”](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1710) [结果就是这里这个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1711) [不正确的结果 其中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1713) [“Don't” 以 Comic Sans 粗体 24 号显示](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1714) [但字符串的其余部分](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1716) [处于默认字体](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1717) [Helvetica 12](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1719) [有两种不同的方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1720) [可以让它们正确地显示](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1723) [一种方法是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1724) [避免将纯文本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1726) [和属性文本混合在一起](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1727) [因此 通过使用原始字符串](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1730) [来初始化我们的新属性字符串](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1731) [我们要把](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1732) [那些原始属性保留下来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1733) [然后我们再应用我们的新属性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1735) [而不会看到这个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1736) [重设的默认效果](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1737) [但是 避免混合纯文本和属性文本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1739) [但是 避免混合纯文本和属性文本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1739) [并不总是可行的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1743) [因此 如果你必须将其混合](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1744) [则可以在从纯文本字符串中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1746) [创建新的属性字符串时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1748) [明确提供属性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1749) [如果我们确保](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1751) [从原始文本中应用相同的属性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1753) [我们就会得到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1754) [正确的结果](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1755) [但是你应该知道](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1756) [重设效果会发生](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1759) [在任何具有默认值](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1760) [而不仅仅是字体的属性的情况下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1762) [如你所见](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1764) [有很多属性都具有默认值](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1766) [所以我想特别提醒一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1767) [这里的 “Paragraph style（段落风格）”](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1770) [因为它是一个隐蔽的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1771) [重置点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1773) [为了明白为什么](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1775) [我们将重新回顾一下前面的例子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1776) [但不是改变字体](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1777) [我们将改变段落风格](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1778) [来屏蔽 “hate” 这个词](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1779) [因为没有人喜欢仇恨](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1781) [所以我们希望我们的文本看起来像这样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1784) [但是当我们运行这段代码时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1785) [我们将得到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1788) [一个这样的结果](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1790) [所有文本的格式都是 Helvetica 12](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1791) [使用默认的段落风格](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1793) [默认的换行模式 和默认的自动断词](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1795) [又一次 对于那些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1797) [讨厌 Comic Sans 的人来说 真是太棒了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1799) [因为它已经被完全地](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1799) [因为它已经被完全地](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1799) [从字符串中移除了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1801) [但它=这是错误的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1802) [但是这次错误的原因](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1804) [与上次不同](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1805) [为了更好地理解这不同](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1806) [让我们回顾一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1808) [属性修复发生在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1809) [布局之前 这时候](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1811) [系统会修复不一致的属性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1813) [在我们的属性字符串中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1816) [我们有一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1817) [包含多个段落样式的单个段落](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1818) [这显然非常不一致](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1819) [因此 当系统修复](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1823) [此字符串的属性时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1824) [它将采用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1826) [它找到的第一段样式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1827) [并将其应用于整个段落](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1828) [这就会导致](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1831) [我们的属性字符串](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1832) [以默认段落样式显示](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1834) [关键是要明确你的属性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1835) [特别是在混合纯文本和](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1839) [属性文本时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1842) [所以通过这样做](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1843) [你就能避免它出现](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1844) [默认属性的重置效果](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1846) [对于 AppKit 开发人员来说](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1847) [如果你正在为 App 更新](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1849) [深色模式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1851) [这一点尤其重要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1852) [因此通过使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1853) [带有动态颜色的显式属性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1854) [如 NSColor.textColor](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1856) [可以确保你的文本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1857) [会根据环境用正确的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1859) [会根据环境用正确的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1859) [颜色绘制](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1860) [继续](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1863) [下一个话题是性能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1864) [如果你使用大量文本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1866) [一个提高 App 性能的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1867) [好方法是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1868) [使用非连续布局](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1870) [为了明白这意味着什么](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1871) [让我们重新回顾](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1874) [布局过程](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1875) [我们说过布局过程](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1877) [包括字形生成](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1878) [和字形布局](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1880) [所以对于连续布局](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1882) [布局管理器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1884) [在文本存储开头就开始](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1885) [执行字形生成和](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1886) [字形布局了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1887) [它以从头到尾的顺序进行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1890) [所以如果有人使用你的 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1893) [滚动到文本视图中间的某个点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1895) [那么布局管理器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1897) [必须为红色矩形](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1898) [所指示区域之前的所有字形](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1901) [生成并布局字形](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1902) [并且请注意](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1905) [这还包括你从](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1906) [屏幕顶部滚动回到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1907) [文本存储起点之间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1909) [所有你看不见的文本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1910) [所以如果你有很多文本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1912) [那么这个可怜的用户](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1914) [可能需要等待你的 App 一段时间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1916) [让它完成布局](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1917) [但幸运的是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1919) [但幸运的是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1919) [我们可以通过使用非连续布局](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1921) [来避免这种情况](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1923) [正如其名称所暗示的那样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1924) [使用非连续布局](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1926) [布局管理器无需](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1928) [从文本存储开始](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1930) [顺序地进行字形](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1931) [生成和布局](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1932) [所以现在当这个使用你 App 的人](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1934) [滚动到文本视图的中间时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1935) [布局管理器可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1937) [立即为该中间部分](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1938) [执行字形生成和布局](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1940) [所以如果你的文本存储中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1943) [有很多文本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1945) [使用非连续布局可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1946) [为你带来巨大的性能提升](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1948) [那么你如何启用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1949) [这个功能呢](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1953) [非连续布局是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1953) [NSLayoutManager 的一个属性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1955) [对于 NSTextView](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1957) [你可以使用布局管理器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1959) [来访问文本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1961) [然后在其中设置该属性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1962) [对于 UITextView](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1964) [你通常不需要做任何事情](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1966) [因为这是默认开启的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1967) [但只需要记住一件重要的事情](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1968) [由于 UITextView 是 UIScrollView 的子类](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1973) [因此非连续布局](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1975) [需要启用滚动](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1977) [才能生效](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1979) [才能生效](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1979) [这是因为当你禁用滚动时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1981) [询求你的文本视图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1982) [所包含的内容大小](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1984) [需要布局](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1986) [所有的文本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1987) [所以你根本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1988) [不会获得](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1989) [非连续布局的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1990) [性能优势](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1991) [这把我们引导了一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1992) [很重要的问题上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1995) [当你使用非连续布局时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1997) [你应该避免一次](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1998) [请求全部或者大多数文本的布局](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1999) [因为这样做](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2000) [从根本上就](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2003) [违背了我们的初衷](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2004) [所以如果你只有一个文本容器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2005) [不要要求](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2007) [整个容器的布局](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2008) [并且不要要求](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2010) [包含文本结尾的大范围字符](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2011) [或字形的布局](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2013) [我们并没有深入](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2017) [研究文本性能的主题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2018) [因为 我在去年的 WWDC 2017 上针对这一点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2019) [进行了一次非常棒的演讲](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2022) [那就是框架效率的不完整性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2024) [你可以在讨论会结束时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2026) [通过更多信息链接](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2027) [访问该视频](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2028) [好的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2029) [现在是时候谈论](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2031) [每个人最喜欢的话题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2033) [安全](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2035) [你可能已经注意到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2036) [最近有一些事件发生在互联网上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2039) [最近有一些事件发生在互联网上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2039) [某些人利用我们软件中的错误](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2040) [来给使用我们产品的人们制造麻烦](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2042) [作为回应](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2048) [我们正在继续设计](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2050) [抵御这类攻击的技术](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2051) [但今天我想谈谈](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2052) [我们如何共同努力](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2056) [为这些攻击](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2057) [提供更强大的防御](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2058) [所以你可能已经听说过](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2060) [纵深防御的概念](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2061) [如果你不熟悉](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2064) [这些术语的话 纵深防御](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2066) [就是创建多层保护](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2067) [来抵御威胁](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2070) [这个概念已经存在了几个世纪了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2071) [你可以在中世纪城堡的设计中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2074) [看到它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2075) [城堡周围的地上没有树木](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2076) [所以你可以看到袭击者来了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2078) [还有一个护城河](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2079) [可以让城堡更加难以接近](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2081) [并且可以防止敌人在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2082) [下面挖隧道](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2083) [而墙壁是另一道防线](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2084) [它们很高](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2087) [所以很难攀爬](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2088) [并且在墙壁和顶部](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2089) [有很多垛口](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2090) [让防御者能在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2092) [有防御的地方](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2094) [向攻击者开火](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2095) [这些保护中单独](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2097) [任何一种都可能不足以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2098) [任何一种都可能不足以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2098) [抵御攻击](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2100) [但它们组合在一起](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2101) [就提供了强有力的防御](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2103) [就像城堡一样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2105) [我们在这里为攻击](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2107) [提供了多层防御](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2109) [但没没有人会阻止](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2111) [你在你的 App 或框架中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2112) [采取自己的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2113) [防御措施](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2114) [通过这样做](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2115) [你可以添加另一层保护](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2117) [并提高产品安全性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2118) [这是共赢](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2120) [那么让我们来谈谈](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2121) [你可以在这里做什么](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2123) [而我希望你考虑的是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2125) [在你的 App 或框架中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2126) [设置文本输入限制](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2128) [现在我想强调](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2131) [这可能并不总是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2132) [有意义的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2133) [因此举例来说](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2134) [如果你的 App 是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2136) [Emily 之前展示的那种](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2137) [日记 App 的创作工具](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2138) [那么对该文本的长度设置限制](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2140) [并没有任何意义](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2142) [所以如果没有意义](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2143) [你就不应该这样做](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2144) [但相比之下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2146) [如果你的手机 App 有一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2147) [用于为帐户分配昵称的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2149) [文本域 那么你可能会想](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2150) [在这里应该设定怎样的限制](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2152) [才合理](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2153) [设置这些限制是个好主意](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2154) [因为所有文本输入](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2157) [都有潜在的风险](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2158) [都有潜在的风险](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2158) [当你允许文本输入时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2162) [你就允许了复制和粘贴](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2163) [你不知道其中会被](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2165) [粘贴哪种文本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2168) [它可能是任何东西](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2170) [它可能是一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2170) [带有恶意字符组合的字符串](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2172) [或者它可能只是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2172) [一个非常](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2174) [非常长的字符串](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2176) [即使像这样的长字符串](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2180) [本身可能不是恶意的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2181) [它也可能会导致你的 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2183) [冻结或卡住](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2184) [如果你有一个文本域](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2186) [是为了一行输入设计的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2187) [但有人想将“战争与和平”的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2189) [全部内容粘贴进去](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2190) [这大约有 310 万个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2192) [英文字符](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2193) [这是否合理](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2195) [可能并不](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2199) [所以这是一个很好的例子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2202) [它可以让你能强制增加](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2203) [你自己的限制](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2205) [以下是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2207) [设定这些限制的推荐方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2209) [你希望在输入字符串](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2211) [在文本域上设置之前进行验证](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2212) [对于 UITextFields](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2215) [你可以通过](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2216) [使用 UITextFieldDelegate 来完成此操作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2217) [对于 NSTextFields](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2219) [对于 NSTextFields](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2219) [你应该使用自定义的 NSFormatter](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2221) [来实现你的验证逻辑](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2223) [而且我们还有一些额外的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2224) [安全增强功能即将推出](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2227) [因此请在发布说明中注意它们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2230) [如果你有任何问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2231) [请在本周的实验室中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2232) [联系我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2233) [好的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2235) [时间要到了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2236) [所以让我们回顾一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2238) [你知道如何选择正确的控件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2240) [自定义点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2241) [和自定义方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2243) [并了解在正确性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2245) [性能和安全性方面](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2246) [遵循的最佳实践](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2247) [使用这些知识和 TextKit](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2250) [去创伟大的东西吧](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2252) [等等](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2255) [这里是超级重要的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2256) [更多信息链接](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2258) [你可以在这里找到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2259) [我们今天引用的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2260) [所有过去的优秀讨论会和文档](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2261) [请在星期四和星期五来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2263) [我们实验室参观](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2264) [谢谢 希望你们可以享受讨论会的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2265) [其余部分](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2267) [[ 掌声 ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2268)