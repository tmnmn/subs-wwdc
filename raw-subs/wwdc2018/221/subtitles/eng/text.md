# TextKit Best Practices

## Summary
Leverage the abilities of TextKit to provide the best experience possible displaying and editing text. Get the best performance out of your app by using TextKit effectively. Learn the concepts to do more complex handling, layout and presentation.

## Info
* Frameworks
* WWDC 2018 - Session 221 - iOS, macOS
* https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/

## Text
 [[ Music ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=6) [[ Applause ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=20) [&gt;&gt; Hi everyone.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=25) [Welcome to session 221, TextKit](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=27) [Best Practices.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=29) [I'm Donna Tom.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=29) [And I'm the TextKit engineer.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=31) [And my colleague Emily Van Haren](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=32) [from authoring tools will be](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=35) [joining me today.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=36) [And we're both really excited to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=37) [share with you some best](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=38) [practices for working with](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=39) [TextKit.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=40) [So let's get started.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=41) [First, we're going to review](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=43) [some key concepts for working](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=45) [with TextKit.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=47) [Then, we'll dive into some](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=48) [examples to illustrate how to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=49) [apply the key concepts in your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=51) [app.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=52) [And finally, we'll wrap up with](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=53) [some best practices in the areas](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=55) [of correctness, performance, and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=56) [security.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=58) [So let's start with the key](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=60) [concepts.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=63) [Now to make sure we're on the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=63) [same page, we're going to start](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=64) [at the very beginning.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=65) [What is TextKit?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=67) [And your first instinct might be](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=69) [to open a shiny new playground](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=72) [in Xcode and type import](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=73) [TextKit, except if you've ever](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=75) [actually tried this, you found](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=77) [that it doesn't work.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=79) [And that's because TextKit is a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=80) [little different than other](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=83) [frameworks you might have used.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=84) [You don't have to import](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=86) [anything special to use it.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=87) [The text controls in UIKit and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=89) [AppKit are built on top of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=90) [TextKit.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=92) [And so if you've ever used a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=93) [label, the text field, or a text](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=94) [view, you've actually used](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=97) [TextKit.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=98) [And TextKit pulls together](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=99) [powerful underlying technologies](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=100) [such as Core Text, Core Graphics](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=102) [and Foundation to make it simple](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=104) [and seamless for your apps to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=106) [show text.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=107) [And every time you use one of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=109) [these built-in controls, you're](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=110) [using the power of TextKit to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=111) [show or edit text in a fully,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=113) [internationalized, localizable](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=115) [manner without having to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=116) [directly use these underlying](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=118) [technologies or understand the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=119) [technologies or understand the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=119) [intricacies of complex scripts.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=121) [And there are a lot of things](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=122) [you get for free too like all of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=124) [these display features that you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=125) [see here.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=126) [And for editing, you'll also get](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=127) [access to all the tech services](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=130) [that are supported by the OS](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=131) [like accessibility, spell](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=132) [checking and more.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=134) [And you can take advantage of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=135) [all of these great features](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=136) [without having to write a single](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=138) [line of code and that's pretty](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=139) [awesome.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=141) [And so with all of this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=142) [functionality at your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=143) [fingertips, how do you decide](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=144) [which control to use?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=145) [So let's talk about that,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=148) [choosing the right control for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=149) [your situation.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=150) [And the options are going to be](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=151) [a little bit different depending](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=152) [on whether you're using UIKit or](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=153) [AppKit.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=155) [So let's review them separately.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=156) [All right.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=157) [Let's start with UIKit.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=158) [And first you're going to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=161) [consider whether you need text](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=163) [input.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=164) [And if you don't need text](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=165) [input, then consider whether you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=167) [need selection or scrolling.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=169) [And if you don't need these,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=170) [then you should use UILabel.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=173) [UILabels are intended for small](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=175) [amounts of text like a few words](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=177) [or a few lines.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=178) [And so if you have more text](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=181) [than that or if you need these](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=182) [selection or scrolling](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=183) [capabilities then you should use](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=184) [a UITextView with editing](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=185) [disabled.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=187) [Now going back to the top.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=188) [If you do need text input, then](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=190) [consider whether you need secure](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=192) [text entry.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=193) [And this would be like a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=194) [password field where the text is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=195) [obscured and copying is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=196) [disabled.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=198) [And so if you need that, then](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=199) [use UITextField because this is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=201) [the only control that supports](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=203) [secure text entry.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=205) [Otherwise, think about how much](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=206) [text you expect to be entered.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=209) [And if you want something that's](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=212) [like a form field input that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=213) [only needs a line, then use](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=214) [UITextField.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=216) [And UITextField only supports](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=217) [one line of text entry.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=218) [Otherwise, if you need more than](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=221) [that, you can use UITextView.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=223) [And so now here's that same](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=225) [decision process for AppKit.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=227) [And it's similar to the UIKit](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=229) [process but there's a few small](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=231) [differences.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=232) [So, again, you're going to start](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=233) [by considering whether you need](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=235) [text input.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=236) [And AppKit doesn't have a label](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=237) [And AppKit doesn't have a label](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=237) [control.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=240) [So if you need to display text,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=240) [use an NSTextField and you can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=243) [disable both editing and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=244) [selection to get that label](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=245) [behavior.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=246) [Now going back to the top here.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=247) [If you do need text input, again](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=250) [ask if you need secure text](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=252) [entry.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=253) [And if so, you can use](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=253) [NSSecureTextField.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=255) [Otherwise, we're going to ask](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=257) [our favorite question, how much](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=259) [text do you expect?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=260) [So NSTextView is optimized for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=263) [performance with large amounts](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=265) [of text.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=266) [And so if you're expecting a lot](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=266) [of text, you should use](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=268) [NSTextView otherwise you can use](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=271) [NSTextField.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=272) [Now, unlike its UIKit](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=273) [counterpart, NSTextField does](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=274) [support multiple lines of text,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=276) [but it's still optimized for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=279) [shorter strings and so you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=280) [should still use NSTextView if](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=281) [you have a lot of text.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=283) [Now those of you who have been](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=285) [around the block a few times](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=286) [with TextKit might notice that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=287) [the flow charts are missing an](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=289) [option and that's string](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=290) [drawing.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=291) [And you use string drawing by](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=293) [directly calling draw in point](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=294) [or draw in rect methods under](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=296) [NSString or your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=298) [NSAttributedString.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=299) [NSAttributedString.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=299) [And many of you may be using](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=301) [this for the performance benefit](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=302) [to avoid the overhead of view](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=303) [objects at the kit level.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=305) [And so if you're going to go](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=307) [this route, please keep the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=308) [following tips in mind.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=309) [You want to use it for small](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=311) [amounts of static text.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=312) [And you want to limit how](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=314) [frequently you call the draw](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=314) [methods.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=316) [Now if you're calling the string](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=317) [drawing methods a lot, you might](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=318) [actually get better performance](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=320) [out of a label or a text field](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=321) [because these controls provide](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=323) [better caching, especially if](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=325) [you're using auto layout.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=326) [And if you're drawing an](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=327) [attributed string with a lot of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=329) [custom attributes, this could](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=331) [also be slowing down your string](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=333) [drawing because the text system](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=334) [needs to validate all of the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=335) [attributes before rendering and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=336) [so for best performance, you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=338) [should strip out extra](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=340) [attributes before drawing and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=341) [only pass in the ones that are](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=342) [needed to determine the visual](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=344) [appearance like font or like](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=346) [color.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=348) [And finally, remember that by](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=349) [using string drawing, you'll](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=351) [miss out on all of this free](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=353) [functionality that's offered by](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=354) [the text controls, so you should](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=355) [use the text controls whenever](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=357) [possible.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=358) [So now you know what you can do](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=359) [So now you know what you can do](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=359) [with TextKit just by using the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=362) [built-in controls.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=363) [But if you want to go beyond](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=365) [what these controls provide,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=366) [you'll need to find the right](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=368) [customization point within the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=368) [text stack.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=370) [And like much of Cocoa, TextKit](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=372) [is based on the model view](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=374) [controller design pattern.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=375) [And the text system can be](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=377) [divided into three phases that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=379) [correspond it directly to NBC](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=380) [and that's storage, display, and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=382) [layout.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=384) [And so now let's take a closer](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=385) [look at the TextKit objects that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=387) [make up each of these phases.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=388) [And we'll start with the storage](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=390) [which corresponds to the model.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=392) [Now NSTextStorage holds your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=395) [string data and your attributes.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=396) [It's a subclass of mutable](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=398) [attributed string and so you can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=400) [work with it in the same way](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=401) [that you already know how to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=403) [work with attributed strings.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=404) [And my colleague Emily will show](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=406) [you some really powerful ways to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=407) [customize the text storage a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=408) [little bit later so stay tuned](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=409) [for that.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=411) [Now NSTextContainer models the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=413) [geometry of the area where your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=415) [text will be laid out.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=416) [And by default, it's a rectangle](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=418) [And by default, it's a rectangle](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=418) [but you can customize the flow](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=420) [or the shape of the text layout](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=421) [as shown here.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=422) [And for more detailed](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=424) [information on working with the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=426) [storage objects, check out these](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=427) [great past WWDC sessions and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=428) [documentation.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=430) [And they'll be available from](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=431) [the more information link at the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=432) [end of the session.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=433) [And next up is the display phase](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=437) [and that corresponds to the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=438) [view.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=441) [And we've already talked about](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=441) [the display phase quite a bit](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=442) [when we talked about choosing](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=443) [the right control.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=444) [And so for additional](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=445) [information, you can again check](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=446) [out these documentation](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=447) [resources.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=448) [And they'll also be accessible](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=449) [from that more information link](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=450) [at the end of the session.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=451) [And finally, we have the layout](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=455) [phase which corresponds to the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=456) [controller.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=457) [And NSLayoutManager is the only](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=459) [component in this phase.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=461) [And let me tell you it is a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=462) [beast.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=464) [And I mean that in a good way](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=466) [because it's so awesome at what](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=467) [it does.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=469) [So it's the brains of the whole](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=470) [operation.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=471) [It coordinates changes between](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=472) [all of the phases, and it](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=473) [controls the layout process](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=474) [itself.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=475) [So here's a quick overview of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=476) [how that layout process works.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=479) [how that layout process works.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=479) [So text layout happens after the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=481) [system fixes attributes in the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=483) [text storage to remove](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=484) [inconsistencies like making sure](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=486) [that all the characters in the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=488) [string are covered by fonts that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=489) [support displaying those](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=491) [characters.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=492) [And so in this example, the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=493) [Times New Roman font is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=494) [specified for the entire string,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=496) [but this font doesn't support](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=498) [displaying Japanese kanji or](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=499) [emoji.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=501) [And so after attribute fixing,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=503) [your text storage will look](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=504) [something like this with an](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=505) [appropriate Japanese font](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=506) [assigned to the Japanese](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=508) [characters and the emoji font](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=509) [assigned to the emoji character.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=511) [All right.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=512) [So once the attributes are](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=513) [fixed, the layout process can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=516) [begin.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=517) [And we can think of layout in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=517) [two steps: glyph generation](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=519) [followed by glyph layout.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=521) [And once they're laid out,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=524) [they're ready for display.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=525) [But wait a minute.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=527) [What's a glyph?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=528) [Let's back up and review that.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=530) [A glyph is a visual](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=532) [representation of one or more](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=533) [characters.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=534) [And as you can see here, the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=535) [mapping between characters and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=536) [glyphs is not always one-to-one.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=538) [glyphs is not always one-to-one.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=538) [So here this string ffi has](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=541) [three characters, but it could](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=543) [be represented by a single glyph](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=544) [for the ligature.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=546) [And you can go in the other](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=547) [direction too.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=549) [Here we have n [inaudible] which](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=550) [is a single character that can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=551) [be represented by multiple](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=553) [glyphs: one for the n and one](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=554) [for the tilde.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=556) [And so going back to our diagram](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=558) [here, we have NSLayoutManager](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=560) [performing glyph generation and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=562) [glyph layout.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=564) [And glyph generation is where](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=565) [the layout manager takes the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=567) [characters and figures out what](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=568) [glyphs need to be drawn.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=569) [And glyph layout is where the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=571) [layout manager positions those](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=572) [glyphs for display in your view.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=574) [And there's a lot more to learn](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=576) [about the layout manager from](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=578) [these past WWDC sessions and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=579) [documentation.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=581) [And you can access them from,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=582) [you guessed it, the more](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=584) [information link at the end of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=585) [the session.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=587) [Okay. So now you understand the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=589) [phases of the text system.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=591) [And you know the TextKit](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=593) [components that make up each](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=594) [phase.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=595) [So now let's explore choosing](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=597) [the right configuration of these](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=598) [the right configuration of these](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=598) [components to create different](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=600) [effects.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=602) [So this is your standard](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=603) [configuration.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=604) [And when you drag and drop a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=605) [text view from Interface](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=607) [Builder, you'll automatically](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=608) [get one of each component as](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=610) [shown here.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=611) [And most the time this is all](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=613) [you're going to need.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=614) [If you want a multiple page or a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=617) [multiple column layout, you can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=619) [use pairs of text containers and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=620) [text views, one pair for each](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=622) [page or column.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=624) [And you can hook all of these up](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=625) [to the same layout manager in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=626) [the same text storage so that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=628) [they share the layout](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=629) [information in the backing](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=630) [store.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=631) [And if you want different](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=632) [layouts in each of you, you can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=635) [do that too, just use multiple](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=636) [layout managers.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=637) [And, again, since the text](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=639) [shares the same backing store,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=640) [updating that text will update](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=642) [all of the views.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=643) [Now we didn't go into too much](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=644) [detail about these](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=647) [configurations because there's a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=648) [great past session that's](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=649) [already done that so check out](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=650) [WWDC 2010 session Advanced Cocoa](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=652) [Text Tips and Tricks.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=654) [And this will be accessible from](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=655) [that more information link at](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=657) [the end of the session.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=659) [the end of the session.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=659) [All right.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=662) [So we've looked at the built-in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=664) [text controls.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=664) [We've looked at the components](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=666) [in TextKit.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=667) [And we've look at how to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=667) [configure those components to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=669) [achieve different effects.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=670) [And there's a lot that you can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=671) [do with that knowledge already,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=672) [but if you need even more,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=674) [you'll need to extend and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=676) [customize parts of TextKit](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=677) [yourself.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=678) [And so now we'll talk a little](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=679) [bit about choosing the right](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=681) [approach for doing that.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=682) [And choosing the right approach](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=684) [is like building up your text](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=686) [toolbox.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=687) [It's like going to the store](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=688) [because you need a hammer.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=689) [And then when you get there, you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=690) [encounter this giant wall of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=692) [hammers to choose from.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=693) [And you want to pick your hammer](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=694) [that can do the job and ideally](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=696) [the least expensive one that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=698) [will do what you need.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=699) [And so these are the hammers](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=700) [that are available to us.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=703) [Delegation is like your standard](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=705) [hammer with the claw on the end,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=706) [and it's used to perform](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=708) [multiple tasks.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=708) [So the delegates have a lot of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=710) [different customization hooks](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=711) [and most of the time they'll get](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=712) [the job done for you.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=713) [Notifications is like a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=716) [ball-peen hammer.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=717) [And this has a ball on the end](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=718) [instead of a claw so it's more](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=719) [instead of a claw so it's more](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=719) [specialized and it's better](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=721) [suited for certain tasks, but](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=723) [it's not as versatile as the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=724) [standard hammer of delegation.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=726) [And finally, subclassing is your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=728) [sledgehammer.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=731) [The sledgehammer is very](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=733) [powerful, and you can use it for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=734) [just about anything that you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=736) [would need a hammer for but it's](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=737) [probably overkill for a lot of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=739) [things.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=740) [And with that, I'd like to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=741) [invite Emily up to show us how](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=743) [to use these different kinds of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=744) [hammers.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=745) [Emily.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=746) [[ Applause ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=747) [&gt;&gt; Thank you, Donna.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=752) [So, as developers, we have a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=754) [collection of controls to choose](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=756) [from, various configurations,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=757) [and a wide range of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=760) [customization options to achieve](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=761) [what we need.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=762) [So our tool chest is stocked](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=764) [full, but how do we know what](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=765) [tools to choose?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=767) [So we're going to take a look at](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=769) [some examples of apps that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=771) [harness the power of TextKit.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=772) [And we don't have to look very](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=775) [far because almost every app](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=776) [that we use displays or edits](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=778) [that we use displays or edits](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=778) [text.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=781) [We're going to start by looking](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=783) [at two apps that we're all](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=784) [familiar with and then go](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=785) [through the steps of building](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=787) [our own.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=788) [So the first app we're going to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=789) [look at is Apple News on iOS,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=792) [which is a beautiful app that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=794) [displays text in a personalized](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=795) [and curated articles.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=798) [So here's an example of an](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=800) [article that is featured in the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=803) [spotlight tab.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=805) [Now the top of the app shows](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=807) [some details about this article.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=809) [Now how could we use TextKit to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=812) [re-create this look and feel?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=813) [So let's consider the flow chart](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=818) [that Donna showed us earlier to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=819) [pick the control that's best](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=821) [suited for this example.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=822) [So we have a handful of text](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=823) [controls to choose from, but](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=827) [since we want to display small](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=829) [amounts of text, each on a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=830) [single line, we'll use a label.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=832) [Now we can see that there is a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=834) [ton of customization options in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=838) [ton of customization options in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=838) [the inspector panel.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=840) [So we're going to go ahead and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=841) [change the text to spotlight.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=843) [We're going to change the font](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=845) [to use the body style.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=848) [And we're going to enable](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=849) [dynamic type, which allows those](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=852) [with accessibility settings](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=854) [enabled to see text in a font](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=855) [size and style that is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=858) [appropriate for their needs.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=859) [Now it's great that we can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=861) [customize this label in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=863) [Interface Builder, but we can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=864) [also see all these properties in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=865) [Swift.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=867) [So we can set the text and the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=868) [formatting properties](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=870) [dynamically at runtime.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=871) [Now back in Interface Builder,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=873) [we'll go ahead and add two more](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=876) [labels.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=878) [Now everything fits pretty well,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=880) [but we have one more thing we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=882) [need to do here.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=884) [So looking back at Apple News,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=886) [we can see that the text on the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=887) [right is actually displayed with](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=888) [two different colors.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=890) [Part of it's black and part of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=891) [it's white.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=893) [Now we could achieve this with](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=895) [two separate labels, but if we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=896) [wanted to use just one label, we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=897) [wanted to use just one label, we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=897) [wouldn't be able to do this in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=900) [Interface Builder.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=901) [So how could we do this?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=902) [Well, we can take advantage of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=906) [the power and flexibility of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=907) [attributed strings.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=909) [Now an attributed string is a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=911) [run of characters that can have](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=913) [attributes applied to ranges of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=915) [characters.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=916) [Now some attributes you get for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=918) [free like the default font and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=919) [text color, but we can override](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=921) [these attributes with our own](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=923) [values.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=924) [In this case, we're going to set](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=925) [part of our string's text color](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=927) [to white.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=928) [Now to see attributed string in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=928) [action, we'll use the add](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=932) [attribute method on](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=934) [NSMutableAttributedString to set](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=935) [the text color to white just for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=937) [the range that we want.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=939) [And this time we'll set the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=941) [attributed text property on our](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=942) [label.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=944) [At runtime, this looks pretty](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=945) [spiffy.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=950) [Now UILabels were a great choice](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=951) [for this sort of text.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=953) [Now if we look at the bottom of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=955) [the screen, we'll see a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=956) [headline.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=957) [Now this is also text, but it's](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=958) [a little bit bigger and it spans](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=959) [a little bit bigger and it spans](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=959) [multiple lines.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=961) [Another thing that makes this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=962) [text different is that it's](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=965) [selectable.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=966) [So which control should we use](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=968) [this time?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=970) [Now both text field and text](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=972) [view support selection but text](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=974) [field is meant for usually just](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=976) [one line.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=978) [So in this case, since our](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=979) [headline can span multiple](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=981) [lines, we're going to use a text](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=982) [view.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=986) [Now when we put a text view onto](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=986) [our storyboard, we can see that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=988) [we get a lot of lorem ipsum text](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=989) [by default.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=991) [So we're going to go ahead and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=992) [change the text in the inspector](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=993) [panel.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=995) [We're also going to change the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=997) [font to look a little bit more](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=998) [like Apple News.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=999) [And we want to disable the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1000) [editing feature because the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1003) [headline isn't really editable.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1004) [Now UITextView scroll by default](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1006) [because they are a subclass of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1009) [UIScrollView.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1011) [But if we want our text view to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1013) [play well with auto layout, we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1014) [want to disable scrolling.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1017) [So this will allow the bounds of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1019) [So this will allow the bounds of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1019) [our text view to resize to fit](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1020) [the text.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1023) [Last but not least, this white](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1025) [background really needs to go,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1027) [so we're going to set it to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1029) [transparent.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1030) [Now Interface Builder made it](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1032) [really easy to customize this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1033) [text view but just like our](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1035) [labels before, we can set all](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1036) [this in code.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1038) [So here in Swift, we can set the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1040) [text and the formatting](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1041) [properties dynamically at](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1043) [runtime.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1044) [So we looked at Apple News to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1046) [pick the right control, but now](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1047) [we're going to look at a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1049) [different app that we're all](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1050) [familiar with to choose the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1052) [right configuration and that's](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1053) [TextEdit.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1056) [Now TextEdit is an app on macOS](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1057) [that handles display and editing](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1060) [of rich text content.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1062) [Now what most people don't know](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1064) [is that TextEdit is actually a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1066) [really thin wrapper around](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1068) [NSTextView.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1069) [So I want to take a moment to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1071) [marvel at just how much we get](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1072) [for free with TextKit.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1074) [So this is the inspector bar,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1077) [and we get this for free just by](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1079) [and we get this for free just by](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1079) [checking a checkbox in Interface](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1080) [Builder.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1082) [And right below it is a ruler](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1083) [view which we also get for free](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1084) [just by enabling it.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1086) [And everything below that is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1089) [just a text view.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1090) [Actually, it's a text view, text](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1093) [container, layout manager, and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1095) [text storage.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1097) [Now this is the standard](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1098) [configuration for both](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1099) [NSTextView and UITextView, but](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1101) [the similarities mostly stop](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1104) [there.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1106) [So, for example, tables are only](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1107) [supported in NSTextView.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1110) [And marveling again at the power](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1112) [that we get for free, TextKit](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1114) [provides a table editor that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1116) [does all the heavy lifting for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1117) [us.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1119) [Now when we use TextEdit, we're](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1122) [often editing large amounts of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1124) [text.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1125) [Sometimes we paste in a lot of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1126) [lorem ipsum to see that we also](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1128) [get a spell-checker for free.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1129) [But really what we want to see](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1131) [is that when we use the format](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1132) [menu to choose wrap to page, we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1134) [end up with it looking a little](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1136) [bit more like a page.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1138) [We can see that the text](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1139) [We can see that the text](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1139) [container has been resized to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1140) [match the dimensions of a piece](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1142) [of paper.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1144) [Now if we scroll down, we can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1146) [see that the text jumps from the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1147) [first page to the second.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1148) [Now the standard configuration](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1150) [doesn't really support layout](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1152) [like this.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1153) [Sure enough, this layout uses](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1155) [two text views and text](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1156) [containers.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1157) [Now they're still managed by the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1159) [same layout manager and text](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1160) [storage, which allows the text](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1161) [to freely jump from one page to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1162) [the next.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1165) [Now if you'd like to see more](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1166) [about how TextEdit works, you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1167) [can actually find its source in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1169) [the guides and sample codes](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1171) [library.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1172) [So we've picked the right](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1172) [controls, we've picked the right](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1176) [configuration, but sometimes we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1177) [actually need to hammer on these](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1179) [to achieve what we want.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1181) [But how do we decide which](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1183) [hammer to use?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1184) [So we're going to try and pick](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1185) [the right hammer for the job](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1189) [when we go through the steps of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1190) [building a journal app together.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1191) [We'll start by putting today's](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1194) [date on to the window.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1195) [Now we don't have UILabels in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1198) [AppKit, but we can make a text](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1199) [AppKit, but we can make a text](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1199) [field behave like a label.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1201) [All we need to do is disable](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1203) [editing.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1205) [Now for the journal entry part](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1206) [of the window, we're going to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1209) [use a text view.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1210) [So in the inspector, we can make](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1212) [sure that the text view is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1213) [editable and selectable and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1214) [supports rich text and undo.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1216) [We're going to add a couple of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1218) [text fields to the bottom of the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1221) [window as well so that we can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1223) [show how many words have been](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1224) [written.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1225) [Now when we run our app, we want](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1226) [the word count at the bottom to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1229) [change, so let's find the right](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1230) [hammer for this job.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1232) [Now we can either conform to a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1233) [delegate, handle a notification](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1236) [or subclass.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1238) [But in this case, we're going to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1239) [use a small hammer.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1241) [And we're going to listen for a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1242) [notification from text storage.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1243) [Now we can get the number of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1246) [words from the text storage.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1247) [And when we hear the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1250) [notification, we can update the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1251) [string value property of our](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1252) [text field.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1254) [And when we start typing, we can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1255) [see the word count change.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1258) [Now if we want to emphasize part](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1260) [of our text, we can use keyboard](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1263) [shortcuts or the menu to apply](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1265) [formatting like bold.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1267) [But it would be great if we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1269) [could support modern text](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1271) [formatting like Markdown, which](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1273) [uses control characters to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1275) [specify formatting.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1277) [So if we start inserting](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1279) [asterisks before and after, we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1280) [want it to be bold.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1282) [But which hammer should we use](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1284) [for this?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1287) [Well, we want to know when a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1288) [change happens, and we want to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1289) [know where a change happens.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1291) [But notifications don't really](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1292) [give us much information about](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1293) [this change.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1295) [So we're going to use a bigger](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1297) [hammer and implement the text](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1298) [storage delegate, specifically](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1300) [the didProcessEditing method.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1302) [Now we can make a new bold font](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1305) [from our existing one.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1307) [And we can add that font](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1308) [directly to our text storage for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1310) [the range that we want to be](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1311) [bold.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1312) [And now when we insert that last](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1313) [asterisk, we can make it bold.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1315) [Now we're feeling pretty good](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1318) [Now we're feeling pretty good](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1318) [about this whole Markdown thing](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1321) [so what if we try inserting a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1322) [code snippet?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1324) [Now in Markdown it looks like](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1326) [this.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1327) [And if we add this last](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1329) [back-tick, we want it to look](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1330) [like a code block.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1332) [It should have a background and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1334) [a header that says Swift Code.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1335) [Now this is actually a complex](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1337) [task, so we're going to need two](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1338) [sledgehammers.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1341) [And the first is a subclass](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1343) [NSTextStorage.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1344) [Now when we subclass](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1346) [NSTextStorage, we need to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1347) [implement four required methods.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1348) [And we can do this by operating](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1351) [on a private instance of a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1352) [mutable string.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1354) [Now let's pay attention to the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1354) [replaceCharacters method.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1357) [Now we can add an NSTextBlock to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1359) [our paragraph style.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1362) [And then we can add that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1363) [paragraph style to our text](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1366) [storage over the range of that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1367) [code block.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1369) [Now NSTextBlock by itself](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1370) [doesn't do any custom drawing by](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1371) [itself.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1373) [So we'll need to subclass that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1374) [too.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1377) [Our NSTextBlock subclass needs](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1378) [Our NSTextBlock subclass needs](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1378) [to have some padding with some](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1380) [extra padding on the top and a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1382) [light gray background.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1384) [We'll override drawBackground](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1387) [and use string drawing to draw](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1389) [the header Swift Code.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1391) [Now this is actually all we need](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1393) [to do to make a text block look](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1394) [like a code snippet.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1396) [Now back in our custom text](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1398) [storage, we can create an](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1400) [instance of our new code block](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1401) [instead of using a plain text](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1404) [block.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1407) [Now, last but not least, we need](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1407) [to tell our text view to use one](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1411) [of our custom text storages, so](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1412) [we'll replace the text storage](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1414) [on the layout manager.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1416) [Now this is turning into a real](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1417) [WYSIWYG Markdown editor.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1421) [Now a popular feature of most](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1423) [Markdown editor's is a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1424) [side-by-side view with an](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1425) [editing version on the left and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1427) [a rendering on the right.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1429) [Now we can do this with two text](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1431) [views side-by-side.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1432) [We'll disable editing for the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1435) [one on the right.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1437) [And now we have two text views](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1438) [And now we have two text views](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1438) [but we want them to display the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1440) [same content but look a little](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1441) [different on the right.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1443) [So we want a configuration like](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1445) [this where we have one text](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1447) [storage but two of everything](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1448) [else.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1451) [To do this, we will replace the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1454) [text storage on the right with](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1456) [that from the left.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1458) [Now let's see what this looks](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1460) [like.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1461) [Now this is actually really](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1462) [cool.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1465) [If we add any characters to the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1465) [left, they'll show up](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1466) [immediately on the right-hand](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1467) [side.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1468) [Now usually the right-hand side](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1469) [doesn't really show the Markdown](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1471) [characters but since this is a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1473) [shared text storage, it means we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1475) [have to hide the characters](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1478) [during the layout process.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1479) [Now since we need to do it this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1480) [way, we really only have one](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1484) [option and that's to implement](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1485) [the shouldGenerateGlyphs method](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1489) [on the NSLayoutManager delegate.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1491) [This will allow us to intervene](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1493) [in the glyph generation process.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1495) [So we can take the glyphs that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1498) [are about to be laid out and if](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1499) [are about to be laid out and if](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1499) [they represent a Markdown](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1501) [control character, we can apply](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1503) [the null property to that glyph.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1505) [Now this will eliminate the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1508) [glyph altogether during the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1509) [layout process without changing](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1510) [the underlying text storage.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1512) [Then, we will use the new glyphs](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1514) [and tell the layout manager that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1519) [we want to present these glyphs](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1520) [with our new properties.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1522) [Now this is actually really](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1527) [cool.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1528) [So the left-hand side shows an](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1529) [editable version with all the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1530) [Markdown characters included.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1531) [And the right-hand side shows no](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1532) [Markdown characters all, all](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1534) [using the same text storage.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1536) [Now building a side-by-side](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1538) [Markdown editor is not something](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1540) [all of us do every day, but it](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1542) [was really good to see how](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1544) [customizable TextKit is with](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1545) [real world examples.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1547) [If you'd like to learn more](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1549) [about how to use and customize](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1551) [TextKit, check out our amazing](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1553) [programming guides.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1554) [And with that, I will hand it](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1556) [back to Donna.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1557) [[ Applause ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1559) [[ Applause ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1559) [&gt;&gt; Thanks, Emily.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1566) [Those are some really cool](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1568) [examples.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1569) [And I really hope you'll be able](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1569) [to take some of the techniques](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1570) [that she showed off and use them](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1571) [in your own apps.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1573) [But now let's shift gears a bit](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1574) [and talk about some best](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1576) [practices for working with text.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1577) [So on the topic of correctness,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1581) [if your text doesn't render the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1583) [way you expect, it could be](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1584) [related to incomplete or](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1586) [incorrect attributes on your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1588) [attributed string.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1589) [And so let's take a look at an](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1591) [example to see this in practice.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1593) [Let's say we have a UITextView](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1596) [with some attributed text that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1597) [says don't hate.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1599) [And it says this in the font](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1600) [Comic Sans 24 point.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1602) [And we want to programmatically](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1604) [apply a bold typeface to the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1606) [word don't because if there's](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1608) [any font more universally hated](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1610) [than Comic Sans, it's Comic Sans](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1612) [bold.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1614) [And so at first blush, it might](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1614) [seem reasonable to write code](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1618) [like this.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1619) [Now here we have our original](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1620) [font.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1622) [And we're going to use a font](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1623) [descriptor to create a bold](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1625) [version of this original font.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1626) [Then, we're going to initialize](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1629) [our mutable attributed string](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1631) [using the original text.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1633) [We're going to apply our new](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1634) [font or new bold font to the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1636) [word don't and that's going to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1638) [be the first five characters.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1640) [And then we're going to set the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1641) [attributed text property of our](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1642) [UITextView to use this new](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1644) [attributed string except when we](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1645) [do that we'll see that our new](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1648) [bold font applied to the word](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1650) [don't just as we expected but](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1652) [the rest of the string somehow](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1654) [lost the original font.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1655) [And now those of you who despise](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1657) [Comic Sans might be happy about](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1659) [that, but the result is wrong](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1660) [and so that warrants a sad face.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1663) [So why did this happen?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1666) [And to answer that, let's take a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1668) [closer look at how we're](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1671) [initializing our attributed](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1672) [string.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1673) [So notice that we're using a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1675) [plain text string to initialize](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1676) [it, and we're using the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1678) [initializer with no attribute](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1679) [initializer with no attribute](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1679) [information.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1681) [And when you create a new](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1681) [attributed string and you don't](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1684) [provide any attribute](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1685) [information, that new attributed](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1686) [string, we use the default](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1688) [attributes.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1689) [And the default font is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1691) [Helvetica 12 point.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1691) [And so to recap what happened,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1693) [we started with this original](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1696) [attributed string with the font](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1697) [Comic Sans 24 applied to the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1699) [entire range.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1700) [And then we created this new](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1701) [attributed string, and it got](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1704) [initialized with the default](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1706) [attributes.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1707) [And we applied our bold font to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1708) [the word don't on this new](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1710) [string, and we ended up with](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1711) [this incorrect result here where](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1713) [the word don't is in Comic Sans](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1714) [bold 24, and the rest of the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1716) [string is in the default font of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1717) [Helvetica 12.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1719) [And so there are two different](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1720) [ways that we could do this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1723) [correctly and one way is to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1724) [avoid mixing the plain and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1726) [attributed text altogether.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1727) [So by initializing our new](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1730) [attributed string using the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1731) [original one, we're going to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1732) [keep those original attributes.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1733) [And then we can apply our new](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1735) [attributes without getting this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1736) [reset effect with the default](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1737) [ones.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1738) [But it's not always feasible to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1739) [But it's not always feasible to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1739) [just avoid mixing plain and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1742) [attributed text.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1743) [So if you've got to mix it up,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1744) [you can explicitly supply the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1746) [attributes when creating that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1748) [new attributed string from the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1749) [plain text string.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1751) [And if we make sure to apply the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1751) [same attributes from the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1753) [original text, we'll get the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1754) [correct result.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1755) [But you should be aware that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1756) [this reset effect can happen](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1759) [with any attributes that have](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1760) [default values and not just](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1762) [fonts.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1763) [And as you can see, there are a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1764) [lot of attributes with default](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1766) [values.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1767) [So I'd like to call out the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1767) [paragraph style here in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1770) [particular as being a sneaky](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1771) [reset point.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1773) [And to see why, we'll revisit](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1775) [our earlier example.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1776) [But instead of changing the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1777) [font, we're going to change the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1778) [paragraph style to truncate the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1779) [word hate because nobody likes](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1781) [hate.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1783) [So we want our text to look like](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1784) [this, but when we run this code,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1785) [we'll get a result like this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1788) [with all of the text in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1790) [Helvetica 12 and using the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1791) [default paragraph style with the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1793) [default line break mode of word](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1795) [wrapping.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1796) [And, again, this is really great](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1797) [for those of you who loathe](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1799) [Comic Sans because it's been](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1799) [Comic Sans because it's been](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1799) [totally eliminated from the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1801) [string but it's wrong.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1802) [And it's wrong in a different](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1804) [way from last time.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1805) [And to understand the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1806) [difference, let's recall that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1808) [attribute fixing happens before](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1809) [layout and this is where the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1811) [system repairs the inconsistent](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1813) [attributes.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1814) [And so here in our attributed](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1816) [string we have a single](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1817) [paragraph with multiple](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1818) [paragraph styles and that's](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1819) [pretty inconsistent.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1821) [So when the system fixes the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1823) [attributes of this string, it's](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1824) [going to take the first](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1826) [paragraph style it finds and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1827) [apply it to the entire](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1828) [paragraph.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1829) [And that's how we ended up with](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1831) [our attributed string displaying](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1832) [with the default paragraph](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1834) [style.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1835) [And the key take away here is to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1835) [be explicit with your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1838) [attributes, especially when](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1839) [you're mixing plain and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1841) [attributed text.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1842) [So by doing this, you're going](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1843) [to avoid this reset effect with](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1844) [the default attributes.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1846) [And for AppKit developers, this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1847) [is actually super important if](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1849) [you're updating your app for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1851) [dark mode.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1852) [So by using the explicit](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1853) [attributes with the dynamic](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1854) [colors like NSColor.textColor,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1856) [you'll ensure that your text is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1857) [drawn with the correct colors](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1859) [drawn with the correct colors](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1859) [for the context.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1860) [So moving on.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1863) [The next topic is performance.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1864) [If you're working with large](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1866) [amounts of text, a good way to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1867) [improve your apps performance is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1868) [to use noncontinuous layout.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1870) [And to understand what that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1871) [means, let's revisit our old](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1874) [friend the layout process.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1875) [We said that the layout process](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1877) [consists of glyph generation](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1878) [followed by glyph layout.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1880) [And so with continuous layout,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1882) [the layout manager is going to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1884) [perform glyph generation and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1885) [glyph layout starting at the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1886) [beginning of the text storage.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1887) [And it goes in order from the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1890) [beginning to the end.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1891) [And so if someone using your app](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1893) [scrolls to some point in the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1895) [middle of your text view, the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1896) [layout manager has to generate](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1897) [and layout the glyphs for all](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1898) [the glyphs that come before that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1901) [point as indicated by the red](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1902) [rectangle.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1904) [And note that this also includes](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1905) [the text that you can't see](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1906) [that's been scrolled off the top](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1907) [of the screen all the way back](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1909) [to the beginning of the text](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1910) [storage.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1911) [And so if you have a lot of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1912) [text, that poor person might](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1914) [have to wait a while for your](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1916) [app to finish layout but](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1917) [luckily, we can avoid this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1919) [luckily, we can avoid this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1919) [situation by using noncontinuous](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1921) [layout.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1923) [And so as the name implies, with](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1924) [noncontinuous layout, the layout](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1926) [manager doesn't have to do glyph](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1928) [generation and layout in order](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1930) [from the beginning of the text](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1931) [storage.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1932) [So now when that person, using](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1934) [your app, scrolls to the middle](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1935) [of your text view, the layout](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1937) [manager can perform glyph](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1938) [generation and layout for that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1940) [middle section right away.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1941) [So if your text storage has a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1943) [lot of text in it, using](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1945) [noncontinuous layout is a huge](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1946) [performance win.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1948) [Great. So how do you turn this](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1949) [on?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1953) [Well, noncontinuous layout is a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1953) [property of NSLayoutManager.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1955) [And so for NSTextView, you can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1957) [access the text to use layout](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1959) [manager and then you can set](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1961) [that property there.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1962) [For UITextView, you usually](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1964) [don't have to do anything](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1966) [because this is turned on by](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1967) [default, but there's just one](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1968) [important thing to remember.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1970) [Since UITextView is a subclass](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1973) [of UIScrollView, noncontinuous](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1975) [layout will require scrolling to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1977) [be enabled.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1979) [be enabled.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1979) [And this is because when you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1981) [disable scrolling, asking for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1982) [the intrinsic content size of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1984) [your text view is going to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1986) [require laying out all the text](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1987) [and then you wouldn't get the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1988) [performance benefits of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1989) [noncontinuous layout in the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1990) [first place.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1991) [And that brings me to a really](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1992) [important point.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1995) [You should avoid requesting](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1997) [layout for all or most of the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1998) [text at once when you're using](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=1999) [noncontinuous layout since that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2000) [kind of defeats the purpose of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2003) [using it in the first place.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2004) [So if you have only one text](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2005) [container, don't ask for the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2007) [layout of the entire thing.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2008) [And don't ask for layout for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2010) [large ranges of characters or](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2011) [glyphs that include the end of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2013) [the text.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2015) [And we didn't dig too deeply](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2017) [into the topic of text](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2018) [performance here because I gave](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2019) [a great talk on this last year](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2020) [at WWDC 2017, Efficient](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2022) [unteractions with Frameworks.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2024) [And you can access the video](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2026) [from that more information link](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2027) [at the end of the session.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2028) [All right.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2029) [Now it's time to talk about](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2031) [everyone's favorite topic,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2033) [security.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2035) [So you may have noticed that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2036) [there have been incidents in the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2039) [there have been incidents in the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2039) [recent past where some people on](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2040) [the Internet have exploited bugs](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2042) [in our software to cause](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2044) [problems for people who use our](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2045) [products.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2047) [And in response, we're](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2048) [continuing to devise techniques](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2050) [for mitigating these kinds of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2051) [attacks, but today I'd like to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2052) [talk about how we can work](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2056) [together to provide a stronger](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2057) [defense against these attacks.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2058) [So you may have heard of the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2060) [concept defense in depth.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2061) [And in case you're not familiar](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2064) [with the terms, defense in depth](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2066) [refers to creating multiple](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2067) [layers of protection to defend](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2069) [against threats.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2070) [And this concept has been around](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2071) [for centuries.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2073) [You can see it in the design of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2074) [medieval castles.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2075) [The land around the outside is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2076) [clear of trees so you can see](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2078) [attackers coming.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2079) [And there's a moat to make](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2079) [approaching the castle more](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2081) [difficult and to prevent](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2082) [tunneling underneath it.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2083) [And the walls are another](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2084) [defense.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2086) [They're built tall so that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2087) [they're difficult to climb.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2088) [And there are arrow slits in the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2089) [walls and crenellations at the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2090) [top to allow defenders to fire](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2092) [on attackers from protected](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2094) [locations.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2095) [Now any one of these individual](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2097) [protections might not be enough](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2098) [protections might not be enough](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2098) [to fend off an attack but](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2100) [collectively they provide a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2101) [strong defense.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2103) [And like the castle, we here at](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2105) [Apple provide multiple layers of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2107) [defense against attacks, but](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2109) [there's nothing stopping you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2111) [from also taking your own](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2112) [defensive measures in your app](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2113) [or framework.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2114) [And by doing this, you're adding](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2115) [another layer of protection and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2117) [improving your product security.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2118) [Everyone wins.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2120) [So let's talk about what you can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2121) [do here.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2123) [And something I'd like you to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2125) [consider is setting limits on](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2126) [text input in your app or](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2128) [framework.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2130) [And now I'd like to emphasize](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2131) [that this might not always make](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2132) [sense to do.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2133) [So, for example, if your app is](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2134) [an authoring tool like that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2136) [journal app that Emily showed](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2137) [earlier, it wouldn't really make](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2138) [any sense to set a limit on the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2140) [length of the text there.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2142) [So if it doesn't make sense, you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2143) [shouldn't do it.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2144) [But in contrast, if your phone](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2146) [app has a text field for](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2147) [assigning a nickname to an](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2149) [account, you probably have some](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2150) [idea what a reasonable limit](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2152) [would be there.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2153) [And it's a good idea to set](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2154) [these limits because all text](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2157) [input is potentially untrusted.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2158) [input is potentially untrusted.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2158) [When you allow text input, you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2162) [allow copy and paste.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2163) [You don't know what kind of text](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2165) [can be pasted in there.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2168) [It could be anything.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2170) [It could be a string with](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2170) [malicious character](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2172) [combinations, or it could just](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2172) [be a string that's really,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2174) [really, really long.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2176) [And even though long strings](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2180) [like that may not be malicious](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2181) [in themselves, it could cause](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2183) [your app to freeze or hang.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2184) [So if you have a text field](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2186) [that's intended for one line of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2187) [input and someone pastes the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2189) [entire contents of "War and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2190) [Peace" into it, which is about](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2192) [3.1 million characters in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2193) [English, is that reasonable?](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2195) [Probably not.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2199) [So this is a great example of a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2202) [case where it makes sense to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2203) [impose your own limits.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2205) [And here are the recommended](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2207) [approaches for setting these](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2209) [kinds of limits.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2210) [You want to validate the input](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2211) [string before it's set on the](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2212) [text field.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2214) [And so for UITextFields, you can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2215) [do this by using](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2216) [UITextFieldDelegate.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2217) [And for NSTextFields, you should](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2219) [And for NSTextFields, you should](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2219) [use a custom NSFormatter to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2221) [implement your validation logic.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2223) [Oh, and we've also got some](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2224) [additional security enhancements](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2227) [coming your way.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2229) [So keep an eye out for them in](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2230) [the release notes and come see](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2231) [us at the labs this week if you](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2232) [have any questions.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2233) [All right.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2235) [We're just about out of time so](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2236) [let's recap.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2238) [You know how to choose the right](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2240) [control, customization point,](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2241) [and customization approach and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2243) [you know the best practices to](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2245) [follow in the areas of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2246) [correctness, performance, and](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2247) [security.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2249) [So use this knowledge to go](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2250) [forth and create great things](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2252) [with TextKit.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2253) [Oh, and before you go, here's](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2255) [that super important more](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2256) [information link where you can](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2258) [find all of the great past](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2259) [sessions and documentation that](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2260) [we've referenced today.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2261) [And come visit us at the labs on](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2263) [Thursday and Friday.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2264) [Thank you and enjoy the rest of](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2265) [the conference.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2267) [[ Applause ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/221/?time=2268)