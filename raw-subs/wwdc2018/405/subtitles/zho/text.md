# Measuring Performance Using Logging

## Summary
Learn how to use signposts and logging to measure performance.  Understand how the Points of Interest instrument can be used to examine logged data. Get an introduction into creating and using custom instruments.

## Info
* Developer Tools
* WWDC 2018 - Session 405 - iOS, macOS, tvOS, watchOS
* https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/

## Text
 [[ 音乐 ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=6) [[ 掌声 ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=22) [&gt;&gt; 下午好](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=31) [我叫 Shane](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=34) [我来自 Darwin Runtime 团队](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=35) [欢迎大家来到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=37) [“使用日志来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=39) [衡量性能”](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=40) [我们在周一听到了很多](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=42) [关于性能的东西](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=44) [性能是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=46) [良好用户体验的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=47) [关键之一](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=49) [人们希望他们的游戏](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=50) [和 App 能跑得快](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=52) [同时兼具流畅性和灵敏性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=54) [但软件是复杂的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=57) [但软件是复杂的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=57) [这意味着当你的 App 在运行时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=62) [有时还同时发生着很多事情](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=65) [这意味着你可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=66) [从一些意想不到的地方](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=69) [找到性能的突出点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=71) [这么做的话](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=73) [发觉这些性能突出点需要你](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=76) [对程序的行为有所理解](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=78) [有时需要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=80) [更深的理解](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=81) [它要求你知道](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=83) [你的代码具体在什么时候运行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=84) [一段运算具体花了多少时间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=86) [所以这是一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=89) [能让好工具真正发挥作用的地方](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=91) [我们知道开发更好的工具](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=94) [并交给你们使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=96) [可以使我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=97) [帮助你们成为](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=99) [更有效率的开发者](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=101) [所以今天我要说说](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=102) [一个这样的工具](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=104) [今天我要说说](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=105) [Signposts](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=107) [Signposts 是 OSLog 家族中的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=108) [新成员](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=110) [你可以在 macOS 中使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=112) [你也可以在 iOS 中使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=116) [你可以在 Swift 和 C 里面使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=118) [但最酷的是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=120) [我们将它整合进了 Instruments](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=122) [这意味着 Instruments 可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=125) [获得 Signposts 产生的数据](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=126) [让你对程序的行为 有更深的理解](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=127) [首先简单讲下历史](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=133) [我们在几年前就推出了 OSLog](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=136) [这是我们关于日志设备](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=139) [的新想法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=141) [这是我们从系统中 获取调试信息的方式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=143) [我们是怀着提升效率的目标](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=146) [并牢记着隐私的重要性 来开发它的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=149) [这里你可以看到一段](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=152) [OSLog 的代码示例](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=154) [我刚刚创建了一个简单的日志句柄](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=155) [并把 “hello world” 传给了它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=157) [Signposts 继承了 OSLog 的 API](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=160) [但它是为了描述](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=163) [性能使用的情况](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=164) [这意味着它们在传达](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=165) [和性能有关的信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=166) [并且我们把它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=168) [整合进了我们的开发者工具中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=169) [也就是说你可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=171) [用 Signposts 来给你的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=172) [代码加上注释然后打开](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=173) [Instruments 就能看到这个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=175) [在这里 Instruments 向你展示了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=178) [关于程序行为和 Signposts 活动](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=180) [的一个漂亮时间线](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=183) [然后在底部](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=186) [有一个聚合了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=187) [Signposts 统计和分析数据](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=189) [的表格](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=191) [通过筛选拆解](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=193) [来检查你程序的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=195) [行为](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=196) [此次会议中我会讲](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=198) [如何在你的代码中使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=200) [Signposts 并向你展示](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=201) [它的功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=203) [然后我们将展示](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=204) [新的 Instrument 和 Signposts 的图像](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=205) [使你对 Signposts 和 Instrument](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=209) [的协作有直观的理解 让我们开始吧](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=211) [我先从一个非常简单的例子开始](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=215) [假设这是你的 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=219) [你想调查](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=223) [一块特定界面](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=224) [刷新所需要的时间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=226) [要达到这个目标](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=229) [你要加载一些图片并将它们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=231) [放在屏幕上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=233) [所以简单来说从 App 的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=234) [这个 App 做的工作就是抓取素材](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=237) [这个 App 做的工作就是抓取素材](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=237) [当你抓取完所有素材以后](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=241) [界面就刷新了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=242) [一个 Signpost 允许我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=245) [标记一段行为的开始](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=247) [和结束然后将](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=249) [这时间上的两点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=251) [和这两个日志事件关联](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=252) [它们通过调用了一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=255) [os_signpost 函数来完成](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=258) [有两种调用方式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=259) [一种是 .begin 一种是 .end](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=260) [这里我用一个下面](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=263) [带 b 的箭头代表开始](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=265) [用下面带 e 的箭头](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=267) [代表结束](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=269) [然后我们将这两点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=271) [联系起来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=272) [让你知道](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=274) [这个间隔经过了多少时间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=276) [好了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=277) [代码里这里有一段](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=280) [这个算法的简单应用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=282) [对于界面的每个元素](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=284) [我们都要获取素材](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=285) [并且想要测量](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=287) [这个操作所需的时间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=289) [要将 signpost 导入](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=292) [这段代码里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=293) [我们只需将包含这个功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=295) [的 os.signpost 模块导入](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=297) [然后因为 Signposts 是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=300) [OSLog 功能的一部分](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=302) [我们要创建一个日志句柄](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=304) [这里 这个日志句柄有两个参数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=306) [一个 subsystem 和一个 category](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=308) [subsystem 可能在你整个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=311) [项目中都是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=313) [一样的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=314) [它看起来非常像你的套装 ID](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=315) [它代表着软件的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=316) [组成部分](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=318) [可能是你使用的框架](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=319) [category 是用来关联](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=322) [将相关的操作或者相关的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=325) [signposts 组合在一起](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=327) [稍后你将在会议中看到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=329) [为什么它很有用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=330) [当我们有了日志句柄后](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=333) [我们将调用 os_signpost 函数两次](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=335) [一次用 .begin. 一次用 .end.](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=337) [我们将日志句柄传给](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=339) [这几次调用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=341) [第三个参数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=342) [是 signpost 名称](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=344) [signpost 名称是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=347) [一个字符串常量](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=349) [用来确定间隔时间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=351) [用来确定我们想要测量的操作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=353) [这个字符串常量是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=355) [用来匹配我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=357) [通过调用的 os_signpost 函数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=359) [通过调用的 os_signpost 函数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=359) [注释或标记过的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=360) [开始点和结束点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=362) [所以在我们的时间线上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=365) [看起来就像这样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=367) [在每段工作的开始](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=368) [我们放了一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=369) [os_signpost](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=371) [在每段工作的结束](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=372) [我们放了一个 os_signpost](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=373) [因为这些字符串常量](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=375) [在开始和结束的调用点上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=376) [按顺序排好了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=377) [我们可以将它俩匹配](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=379) [但是如果我们想要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=380) [测量整段操作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=383) [完成全部刷新](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=385) [所花的时间呢](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=386) [在我们代码里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=388) [我们只需添加另一对 os_signpost](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=391) [begin 和 end 调用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=392) [非常简单](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=394) [这次我赋予了一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=395) [不同的字符串常量](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=397) [所以就有一个不一样的 signpost 名称](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=398) [这次用了 “Refresh Panel”](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=399) [来表示这是一个独立的间隔时间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=401) [和循环里的间隔时间相独立](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=403) [在我们的时间线上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=407) [我们标记了另外两个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=410) [signposts](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=411) [而匹配的字符串常量](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=414) [“Refresh Panel”](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=415) [让系统知道](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=417) [这两点是相关联的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=418) [这两点是相关联的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=418) [好了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=422) [这并不是个超级简单的例子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=423) [如果你的程序一直](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=426) [按第一步第二步](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=427) [然后第三步的顺序来走](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=429) [这么做是可以的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=431) [但在我们系统中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=432) [经常有很多工作是异步发生的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=434) [嗯](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=437) [并不是有第一步](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=437) [第二步第三步](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=439) [我们通常按顺序开始](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=441) [对吧 然后](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=443) [稍后再完成它们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=444) [这意味着](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=446) [这些操作可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=447) [同时发生](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=448) [他们可以重叠](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=449) [在这种情况下我们需要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=451) [给系统一些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=452) [额外的信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=454) [以让它区分开](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=455) [这些 signposts](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=456) [要做到这一点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=459) [目前我们只用到了名称](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=462) [对吧](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=463) [这个名称会匹配](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=463) [开始和结束点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=465) [所以字符串常量现在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=467) [已经标识了时间段](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=468) [但还没有让我们可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=470) [区分重叠的时间段](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=471) [要做到这一点我们给](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=474) [Signpost 调用添加](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=475) [了另一块信息 叫做 signpost ID](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=476) [signpost ID 会告诉系统](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=480) [这些是同一类型的操作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=482) [但是它们之间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=484) [又互相不一样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=486) [所以如果两项操作重叠了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=488) [但它们有着不同的 signpost ID](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=491) [系统就会知道](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=492) [它们是不同的时间段](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=493) [只要你将相同的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=495) [signpost ID 传给了开始调用点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=496) [和结束调用点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=498) [这两个 signpost 就会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=499) [相互关联](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=501) [你可以通过这个构造函数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=503) [使用一个日志句柄](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=505) [来创建 signpost ID 但你也可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=507) [通过对象来创建](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=509) [如果你有一些对象](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=512) [代表你想做的事](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=513) [那么这样就很方便](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=515) [只要你使用了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=516) [对象的同一实例](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=518) [就会生成同样的 signpost ID](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=519) [这意味着你不需要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=521) [到处携带和存储 signpost ID](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=522) [你可以直接使用对象](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=524) [直观上你可以将](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=528) [signpost ID 想成允许我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=531) [向每次 signpost 调用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=533) [传递一点额外的背景信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=535) [对于一段特定的操作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=537) [对于一段特定的操作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=537) [它可以将开始和结束标记联系起来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=540) [这很重要因为这些操作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=543) [不仅可能会重叠](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=544) [它们还通常需要花](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=546) [不一样的时间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=548) [让我们到示例代码中看看](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=552) [这就是我们的代码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=555) [我要将同步获取](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=556) [异步调用转换成](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=558) [异步获取](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=560) [现在我要给它一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=561) [completionHandler](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=563) [当素材获取完毕后](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=564) [这个闭包就会运行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=565) [然后我又添加了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=568) [一个闭包一个 completionHandler](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=569) [在素材获取完后就运行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=571) [在每种情况下我都将](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=575) [os_signpost 结束调用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=576) [放在了闭包内来指示](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=578) [这就是我想要标记时段](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=580) [结束的时间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=582) [OK](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=584) [因为我们觉得](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=585) [这些时段会互相重叠](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=588) [我们想针对每个时段](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=589) [创建新的 signpost ID](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=591) [注意在上面的例子中我已经](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=592) [通过构造函数使用日志句柄](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=594) [创建了一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=595) [第二个 我是通过](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=596) [然后我将这些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=601) [signpost ID 传给调用处](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=603) [做完了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=606) [你可以将 signpost 想成](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=607) [整理好的一种](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=610) [分类或者层次](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=612) [对吧](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=614) [所有这些操作都由](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=615) [日志句柄相关联](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=616) [代表日志类型](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=618) [对我们感兴趣的每段操作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=620) [我们赋予了它一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=621) [signpost 名称](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=622) [然后因为这些 signpost](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=625) [可能互相重叠](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=626) [我们给了它们 signpost ID](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=628) [告诉系统这是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=629) [那段时间的一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=632) [特定实例](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=634) [这个界面专门](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=636) [设计得很灵活](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=639) [这样你就可以在开始点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=642) [和结束点控制所有的参数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=644) [你可以控制 signpost 名称](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=646) [赋予的日志句柄和 ID](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=647) [我们这么做是因为](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=651) [只要你在开始点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=652) [和结束点提供了相同的参数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=654) [那两个 signpost](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=655) [就能够互相匹配](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=657) [这意味着你的开始和结束点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=659) [这意味着你的开始和结束点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=659) [可以在不同的函数中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=661) [它们可以和不同的对象](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=662) [相关联](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=663) [它们甚至可以存在不同的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=664) [源文件中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=665) [我们这么做是因为我们想](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=667) [让你可以在你的代码里使用它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=668) [所以无论你有什么](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=670) [进入和退出的条件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=672) [你都可以调用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=674) [这就是如何使用 signposts](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=677) [来测量间隔时间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=680) [可能你还想随 signposts](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=682) [传达一些额外的信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=684) [一些额外的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=685) [和性能有关的信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=686) [对于这个 我们有办法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=688) [向 signpost 调用添加元数据](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=690) [这是你的基础 signpost 调用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=693) [在此基础上我们可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=696) [添加一个字符串常量参数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=697) [这允许你为你的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=699) [开始和结束调用点添加一些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=700) [背景信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=702) [对于一段特定的操作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=704) [你可能有很多进入和退出点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=706) [但是字符串常量](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=707) [也是一个 OSLog 格式的字符串](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=710) [这意味着我可以拿它来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=713) [向 signpost 传递额外的数据](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=714) [这里 比如说](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=717) [我使用了 %d 传递了四个整数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=719) [我使用了 %d 传递了四个整数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=719) [但是因为这是一个 OSLog 格式的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=722) [字符串 我还可以使用它来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=724) [传递许多不同类型的参数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=726) [这里我传递了一些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=728) [浮点数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=729) [我甚至使用了格式说明符](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=730) [来告诉系统](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=732) [我想要的精确度](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=734) [你也可以使用字符串常量](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=736) [formatter 来传递动态字符串](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=739) [这样我们可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=741) [传递来自函数调用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=743) [或者来自](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=744) [用户输入的信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=745) [而我们使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=748) [固定大小的存储量来引用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=750) [这个格式的字符串常量](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=751) [这意味着你可以想](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=753) [让它多长和易于理解](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=754) [都行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=756) [这段易于理解的字符串](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=759) [跟之后 Instruments 渲染的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=761) [是一样的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=762) [所以你可以随意给它一些背景](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=764) [我在这里列举了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=765) [很多参数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=767) [Instruments 能够展示](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=768) [完整的渲染后的字符串](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=769) [或者它仍然对所附的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=771) [数据有程序访问权限](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=773) [除了这些时段的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=777) [元数据以外你可能还想](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=779) [元数据以外你可能还想](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=779) [添加独立的时间点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=781) [也就是说除了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=784) [开始 signpost 和结束 signpost 以外](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=786) [你还可以有这样一个 signpost](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=788) [它没有跟一个特定的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=789) [时间段绑定](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=790) [而是跟一个固定的时刻绑定](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=792) [对于这个我们有一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=794) [类型为 event 的 os_signpost](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=796) [event 类型的 os_signpost](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=798) [的调用和开始结束的调用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=800) [看起来一样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=801) [只不过多了 event 的类型](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=803) [它标记了一个特定的时间点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=805) [你可以在时间段的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=808) [范围内使用它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=809) [或者可能你想追踪](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=812) [独立于一个时间段的事件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=813) [比如一次用户交互](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=814) [所以对于我们刚刚讲的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=816) [获取素材的时间间隔](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=819) [你可能想知道](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=821) [你在什么时候连接到了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=822) [提供这个素材的服务](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=823) [或者你可能想知道](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=825) [你在什么时候 接收到了其中的几个字节](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=825) [你可以使用这个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=828) [在一个时间段过程中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=829) [多次更新](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=831) [此时间段的状态和进展](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=832) [或者你可能想追踪一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=836) [触发事件比如](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=838) [触发事件比如](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=838) [一次用户界面交互](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=840) [比如有人刚滑动屏幕](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=842) [来更新界面](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=844) [虽然如果你真的在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=845) [研究一个性能问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=847) [他们可能滑动了很多次](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=848) [所以这可能是你看到的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=849) [如果你启用了 signpost](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=854) [默认情况下它们是开启的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=857) [但是我想讲讲](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=859) [有条件地开启和关闭它们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=860) [首先我想强调](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=863) [我们把 signpost 设计得](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=865) [轻便小巧](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=866) [这意味着我们做了很多](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=868) [来优化它们的启动时间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=869) [我们通过优化了编译器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=872) [使得任务能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=873) [提前进行而非](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=874) [在运行时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=876) [我们还推迟了很多事情](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=877) [使它们可以在 Instruments](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=879) [后台运行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=880) [这意味着当](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=881) [在发送 signposts 时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=883) [它们只会占用非常少的系统资源](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=884) [我们这么做是因为我们想](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=886) [最小化它给你的代码运行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=887) [带来的影响](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=889) [我们这么做还因为](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=890) [我们想确保即使](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=892) [你的时间跨度非常小](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=893) [你也能发送很多](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=895) [signpost 来得到一些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=896) [精确的测量结果](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=897) [但是你也可能想要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=900) [关闭你的 signpost](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=901) [你可能想要通过](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=903) [特定路径中的代码消除](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=905) [尽可能多的开销](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=906) [或者你可能有两种类型的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=908) [signposts 两种的体量](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=910) [都非常大 但是在某一时刻](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=911) [你仅仅想对其中一种](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=914) [进行除错](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=916) [要这么做的话](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=917) [我们要利用 OSLog 的一个功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=919) [禁用的日志句柄](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=920) [禁用的日志句柄是一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=924) [简单的句柄](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=926) [它的功能是把](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=927) [对于该句柄的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=930) [OSLog 和 os_signpost 调用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=931) [都变成类似于空操作的东西](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=933) [事实上 如果你在 C 当中使用它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=936) [我们甚至会帮你检查行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=938) [我们甚至不会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=939) [评估剩下的参数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=941) [所以你可以在运行时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=943) [修改这个句柄](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=945) [让我给你看个例子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=946) [让我们回到一开始](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=948) [使用的第一段代码示例](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=951) [你可以在上面看到初始化的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=953) [日志句柄](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=954) [而我现在要让这个初始化](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=956) [有条件地发生](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=959) [有条件地发生](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=959) [所以我要么将它分配给](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=961) [普通的 os_log 构造函数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=962) [或者把它分配给](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=965) [禁用的日志句柄](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=965) [如果我们采取第一种方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=967) [所有的 os_signpost 调用都会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=971) [按照我刚刚说的一样进行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=972) [但如果我们采取第二种方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=974) [这些 os_signpost 调用都会变成](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=975) [接近于空操作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=977) [我刚刚说过](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=978) [我没有必要调用任何我的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=981) [调用 我没有必要改变](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=982) [我的任何调用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=984) [我只需要改变初始化](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=985) [我让初始化条件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=987) [依赖于环境变量](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=989) [你可以在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=991) [对程序进行调试时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=992) [在 Xcode scheme 中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=994) [对此进行设置](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=995) [我刚才说你没有必要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=997) [在调用处内进行改变](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=999) [但是你可能有一些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1000) [用于特定 instrumentation 的功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1001) [也就是说虽然代价高昂](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1004) [但可能只有在调试时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1006) [才使用它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1007) [这种情况下你可以检查一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1008) [特定的日志句柄](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1010) [看看在启用 signpost](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1012) [属性中是否启用了 signpost](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1014) [启用了 signpost 的属性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1016) [可以用来控制](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1017) [额外的操作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1018) [额外的操作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1018) [好的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1022) [我刚展示过的所有例子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1023) [都是用的 Swift](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1025) [但是 signposts 也可以用于 C](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1027) [我刚刚讲过的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1033) [所有功能都可以用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1033) [日志句柄](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1035) [发送三种不同的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1037) [signpost 以及管理](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1038) [你的 signpost 标识符](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1041) [对于那些对使用 C](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1043) [感兴趣的人来说](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1043) [我鼓励你们阅读标题文档](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1045) [标题文档涵盖了所有](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1046) [我刚讲的信息但是是从](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1048) [C 语言开发者的角度写的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1049) [好了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1052) [现在你知道了如何在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1053) [代码中使用 signpost](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1054) [或许你对它们代表的东西](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1056) [有了一个思维模型](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1058) [所以我想让你们看看](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1059) [signposts 如何与](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1061) [Instruments 协作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1063) [这一块 我要把](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1064) [剩下的环节交给](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1065) [我的同事 Chad](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1066) [谢谢](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1069) [[ 掌声 ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1070) [&gt;&gt; 好了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1077) [谢谢你 Shane](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1078) [今天我要向大家演示](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1080) [Instruments 10 的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1082) [三个重要的新功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1084) [帮助你更好地](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1085) [处理 signpost 数据](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1086) [第一个就是新的 os_signpost instrument](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1088) [这个 instrument 允许你](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1090) [记录 图形化](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1091) [并分析你 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1093) [的所有 signpost 活动](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1094) [下一个功能是 points of interest](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1097) [我会大概讲讲什么是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1100) [points of interest](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1100) [你会在什么时候使用它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1102) [然后我会向大家展示](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1104) [新的自定义 instrument 功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1106) [以及如何同 os_signpost](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1107) [使用它来得到关于](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1109) [signpost 的更精确的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1112) [一个表示](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1114) [让我们看看](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1115) [操作示范吧](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1117) [好的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1119) [首先让我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1122) [看看我们的示例程序](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1124) [这是我们的 Trailblazer App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1127) [这个 App 向你展示了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1130) [当地的登山路线](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1133) [当我们往下滑时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1134) [它会为你下载这些好看的图片](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1136) [你会注意到最开始](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1139) [你会注意到最开始](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1139) [是白色的背景然后](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1141) [图片随后出现 填充了背景](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1143) [对于这类 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1144) [这是非常常见的现象](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1146) [有时它植入了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1148) [future 或者 promise](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1149) [但是这个现象 虽然它对](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1152) [性能很有帮助](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1153) [它也很难被配置](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1155) [原因在于有很多异步的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1157) [活动在同时进行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1159) [当用户滑动时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1161) [有一些下载在同时进行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1163) [如果用户像这样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1165) [飞快地滑动时那么](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1167) [在图像单元重新被使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1169) [之前下载可能还没有完成](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1171) [那么我们就得取消下载](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1174) [如果我们取消失败了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1176) [那么一些下载就会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1177) [并行运行但是我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1180) [并不想这样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1181) [让我们看看如何](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1182) [使用 signposts 来分析](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1184) [我们的 Trailblazer 的 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1186) [在路线单元中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1188) [有一个方式叫做](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1191) [startImageDownload](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1193) [当我们需要下载新图像时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1195) [它就会被调用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1196) [它传递了需要被下载的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1198) [它传递了需要被下载的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1198) [图像名称](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1201) [现在我们在这里有一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1202) [download helper 的类](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1204) [我们创建一个传递名称的实例](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1205) [将我们自己设为委托](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1207) [当它下载完后就会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1208) [回调我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1209) [这种情况下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1210) [既然 downloader 代表](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1213) [同时进行的活动](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1215) [这个异步的工作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1216) [就是 signpost ID 的绝佳依据](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1219) [我们现在用我们的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1221) [downloader 对象来创建 signpost ID](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1222) [要启用我们的 signposts](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1226) [我们要做一个 os_signpost begin](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1227) [我们将它发送到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1229) [我们的 networking 日志句柄](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1230) [快速浏览下我们的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1232) [networking 日志句柄](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1234) [你可以看到我们使用了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1235) [Trailblazer 套装 ID 和](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1237) [networking 类别](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1239) [现在我们要传递一张图像](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1241) [不好意思是背景图片的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1245) [signpost 名称这样我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1247) [就能看到所有背景](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1249) [图片的下载](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1250) [它会传递我们创建的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1251) [signpost ID](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1252) [我们给开始附上一些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1253) [元数据来传达我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1256) [下载的图像的名称](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1259) [下载的图像的名称](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1259) [然后我们开始下载](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1261) [我们设置属性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1262) [来追踪下载](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1264) [目前设为 runningDownloader](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1266) [这个完成后我们会在这里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1269) [有一个 didReceiveImage 回调](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1270) [然后我们将图像视图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1273) [设为接收到的图像](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1275) [然后我们结束调用 signpost](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1277) [然后我们将使用完全](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1279) [一样的日志句柄 一样的名称](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1281) [一样的 signpost ID 但这次](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1283) [我们将附上一些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1285) [结束的元数据比如](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1287) [“finished with size”](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1289) [你会注意到这里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1290) [我们给了这个参数标记了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1293) [Xcode:size-in-bytes 的特征](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1295) [这个东西告诉](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1298) [Xcode 和 Instruments](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1300) [这项参数在显示](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1302) [和分析中都应被当做](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1303) [size-in-bytes](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1305) [这些叫工程类型](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1307) [你可以在 Instruments](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1309) [开发者帮助指南中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1310) [读到 就在 Instruments](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1311) [的帮助菜单中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1312) [当我们完成下载后](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1314) [我们可以将它设为 nil](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1317) [我们有两种方式来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1320) [结束下载](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1322) [一种是成功的情况](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1323) [而我们还要考虑](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1326) [取消的情况](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1327) [准备重新使用时 如果我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1328) [现在有一个正在运行的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1331) [downloader 我们首先需要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1332) [取消这个 downloader](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1333) [这种情况下我们要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1336) [为这个时间段创建结束点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1337) [然后我们使用同一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1339) [日志句柄 signpost 名称 signpost ID](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1341) [然后我们使用 cancelled](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1345) [作为结束元数据来隔开它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1347) [当我们成功完成时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1349) [这些应该足够](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1352) [来配置了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1353) [现在我们到这里来配置产品](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1354) [而当我们完成](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1358) [构建和安装后它就会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1360) [启动 Instruments](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1363) [它会在这里启动 Instruments](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1364) [我们可以创建一个空白的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1367) [新文档](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1369) [然后我们到 library 中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1370) [我可以向你展示如何使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1372) [新的 os_signpost instrument](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1374) [这里有我们新的 os_signpost instrument](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1376) [然后我们把它拖动 挪到这里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1379) [然后我们把它拖动 挪到这里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1379) [我们给它在这里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1384) [多留点空间然后我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1385) [按下录制](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1387) [然后我们拿出 iPhone](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1388) [回到开始状态](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1392) [好了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1393) [现在我们要开始滑动](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1394) [然后我们也会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1395) [非常 非常快得滑动屏幕](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1396) [然后我们让它停下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1397) [现在我们返回到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1400) [Instruments 中看看我们记录下了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1402) [什么数据](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1403) [现在我要停止录制](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1404) [现在你可以注意到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1407) [在轨迹视图中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1410) [我们可以直观地看到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1411) [所有背景图片时间间隔](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1413) [这是 signpost 名称](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1414) [如果我们按住选项键](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1415) [然后放大你可以看到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1417) [有一些时间段](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1420) [时间段被](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1421) [开始元数据和结束](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1423) [元数据标记](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1425) [如果我们缩回去](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1428) [然后再次观察轨迹](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1430) [我们会注意到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1432) [只有少于五张的图片](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1434) [在同时进行下载](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1437) [这是一件好事](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1438) [这意味着我们取消成功了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1440) [如果我们想确认的话](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1441) [我们可以到这里然后](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1444) [你可以看到许多](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1445) [时间间隔的元数据都](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1447) [写着下载时被取消](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1449) [如果你想 如果](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1452) [你想看看数据](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1454) [或者说你想看看](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1457) [这些间隔的持续时间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1458) [那么你可以来这里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1459) [看看这些间隔的概要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1462) [然后我们看到按类别](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1464) [进行了细分 然后按 signpost](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1466) [名称然后按开始信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1468) [然后按结束信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1470) [如果我们把这个缩小](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1473) [你可以看到我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1475) [发送了 93 次图片下载请求](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1478) [其中 12 次是针对于位置 1](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1482) [在这 12 次中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1485) [7 次被取消 5 次完成](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1486) [大小为 3.31 MB](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1488) [如果你现在看这里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1492) [这些是关于时段的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1493) [统计数据](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1494) [然后你们可以看到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1495) [被取消的最小和平均](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1498) [被取消的最小和平均](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1498) [时间段比](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1501) [下载完全的时间段](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1502) [要小很多](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1505) [这就是在这种](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1506) [情况下你期待看到的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1507) [现在如果你想要看所有](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1509) [被取消掉的事件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1511) [因为你对这些很感兴趣](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1512) [你可以按下这个聚焦箭头](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1513) [然后它会带你跳转到一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1516) [列表视图你可以在这里看到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1519) [所有地方 其中位置 1](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1521) [有结束信息 “cancelled”](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1524) [并且当我们浏览的时候](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1526) [你会看到轨迹](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1528) [上方的探头](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1529) [会移到每一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1531) [时间间隔处](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1532) [所以你可以追踪所有](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1533) [失败的情况如果你](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1535) [感兴趣的话](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1536) [这是一个查看这些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1536) [间隔的时间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1540) [时间点的好方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1542) [但是如果你想进行对这些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1544) [元数据进行分析呢](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1546) [如果你想确定](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1549) [有多少字节的图像数据](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1551) [是我们已经从网络上下载了呢](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1553) [我们已经发送了元数据信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1555) [比如 “Finished with size”](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1557) [然后是它的大小](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1559) [然后是它的大小](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1559) [如果我们能把这些参数加起来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1561) [那就太棒了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1562) [所以，如果你想这么做](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1565) [你可以在这里选择](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1566) [“summary of metadata statistics”](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1567) [你可以看到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1570) [我们将它分解成了子系统](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1571) [种类和格式化字符串](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1573) [在格式化字符串下面](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1577) [是它的参数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1578) [由于我们的格式化字符串](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1579) [只有一个参数 所以就是 arg0](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1580) [现在 Instruments 已经将这些加在一起了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1582) [并且它知道这是一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1586) [以字节计的大小](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1587) [它给了我们一个精准的计算](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1588) [结果为 80MB](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1589) [所以我们一共下载了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1592) [80MB 的图像数据](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1593) [现在你在这里可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1595) [看到不同的列](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1597) [有最小值 最大值 平均值](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1598) [还有标准差](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1599) [所以这是一个很好的方式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1600) [来查看你通过](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1601) [元数据传递的值的统计分析](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1603) [Shane 刚刚提到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1608) [signposts 非常轻量](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1609) [这是完全正确的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1612) [除非你像我 刚刚跑 Instruments](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1614) [那样运行 Instruments](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1615) [在 immediate 模式下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1617) [在 immediate 模式下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1617) [即默认录制模式下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1620) [Instruments 几乎是在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1621) [实时展现和记录数据](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1623) [所以当它进入到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1627) [immediate 模式录制时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1627) [所有的 signposts 都必须直接](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1629) [发给 Instruments](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1631) [我们就避开了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1633) [在操作系统中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1635) [缓冲能获得的优化](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1636) [现在，通过我们的 signposts](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1639) [通过我们的 signposts App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1641) [我们并不会真正创建足够多的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1644) [时间间隔使我们注意到花销](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1645) [但是如果你有一个游戏引擎](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1647) [并且你想要每秒发送](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1649) [数千个 signpost](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1650) [这时开销就会开始累积变多](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1652) [所以为了避免这个问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1655) [你可以在你](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1657) [录制之前改变](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1659) [Instruments 的录制模式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1661) [你可以通过](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1663) [下拉录制按钮](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1665) [然后选择录制选项来实现](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1666) [在这块全局选项](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1670) [的区域中你可以看到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1672) [我们选中了 immediate 模式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1675) [我们可以把它变成](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1677) [last 5 second 模式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1678) [这种模式通常被称为](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1680) [窗口模式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1681) [它告诉操作系统](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1683) [和录制技术](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1684) [我们不需要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1685) [每一个事件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1687) [我们只想要最后五秒](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1688) [的内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1689) [当你这么做时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1690) [Instruments 会让开](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1691) [然后让操作系统来做](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1692) [这是一个非常常见的模式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1695) [我们将它用于系统追踪](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1696) [我们将它用于 metal 系统追踪](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1698) [和新的游戏性能模板](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1699) [所以这是一种在你的 App 中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1702) [寻找卡顿和挂机的非常常见的方式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1703) [好了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1705) [这就是我们的 os_signpost](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1707) [instrument](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1710) [现在让我们来说说 points of interest](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1712) [现在如果我们回到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1716) [Trailblazer App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1718) [你注意到当我点击一个路线](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1720) [它就显示详细内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1723) [如果我返回点一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1726) [不同的路线它就显示](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1727) [不同的详细信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1728) [如果我们能追踪](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1730) [每一次详细信息界面的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1733) [的出现那就好了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1735) [因为这样我们就能分辨出](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1736) [我们的用户在试图做什么](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1737) [我们知道用户在 App 中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1739) [我们知道用户在 App 中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1739) [所处位置](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1740) [你当然可以用一个 signpost](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1742) [来做这个但是你必须在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1744) [os_signpost instrument](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1747) [里拖动并记录下 App 中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1748) [所有 signpost 的活动](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1750) [它某种程度上降低了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1752) [这些用户使用事件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1754) [的重要性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1756) [所以我们允许你](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1757) [将它们弄到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1759) [points of interest 中去](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1760) [现在如果我到代码里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1762) [查看细节控制器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1763) [看我们的 viewDidAppear 方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1766) [你可以看到我正在发布](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1768) [我正在创建一个 os_signpost 事件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1771) [显示 “Detail Appeared”](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1773) [以及细节的名称](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1774) [这被发送给我们创建的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1777) [一个特别的日志句柄](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1778) [叫 points of interest](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1779) [创建它的方式是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1780) [创建一个带子系统](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1782) [标识符和系统](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1783) [points of interest 类别的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1786) [日志句柄](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1787) [这是一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1788) [Instruments 会查找的特殊类别](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1789) [当它看到这里的 points](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1791) [它会把它们放到 points](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1793) [of interest instrument 里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1795) [如果我们回到这里然后点击](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1797) [time profile 你可以看到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1799) [time profile 你可以看到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1799) [这里自动包含了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1801) [points of interest instrument](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1803) [如果我们录制下来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1805) [然后进行同样的基础操作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1808) [我们进入 Matt Davis Trail](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1811) [然后我们回到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1812) [Skyline Trail 然后再回来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1813) [我们再做一次为了测得更准](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1815) [现在当你返回到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1819) [Instruments 你可以看到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1821) [这些 points of interest](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1825) [突出显示](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1826) [所以你能看到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1827) [在你 App 中 你的用户所处位置](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1829) [你可以将这个和其他](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1831) [性能数据关联](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1832) [所以 points of interest](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1833) [可以让你 从你的 App 中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1834) [选择一些最重要的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1838) [兴趣点然后把它们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1840) [提供给你团队中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1842) [或者开发社区中的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1844) [每一位开发者](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1845) [然后他们可以立即看到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1846) [points of interest](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1847) [好了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1849) [这就是 points of interest](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1850) [instrument 以及如何从](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1851) [signposts 中创建](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1853) [points of interest](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1854) [另一个 Instruments 10 中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1856) [很好的功能是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1859) [很好的功能是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1859) [你可以创建自定义的 instrument](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1861) [为了向大家展示](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1863) [在 os_signpost 可以对自定义](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1865) [instrument 做什么 我们创建了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1866) [作为项目的一部分](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1868) [一个 Trailblazer instruments 包](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1871) [我现在要构建并运行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1873) [你可以看到当我们在做时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1876) [我们启动了 Instruments](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1880) [的一个独立备份](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1881) [里面有我们刚建的包](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1884) [如果我们将版本调出来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1885) [可以看到我们现在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1888) [有一个 Trailblazer Networking](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1890) [轨迹模板](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1892) [如果我们选中它可以看到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1893) [我们有一个 Trailblazer](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1896) [Networking instrument](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1898) [在我们的轨迹文档中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1899) [让我们开始录制](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1901) [然后看看我们的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1903) [points of interest 的区别](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1904) [不好意思 我们的 os_signpost](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1906) [和自定义 instrument](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1908) [可以做什么](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1909) [我们要做同样的事情](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1910) [我们开始基本的下载](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1911) [然后回来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1913) [然后分析我们的轨迹](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1917) [现在这里显示的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1919) [现在这里显示的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1919) [完全不一样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1920) [让我们放大 然后 观察](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1921) [你看到在这里左边](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1924) [我们没有按](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1927) [signpost 名称细分](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1928) [而是按下载的图像](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1929) [现在我们可以看到图二](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1931) [是在这里和这里下载的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1933) [我们在每处标记了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1938) [下载的大小](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1940) [单位是兆](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1941) [我们把他们标成红色](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1942) [如果下载大小大于](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1945) [3 1/2 MB 的话](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1947) [这是我们创建的自定义图像](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1949) [是自定义 instrument 的一部分](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1951) [现在在下面我们还](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1953) [定义了一些细节](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1955) [这里有一张非常简洁的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1956) [下载任务表](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1958) [并且你可以通过它们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1959) [来浏览轨迹](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1961) [我们还有 让我看看](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1963) [能不能把它弄回这里来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1966) [我们还有一个对所有下载](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1967) [的概要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1970) [非常简单](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1971) [我们只想加起来求和](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1972) [我们还有个很棒的东西](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1974) [叫 Timeslice](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1976) [在 Timeslice 视图中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1978) [我们这么做是想要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1980) [回答我之前提出的问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1981) [这些东西中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1982) [哪些实际上是并行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1984) [运行的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1985) [如果你想看看](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1986) [并行运行的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1987) [时间段你只需要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1988) [拖动这里的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1989) [的探头然后你就可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1991) [看到在任一时间点上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1993) [和该探头相交](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1995) [的部分](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1996) [所以这是一个很好的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=1998) [但不同的检查 signpost 数据](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2000) [的方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2001) [如果你在和别人](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2003) [一起做一个项目或者](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2004) [你是开发者社区的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2006) [一员那么使用自定义](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2006) [instrument 能够很好地](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2008) [获取 signpost 数据](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2009) [改造它 这样其他人](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2011) [就可以直接使用并](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2013) [不需要懂得你代码的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2015) [运行细节就能理解](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2016) [所以它们是一个非常重要的功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2017) [好消息是要创建](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2019) [这样的一个 instrument](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2022) [全部软件包定义](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2024) [只有 115 行 XML](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2026) [所以自定义 instruments](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2031) [非常有表现力和强大](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2033) [但又非常简单](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2035) [这就是关于我们演示的总结](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2037) [这就是关于我们演示的总结](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2037) [[ 掌声 ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2041) [在今天的会议中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2049) [我们查看了 signpost API](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2050) [我们向你们展示了如何用它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2053) [在你 App 中标注](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2054) [值得注意的行为](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2056) [和时间段](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2057) [我们展示了如何收集](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2059) [元数据并将元数据](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2060) [放入 Instruments 来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2062) [可视化和做分析](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2063) [我们展示了如何在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2065) [os_signpost 中合并](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2068) [自定义 instrument 来创建](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2069) [更好的 signpost 数据展示](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2072) [所有的这些总结下来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2076) [就是我们可以给你](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2078) [你需要用来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2081) [提升 App 性能的信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2082) [所以我们很高兴看到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2086) [你使用 os_signpost 和](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2087) [Instruments 来一块提升](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2089) [你 App 的用户体验](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2091) [这就是今天的内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2094) [想要了解更多信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2097) [你可以来实验室找我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2098) [你可以来实验室找我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2098) [技术实验室 8 今天下午三点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2100) [同时明天我还有会议 410](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2103) [创建自定义 instrument](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2105) [我会讲讲](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2107) [自定义 instrument](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2108) [的工作原理并向你们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2110) [展示我们如何创建的 Trailblazer](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2111) [networking instrument 包](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2113) [非常感谢](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2115) [享受剩下的会议吧](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2116) [[ 掌声 ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/405/?time=2118)