# A Tour of UICollectionView

## Summary
UICollectionView is a flexible, powerful tool to help you achieve great user experiences in your applications. Hear how you can leverage these rich APIs to rapidly move from initial design ideas to polished shipping applications. Topics range from getting started to advanced update animations and layouts.

## Info
* Frameworks
* WWDC 2018 - Session 225 - iOS
* https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/

## Text
 [［ 音乐 ］](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=7) [［ 掌声 ］](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=22) [&gt;&gt; 下午好](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=30) [欢迎来到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=30) [UICollectionView 之旅](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=32) [我是 Steve Breen 我](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=34) [把这个放在这 我是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=35) [UIKit 团队的一名结构工程师](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=36) [今天舞台上除了我](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=39) [还有我的同事 Mohammed](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=41) [Jisrawi 他也是 UIKit 团队的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=42) [所以今天我们将做](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=48) [一些有点不同的事](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=49) [我们从我们的设计师 Breanka［ 音译 ］](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=51) [中获得了一些规格](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=52) [我们将用这些规格建立一个 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=54) [这将会应用到 UICollectionView](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=56) [的许多功能当中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=58) [现在 当我们完成建立](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=60) [我们的 App 需要的所有工作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=62) [我们将接触到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=63) [广泛的话题和 UICollectionView 有关 包括](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=65) [布局 更新和动画](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=68) [所以我们要涉及很多方面](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=72) [让我们直接进入正题吧](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=74) [好 所以这是我们从设计师那里得到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=77) [的第一个规格](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=79) [看起来像 FriendFeed](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=80) [想象一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=81) [一个很小的柱状布局](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=82) [看起来很简单](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=84) [好](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=88) [好 这看起来很棒](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=89) [所以我们看到了这个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=90) [看起来很棒的花式镶嵌布局](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=91) [这正是我们的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=93) [FriendFeed 的内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=94) [好的 Mohammed 既然你](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=96) [将要为我们写所有](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=97) [代码 快速教我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=98) [怎样使用这些功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=99) [你设计这些的想法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=101) [是什么](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=102) [&gt;&gt; 你知道的 我是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=103) [第一次看到这些 但是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=104) [它们看起来都是不错的 CollectionView](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=105) [候选人](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=107) [我认为用这个有](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=108) [很多乐趣](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=109) [&gt;&gt; 好的 这看起来很棒](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=110) [好](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=111) [所以在我们钻研代码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=112) [Mohammed 开始带领我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=115) [浏览之前 需要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=116) [涉及三个关于 CollectionView 我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=118) [涉及三个关于 CollectionView 我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=118) [要理解的三个概念](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=120) [然后再钻研代码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=121) [让我们开始吧 我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=122) [将要谈论布局](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=124) [数据源和委托](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=126) [好的 所以 首先让我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=130) [谈论一些关于布局的事情](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=131) [如果你第一次](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=133) [开始研究 UICollectionView 的定义](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=135) [而且你对](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=136) [UITableView 很熟悉](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=138) [你会立马注意到在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=140) [API 中有很多熟悉的地方](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=141) [你有一个委托和一个数据源](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=142) [所有这些看起来都很](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=145) [熟悉 但是这个布局](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=146) [概念很独特](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=148) [而且不同于](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=150) [UICollectionView](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=152) [你可以把它看做 UICollectionView](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=153) [的超能力](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=154) [它允许 CollectionView](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=156) [从内容中抽象出](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=158) [与内容本身分离的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=159) [视觉安排](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=161) [布局是所有关于](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=164) [内容安排在哪里的事情](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=166) [现在 每个单独的项都是由](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=168) [UICollectionView 的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=172) [布局属性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=173) [指定 比如像](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=174) [界限 中心和帧这样的属性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=176) [你可以把它看做一套](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=179) [你可以把它看做一套](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=179) [你可以使用的特性 用来定义](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=180) [这些可以展示的项目](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=182) [你甚至可以自定义它们 通过](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=183) [打印你的 UICollectionView 布局](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=186) [属性中的子类](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=187) [把这些都包含在你的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=188) [设计当中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=190) [好 所以当用户](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=192) [滚动浏览屏幕上的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=194) [内容 布局被认为是不能改变的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=196) [现在如果你需要改变这个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=200) [比如你将要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=202) [改变一个布局的外观](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=203) [你要使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=204) [无效化机制](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=206) [Mohammed 将会带领我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=208) [快速浏览一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=209) [好的 现在 关于布局是一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=211) [单独的抽象的很棒的一件事是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=213) [我们可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=215) [从一个布局转换到另一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=217) [布局中 当你在不同布局中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=218) [移动 会有一个动画效果](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=220) [布局 A 不必](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=222) [知道任何关于](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=224) [布局 B 的事情](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=226) [它们只是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=227) [声明这个布局将变成什么样子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=228) [然后转换就发生了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=229) [好 所以 CollectionViewLayout 是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=231) [一个抽象类别 正因如此](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=234) [这意味着不能直接](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=236) [被使用 但是 CollectionViewLayout 的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=238) [被使用 但是 CollectionViewLayout 的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=238) [子类可以直接被使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=240) [幸运的是 我们会提供一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=244) [UICollectionViewFlowLayout](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=246) [如果你之前用过 CollectionView](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=248) [你可能对它很熟悉](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=250) [现在 CollectionViewLayout 上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=251) [有很多定制点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=253) [包括一些我们一会儿要讲的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=255) [特性 但是你](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=257) [也可以使用委托进行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=259) [自定义 我们马上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=261) [会谈论到 CollectionViewDelegate](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=263) [但是 CollectionViewFlowLayout 将会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=264) [指定一些额外的东西](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=268) [扩展到 CollectionViewDelegate](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=270) [好的 所以 Flow 是关于什么的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=274) [它是一个基于线的布局](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=275) [系统 正因如此](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=277) [它可以包括多种](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=279) [你可能享受到的不同设计](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=281) [让我们浏览一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=288) [解释什么是基于线的系统](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=289) [的最好方法是像这样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=291) [给出一个例子 让我们开始吧](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=294) [好的 所以在这我们可以看到 我们得到了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=296) [一个垂直的滚动集合](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=297) [视图 我们将模拟](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=299) [视图 我们将模拟](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=299) [Flow 布局是什么样的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=301) [当它展示出这个内容时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=302) [好的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=304) [这是我们的第一个项目 我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=305) [在顶部的前沿开始](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=307) [我们开始沿着一条线](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=310) [布局我们的项目](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=312) [现在看这条线](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=314) [这条线和滚动轴垂直](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=315) [我们垂直滚动 所以这个线是水平的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=318) [好了 现在注意到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=321) [在这条线的空白处](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=322) [填满了项目 我们将](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=324) [下降到另一条线](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=325) [继续布局我们的内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=328) [最终 我们落到了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=330) [最后一条线 我们得到了所有的内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=332) [现在如果我进行一些指示

00:05:38.596 --> 00:05:39.976 A:middle
来突出显示](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=336) [这些水平线的地方](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=339) [让我们谈谈一些已有的定义](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=342) [作为自定义 Flow 的方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=345) [首先是行间距的概念](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=347) [正如你在这看到的箭头](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=350) [行间距将要成为](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=352) [这些水平线之间的间距](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=353) [相似的是 项目之间的间距](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=356) [相似的是 项目之间的间距](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=356) [指的是这些沿着这个布局线 项目之间的间距](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=360) [在 Flow 布局中我们有两个属性 让你指定](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=363) [他们之间的最小值](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=366) [好的 所以让我们巩固一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=368) [我们的直觉 然后旋转整个画面](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=371) [让我们开始于](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=373) [顶部的前沿](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=375) [现在 这个是水平滚动 好了 所以我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=377) [将要画一个垂直的布局线](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=380) [当我们到达这个区域的底部](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=384) [我们就填满了这条线 回到顶部](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=385) [好的 这个图案现在非常熟悉了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=388) [继续](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=391) [这是我们的所有内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=392) [现在我们有了垂直布局线](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=394) [所以按照这个方向 我们的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=396) [行间距是这样的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=399) [我们的项目之间的间距是这样的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=401) [当你在使用 Flow 布局时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=405) [记住这个很关键](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=406) [好的 所以这就是布局](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=408) [让我们谈论一点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=410) [数据来源 如果你使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=412) [TableView 这个应该看起来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=414) [很熟悉](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=416) [这是一个很简单的图案](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=417) [他们分享相似的 API](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=419) [他们分享相似的 API](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=419) [好 所以如果布局是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=420) [关于内容摆放在哪里的所有事情](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=423) [数据源就是内容是什么](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=426) [内容本身是什么](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=427) [有三种核心办法以供思考](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=429) [第一个是可选的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=431) [在 CollectionView 中的许多部分](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=432) [如果你不提供这个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=433) [我们就会认为你有一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=436) [相似的是 我们在这一部分](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=439) [有很多项目 这将会告诉你](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=441) [每个单独部分的项目数量](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=444) [因为它们可以有所有不同的项目](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=445) [最后一个 出售](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=447) [项目索引路径就是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=449) [你为你的客户提供](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=450) [你将要展示的真实内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=451) [好的 这就是数据源](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=453) [好的 在我们和 Mohammed 钻研](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=456) [代码之前 我们将要谈论的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=457) [三个话题中的最后一个是委托](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=459) [好的 所以使用委托是可选的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=462) [现在 CollectionView 是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=467) [UIScrollView 中的一个子类](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=468) [所以我们使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=470) [由 ScrollView 超类](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=472) [提供的相同委托 但是我们扩展它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=474) [所以如果你需要修改](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=477) [滚动行为 你可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=478) [滚动行为 你可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=478) [在相同的委托中来进行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=480) [也可以使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=481) [一些 UICollectionViewDelegate 中的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=483) [方法 提供一些细粒度控制](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=486) [当用户和你的内容交互时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=488) [控制高亮和选中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=491) [我们也会进入一个 API](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=493) [让你知道 有一些东西](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=495) [出现在屏幕上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=497) [WillDisplayItem 和](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=498) [DidEndDisplayingItem](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=499) [好的 所以在我们钻研代码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=501) [开始 UICollectionView 之前](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=504) [有三个重要概念](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=506) [我们需要谈论一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=508) [所以让我们切换到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=510) [Mohammed 的 Dev Box](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=512) [让他向我们展示下它是怎么工作的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=514) [Mohammed](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=515) [&gt;&gt; 好的 所以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=515) [两个列布局屏幕中的第一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=518) [就是使用 CollectionViewFlowLayout 的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=520) [一个绝佳案例](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=522) [我们可以完成](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=525) [我们需要的任何事情](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=526) [这也会是我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=527) [开始使用 UICollectionView 的一种很好方式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=530) [所以现在当我们可以用一个 Flow 布局](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=534) [完成整个设计目标时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=536) [我实际上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=538) [我实际上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=538) [是来到了 CollectionViewFlowLayout 的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=540) [子类因为](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=541) [我们将要再做一些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=542) [额外的定制化服务](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=543) [所以我将要开始](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=544) [创立一个我的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=547) [ColumnFlowLayout 分类的实例](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=550) [我准备好了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=552) [我将要使用这个实例](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=553) [来建立我的 CollectionView](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=555) [我将要移动这个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=557) [CollectionView 并且](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=558) [设置一些视图属性 比如](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=559) [自动调整掩码 背景](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=561) [颜色 因为它是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=563) [ScrollView 我也可以设置](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=565) [一些 ScrollView 的属性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=566) [这一切只是为了让它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=568) [看起来和感受起来就像我想为](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=569) [大家在我们的 App 上所呈现的那样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=571) [在把 CollectionView 添加到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=573) [我的视图层以后 我将要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=574) [注册我的 PersonCell 类](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=576) [在 CollectionView 上使用独特的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=578) [标识符 所以我们可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=580) [在 App 中设计单元格](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=582) [然后我将要建立](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=585) [这个 View Controller 作为这个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=586) [CollectionView 的数据来源 所以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=587) [我们可以提供给它一些信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=589) [关于将要展示多少单元格](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=591) [以及在它的单元格上将要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=592) [展示什么样的数据](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=594) [接下来我将要把它设置为](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=596) [委托 所以我们可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=599) [委托 所以我们可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=599) [处理单元格的选择](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=600) [所以既然我们已经建立起来这些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=602) [我们实际上需要遵循](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=604) [这两种协议](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=605) [所以让我们先遵循](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=607) [数据源 并且我们有](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=610) [两种要求我们执行的方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=612) [这些当中的第一个是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=614) [Section 中的项目数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=617) [回到我们人口布阵](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=620) [当中的人数或者项目数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=622) [来展示我们的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=623) [数据模型体](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=626) [第二个我们需要执行的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=628) [方法是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=630) [CellForItemAtIndexPath](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=632) [我们可以从 CollectionView 中脱离](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=634) [单元格队列使用我们独特的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=636) [标识符 穿过一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=637) [从我们的人口布阵脱离出去的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=641) [人和物体 来到单元格展示](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=642) [我们的数据 然后](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=644) [回到单元格](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=647) [事情到这圆满完成](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=650) [我们接下来只需从](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=652) [委托协议中挑选一种](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=654) [可供选择的方法 所以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=656) [我们可以处理选择](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=658) [所以我们将要添加](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=659) [所以我们将要添加](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=659) [DidSelectItemAtIndexPath](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=660) [在其中我们将用示例](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=664) [讲解 FeedView 控制器这](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=666) [将要成为我们的第二屏幕 如果](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=667) [我们没有一个实例](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=669) [接下来我们需要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=670) [穿过一个人 所以我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=672) [知道要展示谁的图像](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=674) [接下来我们要把它放到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=677) [我们的导航控制器当中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=679) [好的 所以让我们建立这个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=681) [然后转换到模拟器中来看看](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=684) [好的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=689) [［ 掌声和欢呼声 ］](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=690) [好的 所以可以看到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=694) [屏幕上有了我们的 CollectionView](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=695) [我们也有了一些单元格](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=697) [你可以看到它们 虽然它们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=699) [是扁平的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=701) [它们的大小并不合适 所以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=702) [我们将对它们做一些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=704) [我们认为我们需要做的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=705) [自定义](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=706) [所以让我们回到 Xcode 中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=707) [让我们在这打开我们的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=711) [子集列 我们之前放在一起的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=715) [ColumnFlowLayout Class](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=720) [让我们看看我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=723) [在这需要做什么](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=726) [所以我早已准备了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=727) [一种重写布局存根的方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=730) [现在不论什么时候布局无效](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=733) [就调用 UICollectionView LayoutsPrepare](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=735) [只要 CollectionView 的边界大小改变](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=742) [我们的布局就无效了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=744) [所以如果我们的 App 在手机上旋转](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=747) [或者我们的 App 在 iPad 上重新调整大小](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=749) [所以在这里进行自定义](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=753) [很棒 这种自定义把](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=755) [CollectionView 考虑到其中了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=759) [在我们的例子中 我们想要我们的单元格](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=761) [拥有像 CollectionView 一样的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=762) [很多功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=765) [我们也可以让](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=767) [CollectionView 知道我们想要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=768) [我们的项目变多大 通过](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=771) [指明项目的大小属性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=773) [所以我将要继续](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=774) [在这里做这个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=775) [所以我要把我的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=777) [CollectionView 的项目大小](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=778) [CollectionView 的项目大小](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=778) [设置为 CG 大小 宽度也设置成](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=781) [CollectionView 的边缘宽度](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=783) [插入布局边缘](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=784) [我们将要把它的高度](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=787) [设置成 70 点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=788) [以此来匹配我们的设计](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=790) [既然我们已经到这了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=794) [我将要在这做](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=794) [一些不同的事情](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=795) [使它们看起来美观](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=797) [我要在顶部](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=799) [填充一个 sectionInset](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=801) [来匹配我们的项目内](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=802) [间距 我将要把这个布局的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=804) [sectionInsertReference](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=806) [属性设置到安全区域](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=808) [所以一切都整齐地](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=810) [安置在 CollectionView 的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=812) [安全区域内](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=813) [好的 让我们再一次](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=815) [回到模拟器中 看看](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=817) [我们正确构建的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=819) [布局长什么样子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=820) [好的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=821) [这看起来很棒](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=823) [这看起来就像我们的规格](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=824) [我认为我们的设计者将会非常开心](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=827) [如果我们把它旋转成横屏](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=828) [我们可以看到我们的单元格大小很合适](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=832) [所以我们知道我们的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=833) [无效代码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=835) [随时准备再次被调用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=836) [现在一切都准备好了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=839) [现在一切都准备好了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=839) [你可能会想 我们并没有做到最好](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=841) [它看起来没有非常棒](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=844) [我们可能想要做一些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=848) [更有趣的事情 比如](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=849) [展示多列布局](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=850) [因为我们有了一些可获得的间距](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=852) [现在流式布局使这个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=855) [变得如此简单](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=856) [如果你记得之前 Steve 的解释](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=858) [流式布局是怎样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=859) [安排它的布局](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=861) [流式布局会在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=862) [移动到下一条线之前](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=864) [安装尽可能多的项目](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=866) [所以使用这个 我们可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=870) [搞清楚布局](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=873) [如果我们改变我们的项目大小](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=876) [我们就可以获得很多列](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=877) [所以如果我们回到 Xcode 中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=879) [回到我们这里的布局](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=881) [如果我们仅仅改变我们计算项目](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=884) [大小的方式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=886) [所以我将要移除](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=887) [这个 将要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=890) [用一些和数学相关的东西](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=892) [来替代它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=894) [所以我将要开始使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=896) [与我之前获得的相同的可用宽度](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=898) [与我之前获得的相同的可用宽度](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=898) [这是由边距插入的边界](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=900) [和一些对最小列宽的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=902) [任意定义](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=905) [是 300 点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=907) [然后取这些数值中的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=911) [两个数值 使用它们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=914) [来计算一个我认为可以安装](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=915) [在可用空间中的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=917) [最大列值](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=918) [我将使用这个数值来除以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=921) [可用宽度来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=923) [计算出一个最佳单元宽度](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=924) [这可能会超过 300 点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=926) [我将要把这个数值带到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=930) [我现在正在使用的作为我的项目](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=932) [大小的 CT 大小中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=933) [好的 所以现在让我们再次回到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=934) [我们的模拟器中 看看我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=937) [更新的布局是什么样子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=939) [好的 所以一切都一模一样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=942) [我们没有打破它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=943) [这是一个好的开始 如果我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=944) [想要横过来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=947) [我们就会有多列并排](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=950) [这正是我们想要的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=951) [你怎么想呢 Steve](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=953) [&gt;&gt; 看起来很棒](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=955) [我们得到了一个很棒的可改变的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=956) [柱形布局](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=957) [没有花太多力气](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=958) [&gt;&gt; 没有](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=960) [&gt;&gt; 接下来我们的设计是什么呢](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=960) [&gt;&gt; 好的 既然我们已经轻松](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=962) [进入我们的朋友列表中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=962) [现在该开始](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=964) [想想](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=965) [App 的花式镶嵌布局了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=967) [&gt;&gt; 好](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=968) [很棒](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=968) [&gt;&gt; 是的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=969) [&gt;&gt; 让我们回到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=969) [幻灯片 稍微](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=970) [聊一聊](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=973) [好的 让我们看一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=977) [这里的布局或者设计](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=979) [看看我们可以做什么](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=981) [所以我们的第一个意向](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=982) [我不知道你的 但是我的是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=983) [我能否用 Flow](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=985) [我懂了 准备好了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=986) [让我们开始使用它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=987) [所以让我们简单看一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=989) [这个设计 看看 Flow 对于](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=990) [我们来说是否有意义](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=992) [在这个特殊的区域有](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=994) [这三张照片 我将迅速放大](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=996) [好](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1000) [所以在现在这个例子中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1001) [我们左边有一张非常大的照片](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1003) [右边有一个垂直的堆叠](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1005) [所以在 Flow 领域](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1008) [因为它是基于线条的 我们将要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1009) [把左边那个大一点的项目](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1010) [移动到下一个项目](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1013) [所在的地方 然后再安排](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1014) [另一个项目 然后再跳到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1015) [下一条线中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1017) [但是我们没有完成](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1018) [我们还要处理这个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1019) [我们还要处理这个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1019) [垂直的堆栈](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1020) [所以这对于 Flow 来说](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1021) [行不通 因为事实证明](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1023) [它并不是一个真的基于线的布局](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1024) [但是这个练习的经历](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1029) [还是有用的 所以 你知道](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1030) [让我们先开始 Flow](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1032) [好的 所以在这个例子中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1035) [我们将要创建 我们自己的自定义布局](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1036) [我们有点害怕](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1039) [不用怕 这并不复杂](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1040) [我们已经有了四种基本方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1041) [来处理这个 我将要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1043) [提出另外一种](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1045) [让人自豪的方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1047) [好的 四种方法 让我们开始吧](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1049) [我想说的第一种方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1052) [关于 CollectionView 的内容大小](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1054) [现在 在我们提到 CollectionView 是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1057) [UIScrollView 的一个子集之前回忆](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1059) [一下 UIScrollView 的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1060) [一个特征就是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1062) [你有一个可视化区域和一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1064) [很大的内容区域 并且你有一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1065) [很棒的 iOS 体验](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1067) [可以在其内部移动你的内容 所以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1069) [CollectionView 需要知道怎样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1072) [告诉 ScrollView](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1073) [我的内容有多大](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1075) [好的 所以我们如何得到这个尺寸](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1077) [想象一下一个长方形](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1080) [包含这个布局将要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1081) [为你的 CollectionView 定义](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1083) [所有内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1084) [我们想要这样的大小](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1086) [好的 这就是 CollectionView](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1089) [的内容大小](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1091) [接下来我们有两种](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1093) [提供布局属性的方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1095) [第一种是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1099) [LayoutAttributesForElements（在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1100) [矩形中）](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1101) [现在这个被 CollectionView 定期调用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1103) [当用户第一次滚动浏览](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1104) [你的内容或者展示时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1105) [它需要知道在屏幕上展示 什么](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1106) [所以这个查询是由一个几何区域构成的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1111) [好的 这是 API](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1115) [LayoutAttributesForItem](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1118) [AtIndexPath 你可以想象](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1119) [它只是在寻找一个单独的项目](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1122) [给我这个属性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1123) [好的 当 Mohammed 带着我们浏览的时候](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1125) [我们会看到更多东西](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1127) [但是对于这两个 API 来说](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1128) [需要注意的是 性能最重要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1130) [好的 所以我们四个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1137) [核心自定义布局子集中的第四个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1139) [核心自定义布局子集中的第四个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1139) [就是 Prepare 方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1141) [现在 Mohammed 已经讲了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1144) [一些这方面的事情](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1145) [每当布局无效时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1146) [就调用这个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1148) [所以这是计算一切的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1149) [有利时机 比如](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1151) [你想要缓存的布局属性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1152) [和你的内容大小](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1153) [之后很快就会要求这些事情](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1156) [好的 所以我们值得骄傲的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1163) [API 让我们谈论一下它吧](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1165) [这是一个为边界变更设置的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1167) [ShouldInvalidateLayout](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1168) [所以每次 CollectionView 的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1170) [边界改变时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1173) [都会被调用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1174) [好的 再一次 它是 CollectionView](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1175) [是 UIScrollView 的一个子集](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1176) [所以边界发生变化 究竟是什么意思](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1178) [当一个 ScrollView 边界发生改变](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1181) [原点可以在滚动期间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1183) [发生改变](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1185) [当 App 大小改变](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1187) [或者 CollectionView 的大小改变时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1188) [其大小也会发生改变](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1190) [所以这将会在滚动过程中被调用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1191) [是的 就像表情符号](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1195) [这经常被调用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1196) [所以在这里做出正确的决定](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1198) [所以在这里做出正确的决定](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1198) [非常重要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1200) [好的 所以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1201) [UICollectionViewLayout 中的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1203) [默认执行将返回 false](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1204) [所以如果你需要让它做](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1207) [一些不同的事情 你的机会到了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1208) [作为示例的一种方式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1211) [如果原点改变](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1213) [UICollectionViewLayout 将返回 false](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1216) [好的 所以用户只是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1218) [在滚动浏览你的内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1219) [我们不会无效](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1220) [把它变成默认状态](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1221) [但是如果 iPad 旋转](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1223) [手机旋转 你的 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1225) [大小就发生了改变](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1226) [它即将返回 true](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1228) [现在有一点例外](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1230) [比如浮动的页眉和页脚](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1232) [对吧](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1233) [当你在滚动你的内容时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1234) [我们必须重新计算这些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1235) [要做一个自定义的无效](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1237) [来考虑这些事情](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1239) [好的 理论已经足够多了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1240) [让我们回到我们的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1242) [开发机器当中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1244) [让 Mohammed 带领我们了解一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1247) [在用代码建立这个奇特自定义](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1248) [UICollectionViewLayout 的时候](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1249) [看起来会是什么样子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1251) [&gt;&gt; 好的 让我们直接进入](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1253) [正题吧](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1255) [所以我已经把](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1256) [另一个我们将要为这个布局使用的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1258) [另一个我们将要为这个布局使用的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1258) [布局子集放到一起](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1260) [你可能会注意到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1261) [它是 UICollectionViewLayout 的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1263) [一个子集](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1264) [不是 CollectionViewLayout 的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1266) [一个子集](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1267) [这就是 Steve 之前向我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1269) [解释的原因](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1271) [UICollectionViewLayout 并没有](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1274) [真正满足我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1276) [自定义的镶嵌布局设计](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1277) [所以我在这做的第一件事](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1280) [是我要建立一些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1282) [实例变量](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1283) [我将用它们来保存](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1285) [一些稍后可以参考的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1286) [关键信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1288) [第一个是内容绑定的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1290) [CG 矩形 我将要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1292) [用它来保持](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1294) [我的 CollectionView 内](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1297) [所有项的代表性边界](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1299) [第二个是缓存](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1300) [属性数列 我将要使用这个来保存我的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1303) [布局属性 所以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1306) [当性能重要的时候 我可以快速查阅它们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1308) [所以我们将为这个布局](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1311) [再次开始执行我们的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1312) [Prepare 类函数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1314) [Prepare 是我们做大部分工作的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1316) [理想场所](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1319) [理想场所](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1319) [因为每次失效都会调用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1321) [Prepare](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1323) [我们可以在这建立我们自己的布局](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1324) [然后避免做任何](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1326) [繁重的布局工作或者任何繁重](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1328) [的经常被调用的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1330) [布局数学函数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1332) [所以我们要在这儿做很多事情](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1338) [首先 我们将重置我们的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1339) [缓存属性和我们的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1341) [内容界限只为了清除](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1343) [以前失效的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1344) [所有陈旧信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1346) [接下来 我们要为](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1349) [我们的 CollectionView 中的每一个项目](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1352) [做一些事情](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1353) [这些当中的第一个实际上是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1355) [准备这些属性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1356) [但是现在我不会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1358) [深入研究](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1359) [具体布局的内容 因为](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1361) [这对你而言](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1362) [会有所不同](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1363) [这是你将要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1364) [计算大小](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1366) [位置和转换的地方](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1367) [使你的单元格 符合你的设计需求](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1369) [但是在我们完成](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1373) [这些属性以后](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1374) [我们将要在这做很多关键的事情](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1375) [第一 我们将要缓存它们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1378) [我们将要把它们放在我们的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1379) [我们将要把它们放在我们的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1379) [缓存的属性数组以便我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1380) [不久后可以快速抓住它们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1381) [第二个是 我们将](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1384) [把他们的框架和我们的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1386) [内容界限矩形结合起来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1388) [以便于我们的内容界限保持更新](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1390) [所以既然我们的 Prepare 已经出现](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1393) [并且运行 我们需要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1395) [在我们需要使一切运转的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1396) [布局中执行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1398) [剩余的方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1400) [所以这些当中的第一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1402) [CollectionView 内容大小](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1405) [在这其中 如果我们在 Prepare 中正确地](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1407) [完成了我们的工作 我们可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1409) [返回我们的内容界限作为大小](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1410) [下一个是为边界改变设置的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1415) [shouldInvalidateLayout](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1417) [现在既然我们的布局中不](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1419) [包含任何当我们滚动时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1420) [失效的元素](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1423) [所以没有任何浮动的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1424) [标题 浮动页脚或者](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1427) [类似的东西](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1428) [我们只想在 CollectionView 的大小变化范围](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1430) [发生变化时无效](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1431) [所以如果我们的新的大小边界](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1434) [不等于](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1436) [我们的 CollectionView 的大小边界](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1438) [我们目前的大小边界 我们就会返回 true](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1439) [我们目前的大小边界 我们就会返回 true](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1439) [在那之后 我们将执行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1443) [LayoutAttributesForItem](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1445) [AtIndexPath 在这里 再一次](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1446) [因为在我们的 Prepare 函数中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1448) [我们已经准备了所有属性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1449) [我们只能把握](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1450) [从我们的数组中回应](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1452) [RequestAtIndexPath 的特别属性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1455) [最后 我们将执行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1458) [LayoutAttributesForElements

00:24:23.786 --> 00:24:24.166 A:middle
InRect](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1462) [现在这个方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1465) [被带有不同](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1466) [查询矩阵的 CollectionView](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1467) [定期调用 这个矩形可能会比](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1469) [我们的 CollectionView 更大](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1471) [我们的 CollectionView 只要求一些列](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1472) [匹配特定区域的属性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1476) [我们的工作是返回一个数组](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1478) [该数组包含所有属性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1481) [这些属性与所有](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1484) [将要在我们的 CollectionView 矩形中出现的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1486) [所有项目相对应](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1487) [所以我们可以简单地](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1490) [通过过滤属性框架上的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1492) [缓存属性数组](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1494) [来回答这个问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1497) [来回答这个问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1497) [所以如果我们的属性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1500) [有一个与我们的查询矩阵相交的框架](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1502) [我们可以返回它们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1504) [好的 所以让我们回到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1506) [Sim 看看我们的布局变成了什么样子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1508) [所以我将要挑选其中的一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1512) [Feed 在这](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1514) [我们有我们的布局](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1515) [我们的图像可以很好地加载到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1517) [这个花式镶嵌结构中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1519) [如果我们想要旋转成横屏](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1521) [你可以看到我们的单元格已经](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1523) [调整了大小 所以我们已正确更新](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1525) [所有内容 我们已经将其](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1526) [无效化 这真的很棒](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1528) [所以这看起来很像我们的规格](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1532) [但是滚动性能并不是很好 对吗](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1536) [&gt;&gt; 不是很好](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1539) [&gt;&gt; 很差](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1539) [所以你可能早已有了一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1541) [关于接下来怎么进行的主意](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1543) [让我们回到代码中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1544) [看看接下来会发生什么](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1545) [所以如果我们在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1549) [这的矩形中看看我们的布局属性或](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1550) [元素 要记得这种](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1551) [方法在滚动时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1554) [经常被调用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1555) [所以这里的这个函数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1558) [所以这里的这个函数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1558) [正在过滤我们的整个数组](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1561) [你可能会想](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1563) [当我们的 CollectionView 的项目数增加](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1565) [会变得非常高耗](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1566) [所以在我们的 App 中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1568) [我们的照片越多](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1569) [我们的滚动进程将会越慢](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1571) [所以如果你发现你自己遇到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1574) [这种情况 它帮助你](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1575) [后退 想想你](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1577) [布局的属性 想想](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1578) [你是否可以找到任何](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1580) [优化机会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1581) [所以我们的布局要求](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1584) [每个单元 App 紧邻或者](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1588) [低于它的前一个单元格](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1591) [所以这意味着我们的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1593) [属性已经按照](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1594) [它们框架的最小 y 值](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1597) [在缓存的属性数组中排序了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1599) [所以我们有一个排序数组 所以我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1603) [可以通过做一些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1605) [二进制的搜索来加速搜索](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1608) [而不是像现在我们正在做的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1609) [线型过滤器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1611) [所以让我们删除我们的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1613) [慢执行 让我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1617) [慢执行 让我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1617) [用一些本应该更快的东西来替代它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1620) [所以我会逐步介绍](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1623) [不必担心](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1626) [所以我们在这要做的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1628) [第一件事是我们调用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1630) [我们已经准备好的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1633) [二进制搜索函数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1635) [它在我们的数组和](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1636) [我们的查询矩阵中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1637) [引入了一些列索引](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1640) [如果它发现了一组](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1642) [在我们的矩阵中包含一个框架的属性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1645) [它将作为我们数组中的索引](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1647) [返回属性 然后从该索引开始](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1650) [我们可以简单地通过在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1654) [我们的数组中上下循环](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1656) [并拾取属性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1659) [来构建其余部分](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1661) [的属性集 直到我们退出查询矩阵](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1663) [直到我们找到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1666) [在我们的矩阵之外的属性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1667) [这应该快得多了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1669) [在你的数组中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1671) [有成千上万的项目](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1673) [你不可能通过成千上万个项目](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1673) [循环成千上万次](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1676) [好的 让我们再次回到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1678) [好的 让我们再次回到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1678) [Sim 中 让我们看看](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1680) [更快的滚动算法是什么样子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1682) [让我们把这个弹出来的打开 然后轻点一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1687) [更快了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1690) [你怎么看 Steve](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1691) [&gt;&gt; 好多了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1693) [好的 很棒](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1694) [所以我们现在已经有了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1694) [两种布局](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1696) [接下来是什么呢](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1697) [&gt;&gt; 所以我们有了两个屏幕](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1698) [这位我们这里的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1700) [朋友列表留下了我们的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1702) [更新动画](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1704) [&gt;&gt; 很棒](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1704) [好的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1705) [好的 让我们回到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1705) [幻灯片中 让我们浏览一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1707) [我想我们的设计师会称它为](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1708) [非常酷的更新动画](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1710) [好的 这里有一个视频](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1713) [让我们浏览一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1715) [看看这个非常酷炫的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1716) [更新动画是什么样子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1718) [好的 所以我们这里有一些元素](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1719) [我们看到最后一个项目更新了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1721) [我猜有人发了一张](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1724) [照片 我们有在这得到了另一个项目](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1726) [它看起来 是第三个项目涂片](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1728) [不会在这里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1731) [好的 所以我们在这里有](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1732) [三个基本操作正在进行 对吧](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1735) [我们重新下载 移动 删除](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1736) [我们为什么不回到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1740) [开发机器 Mohammed](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1741) [你何不给我们展示一下 这个是怎么操作的呢](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1743) [&gt;&gt; 当然](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1746) [好的 所以我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1748) [同时做了很多动画的更新](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1751) [所以你可能会认识到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1754) [UICollectionView 和 UITableView 提供给](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1755) [我们 一个多么伟大的工具](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1757) [正是执行批量更新 API](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1759) [它基本上可以允许我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1761) [通过集合视图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1764) [可以在动画执行的同时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1766) [执行一组更新](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1768) [所以我要给](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1770) [CollectionView PerformBatchUpdates](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1773) [添加一个调用 并且注意](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1774) [我在关闭这里做了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1776) [我的数据源更新和](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1777) [我的 CollectionView 的更新](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1778) [这实际上是一种最佳方式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1781) [协调我的更新](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1783) [并保持事物的整齐同步](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1785) [避免事物不一致](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1787) [所以 首先 我在我的数据源上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1790) [更新了我的最后一个项目](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1793) [我把第二个项目移动到最后](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1797) [一个项目中 选中最后一个项目](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1799) [一个项目中 选中最后一个项目](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1799) [移动到最顶端](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1801) [然后我要求 CollectionView](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1802) [执行我想要的动画](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1804) [好的 让我们再次回到 Sim](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1806) [看看我们的更新是什么样子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1808) [所以我们已经通过](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1810) [右上角的更新按钮](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1813) [连接了我们的更新代码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1814) [&gt;&gt; 怎么样了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1818) [&gt;&gt; 有点尴尬](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1820) [这发生了什么](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1823) [&gt;&gt; 你知道的 我写](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1825) [iOS 很长时间了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1826) [我之前见过这个影片](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1827) [&gt;&gt; 是的 在舞台上发生这种事情](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1829) [很糟糕](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1831) [你知道的 我们的时间马上要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1834) [用完了 我们为什么不](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1836) [调用重新下载数据 我们可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1837) [回去 然后为 V2 做动画](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1839) [&gt;&gt; 真的吗](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1841) [［ 掌声 ］](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1843) [你知道的 我们可以的 但是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1848) [接下来我们将会丢失这个非常酷炫的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1850) [更新动画 我们的用户](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1851) [期待这些生动的界面](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1853) [对吗](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1856) [&gt;&gt; 是的 你说的对](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1856) [你知道吗](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1857) [他们值得更好的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1858) [&gt;&gt; 我喜欢你思考问题的方式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1859) [&gt;&gt; 我喜欢你思考问题的方式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1859) [好的 让我们快速](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1860) [回到幻灯片中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1861) [让我们看看我们是否保存了我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1863) [非常酷炫的动画更新](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1864) [你之前已经看过了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1867) [好的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1868) [所以首先让我们仔细研究一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1869) [这个调试异常 然后看看](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1871) [它试图想告诉我们什么](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1872) [好的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1874) [所以这里说的是 我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1875) [正试图从 0-3 的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1876) [相同索引路径执行删除和](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1878) [移动操作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1880) [所以如果我记的对的话 这刚刚是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1881) [第四个项目](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1882) [我们重新下载 然后移动它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1883) [我们刚刚没有删除它 我们删除了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1885) [第三个项目 0-2 对](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1887) [&gt;&gt; 所以 这是怎么回事](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1891) [好的 在我们开始这个之前](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1893) [让我们回去](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1894) [匆匆看一眼 PerformBatchUpdates](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1896) [API 讨论一些高级原则](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1898) [好的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1901) [所以正如 Mohammed 之前提到的那样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1901) [当他介绍这个 API 的时候](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1903) [这个 API 的目的便是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1905) [我们可以同时处理多种更新](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1907) [让一切充满生气](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1908) [获得这样一种](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1910) [很棒的体验](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1911) [也正如他所提到的那样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1914) [在 CollectionView](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1915) [更新关闭中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1917) [执行数据源更新和](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1919) [执行数据源更新和](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1919) [你的 CollectionView 更新非常重要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1920) [现在 我所说的关于](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1923) [CollectionView 的这些也同样适用于](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1924) [TableView](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1925) [所以如果你想要在你的 App 上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1926) [安装 TableViews 所有的这些信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1927) [都是一致的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1929) [好的 让我们多观察一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1931) [CollectionView 更新时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1934) [你插入 移动和删除](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1936) [这些顺序](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1936) [在你的更新关闭中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1939) [并不重要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1940) [把它们放在任何你想要放的地方](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1941) [然而 当你改变结构时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1943) [现在你的数据源会更新](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1945) [提供你的数据源或者](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1946) [支持数据源的数据源很重要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1947) [好的 最好用一个例子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1952) [来展示 所以我将](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1954) [列举一个例子 这个例子包含两个数组](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1956) [每个数组有三个元素](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1958) [我们将强化我们这方面的直觉](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1959) [展示一个删除和一个插入](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1961) [但是首先我们将](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1964) [先执行一次删除](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1965) [然后再执行第二个删除](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1966) [我们将颠倒顺序](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1968) [只是为了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1969) [增强我们的直觉](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1971) [我一直这样做](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1972) [画画 对](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1973) [好的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1973) [所以我们删除第一个项目](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1974) [然后我们现在要在索引一插入](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1977) [然后我们现在要在索引一插入](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1977) [好的 在第二个例子中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1981) [我们颠倒顺序](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1982) [先插入然后再进行删除](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1983) [所以我们的直觉依然存在 确实](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1986) [我们得到了一个完全不同的结果](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1988) [这可能并不是一件好事](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1989) [好的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1990) [让我们把这个和](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1992) [CollectionView 的更新做一下对比](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1994) [现在这里有两组](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1996) [批量更新提交的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1997) [CollectionView 更新](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=1998) [我已经删除了数据源更新](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2001) [只是为了保持幻灯片的整洁](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2002) [但是我在第一个上面做了插入和](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2004) [删除 在第二个上面先删除再插入](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2005) [顺序是不同的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2008) [但这会给你完全](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2010) [相同的结果](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2011) [我们都是工程师](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2013) [我们想知道为什么](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2014) [为什么是这样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2015) [好的 让我们谈谈吧](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2016) [这是怎么发生的呢](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2018) [为什么排序对于](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2019) [发送到 CollectionView 的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2020) [更新并不重要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2022) [当然这是针对你的数据源而言的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2023) [好的 让我们通过操作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2024) [来完成这些操作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2026) [所以第一个是要删除](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2027) [这是按降序索引路径顺序](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2030) [进行的过程](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2032) [现在让我们谈谈索引路径](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2033) [所以首先](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2035) [在批量更新开始之前](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2037) [你在考虑](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2038) [在 PerformBatchUpdate 中发生了什么](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2039) [在 PerformBatchUpdate 中发生了什么](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2039) [你的数据源处于之前状态](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2041) [现在一旦所有事情](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2044) [在批量更新中完成](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2045) [你将处于一个后续状态](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2047) [好的 所以对于删除而言](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2048) [索引路径总是指向前级](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2050) [所以这就是删除](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2053) [所以插入是按](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2055) [升序索引路径顺序进行处理的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2058) [因此 插入中的索引](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2060) [路径总是指向](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2063) [最终状态或者](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2065) [后更新阶段](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2067) [所以 移动是这两者的结合](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2069) [对吧](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2070) [你有一个来和一个去的索引](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2071) [路径 来是处于](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2073) [之前状态 好的 去是处于后续状态](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2075) [重新加载 现在如果你愿意](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2079) [重新加载算一个超级命令](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2082) [它实际上可以分解成为](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2084) [一个删除和一个插入](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2086) [重新加载中指定的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2088) [索引路径是关于前状态的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2091) [好的 所以既然我们已经](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2096) [了解了重新加载是干什么的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2097) [这种洞察力可以告诉我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2099) [这种洞察力可以告诉我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2099) [在我们的 App 中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2100) [发生了什么错误](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2102) [因为最后个项目](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2105) [重新加载中的删除和](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2106) [项目的移动概念相冲突](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2107) [好的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2110) [所以当我们回到代码中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2110) [我们可以一分钟内解决这个问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2112) [好的 我不打算检查](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2114) [这些 但是你可以稍后解释](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2115) [只是把它放在这里作参考](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2117) [这些都会导致 CollectionView 崩溃](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2118) [不要这样做](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2122) [我们如何获取所有这些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2123) [知识并简化它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2127) [以这样一种方式来使用它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2129) [我们总是可以从给定的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2130) [CollectionView 或 TableView](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2132) [中应用我们的数据源更新](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2134) [并确保所有的东西都同步](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2135) [好的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2137) [所以这是四项基本的原则](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2137) [所以首先你想要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2139) [分解这些动作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2140) [删除然后插入](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2141) [简单 将所有删除和插入](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2142) [组合到两个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2144) [单独的列表中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2145) [首先在索引路径上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2148) [按降序顺序进行删除](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2150) [最后按升序索引路径](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2152) [应用这些插入](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2154) [做到这一点 就很好往下进行了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2155) [重新加载数据怎么样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2159) [重新加载数据怎么样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2159) [我知道 Mohammed 说我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2160) [可以做到这一点 我们完成了 每个人都笑了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2162) [我很确定我大喊了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2164) [情况就是这样 但是关于](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2165) [重新加载数据的事实却是你没有](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2167) [获得这些很棒的动画](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2168) [这真的是一个强有力的做法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2169) [所以 我们真的想让我们的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2172) [App 变得活泼生动](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2173) [使我们的客户 获得很棒的感受](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2175) [所以 这是在特殊情况下使用的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2176) [好吧 Mohammed 让我们快速](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2180) [切换回来 看看我们能否](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2181) [在代码中解决这个问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2183) [并保存完全酷炫的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2184) [更新动画](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2186) [&gt;&gt; 好的 是时候赎罪了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2187) [&gt;&gt; 是的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2189) [&gt;&gt; 所以让我们使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2189) [刚刚 Steve 分享给我们的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2192) [指导原则来修复我们的更新动画](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2193) [所以让我们删除这里的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2195) [所有执行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2196) [如果你还记得 我们的更新](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2197) [包括重新加载 删除 和移动](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2200) [我们的重新加载和移动](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2204) [处于相同的索引路径](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2206) [它们在同样的地方开始](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2209) [这就是我们的冲突所在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2210) [所以我们需要先分开这两个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2212) [因此让我们重新载入](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2215) [自己的调用来执行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2217) [批量更新 然后在这](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2219) [批量更新 然后在这](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2219) [我只是在更新我的数据源 再一次](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2224) [和之前一样 在 CollectionView 上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2226) [调用重新加载的项目](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2229) [我只是在没有动画关闭](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2230) [的 UI 视图中执行它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2232) [如果你仔细查看](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2234) [我们的规范](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2236) [它实际上是非动画的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2238) [初始重新加载](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2239) [好的 所以接下来 我们必须](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2242) [处理剩余的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2244) [更新 删除和移动](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2245) [让我们来解释一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2249) [我们在索引二处删除](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2252) [然后把项目从索引三](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2255) [移动到索引零处](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2258) [因此如果我们使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2261) [我们刚刚学到的指导原则来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2263) [分解我们的动作 这就变成了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2264) [索引二进行删除](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2267) [索引三进行删除](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2270) [把项目插入到索引三至索引零](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2273) [所以现在我们有两套操作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2277) [所以现在我们有两套操作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2277) [我们有删除和插入](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2280) [我们可以相应地处理它们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2283) [首先 我们按照降序顺序](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2285) [执行删除操作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2287) [因此我们首先要在索引三处](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2288) [进行删除 然后](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2291) [抓住来自那里的人 以便](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2293) [以后我们可以插入它们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2295) [接下来我们将要删除 在索引二处的项目](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2297) [接下来我们需要按照升序的顺序来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2303) [处理我们的插入](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2304) [我们只有一个 所以我们就](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2306) [继续 插入它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2307) [最后 我们会要求](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2310) [CollectionView 执行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2311) [我们想要的动画](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2314) [现在 注意 我仍在调用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2315) [此处的移动](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2318) [我没有把它分解成](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2319) [它的组件动作 因为](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2320) [我们仍然想要 Collection View](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2322) [播放正确的动画](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2324) [如果我们用我们的数据源](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2325) [做出了正确的事情](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2326) [那么 CollectionView 会根据动画做出](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2327) [正确的思考](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2329) [好的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2331) [让我们回到模拟器中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2331) [看看当它工作时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2333) [我们的更新是什么样子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2336) [好的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2338) [这里什么也没有](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2340) [&gt;&gt; 哇](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2341) [&gt;&gt; 很棒](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2342) [［ 掌声 ］](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2343) [我将要重新加载](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2348) [绕场慢跑一圈庆祝胜利](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2349) [让我们继续吧](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2351) [这看起来和我们的规格完全一样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2353) [不是吗](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2355) [&gt;&gt; 很棒 了不起](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2356) [好的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2357) [让我们圆满完成它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2358) [我们涵盖了大量内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2359) [你能回到幻灯片中吗](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2361) [我想发布一个调用来执行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2363) [所以如果你对构建自定义布局](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2365) [感到紧张或焦虑](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2369) [请采用我们今天刚刚](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2370) [应用的内容 然后返回](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2372) [研究并建立那些自定义](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2373) [布局 建立行之有效的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2375) [CollectionView 解决方案](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2376) [如果在你的 App 中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2378) [重新加载的数据导出都是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2379) [你正在失去](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2381) [这些灰色的动画](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2382) [它们会检查这些事情](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2384) [看看为什么你不理解这些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2385) [或者不明白](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2386) [为什么会发生这些事情](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2387) [并修复这些地方](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2388) [好的 所以想获取更多消息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2392) [你可以看到幻灯片这儿](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2394) [有链接](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2395) [并且明天上午 9 点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2396) [我们也有一个 CollectionView 的实验](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2397) [如果你有任何](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2399) [如果你有任何](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2399) [关于你的 CollectionViews 的问题或评论](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2400) [请顺便来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2401) [找我们聊一聊](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2402) [Mohammed 和我都会在这](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2403) [谢谢大家来参加](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2405) [我希望你们能享受](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2407) [接下来的会议](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2408) [［ 掌声 ］](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/225/?time=2409)