# Behind the Scenes of the Xcode Build Process

## Summary
Ever wonder what happens when you build your project in Xcode? Learn how Xcode automates the steps required to build an application, and go behind the scenes to learn how clang, swiftc, and the linker work together to turn your source code into a working program.

## Info
* Developer Tools
* WWDC 2018 - Session 415 - iOS, macOS, tvOS, watchOS
* https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/

## Text
 [（Xcode构建过程的后台工作
演讲415）](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=17) [大家下午好](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=36) [欢迎来到
Xcode构建过程的后台工作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=38) [我是Jake Petroules](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=41) [我是Xcode构建系统团队的
工程师](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=43) [今天我们要讨论](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=45) [Xcode构建过程](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=47) [首先我要讲讲
Xcode 10的新构建系统](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=51) [用Swift的scratch编写](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=54) [提供更好的性能和可靠度](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=55) [我们要解答如下问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=58) [我们要解答如下问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=58) [按住Command + B
会发生什么](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=60) [如何架构构建过程](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=62) [Xcode如何用
project文件的信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=64) [决定构建过程的模型和流程](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=66) [然后是编译器领域](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=71) [看看Clang和Swift](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=74) [怎样将源代码加入目标文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=76) [我们会展示
头文件和模块的运行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=79) [编译器如何在代码中查找声明](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=81) [以及Swift编译模型如何不同于](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=84) [C、C++
和Objective-C](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=86) [最后是连接器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=90) [构建过程的最后一步](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=92) [我们会解释什么是符号
及其与源代码的关系](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=96) [还有连接器如何将
编译器产生的目标文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=99) [整合成最终的可执行文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=102) [提供给app或框架](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=104) [我们会使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=108) [叫PetWall的小app样本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=109) [作为这次演讲的示例](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=111) [它只是一个很小的iOS app
用来展示宠物图片](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=113) [首先来了解
什么是构建过程](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=119) [首先来了解
什么是构建过程](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=119) [以及如何用Xcode
创建类似PetWall的app](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=122) [这里你看到app对象、框架](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=126) [不同的代码文件 都是Swift
和Objective-C](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=128) [看起来可能很像你自己的项目](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=131) [在构建app的时候](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=135) [要经过很多步骤 从源代码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=139) [和项目资源开始](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=142) [到提供给客户的打包文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=144) [或上传到App Store发布](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=145) [你要编译和连接源代码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=149) [复制和处理资源 比如头文件
资源目录和Storyboard](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=151) [最后是代码签名以及自定义](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=157) [shell脚本或make文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=159) [比如给框架构建API文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=161) [运行代码检查和验证工具等](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=164) [大多数任务](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=168) [在构建过程中
由命令行工具运行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=169) [比如Clang、LD、AC工具
IB工具、代码符号等](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=172) [这些工具的执行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=177) [需要一组特定的实参](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=179) [需要一组特定的实参](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=179) [以特定的顺序](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=181) [基于Xcode项目的配置](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=182) [构建系统的用处](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=186) [就是将任务的执行部署自动化](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=188) [在每次构建的时候](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=191) [由于任务数量成千上万](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=193) [构建过程更是数不胜数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=196) [依赖关系十分复杂](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=198) [你肯定不想手动输入](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=200) [1天敲100遍命令](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=202) [那就让构建系统来做](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=205) [我说过
构建系统里的任务](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=209) [按照特定的顺序进行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=212) [因此我们谈谈这个顺序
怎么决定及其重要性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=214) [构建任务的执行顺序](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=218) [取决于信息的依赖关系](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=220) [就是任务](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=223) [任务需要的输入](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=224) [和任务生成的输出](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=226) [以编译任务为例](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=229) [它需要输入源代码文件
比如PetController.m](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=231) [然后输出目标文件
比如PetController.o](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=235) [同样 连接器任务](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=240) [需要几个目标文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=242) [由编译器在上个任务中生成](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=243) [再生成可执行或lib文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=246) [比如PetWall运行文件
会存到.app资源文件包](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=249) [希望大家已经看出些许端倪](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=252) [你能看到信息的依赖关系
是顺着这个图形的走向](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=255) [最终形成执行顺序](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=259) [现在大家关注下
图形中的编译任务](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=262) [很像川流不息的马路](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=265) [你看得到编译任务](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=268) [在各自的路上互不干涉
可以平行运行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=270) [因为连接器任务
需要所有其他的输入](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=275) [它要在最后一位](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=278) [构建系统通过依赖关系](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=281) [决定任务执行的顺序](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=284) [以及平行运行的任务](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=286) [我们叫做依赖顺序](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=289) [知道了构建过程的定义后](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=291) [我们具体讲讲怎么操作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=293) [点击“构建”会发生什么？](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=297) [构建系统的第一步是获取构建描述](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=300) [Xcode项目文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=303) [解析项目中的所有文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=305) [目标app和依赖关系](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=308) [构建设置](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=311) [转换成一个树形结构叫做定向图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=312) [它显示了所有依赖关系](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=316) [项目中的输入和输出文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=318) [以及处理它们的执行任务](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=320) [然后低级执行引擎会处理这张图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=326) [研究依赖关系 决定执行哪个任务](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=329) [执行顺序是什么](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=334) [以及哪些可以平行运行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=336) [然后继续执行任务](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=339) [我说的低级执行引擎](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=342) [是新构建系统的
叫做llbuild](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=344) [它是开源资源 用GitHub开发](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=346) [如果对构建系统开发感兴趣](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=348) [请随意研究 看看它如何工作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=350) [它的链接和另一个关于构建系统的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=352) [开源模块 会在演讲最后提到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=354) [现在讲讲已知的依赖关系](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=358) [现在讲讲已知的依赖关系](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=358) [由于你无法获取过多的依赖关系信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=361) [构建系统可能会找到更多](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=364) [在任务的执行过程中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=367) [比如Clang编译
Objective-C文件时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=369) [如你所料 会生成目标文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=372) [但是它也会生成另一个文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=375) [其中包含一个列表](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=378) [列出源文件中的头文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=379) [那么下次构建时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=382) [构建系统会使用这个文件中的信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=384) [以保证再次编译源文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=387) [如果你更改了其中任何头文件的话](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=389) [这里的关系路径是
PetController.h](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=392) [PetController.d
.n直到.o文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=395) [我们已经讲了很多](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=400) [构建系统的主要工作就是执行任务](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=403) [当然项目越大 构建时间越长](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=407) [你肯定不想把所有任务都运行一遍](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=412) [在每次构建的时候](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=414) [构建系统实际上可以只执行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=416) [定向图上的任务子集](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=418) [定向图上的任务子集](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=418) [基于你对项目做出的更改](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=422) [对比上次构建过程](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=425) [我们称之为累加构建](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=427) [准确的依赖关系十分重要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=429) [这样累加构建才能正确高效地工作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=432) [下面看看哪些更改
会影响构建系统](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=437) [以及与累加构建的关系](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=440) [构建系统如何检测更改呢？](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=442) [构建过程中的每个任务
都有相应的签名](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=446) [类似于Hash
通过计算](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=449) [多个任务相关信息而得出](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=450) [这些信息包括
任务输入的统计信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=454) [比如文件路径
和更改时间标签](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=457) [运行命令的命令行指示](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=460) [以及其他有关任务的元数据](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=463) [比如编译器版本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=465) [构建系统会追踪任务签名](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=469) [包括当前和之前的构建](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=472) [所以它知道每次构建时
是否要重新运行任务](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=474) [如果某个任务的签名](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=479) [如果某个任务的签名](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=479) [与上次构建时不同](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=480) [它就会重新运行这个任务](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=483) [如果相同就会跳过](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=486) [这就是累加构建的概念](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=488) [我们大概了解了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=492) [构建过程的定义和流程](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=494) [如何利用构建系统呢？](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=497) [先回顾下基本知识](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=501) [构建系统按照一定顺序
执行一系列任务](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=503) [但要记得
构建过程以定向图表示](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=507) [我们不要担心
任务执行的顺序](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=511) [这是构建系统的工作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=515) [作为开发者](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=517) [我们要考虑的是
任务之间的依赖关系](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=519) [让构建系统决定
最佳的执行方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=522) [根据定向图结构](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=524) [这样构建系统
可以正确地给任务排序](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=526) [可能的时候并排运行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=529) [以完全利用多核硬件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=530) [依赖关系源自哪里呢？](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=534) [对某些任务](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=537) [依赖关系](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=538) [依赖关系](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=538) [来自构建系统自带的数据](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=540) [构建系统自带一些规则
比如编译器、连接器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=541) [资源目录
Storyboard处理器等等](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=545) [这些规则定义了
哪些是输入文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=548) [和哪些是输出文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=551) [还有目标依赖关系](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=555) [大致决定了
目标构建的顺序](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=557) [有些时候](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=560) [构建系统可以编译
不同目标和平行文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=561) [之前的Xcode
要构建一个app](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=564) [就要完成整个app的构建](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=567) [然后才能使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=569) [Xcode X的新构建系统
就要快得多](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=572) [编译源阶段会提前开始](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=575) [免费提供并行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=578) [但是如果含有
任何运行脚本阶段](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=581) [这些阶段完成后](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=584) [并行才能开始](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=585) [有关依赖的还有隐性依赖关系](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=589) [比如在链接库里
列出一个目标](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=593) [用二进制构建阶段](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=595) [隐性依赖关系
由scheme编辑器生成](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=597) [隐性依赖关系
由scheme编辑器生成](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=597) [默认为开启](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=600) [构建系统会为这个目标
建立隐性依赖关系](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=601) [即便它不在目标依赖关系之列](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=604) [接下来是构建阶段依赖](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=608) [在目标编辑器里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=610) [你会看到几个构建阶段](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=611) [复制头文件、编译源
复制资源包等等](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=614) [这些任务与每个阶段相关](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=619) [通常按组运行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=621) [根据阶段的排列顺序](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=622) [构建系统也会忽略它
如果有更好的方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=625) [比如第三方静态库阶段](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=627) [在编译源之前](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=630) [注意有的时候
构建阶段顺序不对](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=633) [会导致问题或构建失败](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=635) [因此为了解依赖关系](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=637) [验证构建阶段的顺序](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=638) [还有scheme顺序依赖](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=642) [如果开启了
并行构建检查](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=645) [在方案设置里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=647) [构建性能会更好](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=648) [不用担心目标顺序](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=650) [但如果关闭
并行构建](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=652) [Xcode构建目标时
会按照你排列的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=655) [构建行动顺序
逐个构建](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=659) [构建行动顺序
逐个构建](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=659) [目标依赖关系
优先级较高](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=661) [优先决定
第一个构建目标](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=664) [但Xcode会遵从这个排列](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=665) [这个让人跃跃欲试
因为它给出了可预期的构建顺序](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=668) [即使依赖关系有误](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=672) [但这样会牺牲
大量并行空间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=674) [延缓构建速度](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=677) [所以我们推荐
开启并行构建](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=679) [正确设置依赖关系
不要依赖排序](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=682) [最后 依赖关系在于你自己](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=687) [开发者](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=690) [你可以自定义shell脚本
构建阶段或规则](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=692) [明确告诉构建系统
输入和输入都是什么](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=695) [以避免重复运行
不必要的脚本任务](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=699) [保证正确执行顺序](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=702) [你可以用运行脚本阶段编辑器
定义输入和输出](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=705) [这些文件的路径](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=709) [将作为环境变量
在脚本中激活](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=710) [不要依赖项目里
目标依赖关系的自动连接](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=714) [Clang编译器
有自动关联功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=718) [Clang编译器
有自动关联功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=718) [在构建设置中
自动使用关联框架](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=720) [让编译器自动连接框架](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=724) [对应导入的模块](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=727) [不用在连接库的
构建阶段再明确表示](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=729) [但是要注意](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=733) [自动关联
不会建立依赖关系](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=734) [在构建系统层级](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=736) [所以它不能保证
依赖的目标](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=738) [在关联之前已经建好](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=741) [所以它只能用于平台STK的框架](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=745) [比如
Foundation或UIKit](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=749) [因为我们知道
它们在构建前就已经存在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=751) [你自己项目里的目标](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=754) [要保证明确的库依赖关系](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=756) [你也许需要创建项目引用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=760) [将另一个Xcode项目拖放到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=762) [项目文件导航](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=764) [说明与其他项目的
目标文件的依赖关系](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=766) [总结来说
有了准确的依赖关系](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=771) [构建系统就能
更好地并行构建任务](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=774) [保证每次构建的结果一致](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=777) [这样就能减少构建用时
给开发多点时间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=779) [这样就能减少构建用时
给开发多点时间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=779) [想知道更多快速构建的内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=784) [如何最大化利用
崭新的iMac Pro内核](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=786) [推荐观看演讲
用Xcode加速构建过程](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=788) [现在
我要有请Jurgen](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=792) [他会带大家
探索编译器的世界](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=794) [谢谢 Jake](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=803) [现在我们要看看
后台都发生了什么](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=806) [当Xcode构建系统
启动Clang编译器的时候](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=809) [大家好](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=814) [我是Jurgen](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=815) [我是Clang前端团队的
编译器工程师](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=816) [今天我要讲两个功能
大家可能已经知道了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=820) [第一个是头文件映射](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=824) [我们用它传递信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=827) [从Xcode构建系统
到Clang编译器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=830) [第二个是Clang模块](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=834) [我们用它加快构建的速度](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=837) [在坐有些人可能只用Swift](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=841) [我想告诉你](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=844) [Swift在后台也用Clang](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=846) [所以你们应该也会感兴趣](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=848) [什么Clang？](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=854) [Clang是Apple的
官方编译器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=856) [用于所有C语言](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=860) [比如C、C++
当然还有Objective-C](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=864) [大部分框架都在用的语言](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=868) [Jake刚才提过](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=872) [编译器一次性
编辑所有输入文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=875) [生成仅一个输出文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=878) [之后被连接器使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=880) [如果要从OS访问API](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=883) [或从自己的代码
访问实现文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=887) [就需要一个叫做
头文件的东西](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=893) [头文件是一种承诺](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=897) [承诺在其他地方
存在这个实现文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=900) [它们通常可以匹配](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=904) [如果你只更新实现文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=907) [而忘记头文件
你就食言了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=910) [通常这个问题
不会在编译过程中出现](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=914) [因为编译器相信你的承诺](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=917) [问题出在链接过程](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=920) [编译器通常包含
不止一个头文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=924) [而且所有编译器
都是这样被调用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=928) [以样本app为例](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=932) [看看怎么处理头文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=935) [这个PetWall](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=940) [是多语言app](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=942) [app本身
用Swift编写](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=944) [框架的语言是
Objective-C](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=948) [它有个兼容库
美学档案](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=952) [是C++语言](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=955) [时间越长
app内容越多](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=960) [所以要重新组织
方便查找文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=962) [比如](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=968) [将所有跟猫有关的文件
移动到子文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=969) [不要改变任何实现文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=976) [也是可以的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=980) [那么你想](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=982) [Clang是如何找到头文件的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=986) [举个简单的例子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=992) [这是一个实现文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=994) [在这个代码里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=997) [包含一个头文件
命名为cat.h](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=998) [怎么知道Clang做了什么](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1003) [一是查看构建日志](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1006) [看看Xcode构建系统
在编译这个文件时做了什么](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1010) [复制粘贴这个调用代码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1016) [打开命令窗口
输入-v选项](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1019) [打开命令窗口
输入-v选项](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1019) [-v代表显示](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1023) [然后Clang会返回很多信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1025) [我们只要关注一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1029) [搜索路径](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1032) [我说搜索路径](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1035) [大家想到的可能是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1037) [指向源代码的搜索路径](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1040) [不是这样的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1044) [相反](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1047) [你会看到这个
headermaps](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1048) [（寻找猫咪）](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1050) [Headermaps
由Xcode构建系统创建](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1052) [说明头文件的位置](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1056) [仔细看下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1060) [这是最重要的两个
headermap文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1061) [前两行只是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1067) [插入了框架名称](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1071) [给头文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1074) [这两个头文件
原来是公共文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1076) [我建议
不要依赖这个功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1082) [原因是…](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1085) [把它放在这里
是为了让现有项目持续运行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1087) [但之后使用Clang模块时
可能会出现问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1091) [所以我们建议
自己标出框架名称](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1095) [在将公共或私有头文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1100) [从自己的框架中导入时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1103) [第三行是项目头文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1107) [这个例子中并不需要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1110) [而且…](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1112) [headermap是为了
连接回源代码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1113) [如你所见](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1119) [公共和私有头文件的操作一样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1120) [总是回归源代码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1124) [这是为了让Clang生成](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1126) [有用的报错信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1130) [用于源目录文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1133) [而不是从构建目录
复制过来的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1135) [其他内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1138) [其他内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1138) [很多人不知道
头文件映射的存在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1143) [就会遇到某些问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1146) [最常见的是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1148) [忘记将头文件
添加到项目](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1150) [它在源目录
但不在项目里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1155) [一定保证将头文件
添加到项目](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1159) [另一个问题是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1163) [如果头文件命名一样
它们会彼此重叠](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1166) [所以头文件的名称
要有所区别](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1171) [这对系统头文件也一样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1174) [如果项目里的本地头文件
与系统头文件名字一样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1177) [它会叠加到系统头文件上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1182) [要注意避免](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1184) [提到系统头文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1187) [怎么查找？](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1188) [再用PetWall演示下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1193) [这里导入
Foundation.h头文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1196) [在SDK里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1199) [在SDK里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1199) [我们可以像之前一样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1201) [就像查找自己项目的头文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1204) [但现在是系统头文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1206) [我说过头文件映射
只用于私有的头文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1208) [所以可以忽略](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1213) [现在关注导入路径](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1215) [那么](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1218) [默认的SDK里有两个目录](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1219) [第一个是用户的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1223) [第二个是系统库框架](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1226) [先看第一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1230) [这是正常的包含目录](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1233) [我们只要输入搜索关键词](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1235) [这里是
Foundation/Foundation.h](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1238) [头文件没找到
因为它不在那里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1242) [没关系
再试试第二个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1245) [系统库框架](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1248) [这是框架目录](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1252) [所以Clang的做法会有些不同](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1254) [首先…](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1257) [它要确定框架的定义
看看框架是否存在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1258) [它要确定框架的定义
看看框架是否存在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1258) [然后](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1265) [从头文件目录中
查找头文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1266) [这里找到了
不错](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1270) [但如果没找到呢？](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1273) [比如输入不存在的假冒头文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1277) [显然不会在头文件目录中找到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1281) [但之后它会查找
私有头文件目录](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1285) [Apple的SDK中
不会带有任何私有头文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1290) [但是你的项目](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1294) [和框架中可能公共和私有头文件都有](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1296) [所以也会检查](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1299) [但这是个假的头文件
所以那里也没有](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1302) [现在就有意思了
搜索停止了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1306) [我们不会再查找其他目录](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1310) [这是因为](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1313) [框架已经被找到了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1314) [一旦框架被找到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1319) [一旦框架被找到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1319) [一般框架目录里
能找到头文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1320) [如果找不到
搜索就放弃了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1323) [如果好奇
实现文件的模样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1327) [当所有头文件
都被导入和预处理之后](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1331) [你可以让Xcode](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1335) [创建预处理文件
给实现文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1337) [这会生成一个
巨大的输出文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1344) [有多大呢？](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1348) [举个简单的例子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1352) [Foundation.h是…](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1355) [系统最基本的头文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1358) [这个头文件很可能被](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1363) [直接或间接地
导入其他头文件夹](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1365) [就是说…](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1369) [每次调用编译器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1370) [都要查找这个头文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1371) [一天之内](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1375) [Clang要查找并处理
800多个头文件夹](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1377) [Clang要查找并处理
800多个头文件夹](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1377) [只为一个导入声明](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1382) [也就是要解析和验证
大于9兆的源代码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1385) [每次调用编译器
都是如此](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1391) [这个工作量很大
很冗余](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1395) [所以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1398) [怎么改善？](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1400) [这里有个功能叫做
预编译头文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1403) [这是个好办法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1407) [但还有更好的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1410) [几年前
我们发布了Clang模块](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1412) [Clang模块只允许我们
为框架查找和解析头文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1416) [一次](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1420) [然后储存到硬盘
缓存并可以再利用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1422) [这可以提升构建速度](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1428) [要实现它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1433) [Clang模块
要具备特定的属性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1435) [最重要的一点是
上下文无关](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1439) [最重要的一点是
上下文无关](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1439) [什么是上下文无关？](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1443) [这有两个代码片段](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1446) [两个都导入了PetKit模块](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1449) [但两个宏观定义不同](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1453) [如果用传统方法
导入头文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1459) [文本也会被导入](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1462) [预处理器…](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1465) [会遵从这个定义
并应用到头文件夹](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1466) [如果这样做](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1471) [每个案例的模块](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1472) [就不一样
不能重复使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1474) [所以…](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1477) [如果要使用模块
就不能这样做](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1479) [模块会忽略
所有文本信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1481) [这样就能被
所有实现文件重复使用了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1487) [另一个要求是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1494) [模块各自独立](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1496) [也就是说
要明确所有依赖关系](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1498) [也就是说
要明确所有依赖关系](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1498) [这对你有好处](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1504) [就是只要你导入一个模块](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1506) [它就能工作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1510) [不用考虑还要
添加其他的头文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1511) [才能运行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1514) [我们怎么知道
或者说Clang怎么知道](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1519) [要不要创建模块呢？](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1522) [看个简单的例子
NSString.h](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1525) [首先Clang要找到框架里的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1530) [这个头文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1533) [你们知道怎么做了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1537) [这是Foundation.framework
目录](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1538) [然后Clang编译器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1542) [会查找模块目录
和模块映射](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1544) [它与头文件目录相关](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1547) [找到了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1549) [什么是模块映射？](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1551) [模块映射描述了
特定的一组头文件夹](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1553) [翻译到模块中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1557) [具体讲下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1560) [模块映射很简单](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1564) [这是Foundation的
整个模块映射](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1566) [就这些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1568) [显然它描述了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1570) [模块的名称
就是Foundation](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1571) [它还说明了
哪个头文件属于该模块](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1574) [这里只有一个头文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1580) [Foundation.h](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1583) [但这个头文件很特殊
这是umbrella header](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1585) [用特殊关键词
umbrella标出](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1588) [这是说…](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1592) [Clang要查找
这个特殊的头文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1593) [来确定NSString.h
是不是模块的一部分](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1597) [耶 找到了！](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1602) [好了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1604) [我们已经确定](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1605) [NSString.h是
foundation模块的一部分](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1607) [Clang可以升级文本输入](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1610) [到模块输入](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1614) [为此我们要创建
foundation模块](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1616) [如何创建
foundation模块呢？](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1621) [首先](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1623) [为Clang单独创建位置](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1625) [Clang位置里
包含的所有头文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1628) [都属于foundation模块](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1631) [我们不会转移任何现有的上下文](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1635) [来自原始的编译器调用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1639) [所以说是上下文无关](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1641) [实际上我们转移的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1644) [是传递给Clang的命令行实参](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1645) [随后继续传递](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1648) [在创建foundation模块时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1652) [模块本身或框架](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1656) [框架本身…](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1657) [会导入其他框架](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1659) [也就是说…](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1661) [我们也要构建那些模块](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1663) [我们不能停顿](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1666) [因为它可能还包含
其他框架](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1668) [但是我们已经能看到
它的好处了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1672) [某些导入可能是一样的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1675) [所以总能重复使用那个模块](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1677) [所以总能重复使用那个模块](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1677) [所有模块要序列化
存到模块缓存区](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1682) [我说过…](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1689) [命令行实参会向后传递
在创建模块的时候](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1691) [就是说…](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1695) [这些实参会影响](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1697) [模块的内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1700) [所以我们要散列](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1702) [这些实参](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1705) [再保存这些
为特定编译器调用而创建的模块](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1706) [到散列匹配的目录里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1710) [如果修改编译器实参](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1714) [用不同的限制文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1717) [比如写入
enable cat](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1719) [这是不同的散列](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1722) [要求Clang重新创建](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1724) [所有模块
且输入到那个目录](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1727) [匹配那个散列](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1731) [为了更多重复利用模块缓存](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1733) [你要保证实参的一致性
如果可能的话](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1737) [你要保证实参的一致性
如果可能的话](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1737) [以上就是如何查找
和创建系统框架模块](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1745) [但是你的框架呢？](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1750) [如何为它们创建模块？](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1752) [回到刚才猫的例子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1756) [这时打开模块](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1759) [如果要用头文件映射](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1763) [它会映射到源目录](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1766) [看看这个源文件
出问题了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1771) [这里没有模块目录](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1775) [看上去根本不是框架](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1778) [Clang现在不知所措](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1781) [答案是一个新的概念](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1785) [叫做
Clang的虚拟文件系统](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1789) [它会创建一个
虚拟的抽象框架](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1792) [方便Clang创建模块](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1796) [但是…](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1799) [但是…](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1799) [抽象框架只能映射到目录文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1801) [这样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1805) [Clang就能在源代码中报错](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1806) [这就是创建模块的方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1811) [在使用框架的情况下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1813) [大家记得
开始的时候我说过](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1818) [如果不确定框架名字
会有问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1820) [我们就来举个例子
看看是什么问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1825) [这是很简单的代码样本
只有两个输入](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1830) [第一个输入
PetKit模块](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1834) [第二个输入](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1839) [我们都知道
这是PetKit模块的一部分](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1841) [但Clang可能不知道](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1845) [因为你没有写明
框架的名称](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1847) [这样一来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1851) [你可能会收到
重复定义的报错](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1853) [这种情况常见于
将同一个头文件导入了两次](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1857) [这种情况常见于
将同一个头文件导入了两次](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1857) [Clang在后台辛苦工作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1863) [就为了解决
诸如此类的常见问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1865) [但它不可能全部解决](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1870) [这只是个简单的例子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1873) [稍微调整一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1875) [修改一下上下文](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1878) [模块的导入
完全不受影响](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1881) [因为我说过
上下文可以忽略](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1885) [cat导入](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1889) [还是头文件的文本导入](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1890) [它会遵循这个修改](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1893) [这时可能就不是双重定义了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1896) [而是矛盾定义](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1899) [无法解决](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1902) [Clang解决不了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1904) [那么…](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1906) [记住我的建议](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1907) [永远明确框架名称](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1909) [无论是导入公共的
还是私有的头文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1912) [现在有请Devin](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1916) [他为大家讲解Swift和
Swift对Clang模块的使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1918) [他为大家讲解Swift和
Swift对Clang模块的使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1918) [谢谢 Jurgen](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1929) [我们现在要具体讲解](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1931) [Swift和构建系统
如何并肩作战](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1933) [在项目中查找声明](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1937) [先总结下
Jurgen的演讲](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1941) [Clang单独编译
每个Objective-C文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1943) [如果你要在另一个文件夹
查找一个类](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1947) [你要导入声明那个类的头文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1952) [Swift的设计不需要写入头文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1957) [为了方便初学者上手应用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1961) [避免了在不同文件里
重复一个声明](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1964) [但这就意味着编译器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1970) [要做些额外的记录工作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1972) [下面就讲讲
记录工作怎么做](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1974) [回到PetWall app](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1979) [回到PetWall app](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1979) [在界面控制器里
有个Swift的界面](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1982) [Objective-C
app代理](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1987) [和Swift单元测试](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1989) [为了编译](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1991) [哪怕只是上面这个
PetViewController](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1992) [编译器也要
进行4个不同的运算](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=1996) [首先要找到声明](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2000) [Swift目标里的
和来自Objective-C的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2003) [它还要生成接口
描述文件内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2009) [以便声明可以
被找到并用于](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2013) [Objective-C
和其他Swift目标](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2016) [接下来的部分](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2020) [我会演示这个例子
分别阐述这四个任务](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2022) [首先是在Swift目标里查找声明](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2027) [要编译
PetViewController.swift](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2035) [编译器会查找
PetView的初始程序类型](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2038) [编译器会查找
PetView的初始程序类型](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2038) [以便检查调用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2042) [但在此之前](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2045) [它要解析
PetView.swift](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2047) [并验证](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2050) [以保证初始程序的声明
是正常的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2051) [编译器很聪明
它知道](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2055) [不需要检查
初始程序的主体](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2058) [但它还要做些工作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2062) [处理文件的接口部分](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2063) [这与Clang不同](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2069) [编译一个Swift文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2072) [编译器也要解析
目标中所有其他Swift文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2075) [以检查与接口有关的部分](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2079) [在Xcode 9
这会导致重复工作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2088) [在增量调试构建中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2091) [因为编译器单独编译每个文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2094) [文件的编译可以并行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2098) [文件的编译可以并行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2098) [但它强制编译器
重复解析每个文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2101) [解析一次
作为实现文件生成.o](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2105) [解析多次是作为接口](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2108) [查找声明](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2111) [Xcode 10减少了这种消耗](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2114) [通过将文件合并成组](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2117) [尽可能多得分担工作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2120) [在依旧最大化并行的同时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2124) [在组中重复利用解析](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2127) [只在跨组处理时重复](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2131) [由于组的数量相对较少](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2134) [就能大幅提升
增量调试构建的速度](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2138) [Swift代码
不止调用其他Swift代码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2146) [还能调用Objective-C](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2150) [回到PetWall样本app](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2153) [我们看到它很重要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2155) [因为它是系统框架](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2158) [比如 UIKit
是Objective-C语言](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2160) [Swift与其他语言不一样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2166) [它不需要外部功能接口](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2170) [这里你一般要
比如](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2175) [编写Swift声明给每个
Objective-C API](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2177) [但是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2182) [编译器内置了
Clang的一大部分](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2183) [用作库](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2188) [这就可以直接导入
Objective-C框架](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2190) [Objective-C声明
来自哪里？](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2197) [导入器会查看头文件
根据目标类型](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2200) [任何目标在导入
Objective-C框架时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2205) [导入器在头文件中
找到声明](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2209) [显示的是
Clang对此框架的模块映射](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2212) [用Swift和Objective-C
代码混编的框架](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2216) [导入器在umbrella头文件中
查找声明](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2220) [这个头文件定义了公共接口](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2224) [这样 框架内的Swift代码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2228) [就可以调用同一框架内的
公共Objective-C代码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2230) [最后
在app和单元测试中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2236) [可以导入目标的桥接头文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2239) [允许其中的声明
被Swift调用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2242) [现在…](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2248) [导入器找到声明后](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2249) [通常会修改它们
让它们变得更口语化](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2251) [比如它会导入
Objective-C函数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2255) [用NSError惯用语](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2257) [作为throwing函数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2260) [使用Swift内置的
错误处理语言功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2262) [具体来说
就是输入参数类型名称](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2267) [后跟动词和介词](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2270) [比如函数
drawPet atPoint](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2273) [带有宠物这个词](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2276) [对于参数类型
宠物](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2278) [对于参数类型
宠物](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2278) [后跟一个动词
画](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2280) [同样单词point](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2283) [代表参数类型
CGPoint](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2286) [后跟介词at](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2288) [Swift删除了这些词](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2291) [只导入函数
draw at](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2294) [怎么做到的？](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2299) [你可能不知道](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2301) [编译器带有一组
常用英文动词和介词列表](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2303) [因为它们很难编码
人类语言太复杂](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2309) [有时会缺词](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2313) [另外为了
匹配Swift名字转换](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2315) [导入器会重命名函数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2318) [根据词性删除单词](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2321) [比如
动词feed不在列表上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2325) [所以feedPet导入后
不是我们预想的feed](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2327) [这个时候](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2333) [可以用注解
NS_Swift_Name](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2334) [让编译器导入
你要的函数形式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2337) [让编译器导入
你要的函数形式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2337) [如果你要看看
Objective-C头文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2345) [如何导入Swift](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2348) [你可以到
Xcode相关项目弹窗](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2350) [它在源编辑器的左上角](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2353) [选择生成的接口](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2356) [就能看到接口的样子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2358) [和不同的Swift版本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2361) [以上就是用Swift
导入Objective-C](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2365) [反过来呢？](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2368) [Objective-C
怎么导入Swift？](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2370) [答案是
Swift会生成一个头文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2375) [可以进行导入](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2377) [这样你可以用Swift编写类
然后用Objective-C调用它们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2379) [看看工作原理](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2385) [编译器生成
Objective-C声明](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2388) [给Swift类
NSObject和@objc函数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2391) [单元测试的app](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2397) [头文件会包含
公共和内部两种声明](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2398) [头文件会包含
公共和内部两种声明](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2398) [就能在app的Objective-C部分
使用内部Swift](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2403) [但是对于框架](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2408) [生成的头文件只包含公共声明](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2410) [因为它包含于构建的产品](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2413) [是框架公共接口的一部分](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2415) [右边](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2420) [你看到编译器
将Objective-C类连接到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2421) [名字变形的Swift类](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2424) [包含模块名称
PetWall](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2427) [现在我讲一讲模块](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2431) [之后Louis会讲解
命名修饰](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2434) [现在大家要知道](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2436) [它能防止
运行时间里的冲突](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2438) [不让两个模块定义
同名的类](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2441) [你可以让Swift重命名
Objective-C类](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2446) [通过传递识别符
到objc属性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2450) [如果这样做](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2454) [你要保证两个名字不冲突](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2455) [我用了PWL前缀
防止冲突](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2459) [我用了PWL前缀
防止冲突](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2459) [这样就能在Objective-C中
引用这个类PWLPetCollar](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2465) [编译器用类似的方法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2474) [生成其他Swift目标的接口](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2475) [为此](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2481) [Swift基于Clang的
模块概念进行构建](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2482) [就像Jurgen说的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2485) [然后更深层的融入语言](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2487) [Swift里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2490) [模块是可分布的声明单元](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2491) [为了使用这些声明
就要导入模块](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2494) [你可以导入
Objective-C模块](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2500) [比如XEtest](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2502) [Xcode里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2505) [每个Swift目标
生成单独的模块](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2506) [包括目标app](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2510) [所以要导入
app的主模块](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2512) [以便进行单元测试](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2515) [导入模块时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2520) [编译器反序列化
一个特殊的Swift模块文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2522) [在使用时
检查它的类型](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2526) [例如在单元测试中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2529) [编译器加载
PetViewController](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2530) [从PetWall Swift模块里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2534) [以保证控制器的创建
没有问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2536) [这类似于编译器在目标里查找声明](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2539) [我之前展示过的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2542) [除此之外](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2545) [编译器会加载一个
总结模块的文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2547) [而不是直接解析Swift文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2550) [编译器生成的
Swift模块文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2556) [很多就像
Objective-C头文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2558) [但它不是文本模式
而是二进制形式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2562) [它包括内联函数的主体](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2566) [很像Objective-C
静态内联函数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2568) [C++头文件实现](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2571) [但是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2574) [要注意一点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2575) [就是它包含
私有声明的名称和类型](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2576) [就是它包含
私有声明的名称和类型](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2576) [这让你可以
在调试器中引用它们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2582) [很方便](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2584) [但也意味着](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2586) [你不能用私人秘密
来命名私有变量](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2588) [对累加构建](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2595) [编译器生成
部分Swift模块文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2597) [然后合并为一个文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2600) [代表整个模块的内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2603) [合并过程可能会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2606) [生成一个
Objective-C头文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2609) [很多时候](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2614) [这类似于连接器的操作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2615) [把目标文件整合成](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2617) [一个执行文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2619) [更多关于它的内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2622) [有请Louis讲讲连接器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2623) [Louis](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2626) [谢谢 Devin](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2628) [我是Louis Gerbarg
工作重点就是连接器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2634) [这是完成Xcode构建的最后一步](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2637) [这是完成Xcode构建的最后一步](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2637) [开始吧](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2640) [首先浏览一下我要讲的内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2643) [我会讲什么是连接器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2646) [还有它用做输入的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2649) [dylibs和目标文件及其定义](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2651) [还会讲到符号](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2654) [及其内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2656) [最后我会总结一遍](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2658) [通过举例
因为内容比较难懂](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2661) [如果感到疑惑](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2665) [坚持住
希望我能讲明白](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2667) [那么…](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2671) [什么是连接器？](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2672) [我说过
它是最后一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2673) [构建阶段](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2676) [我们要合并
所有的.o文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2678) [是两个编译器之前生成的
合成一个可执行文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2681) [全部内容就是
移动和打包代码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2687) [它不能生成代码
这点很重要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2689) [我来举例说明](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2691) [我们有两种输入文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2695) [第一种是dylibs
就是库](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2698) [第一种是dylibs
就是库](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2698) [有多个…](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2701) [第一个应该是
目标文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2703) [产生于构建过程](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2705) [第二种是库](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2706) [由多种类型组成
包括dylibs](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2708) [tbd
.a文件或静态库](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2711) [符号是什么？](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2715) [符号是名称
代表代码或数据片段](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2718) [这些片段可能会
指向其他符号](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2724) [当一个函数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2728) [调用另一个函数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2729) [符号具有属性
会影响连接器的行为](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2733) [这有很多](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2736) [我只举一个例子
弱符号](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2738) [弱符号的注释是指](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2742) [它可能会消失
当你在系统上运行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2745) [执行文件时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2751) [这都是可用性标记
表示这个API可用于iOS 12](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2753) [那个API可用于iOS 11](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2758) [那个API可用于iOS 11](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2758) [这就引到了
今天的主题连接器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2761) [连接器决定哪些符号
必须出现](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2765) [和哪些符号
可以在运行时间处理](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2767) [语言可以将数据编码成符号
通过命名修饰](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2774) [Devin已经提到过](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2778) [而且…](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2781) [C++和Swift中
都能见到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2782) [那么…](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2787) [符号就是这些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2788) [代码和数据的名字](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2790) [那么…](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2793) [编译器生成目标文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2794) [目标文件就是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2795) [代码和数据的集合](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2798) [它们不可执行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2802) [因为是编译的代码
所以还没完成](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2803) [还有缺失](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2807) [就需要linke整合和修复](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2809) [每个文件的片段
以符号表示](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2814) [那么…](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2817) [print f函数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2818) [print f函数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2818) [就以符号代替代码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2821) [对于其他PetKit函数
一会儿会演示](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2823) [也是一样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2826) [片段可能引用未定义符号](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2829) [如果.o文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2832) [引用另一个
.o文件的函数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2835) [这个.o文件就是未定义的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2838) [连接器会查找未定义符号
进行匹配](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2840) [那么…](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2846) [我说过目标文件是编译器的输出](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2847) [什么是库？](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2850) [库是定义符号的文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2852) [但不属于构建的目标](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2854) [我们有动态库](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2858) [而且…](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2861) [这些Mach-O文件
显示代码和数据片段](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2862) [供可执行文件使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2866) [它们是系统的一部分](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2869) [这是我们用的框架
你们可能会用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2872) [自己的框架](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2874) [还有TBD文件
基于文本的动态库文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2878) [还有TBD文件
基于文本的动态库文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2878) [这是什么呢？](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2882) [就是…](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2883) [在给iOS和macOS
创建SDK的时候](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2885) [会有所有这些动态库和函数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2889) [例如MapKit和WebKit
你可能会用到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2891) [但我们不想把
所有这些跟SDK一起加载](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2894) [这样体积太大](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2897) [编译器和连接器
都不需要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2899) [它只要运行程序](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2901) [因此我们创建了
stub dylib](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2903) [删除了所有符号的主体](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2904) [只保留名字](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2907) [完成之后](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2909) [转用文本表示
用起来比较简单](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2910) [目前它们只用于
分配SDK以减少体积](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2913) [如果在项目中看见它们
不要紧张](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2920) [它们只是符号](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2923) [最后是静态库](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2926) [那么…](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2928) [静态库是…](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2930) [之前用AR工具创建的
.o文件的集合](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2932) [也可能是lib
这是它的包装工具](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2936) [也可能是lib
这是它的包装工具](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2936) [根据AR操作文档](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2940) [AR创建并维护文件组](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2943) [将它们合并为一个库](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2946) [听上去像是
TAR或ZIP文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2949) [的确是这样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2952) [事实上…](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2954) [.a格式是原始的库格式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2954) [在更好的工具产生之前
为UNIX所用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2957) [但现在的编译器和连接器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2961) [可以完全理解它们
所以继续使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2964) [它就只是个档案文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2966) [值得注意的是
它们孕育了动态链接](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2971) [在过去](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2975) [所有代码都被存档](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2976) [因此](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2979) [不能涵盖所有C库](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2981) [只用一个函数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2984) [因此 行为是…](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2986) [如果.o文件含有符号](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2988) [我们会把整个.o文件
从库中提出来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2990) [但不会带入其他.o文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2993) [如果在之间引用符号](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2996) [只要带入即可](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2998) [如果是非符号行为](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2999) [如果是非符号行为](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=2999) [比如静态初始程序](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3002) [或将它们以你个人
dylib的形式重新导入](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3004) [你要明确地用到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3006) [强制加载或制定加载
让连接器提取所有](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3009) [或这些文件
即便之间没有关联](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3013) [我们通过一个例子
串联起这些内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3017) [台上是playSound函数样本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3023) [只看宠物不听声音
有何乐趣呢？](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3028) [那么…](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3032) [调用playSound](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3033) [这个Cat函数
调用playSound](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3035) [很简单吧](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3037) [来看看生成的程序集](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3039) [那么…](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3042) [输出文件是cat.o](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3044) [现在…](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3046) [我们可以看到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3048) [字符串purr.aac
就是AAC声音文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3051) [它被复制到cat.o](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3055) [你会看到
名字为purr的文件不见了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3057) [你会看到
名字为purr的文件不见了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3057) [因为它是静态的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3061) [如果你熟悉C语言
这是非导出命名](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3063) [没有人能引用它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3066) [既然如此
我们不需要它了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3067) [排除掉](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3069) [然后可以看到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3074) [Cat purr变成了符号](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3075) [-[Cat purr]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3078) [跟预想的差不多](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3083) [然后我们要把这个变量](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3086) [传递到playSound](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3089) [这里出现了两个指令](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3091) [这是因为…](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3093) [我们不知道
这个字符串最后在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3095) [执行文件的位置](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3098) [没有具体的位置](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3099) [但我们知道RM64
就是这个程序集](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3101) [它最多接收两个指令](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3105) [编译器留下两个指令](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3106) [留下了符号偏离
值为PAGE和PAGEOFF](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3109) [连接器之后回来修复](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3113) [既然已经
将字符串加载到x0](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3116) [既然已经
将字符串加载到x0](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3116) [就可以调用playSound
不用写入playSound](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3121) [我们写入
__z9playSoundPKc](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3125) [这是什么？](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3131) [这是变形的符号](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3132) [如果仔细看
会看到cat.mm](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3133) [这是Objective-C++](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3136) [playSound实际是
C++函数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3138) [那么…](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3142) [如果你不熟悉](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3142) [可以在命令窗口
输入命令](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3145) [如果运行
Swift-demangle](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3148) [传递符号
然后反修饰](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3151) [没有用
它不是Swift符号](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3153) [但C++filt
C++反修饰器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3156) [告诉我们它实际上是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3159) [playSound的符号](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3161) [除了playSound
它还有一个实参](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3162) [就是const char*](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3164) [因为C++会将更多信息
编入修饰符号](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3167) [现在有了.o文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3173) [实际构建中会有更多](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3175) [那怎么办呢？](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3178) [那怎么办呢？](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3178) [首先
构建系统](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3182) [会将所有的.o
输入到连接器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3183) [连接器会创建文件夹
放置这些文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3186) [这里构建的PetKit](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3189) [是PetWall的内嵌框架](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3191) [所以我们只要复制](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3194) [创建一个文本片段](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3196) [用来保存
app相关的所有代码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3199) [然后复制cat.o到这里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3202) [但是要分成两个部分](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3204) [一个给字符串
一个给执行代码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3206) [现在已知它们的文件位置](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3210) [连接器就能复写cat.o](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3213) [基于特定的偏移值](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3217) [你看到第二个指令消失了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3220) [它被一个null指令代替
没有任何行动](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3223) [但是它不能被删除
因为我们无法创建或删除代码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3227) [这会打乱所有已经完成的工作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3232) [所以与其删除](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3236) [不如用零行动替代](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3239) [不如用零行动替代](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3239) [最后是分支](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3242) [那么分支指令…](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3244) [然后…](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3247) [要怎么做？](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3249) [因为这个未定义符号？](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3251) [我们要继续浏览](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3253) [所有已经导入的.o文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3254) [首先是过去的静态库](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3258) [这是PetSupport.a](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3260) [PetSupport.a里面](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3262) [有一些文件
包括PetSounds.o](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3265) [大家能看到
playSound对应的符号](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3269) [把它拉入](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3274) [PetCare.o
不能被拉入](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3278) [因为这个.o文件没有符号](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3281) [能被app的其他部分](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3283) [引用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3286) [所有我们把它拉入
现在需要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3288) [_open
但没有定义](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3291) [你看到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3293) [拉入的对话已变成](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3296) [open$stub](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3297) [为什么呢？](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3299) [为什么呢？](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3299) [因为我们发现open的复制](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3301) [在lib系统的
TBD文件里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3305) [我知道
这不属于系统库](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3311) [我不会复制到
我的app](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3314) [但我需要…](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3316) [在app里放入足够的信息
以方便调用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3317) [所以我们创建假函数
只是个模板](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3321) [用来代替](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3325) [从lib系统
拿走的函数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3326) [这里就是open](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3327) [观察这个函数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3329) [它实际是来自指针
open$pointer](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3331) [然后跳过来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3336) [这需要一个函数指针
任何正常的C语言函数指针](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3337) [然后创建它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3342) [在数据片段中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3344) [如果有全局变量
就会出现在这里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3345) [但这里是0](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3349) [如果空引用就会导致崩溃](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3351) [所以添加一个
LINKEDIT部分](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3355) [LINKEDIT是元数据](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3358) [LINKEDIT是元数据](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3358) [连接器会用它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3360) [给操作系统留下信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3363) [这就是动态连接器
在运行时间解决问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3366) [了解更多信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3370) [请观看2016年的演讲
优化app启动时间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3372) [那么…](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3379) [简单回顾下今天的内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3381) [Jake讲述了构建系统
如何用依赖关系](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3383) [优化多核构建过程](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3387) [Jurgen展示了Clang
和如何查找头文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3393) [以及如何优化模块构建](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3396) [Devin简述了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3401) [Swift对模块的扩展](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3402) [所有这些今年的新实施](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3405) [比如BF处理
都是为了提升构建速度](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3406) [最后连接器接收](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3409) [两个编译器的输出](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3411) [将它们带入app](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3413) [这时Xcode会
代码签名并打包](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3415) [与其他…](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3418) [app部分糅合
准备分发](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3420) [那么…](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3423) [这些基本都是开源的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3425) [如果感兴趣](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3427) [可以研究Swift或Clang
或llbuild执行引擎](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3429) [对这些URL](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3434) [谢谢大家的到来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3436) [而且…](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3439) [希望你们享受本次WWDC
我们将在实验室见](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3440) [谢谢](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/415/?time=3443)