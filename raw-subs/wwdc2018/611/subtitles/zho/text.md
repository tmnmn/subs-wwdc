# Metal for VR

## Summary
On macOS, Metal 2 adds specialized support for virtual reality (VR) rendering and external GPUs. Learn about new features and optimizations to take advantage of these technologies within your Metal 2-based apps and games. Understand best practices for scheduling workloads across multiple GPUs and techniques for frame pacing while multi-threading.

## Info
* Graphics and Games
* WWDC 2018 - Session 611 - macOS
* https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/

## Text
 [[ 音乐 ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=7) [[ 掌声 ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=17) [&gt;&gt; 大家早上好](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=23) [我叫 Karol Gasinski 我是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=25) [GPU 软件架构组的成员](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=26) [在本次会议的开头](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=29) [我们将简单概括](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=32) [macOS 中的新功能 主要和 VR 的应用有关](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=35) [然后 我们将深入探讨](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=38) [Metal 2 的新特性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=41) [它是今年](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=43) [专为 VR 而设计的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=45) [最后 在本次会议的结尾](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=46) [我们将讨论](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=48) [开发 VR App 的先进技术](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=50) [近来 我们推出了全新的 iMac 和 iMac Pro](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=53) [这两款产品使用了强大的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=56) [图形处理器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=57) [图形处理器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=57) [iMac 如今配有基于 ARM 的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=60) [图形处理器 并且拥有最高 8 GB](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=61) [的视频存储器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=65) [而 iMac Pro 配有](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=67) [更先进且更大的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=69) [图形处理器 视频存储器容量最高可达 16 GB](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=71) [这是多么强大的功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=76) [现在就掌握在大家的手中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=78) [但我们并没有](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=80) [将服务限制在 iMac 上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=81) [我们最近宣布](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=84) [扩展了图形处理器支持 这能让你](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=85) [将任何一台 Mac 变成强大的工作站](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=88) [它将赋予你超过](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=90) [10 倍更强大的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=94) [处理能力](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=95) [我们做的还不止这些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=97) [今天我们介绍的是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=99) [HTC Vive 这款头戴式显示器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=100) [的即插即用支持](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=103) [它有两块 1440x1600](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=105) [AMOLED 的屏幕和每英寸 615 像素](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=108) [和 Vive 相比](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=114) [分辨率提高了百分之 78](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=118) [分辨率提高了百分之 78](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=118) [像素密度提高了百分之 57](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=121) [更强大的屏幕](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=123) [为它的新前置双摄像头系统](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=126) [提供了支持](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=129) [这样 开发者们就可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=131) [用这些摄像头](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=133) [在 Mac 上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=134) [尝试直通视频](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=136) [同时加上 Vive Pro 的支持](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=138) [就得到了更加先进的跟踪系统](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=139) [那么 你现在可能想知道如何](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=143) [在 macOS 上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=145) [开始 VR App 的开发](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=146) [HTC Vive 和 Vive Pro](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=148) [同时能和 Valve 的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=152) [SteamVR Runtime 一起运行 这能提供](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=154) [大量的服务 其中就包括 VR 生成器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=157) [Valve 也能让开放的 VR](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=160) [框架运行于 macOS 上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=163) [这样你就能通过 SteamVR 建立地图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=166) [我们一直和 Valve 以及 HTC 紧密合作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=170) [确保 Vive Pro 在 macOS 上的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=174) [SteamVR Runtime 中获得支持](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=177) [SteamVR Runtime 中获得支持](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=177) [那么 接下来我们来了解一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=183) [我们现在正在介绍的 Metal 新功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=184) [会如何开发 macOS Mojave 可以用来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=186) [优化你的 VR App 的品质](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=189) [为了帮助大家回忆 让我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=192) [回顾一下当下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=195) [App 和 VR 生成器之间的交互](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=196) [App 在启动时会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=198) [将针对左眼和右眼的图像](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=201) [转换为 30 个多样本纹理](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=203) [然后它会将这些图像分解成](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=206) [iOS 表面背景纹理](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=208) [它可以进一步](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=210) [传递给 VR 生成器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=212) [VR 生成器将会执行最终](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=213) [处理步骤](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=217) [其中包括镜头失真校正](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=219) [色差调整以及排序操作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=222) [简单来说就是变形](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=224) [最终图像一旦生成](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=228) [就会被发送到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=229) [头戴式设备或呈现的画面之中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=232) [这里涉及的很多操作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=234) [会发生两次 让我们来看一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=236) [你可不可以对此做些什么](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=239) [你可不可以对此做些什么](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=239) [看 如今有了 VR App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=242) [它想要从多样本中获益](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=244) [它需要针对每只眼睛使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=247) [专用纹理 或者都使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=248) [单一的共享纹理](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=252) [但是这些布局都并不完美](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=253) [专用纹理需要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=256) [独立的绘图调用和通道](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=258) [这正如我们所见](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=260) [而直接纹理可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=263) [在单一渲染和结果通道中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=265) [进行双眼的渲染](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=267) [这些纹理在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=270) [后期处理和效果方面会产生一些问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=272) [对于分层纹理拥有](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=274) [专用纹理和共享布局](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=276) [的全部优势 但是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=279) [当下它们不能和多重采样抗锯齿一起使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=281) [这促使 App 开发者们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=285) [使用不同的渲染兼用布局](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=287) [具体取决于](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=288) [他们是否想使用多重采样抗锯齿](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=291) [或使用不同诀窍来解决这一问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=294) [那么我们就来看看 我们可以如何优化](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=297) [这一渲染](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=299) [这一渲染](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=299) [今天我们要介绍](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=302) [一个新的纹理](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=304) [2DMultisampleArray 纹理](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=306) [这一纹理类型拥有](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=308) [上述类型的所有优点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=310) [而没有上述类型的任何缺点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=313) [多亏有了它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=315) [现在可以区分每一](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=317) [渲染空间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=319) [这简化了后期处理](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=322) [效果 视图数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=324) [这样 App 就可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=328) [轻松地返回单视场渲染](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=330) [并能控制抗锯齿模式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=333) [作为结果 App 就能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=336) [拥有单一渲染文件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=338) [可以轻松运用于任何情形之中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=340) [最重要的是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=343) [在每种情景中 App 可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=346) [通过单一绘图和渲染通道](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=348) [被渲染](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=350) [那么这里我们可以看到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=353) [创建上述 2DMultisampleArray](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=355) [纹理的代码片段](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=357) [我们将样本数设置为 4](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=361) [这样就能在质量和性能之间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=363) [达到最佳平衡](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=365) [与此同时 我们将](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=367) [其他长度设置为 2 因为我们想](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=369) [将每只眼睛的图像存储为](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=372) [独立的切片](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=376) [那么让我们让来看看 管线会怎样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=378) [发生变化](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=381) [我们现在可以将那些 2D](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=383) [多样本纹理用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=385) [单一 2D 多样本阵列纹理](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=387) [纹理进行替换](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=392) [那么现在 App 就能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=393) [在单一渲染通道进行双眼渲染](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=394) [而且如果它使用实例化](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=398) [它甚至可以在单一绘图代码中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=400) [做到这一点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=402) [这已经看起来很不错了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=402) [但是我们仍然需要将那些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=405) [2D 多样本阵列纹理切片](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=407) [变为独立的 iOS](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=409) [面部图像在我们将其传递到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=412) [生成器之前](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=414) [那么让我们专注于我们自己的方式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=416) [App 和生成器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=419) [App 和生成器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=419) [共享纹理](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=421) [那么现在 为了共享纹理](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=421) [我们使用 IOSurface](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=424) [它们在不同的进程空间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=426) [和不同的图形处理器之间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=428) [共享纹理 但是有着这样的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=430) [灵活性会产生代价](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=434) [IOSurface 只可用于](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=436) [共享简单的 2D 纹理](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=439) [所以如果你有多样本纹理](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=442) [存储困难或者拥有](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=444) [复杂的纹理 它们不能被共享](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=446) [这就是为什么我们今天要介绍](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=449) [可共享的 Metal 纹理](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=450) [他们能让你的 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=452) [在进程空间之间共享](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=454) [任意一种 Metal 纹理](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=456) [只要这些纹理位于](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=459) [单一图形处理器之中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=462) [这个文件的特色是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=463) [这些案例的高级视图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=466) [例如 将场景的深度](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=469) [和 VR 生成器进行共享](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=472) [但是 当然并不仅限于此](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=474) [现在让我们看看如何](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=477) [来创建那些纹理](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=479) [来创建那些纹理](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=479) [因为可共享的纹理](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=482) [能让我们在进程之间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=483) [传递复杂纹理 所以我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=486) [会创建 2D 阵列纹理](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=488) [我们会将其传递给 VR 生成器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=490) [如你所见 我们为此](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=493) [使用了新方式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=496) [用这个创建工具创建了新的共享纹理](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=498) [与此同时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=499) [你必须记得使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=503) [Private 存储模式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=505) [这一纹理仅能通过将其创建出来的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=507) [图形处理器获得](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=509) [现在我们可以看到一个代码片段](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=513) [向我们展示了以前我们的 VR](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=516) [App 会如何将 IOSurface](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=518) [发送到 VR 生成器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=521) [我们现在来看看这个代码片段](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=524) [看看需要做出哪些改变](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=525) [从而可以从使用 IOSurface](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=527) [转变为共享的 Metal 纹理](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=530) [所以我们无须再使用这两个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=534) [IOSurface 而且由它们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=536) [支持的两种纹理](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=539) [支持的两种纹理](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=539) [现在可以被替换为](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=541) [单一可共享 Metal 纹理](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=543) [这就是目前的 2D 阵列纹理](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=545) [然后我们会将这一纹理分配给](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=549) [来自开放式 VRSDK](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=552) [的两个纹理描述器 并将它的类型](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=555) [从 IOSurface 改变为 Metal](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=559) [在完成这几项改变之后](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=561) [我们可以将针对](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=565) [左眼和右眼的图像 提交至生成器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=567) [然后生成器就会知道 我们已经传递了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=572) [拥有高级布局的 Metal 纹理](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=575) [而非 IOSurface 而且当我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=577) [查看的时候 如果它的类型是 2D 阵列纹理](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=580) [或者 2D 多样本阵列纹理](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=582) [如果是这样 那么生成器将](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=585) [自动认定](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=587) [对于左眼的图像存储于](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=589) [切片 0 之中 对于右眼的图像](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=591) [存储于 切片 1 之中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=594) [这样你的 App 就无须](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=596) [再对此做任何其他操作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=597) [当然 在 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=599) [当然 在 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=599) [和生成器之间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=603) [共享 Metal](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=605) [并非是 Metal 纹理的唯一用法](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=606) [这里有几个简单的例子](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=609) [展现了你可以如何](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=611) [在任意两个进程之间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=612) [传递 Metal 纹理](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=614) [那么我们完全按照同样的方式开始](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=615) [我们创建我们的可共享 Metal 纹理](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=618) [但如今我们从这一纹理中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=619) [创建出了可以在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=623) [进程空间之间传递的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=625) [特殊共享纹理句柄](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=627) [可以通过跨进程](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=630) [通信连接](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=631) [一旦这一句柄被传递至](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=633) [其他进程 它就可以用于](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=636) [重新创建纹理对象](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=639) [但在做此的同时 你必须](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=642) [记得在与其他进程空间中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=645) [进行创建时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=647) [所使用的相同设备上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=649) [重新创建你的纹理对象](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=651) [因为这一纹理不能脱离](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=653) [图形处理器的范围](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=656) [现在我们再回过来看我们的管线](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=658) [现在我们再回过来看我们的管线](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=658) [看看会发生什么变化](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=662) [现在 App 可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=665) [用一个 2D 阵列纹理](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=667) [替换那些分离的 IOSurface](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=670) [将针对双眼的图像存储起来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=673) [这能够促成进一步的优化](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=675) [因为原始的 2D 多样本](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=678) [阵列纹理现在也可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=680) [在一个通道中加以解决](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=681) [只需通过阵列纹理](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=684) [将其创建成可共享的类型即可](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=685) [而且不止如此](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=687) [让我们来看一下生成器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=689) [一旦我们在 App 上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=692) [完成了渲染部件的简化](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=693) [就没有什么](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=695) [可以阻止生成器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=696) [从这些新特性中获益](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=698) [所以生成器现在可以使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=701) [这些即将发布的 2D 阵列纹理](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=705) [并能在单一渲染通道中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=707) [针对双眼执行操作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=710) [正如你所见 我们刚刚完成了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=711) [整条管线的简化](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=714) [那么让我们来总结一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=717) [我们刚刚了解到的内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=719) [我们刚刚描述了两种新的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=721) [Metal 纹理](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=723) [可共享 Metal 纹理以及](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=724) [2D 多样本阵列纹理](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=727) [以及用他们来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=729) [进一步优化你的渲染管线](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=732) [的方式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=734) [这两种纹理马上就会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=736) [在即将推出的 SteamVR](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=737) [Runtime 更新中获得支持](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=739) [那么现在让我们把注意力集中在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=742) [那些可以将你 App 的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=743) [中央处理器和图形处理器的使用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=745) [最大化的技术之上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=747) [这一部分我们会分为](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=749) [两个小节 先进的帧同步技术](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=752) [以及不断降低的空闲率](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=754) [我们先来讲讲帧同步技术](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=758) [在这一小节中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=761) [我们将分析 App 的帧同步技术](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=763) [以及如何为了 VR 优化帧同步技术](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=765) [那么我们先从简单的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=768) [单线程 App 入手](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=770) [它们在执行所有操作时都会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=772) [采取串口监视的方式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=773) [这样的 App 会通过调用 WaitGet 停顿](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=775) [开始处理其中的画面](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=777) [从而接收停顿](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=780) [并将其执行情况同步到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=783) [头戴式设备的帧率之中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=785) [Vive 和 Vive Pro 都拥有](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=789) [每秒 90 帧的刷新率](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=791) [这就意味着](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=793) [App 只需要 11.1](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=794) [毫秒就能处理一帧](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=797) [对比之下 眨一下眼](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=800) [大约需要 300 毫秒](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=802) [那么在这一时间里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=805) [App 就能渲染 50 帧画面](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=807) [所以一旦 App 收到了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=810) [来自 WaitGet 停顿的停顿](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=812) [它就能开始模拟你的试验](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=814) [一旦完成模拟](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=818) [也就知道了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=819) [所有对象的状态](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=821) [App 就能继续对](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=823) [命令缓冲区进行编码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=826) [然后将其发送至图形处理器 以实现执行目的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=828) [一旦图形处理器完成操作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=831) [针对双眼的图像 也就渲染完成了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=834) [它可以被发送至 VR 生成器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=837) [进行我们在前几张幻灯片中所讲的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=839) [进行我们在前几张幻灯片中所讲的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=839) [最终后期处理](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=841) [然后再从存储器中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=842) [将各帧图像扫描到 头戴式设备的面板中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=847) [这一传输需要额外的帧](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=849) [因为在呈现图像之前](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=852) [所有像素必须完成更新](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=855) [一旦所有像素完成更新](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=859) [头戴式设备的面板中和用户 可以看到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=863) [一帧图像](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=865) [所以你可以看到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=867) [从 App 收到停顿的那一刻起](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=868) [到图像真正投射出来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=869) [的那一刻为止 一共历时 25 毫秒](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=872) [这就是为什么 App 要接收](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=875) [已经预测到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=879) [会在未来发生的停顿](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=881) [到了发射光子的那一刻](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=883) [就可以使被渲染的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=885) [图像可以和用户的停顿相匹配](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=887) [而这一连串](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=890) [与上一帧以及下一帧](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=894) [重叠的事件创建了我们的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=896) [帧基础图](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=898) [如你所见](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=899) [如你所见](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=899) [在单线程 App 中 图形处理器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=902) [在大部分时间中都是空闲的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=904) [那就让我们来看看](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=907) [是否可以对此做些什么](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=908) [我们现在切换到了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=911) [多线程 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=913) [它将视觉环境的模拟](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=915) [和针对图形处理器的编码操作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=917) [分离开来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=920) [对于这些操作的编码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=923) [现在会在独立的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=924) [渲染线程中进行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=926) [因为我们已将模拟](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=928) [和编码分离开来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=929) [所以对于帧的模拟](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=931) [可与图形处理器操作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=933) [的上一帧编码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=936) [同时进行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=938) [这意味着编码现在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=940) [已经在时间上发生了变化](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=943) [在我们收到预测的停顿之后](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=945) [编码会立即开始](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=947) [这意味着你的 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=949) [现在可以有更多时间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=950) [对图形处理器进行编码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=952) [并且图形处理器也可以有更多时间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=954) [来处理它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=956) [这样一来 你的 App 可以拥有更好的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=957) [这样一来 你的 App 可以拥有更好的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=957) [视觉化效果](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=960) [但这里有一点要注意](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=962) [因为现在模拟](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=965) [会在上一帧就开始](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=967) [所以需要独立的一组](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=969) [预测停顿](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=972) [这一组可以预测到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=974) [未来的 56 毫秒](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=976) [这样就能和针对渲染线程](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=978) [进行预测的小组相匹配](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=980) [而且这两组会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=982) [和发射光子的时刻相匹配](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=984) [这张图从中央处理器来看](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=987) [已经很不错了 正如我们所见](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=988) [App 在中央处理器中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=991) [很好的分配了它的工作 但是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=992) [让我们把重点放在图形处理器上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=996) [如你所见 我们例子中的 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=998) [现在正在对所有这些图形处理器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1003) [所有工作流程进行编码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1006) [从而使一帧进入单一的公用缓冲区](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1008) [因此除非这一公用缓冲区已完成](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1011) [否则图形处理器就会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1014) [处于空闲的等待状态](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1016) [不过 值得注意的是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1018) [不过 值得注意的是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1018) [在中央处理器上 对图形处理器的操作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1020) [进行编码所花费的时间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1022) [比在图形处理器上处理这些操作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1025) [所花费的时间要少很多](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1026) [因此我们可以利用这一事实](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1028) [并将我们的编码操作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1030) [分解成为几个公用缓冲区](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1033) [而几个公用缓冲区](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1035) [可以进行快速编码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1037) [仅需几步操作而已](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1039) [并尽快将其提交至](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1041) [图形处理器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1043) [这样一来 我们就能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1045) [在图形处理器已经处理帧的同时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1050) [进行我们的编码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1053) [而且如你所见](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1055) [在图形处理器进行处理的时候](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1056) [我们延长了时间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1060) [作为结果 这样进一步增加了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1063) [你可以在一帧中提交的工作量](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1065) [现在让我们回到我们的图表](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1068) [看一下全部放在一起](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1069) [看起来会如何](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1070) [如你所见 现在中央处理器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1073) [和图形处理器都被完全利用起来了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1075) [那么这样的 App 已经](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1078) [那么这样的 App 已经](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1078) [为你的 App 提供了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1080) [很好的示范](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1081) [但我们仍有提升的空间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1083) [你可能会注意到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1087) [在收到预测停顿之前](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1089) [当对任何种类的图形处理器 进行编码时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1091) [渲染线程仍然处于等待状态](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1094) [但是并非一帧里的所有工作流程](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1097) [都需要这些停顿](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1099) [那么让我们进行更加细致的分析](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1102) [来选择帧的工作负荷](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1104) [在这里 你可以看到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1107) [工作负荷列表 它们可能会在每一帧中被执行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1110) [其中一部分在屏幕空间中进行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1114) [或者需要了解](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1115) [与为了渲染帧所产生的停顿](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1117) [有关的总体信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1119) [我们将这样的工作负荷](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1121) [称为停顿依赖性工作负荷](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1122) [与此同时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1124) [还有一般性的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1126) [无需与停顿有关的信息](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1128) [就能立即执行的工作负荷](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1130) [我们将这些工作负荷称为](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1133) [非停顿依赖性工作负荷](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1134) [那么现在 我们的 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1136) [正在等待停顿](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1139) [正在等待停顿](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1139) [以对图形处理器的任何工作进行编码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1141) [但如果我们将这些工作负荷平分开来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1143) [我们就能立即](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1145) [对非停顿依赖性工作负荷编码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1148) [然后等待停顿](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1149) [以继续对停顿依赖性工作负荷编码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1152) [在这张幻灯片中 我们已经](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1156) [将非停顿依赖性工作负荷](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1159) [与停顿依赖性工作负荷](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1161) [区分来开](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1163) [非停顿依赖性工作负荷](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1164) [现在已经在公用缓冲区](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1166) [被编码 如果将它和后面的停顿依赖性](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1167) [工作负荷比较的话](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1169) [它被标记地](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1171) [要更暗一些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1172) [因为停顿依赖性工作负荷](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1174) [可以被立即编码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1175) [所以我们就会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1176) [采取如下操作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1179) [我们会在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1179) [上一帧工作负荷编码完成后](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1181) [立即对其编码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1182) [这给了你的中央处理器更多时间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1184) [以对图形处理器工作进行编码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1186) [更重要的是 这确保了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1189) [这一图形处理器工作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1191) [已在图形处理器上等待被执行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1194) [因此图形处理器就没有](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1196) [任何空闲时间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1199) [任何空闲时间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1199) [只要上一帧完成之后](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1200) [图形处理器就会立即开始](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1201) [下一帧处理](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1204) [最后一个小节就是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1206) [多图形处理器工作负荷的分配](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1209) [我们可以在多个图形处理器之间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1213) [分配工作负荷](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1215) [当前的 Mac Book Pro 目前共有两个图形处理器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1216) [虽然它们具有](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1219) [不同的性能特点](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1221) [但是我们可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1222) [畅通无阻地使用它们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1223) [类似地 如果每个图形处理器相互连接起来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1226) [那么 App 就能用它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1227) [对头戴式设备进行渲染](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1229) [并同时使用 Mac 的主图形处理器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1232) [对一些工作进行分流](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1234) [所以我们将](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1239) [停顿依赖性工作分离出来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1240) [并将它移动至次图形处理器上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1243) [我们这样做是因为这些工作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1245) [在很久之前的帧中就已经](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1248) [完成编码 而且现在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1252) [停顿依赖性工作负荷](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1253) [在执行上一帧](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1255) [停顿依赖性工作负荷的同时 被执行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1257) [因此 我们进一步](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1260) [增加了你在帧方面拥有的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1261) [图形处理器时间量](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1263) [但是 通过将这一工作分给](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1267) [多个图形处理器 我们现在到达了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1269) [这么一种情况 我们需要一种方式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1273) [来将这些工作负荷](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1274) [同步起来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1276) [所以我们今天要介绍新的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1282) [同步参数](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1284) [来处理这样的情况](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1286) [MTL Event 现在可以用于](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1288) [在不同 Metal 线索之间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1291) [同步单个图形处理器范围内的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1293) [图形处理器工作 而 MTL Shared Event](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1295) [拓展了这一功能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1299) [使其可以同步](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1301) [不同图形处理器之间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1302) [甚至不同进程之间的工作负荷](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1304) [那么在这里 我们来看看这个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1309) [简单的代码示例](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1311) [我们的 Mac 拥有](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1313) [外置图形处理器 它通过 Thunderbolt 3 接口](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1315) [进行连接](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1317) [这一外置图形处理器将成为我们的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1318) [这一外置图形处理器将成为我们的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1318) [主图形处理器 用于驱动头戴式设备](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1320) [这样我们就能使用 Mac 中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1324) [已有的图形处理器作为辅助的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1326) [次图形处理器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1328) [然后我们会使用共享事件来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1330) [同步两个图形处理器中的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1332) [工作负荷](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1338) [事件的初始值为 0](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1339) [因此有必要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1341) [从 1 开始启动同步计数器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1342) [这是因为当我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1346) [在初始化事件中等待之时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1347) [如果事件的计数器显示为 0](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1350) [事件就会立刻恢复原状](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1352) [所以就无法实现同步](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1354) [那么我们的渲染线程现在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1357) [立即开始了针对辅助图形处理器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1359) [的编码工作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1361) [它会对停顿依赖性工作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1364) [进行编码 这会发生在我们的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1366) [次图形处理器上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1368) [一旦这一工作完成](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1371) [结果将会存储在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1373) [锁定存储器之中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1375) [这就是为什么我们采用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1376) [编码简单操作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1379) [编码简单操作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1379) [将这些结果传输到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1381) [对两个图形处理器都可见](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1383) [的系统内存中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1385) [一旦传输完成](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1387) [我们的次图形处理器就能](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1388) [安全地向我们的共享事件发出信号](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1392) [这一信号会告诉外置图形处理器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1395) [现在接受这些结果是安全的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1398) [所以我们的渲染线程](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1401) [执行这一些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1403) [共用缓冲区 并且辅助图形处理器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1404) [已经在处理这一工作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1406) [与此同时 我们可以开始](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1410) [对驱动头戴式设备的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1412) [主图形处理器的命令缓冲区进行编码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1414) [在这一命令缓冲区中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1417) [我们一开始会等待我们的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1419) [共享事件 确保数据存储在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1421) [在系统内存里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1423) [只要它在那里  并且共享事件](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1425) [收到信号 那么我们可以执行一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1427) [简单操作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1430) [它会通过 Thunderbolt 3 接口](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1431) [将这一数据传回](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1432) [我们的外部图形处理器中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1435) [一旦传输完成](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1437) [执行停顿依赖性工作就会变得安全](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1439) [执行停顿依赖性工作就会变得安全](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1439) [因此第二个命令缓冲区](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1441) [就会发出封锁事件的信号](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1445) [让停顿依赖性工作知道](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1448) [它可以开始执行操作了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1450) [在将这两个命令缓冲区](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1452) [编码并提交之后](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1454) [渲染线程可以向往常一样继续](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1456) [等待停顿](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1458) [并在之后](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1460) [对停顿依赖性工作进行编码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1461) [那么现在我们就有了一个](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1466) [同步不同图形处理器间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1468) [不同工作负荷的机制](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1470) [但是你可以看到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1471) [我们的次图形处理器仍然](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1475) [有些空闲](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1477) [这是因为在这个例子里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1478) [我们想要设法完成](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1480) [停顿依赖性工作负荷](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1484) [即那些拥有依赖于](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1485) [停顿依赖性的工作](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1487) [抱歉](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1489) [不过 当然也有一些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1490) [工作负荷不具](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1492) [依赖性 它们可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1493) [在较低频率中发生](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1495) [也就是头戴式设备的频率](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1497) [这样的工作负荷](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1499) [这样的工作负荷](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1499) [比如可以是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1501) [基于物理的精准](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1503) [异常值的模拟](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1505) [或者需要大量更新时间](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1507) [的任何东西](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1511) [这样的工作负荷可以发生在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1513) [背景中 完全](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1515) [和渲染画面不同步](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1517) [而且在它每次](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1518) [准备完成后 它的结果就会被发送至](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1520) [主图形处理器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1523) [这里灰色的标记](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1525) [是用来表示它](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1527) [和任何特定一帧无关](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1528) [那么 当然会有](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1532) [具有不同性能特点的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1533) [不同图形处理器 而且](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1536) [它们会具有不同](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1538) [带宽的连接](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1538) [而且你的 App 将会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1540) [在一帧中拥有不同的工作负荷](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1543) [它们之间分别具有不同的关系](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1544) [因此你需要设计出一种方式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1548) [让你能分配这一工作负荷](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1551) [但是说了这么多](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1553) [开始考虑](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1556) [这一图形处理器工作负荷的分配](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1558) [这一图形处理器工作负荷的分配](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1558) [非常重要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1560) [因为多图形处理器配置如今](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1562) [在 Apple 应用平台上十分常见](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1564) [那么让我们来总结一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1567) [我们在这一节中学到的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1570) [所有内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1571) [我们展示了多线程 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1572) [来充分利用](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1573) [所有的中央处理器代码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1576) [并分离了命令缓冲区](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1577) [确保图形处理器没有处于空闲状态](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1580) [在这一过程中 在可能的条件下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1583) [我们尽量将](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1586) [非停顿依赖性工作负荷](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1587) [与停顿依赖性工作负荷划分开来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1588) [从而尽快对这一工作进行编码](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1591) [除此之外](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1592) [我们还根据更新频率划分工作负荷](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1596) [所以如果你的 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1598) [会在多图形处理器配置下执行](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1601) [你可以轻松地](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1602) [在那些图形处理器中对其进行分配](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1604) [而且在这一过程中](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1608) [确保你驱动各个图形处理器时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1611) [使用了独立的渲染线程](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1613) [从而确保它们在执行时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1615) [是不同步的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1617) [现在 你来到了降低填充率的部分](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1619) [现在 你来到了降低填充率的部分](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1619) [Vive Pro](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1623) [为 VR App 的开发者带来了新挑战](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1625) [为了更好地认识到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1628) [问题的严重性 我们将比较](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1629) [不同的媒介填充率](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1631) [例如](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1632) [按默认缩放比例](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1635) [对 Vive 头戴式设备进行渲染的 App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1638) [每秒可产生 4.36 亿像素](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1642) [而对于目前便宜的高清屏幕相比于](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1647) [最先进驱动的屏幕](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1650) [拥有每秒 4.75 亿像素](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1652) [的填充率](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1659) [这些数据已经过于大了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1660) [以至于游戏开发者](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1664) [做出了不同的改进 来降低这一填充率](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1665) [接下来让我们看看 Vive Pro](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1668) [在这些数据上的对比情况](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1669) [Vive Pro 拥有正常的填充率](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1673) [为每秒 7.75 亿像素](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1675) [如果你增加](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1679) [如果你增加](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1679) [4 倍多样本抗锯齿](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1680) [或者更大的缩放率](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1683) [这一数据就会变得更大](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1685) [这就是降低填充率](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1686) [为何如此重要](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1689) [现在已经有多种技术](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1692) [而且每一天都会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1693) [产生新的技术](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1694) [所以我建议你们 把它们都尝试一遍](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1696) [但是今天我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1699) [只关注其中的一小部分 因为它们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1702) [执行起来最为简单](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1704) [并能带来不错的性能提升](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1707) [那么我们先讲讲裁剪](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1710) [不可见的像素](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1711) [这里 你可以看到渲染的图像](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1713) [它针对的是左眼](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1716) [但是因为](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1718) [镜头的性质 大约 20% 的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1720) [像素会在生成器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1724) [执行失真校正后丢失](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1727) [在右侧 你可以看到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1730) [将在通过镜头之前](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1732) [展示在头戴式设备面板上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1733) [的图像](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1735) [所以 最简单的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1738) [所以 最简单的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1738) [降低填充率的方式就是防止我们的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1740) [App 渲染那些](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1743) [完全不可见的像素](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1745) [你可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1747) [通过使用 SteamVR Stencil Mask](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1749) [轻松实现](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1752) [那么我们刚刚降低了百分之 20 的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1754) [填充率 借助了这一](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1758) [简单的遮罩 并将我们 Vive](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1760) [Pro 的填充率降至 6.2 亿像素](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1762) [现在我们来分析一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1769) [执行这一镜头失真校正](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1772) [的更多细节](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1773) [我们可以将我们的视场](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1776) [分为九个区域](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1780) [中心区域的视野](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1783) [水平为 80 度](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1785) [垂直为 80 度](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1788) [周围区域](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1791) [位于边缘和角落里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1793) [我们为它们上了色](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1795) [从而可以更好地看到](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1797) [它们对最终图像的影响](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1798) [它们对最终图像的影响](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1798) [正如你所见](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1801) [角落几乎完全不可见](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1805) [和原来的相比](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1808) [边缘对图像的影响](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1811) [会更小](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1813) [事实上 如果你](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1815) [在头戴式设备中看这幅图像](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1817) [你是无法直接看到红色](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1820) [区域的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1822) [可以看到这些图像的唯一方式](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1824) [就是使用你的周边视觉](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1825) [这就给了我们很大的启发](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1828) [我们可以通过较低的填充率](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1833) [渲染这些边角区域](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1835) [因为不管怎么说](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1837) [它们几乎不可见](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1840) [我们渲染了中心区域](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1842) [如同之前一样](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1845) [但之后在渲染垂直边缘时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1847) [我们会将宽度减半](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1849) [对于水平区域](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1851) [则将高度减半](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1853) [最后 在渲染角落区域时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1854) [我们会将分辨率降至](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1857) [我们会将分辨率降至](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1857) [四分之一](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1860) [当我们完成昂贵的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1863) [渲染通道之后 我们会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1865) [执行廉价的放大通道](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1866) [让这些区域](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1869) [拉伸至](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1871) [需要提交给生成器的分辨率](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1873) [那么你可能会好奇](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1876) [这样我们可以获得多少提升](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1878) [对于 80x80 度](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1881) [的中央区域 我们将我们的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1883) [填充率一下子降到了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1885) [每秒 4.91 亿像素](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1887) [但是你应该记得我们刚刚](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1891) [提到了裁剪不可见像素](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1892) [所以让我们](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1894) [将这两个技术结合起来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1896) [通过将像素裁剪](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1900) [和多分辨率变化结合起来](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1902) [你甚至可以进一步将填充率](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1904) [降至每秒 4.56 亿像素](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1905) [这并不是一个随机数字](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1908) [事实上这是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1911) [Vive 头戴式设备的默认填充率](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1914) [所以仅仅通过使用这两项优化技术](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1917) [你的 App 就可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1919) [你的 App 就可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1919) [使用与渲染 Vive 头戴式设备时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1921) [所使用的相同图形处理器](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1923) [而得到更高的分辨率](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1925) [对 Vive Pro 进行渲染](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1928) [当然 你也可以](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1930) [在对 Vive 进行渲染时](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1932) [使用这些技术](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1933) [这能让你 App 的视觉化效果](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1935) [更加突出](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1937) [更加美观](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1940) [这里要提醒一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1941) [多分辨率变化](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1945) [需要一些新的渲染通道](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1947) [所以它会在几何管线上](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1950) [增加你的工作负荷](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1954) [但你可以轻松缓解这一问题](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1956) [只需将你的中心区域](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1958) [降低几度](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1959) [这里 仅将我们的中心视野](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1962) [降低了 10 度](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1964) [我们就将填充率一下子降低到了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1966) [每秒 3.82 亿像素](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1968) [而且如果你的几何图形的工作负荷](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1971) [非常高 你可以更进一步](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1973) [尝试更低的填充率](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1976) [更低的区域](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1979) [更低的区域](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1979) [这会将填充率降得更低](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1982) [对于 55x55 度的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1984) [中心区域 你百分之 80 的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1987) [眼部动作仍然会](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1991) [位于这一区域之中 但是](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1992) [我们将我们的填充率](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1995) [减少了一大半](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=1997) [降至每秒 3.6 亿像素](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=2000) [当然 还有其他](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=2003) [方法可以实现](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=2005) [多分辨率变化](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=2006) [而且你会从中获得](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=2010) [不同的性能提升](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=2012) [所以我建议大家](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=2014) [尝试这一技术](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=2016) [看看什么最适合你](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=2018) [下面让我们来总结一下](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=2021) [我们在本次会议中 学到的所有内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=2022) [我们刚刚公布了针对 Vive Pro 头戴式设备](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=2027) [的即插即用支持](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=2028) [并且介绍了](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=2030) [Metal 2 的新特性 它们能使你](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=2033) [开发更多的](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=2035) [先进的 VR App](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=2037) [然后我建议大家](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=2039) [然后我建议大家](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=2039) [利用多图形处理器配置](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=2041) [因为它们现在](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=2043) [在 Apple 平台上变得越来越常见](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=2045) [你可以通过这个链接](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=2048) [了解有关本次会议的更多内容](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=2052) [我想邀请大家](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=2054) [在 Metal 4 VR 实验室里](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=2056) [和我以及我的同事见面](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=2057) [时间就定在今天](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=2059) [中午 12 点 地点在 6 号](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=2061) [科技实验室](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=2064) [非常感谢大家](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=2064) [[ 掌声 ]](https://developer.apple.com/videos/wwdc2018/videos/play/wwdc2018/611/?time=2067)